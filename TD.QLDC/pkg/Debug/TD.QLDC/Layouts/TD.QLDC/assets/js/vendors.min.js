!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).numbro=t()}}(function(){return function o(a,s,l){function u(n,t){if(!s[n]){if(!a[n]){var e="function"==typeof require&&require;if(!t&&e)return e(n,!0);if(h)return h(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var i=s[n]={exports:{}};a[n][0].call(i.exports,function(t){var e=a[n][1][t];return u(e||t)},i,i.exports,o,a,s,l)}return s[n].exports}for(var h="function"==typeof require&&require,t=0;t<l.length;t++)u(l[t]);return u}({1:[function(t,n,e){!function(t){"use strict";var e,B=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,F=Math.ceil,V=Math.floor,j=" not a boolean or binary digit",W="rounding mode",U="number type has more than 15 significant digits",z="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",G=1e14,Y=14,$=9007199254740991,X=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],K=1e7,q=1e9;function Z(t){var e=0|t;return 0<t||t===e?e:e-1}function Q(t){for(var e,n,r=1,i=t.length,o=t[0]+"";r<i;){for(e=t[r++]+"",n=Y-e.length;n--;e="0"+e);o+=e}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function o(t,e){var n,r,i=t.c,o=e.c,a=t.s,s=e.s,l=t.e,u=e.e;if(!a||!s)return null;if(n=i&&!i[0],r=o&&!o[0],n||r)return n?r?0:-s:a;if(a!=s)return a;if(n=a<0,r=l==u,!i||!o)return r?0:!i^n?1:-1;if(!r)return u<l^n?1:-1;for(s=(l=i.length)<(u=o.length)?l:u,a=0;a<s;a++)if(i[a]!=o[a])return i[a]>o[a]^n?1:-1;return l==u?0:u<l^n?1:-1}function J(t,e,n){return(t=it(t))>=e&&t<=n}function tt(t){return"[object Array]"==Object.prototype.toString.call(t)}function et(t,e,n){for(var r,i,o=[0],a=0,s=t.length;a<s;){for(i=o.length;i--;o[i]*=e);for(o[r=0]+=z.indexOf(t.charAt(a++));r<o.length;r++)o[r]>n-1&&(null==o[r+1]&&(o[r+1]=0),o[r+1]+=o[r]/n|0,o[r]%=n)}return o.reverse()}function nt(t,e){return(1<t.length?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function rt(t,e){var n,r;if(e<0){for(r="0.";++e;r+="0");t=r+t}else if(++e>(n=t.length)){for(r="0",e-=n;--e;r+="0");t+=r}else e<n&&(t=t.slice(0,e)+"."+t.slice(e));return t}function it(t){return(t=parseFloat(t))<0?F(t):V(t)}(e=function t(e){var v,u,n,h,a,s,l,c,d,b=0,r=_.prototype,m=new _(1),p=20,y=4,f=-7,g=21,w=-1e7,C=1e7,E=!0,S=D,O=!1,T=1,N=0,R={decimalSeparator:".",groupSeparator:",",groupSize:3,secondaryGroupSize:0,fractionGroupSeparator:"Â ",fractionGroupSize:0};function _(t,e){var n,r,i,o,a,s,l=this;if(!(l instanceof _))return E&&P(26,"constructor call without new",t),new _(t,e);if(null!=e&&S(e,2,64,b,"base")){if(s=t+"",10==(e|=0))return H(l=new _(t instanceof _?t:s),p+l.e+1,y);if((o="number"==typeof t)&&0*t!=0||!new RegExp("^-?"+(n="["+z.slice(0,e)+"]+")+"(?:\\."+n+")?$",e<37?"i":"").test(s))return u(l,s,o,e);o?(l.s=1/t<0?(s=s.slice(1),-1):1,E&&15<s.replace(/^0\.0*|\./,"").length&&P(b,U,t),o=!1):l.s=45===s.charCodeAt(0)?(s=s.slice(1),-1):1,s=M(s,10,e,l.s)}else{if(t instanceof _)return l.s=t.s,l.e=t.e,l.c=(t=t.c)?t.slice():t,void(b=0);if((o="number"==typeof t)&&0*t==0){if(l.s=1/t<0?(t=-t,-1):1,t===~~t){for(r=0,i=t;10<=i;i/=10,r++);return l.e=r,l.c=[t],void(b=0)}s=t+""}else{if(!B.test(s=t+""))return u(l,s,o);l.s=45===s.charCodeAt(0)?(s=s.slice(1),-1):1}}for(-1<(r=s.indexOf("."))&&(s=s.replace(".","")),0<(i=s.search(/e/i))?(r<0&&(r=i),r+=+s.slice(i+1),s=s.substring(0,i)):r<0&&(r=s.length),i=0;48===s.charCodeAt(i);i++);for(a=s.length;48===s.charCodeAt(--a););if(s=s.slice(i,a+1))if(a=s.length,o&&E&&15<a&&($<t||t!==V(t))&&P(b,U,l.s*t),C<(r=r-i-1))l.c=l.e=null;else if(r<w)l.c=[l.e=0];else{if(l.e=r,l.c=[],i=(r+1)%Y,r<0&&(i+=Y),i<a){for(i&&l.c.push(+s.slice(0,i)),a-=Y;i<a;)l.c.push(+s.slice(i,i+=Y));s=s.slice(i),i=Y-s.length}else i-=a;for(;i--;s+="0");l.c.push(+s)}else l.c=[l.e=0];b=0}function M(t,e,n,r){var i,o,a,s,l,u,h,c=t.indexOf("."),d=p,f=y;for(n<37&&(t=t.toLowerCase()),0<=c&&(a=N,N=0,t=t.replace(".",""),l=(h=new _(n)).pow(t.length-c),N=a,h.c=et(rt(Q(l.c),l.e),10,e),h.e=h.c.length),o=a=(u=et(t,n,e)).length;0==u[--a];u.pop());if(!u[0])return"0";if(c<0?--o:(l.c=u,l.e=o,l.s=r,u=(l=v(l,h,d,f,e)).c,s=l.r,o=l.e),c=u[i=o+d+1],a=e/2,s=s||i<0||null!=u[i+1],s=f<4?(null!=c||s)&&(0==f||f==(l.s<0?3:2)):a<c||c==a&&(4==f||s||6==f&&1&u[i-1]||f==(l.s<0?8:7)),i<1||!u[0])t=s?rt("1",-d):"0";else{if(u.length=i,s)for(--e;++u[--i]>e;)u[i]=0,i||(++o,u=[1].concat(u));for(a=u.length;!u[--a];);for(c=0,t="";c<=a;t+=z.charAt(u[c++]));t=rt(t,o)}return t}function A(t,e,n){var r,i,o,a,s=0,l=t.length,u=e%K,h=e/K|0;for(t=t.slice();l--;)s=((i=u*(o=t[l]%K)+(r=h*o+(a=t[l]/K|0)*u)%K*K+s)/n|0)+(r/K|0)+h*a,t[l]=i%n;return s&&(t=[s].concat(t)),t}function k(t,e,n,r){var i,o;if(n!=r)o=r<n?1:-1;else for(i=o=0;i<n;i++)if(t[i]!=e[i]){o=t[i]>e[i]?1:-1;break}return o}function x(t,e,n,r){for(var i=0;n--;)t[n]-=i,i=t[n]<e[n]?1:0,t[n]=i*r+t[n]-e[n];for(;!t[0]&&1<t.length;t.splice(0,1));}function I(t,e,n,r){var i,o,a,s,l;if(n=null!=n&&S(n,0,8,r,W)?0|n:y,!t.c)return t.toString();if(i=t.c[0],a=t.e,null==e)l=Q(t.c),l=19==r||24==r&&a<=f?nt(l,a):rt(l,a);else if(o=(t=H(new _(t),e,n)).e,s=(l=Q(t.c)).length,19==r||24==r&&(e<=o||o<=f)){for(;s<e;l+="0",s++);l=nt(l,o)}else if(e-=a,l=rt(l,o),s<o+1){if(0<--e)for(l+=".";e--;l+="0");}else if(0<(e+=o-s))for(o+1==s&&(l+=".");e--;l+="0");return t.s<0&&i?"-"+l:l}function i(t,e){var n,r,i=0;for(tt(t[0])&&(t=t[0]),n=new _(t[0]);++i<t.length;){if(!(r=new _(t[i])).s){n=r;break}e.call(n,r)&&(n=r)}return n}function D(t,e,n,r,i){return(t<e||n<t||t!=it(t))&&P(r,(i||"decimal places")+(t<e||n<t?" out of range":" not an integer"),t),!0}function L(t,e,n){for(var r=1,i=e.length;!e[--i];e.pop());for(i=e[0];10<=i;i/=10,r++);return(n=r+n*Y-1)>C?t.c=t.e=null:n<w?t.c=[t.e=0]:(t.e=n,t.c=e),t}function P(t,e,n){var r=new Error(["new BigNumber","cmp","config","div","divToInt","eq","gt","gte","lt","lte","minus","mod","plus","precision","random","round","shift","times","toDigits","toExponential","toFixed","toFormat","toFraction","pow","toPrecision","toString","BigNumber"][t]+"() "+e+": "+n);throw r.name="BigNumber Error",b=0,r}function H(t,e,n,r){var i,o,a,s,l,u,h,c=t.c,d=X;if(c){t:{for(i=1,s=c[0];10<=s;s/=10,i++);if((o=e-i)<0)o+=Y,a=e,h=(l=c[u=0])/d[i-a-1]%10|0;else if((u=F((o+1)/Y))>=c.length){if(!r)break t;for(;c.length<=u;c.push(0));l=h=0,a=(o%=Y)-Y+(i=1)}else{for(l=s=c[u],i=1;10<=s;s/=10,i++);h=(a=(o%=Y)-Y+i)<0?0:l/d[i-a-1]%10|0}if(r=r||e<0||null!=c[u+1]||(a<0?l:l%d[i-a-1]),r=n<4?(h||r)&&(0==n||n==(t.s<0?3:2)):5<h||5==h&&(4==n||r||6==n&&(0<o?0<a?l/d[i-a]:0:c[u-1])%10&1||n==(t.s<0?8:7)),e<1||!c[0])return c.length=0,r?(e-=t.e+1,c[0]=d[(Y-e%Y)%Y],t.e=-e||0):c[0]=t.e=0,t;if(0==o?(c.length=u,s=1,u--):(c.length=u+1,s=d[Y-o],c[u]=0<a?V(l/d[i-a]%d[a])*s:0),r)for(;;){if(0==u){for(o=1,a=c[0];10<=a;a/=10,o++);for(a=c[0]+=s,s=1;10<=a;a/=10,s++);o!=s&&(t.e++,c[0]==G&&(c[0]=1));break}if(c[u]+=s,c[u]!=G)break;c[u--]=0,s=1}for(o=c.length;0===c[--o];c.pop());}t.e>C?t.c=t.e=null:t.e<w&&(t.c=[t.e=0])}return t}return _.another=t,_.ROUND_UP=0,_.ROUND_DOWN=1,_.ROUND_CEIL=2,_.ROUND_FLOOR=3,_.ROUND_HALF_UP=4,_.ROUND_HALF_DOWN=5,_.ROUND_HALF_EVEN=6,_.ROUND_HALF_CEIL=7,_.ROUND_HALF_FLOOR=8,_.EUCLID=9,_.config=_.set=function(){var t,e,n=0,r={},i=arguments,o=i[0],a=o&&"object"==typeof o?function(){if(o.hasOwnProperty(e))return null!=(t=o[e])}:function(){if(n<i.length)return null!=(t=i[n++])};return a(e="DECIMAL_PLACES")&&S(t,0,q,2,e)&&(p=0|t),r[e]=p,a(e="ROUNDING_MODE")&&S(t,0,8,2,e)&&(y=0|t),r[e]=y,a(e="EXPONENTIAL_AT")&&(tt(t)?S(t[0],-q,0,2,e)&&S(t[1],0,q,2,e)&&(f=0|t[0],g=0|t[1]):S(t,-q,q,2,e)&&(f=-(g=0|(t<0?-t:t)))),r[e]=[f,g],a(e="RANGE")&&(tt(t)?S(t[0],-q,-1,2,e)&&S(t[1],1,q,2,e)&&(w=0|t[0],C=0|t[1]):S(t,-q,q,2,e)&&(0|t?w=-(C=0|(t<0?-t:t)):E&&P(2,e+" cannot be zero",t))),r[e]=[w,C],a(e="ERRORS")&&(t===!!t||1===t||0===t?(b=0,S=(E=!!t)?D:J):E&&P(2,e+j,t)),r[e]=E,a(e="CRYPTO")&&(!0===t||!1===t||1===t||0===t?t?!(t="undefined"==typeof crypto)&&crypto&&(crypto.getRandomValues||crypto.randomBytes)?O=!0:E?P(2,"crypto unavailable",t?void 0:crypto):O=!1:O=!1:E&&P(2,e+j,t)),r[e]=O,a(e="MODULO_MODE")&&S(t,0,9,2,e)&&(T=0|t),r[e]=T,a(e="POW_PRECISION")&&S(t,0,q,2,e)&&(N=0|t),r[e]=N,a(e="FORMAT")&&("object"==typeof t?R=t:E&&P(2,e+" not an object",t)),r[e]=R,r},_.max=function(){return i(arguments,r.lt)},_.min=function(){return i(arguments,r.gt)},_.random=(n=9007199254740992,h=Math.random()*n&2097151?function(){return V(Math.random()*n)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,n,r,i,o,a=0,s=[],l=new _(m);if(t=null!=t&&S(t,0,q,14)?0|t:p,i=F(t/Y),O)if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(i*=2));a<i;)9e15<=(o=131072*e[a]+(e[a+1]>>>11))?(n=crypto.getRandomValues(new Uint32Array(2)),e[a]=n[0],e[a+1]=n[1]):(s.push(o%1e14),a+=2);a=i/2}else if(crypto.randomBytes){for(e=crypto.randomBytes(i*=7);a<i;)9e15<=(o=281474976710656*(31&e[a])+1099511627776*e[a+1]+4294967296*e[a+2]+16777216*e[a+3]+(e[a+4]<<16)+(e[a+5]<<8)+e[a+6])?crypto.randomBytes(7).copy(e,a):(s.push(o%1e14),a+=7);a=i/7}else O=!1,E&&P(14,"crypto unavailable",crypto);if(!O)for(;a<i;)(o=h())<9e15&&(s[a++]=o%1e14);for(i=s[--a],t%=Y,i&&t&&(o=X[Y-t],s[a]=V(i/o)*o);0===s[a];s.pop(),a--);if(a<0)s=[r=0];else{for(r=-1;0===s[0];s.splice(0,1),r-=Y);for(a=1,o=s[0];10<=o;o/=10,a++);a<Y&&(r-=Y-a)}return l.e=r,l.c=s,l}),v=function(t,e,n,r,i){var o,a,s,l,u,h,c,d,f,p,g,v,m,y,w,b,C,E=t.s==e.s?1:-1,S=t.c,O=e.c;if(!(S&&S[0]&&O&&O[0]))return new _(t.s&&e.s&&(S?!O||S[0]!=O[0]:O)?S&&0==S[0]||!O?0*E:E/0:NaN);for(f=(d=new _(E)).c=[],E=n+(a=t.e-e.e)+1,i||(i=G,a=Z(t.e/Y)-Z(e.e/Y),E=E/Y|0),s=0;O[s]==(S[s]||0);s++);if(O[s]>(S[s]||0)&&a--,E<0)f.push(1),l=!0;else{for(y=S.length,b=O.length,E+=2,1<(u=V(i/(O[s=0]+1)))&&(O=A(O,u,i),S=A(S,u,i),b=O.length,y=S.length),m=b,g=(p=S.slice(0,b)).length;g<b;p[g++]=0);C=O.slice(),C=[0].concat(C),w=O[0],O[1]>=i/2&&w++;do{if(u=0,(o=k(O,p,b,g))<0){if(v=p[0],b!=g&&(v=v*i+(p[1]||0)),1<(u=V(v/w)))for(i<=u&&(u=i-1),c=(h=A(O,u,i)).length,g=p.length;1==k(h,p,c,g);)u--,x(h,b<c?C:O,c,i),c=h.length,o=1;else 0==u&&(o=u=1),c=(h=O.slice()).length;if(c<g&&(h=[0].concat(h)),x(p,h,g,i),g=p.length,-1==o)for(;k(O,p,b,g)<1;)u++,x(p,b<g?C:O,g,i),g=p.length}else 0===o&&(u++,p=[0]);f[s++]=u,p[0]?p[g++]=S[m]||0:(p=[S[m]],g=1)}while((m++<y||null!=p[0])&&E--);l=null!=p[0],f[0]||f.splice(0,1)}if(i==G){for(s=1,E=f[0];10<=E;E/=10,s++);H(d,n+(d.e=s+a*Y-1)+1,r,l)}else d.e=a,d.r=+l;return d},a=/^(-?)0([xbo])(?=\w[\w.]*$)/i,s=/^([^.]+)\.$/,l=/^\.([^.]+)$/,c=/^-?(Infinity|NaN)$/,d=/^\s*\+(?=[\w.])|^\s+|\s+$/g,u=function(t,e,n,r){var i,o=n?e:e.replace(d,"");if(c.test(o))t.s=isNaN(o)?null:o<0?-1:1;else{if(!n&&(o=o.replace(a,function(t,e,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=i?t:e}),r&&(i=r,o=o.replace(s,"$1").replace(l,"0.$1")),e!=o))return new _(o,i);E&&P(b,"not a"+(r?" base "+r:"")+" number",e),t.s=null}t.c=t.e=null,b=0},r.absoluteValue=r.abs=function(){var t=new _(this);return t.s<0&&(t.s=1),t},r.ceil=function(){return H(new _(this),this.e+1,2)},r.comparedTo=r.cmp=function(t,e){return b=1,o(this,new _(t,e))},r.decimalPlaces=r.dp=function(){var t,e,n=this.c;if(!n)return null;if(t=((e=n.length-1)-Z(this.e/Y))*Y,e=n[e])for(;e%10==0;e/=10,t--);return t<0&&(t=0),t},r.dividedBy=r.div=function(t,e){return b=3,v(this,new _(t,e),p,y)},r.dividedToIntegerBy=r.divToInt=function(t,e){return b=4,v(this,new _(t,e),0,1)},r.equals=r.eq=function(t,e){return b=5,0===o(this,new _(t,e))},r.floor=function(){return H(new _(this),this.e+1,3)},r.greaterThan=r.gt=function(t,e){return b=6,0<o(this,new _(t,e))},r.greaterThanOrEqualTo=r.gte=function(t,e){return b=7,1===(e=o(this,new _(t,e)))||0===e},r.isFinite=function(){return!!this.c},r.isInteger=r.isInt=function(){return!!this.c&&Z(this.e/Y)>this.c.length-2},r.isNaN=function(){return!this.s},r.isNegative=r.isNeg=function(){return this.s<0},r.isZero=function(){return!!this.c&&0==this.c[0]},r.lessThan=r.lt=function(t,e){return b=8,o(this,new _(t,e))<0},r.lessThanOrEqualTo=r.lte=function(t,e){return b=9,-1===(e=o(this,new _(t,e)))||0===e},r.minus=r.sub=function(t,e){var n,r,i,o,a=this,s=a.s;if(b=10,e=(t=new _(t,e)).s,!s||!e)return new _(NaN);if(s!=e)return t.s=-e,a.plus(t);var l=a.e/Y,u=t.e/Y,h=a.c,c=t.c;if(!l||!u){if(!h||!c)return h?(t.s=-e,t):new _(c?a:NaN);if(!h[0]||!c[0])return c[0]?(t.s=-e,t):new _(h[0]?a:3==y?-0:0)}if(l=Z(l),u=Z(u),h=h.slice(),s=l-u){for((i=(o=s<0)?(s=-s,h):(u=l,c)).reverse(),e=s;e--;i.push(0));i.reverse()}else for(r=(o=(s=h.length)<(e=c.length))?s:e,s=e=0;e<r;e++)if(h[e]!=c[e]){o=h[e]<c[e];break}if(o&&(i=h,h=c,c=i,t.s=-t.s),0<(e=(r=c.length)-(n=h.length)))for(;e--;h[n++]=0);for(e=G-1;s<r;){if(h[--r]<c[r]){for(n=r;n&&!h[--n];h[n]=e);--h[n],h[r]+=G}h[r]-=c[r]}for(;0==h[0];h.splice(0,1),--u);return h[0]?L(t,h,u):(t.s=3==y?-1:1,t.c=[t.e=0],t)},r.modulo=r.mod=function(t,e){var n,r,i=this;return b=11,t=new _(t,e),!i.c||!t.s||t.c&&!t.c[0]?new _(NaN):!t.c||i.c&&!i.c[0]?new _(i):(9==T?(r=t.s,t.s=1,n=v(i,t,0,3),t.s=r,n.s*=r):n=v(i,t,0,T),i.minus(n.times(t)))},r.negated=r.neg=function(){var t=new _(this);return t.s=-t.s||null,t},r.plus=r.add=function(t,e){var n,r=this,i=r.s;if(b=12,e=(t=new _(t,e)).s,!i||!e)return new _(NaN);if(i!=e)return t.s=-e,r.minus(t);var o=r.e/Y,a=t.e/Y,s=r.c,l=t.c;if(!o||!a){if(!s||!l)return new _(i/0);if(!s[0]||!l[0])return l[0]?t:new _(s[0]?r:0*i)}if(o=Z(o),a=Z(a),s=s.slice(),i=o-a){for((n=0<i?(a=o,l):(i=-i,s)).reverse();i--;n.push(0));n.reverse()}for((i=s.length)-(e=l.length)<0&&(n=l,l=s,s=n,e=i),i=0;e;)i=(s[--e]=s[e]+l[e]+i)/G|0,s[e]=G===s[e]?0:s[e]%G;return i&&(s=[i].concat(s),++a),L(t,s,a)},r.precision=r.sd=function(t){var e,n,r=this.c;if(null!=t&&t!==!!t&&1!==t&&0!==t&&(E&&P(13,"argument"+j,t),t!=!!t&&(t=null)),!r)return null;if(e=(n=r.length-1)*Y+1,n=r[n]){for(;n%10==0;n/=10,e--);for(n=r[0];10<=n;n/=10,e++);}return t&&this.e+1>e&&(e=this.e+1),e},r.round=function(t,e){var n=new _(this);return null!=t&&!S(t,0,q,15)||H(n,~~t+this.e+1,null!=e&&S(e,0,8,15,W)?0|e:y),n},r.shift=function(t){var e=this;return S(t,-$,$,16,"argument")?e.times("1e"+it(t)):new _(e.c&&e.c[0]&&(t<-$||$<t)?e.s*(t<0?0:1/0):e)},r.squareRoot=r.sqrt=function(){var t,e,n,r,i,o=this,a=o.c,s=o.s,l=o.e,u=p+4,h=new _("0.5");if(1!==s||!a||!a[0])return new _(!s||s<0&&(!a||a[0])?NaN:a?o:1/0);if((n=0==(s=Math.sqrt(+o))||s==1/0?(((e=Q(a)).length+l)%2==0&&(e+="0"),s=Math.sqrt(e),l=Z((l+1)/2)-(l<0||l%2),new _(e=s==1/0?"1e"+l:(e=s.toExponential()).slice(0,e.indexOf("e")+1)+l)):new _(s+"")).c[0])for((s=(l=n.e)+u)<3&&(s=0);;)if(i=n,n=h.times(i.plus(v(o,i,u,1))),Q(i.c).slice(0,s)===(e=Q(n.c)).slice(0,s)){if(n.e<l&&--s,"9999"!=(e=e.slice(s-3,s+1))&&(r||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(H(n,n.e+p+2,1),t=!n.times(n).eq(o));break}if(!r&&(H(i,i.e+p+2,0),i.times(i).eq(o))){n=i;break}u+=4,s+=4,r=1}return H(n,n.e+p+1,y,t)},r.times=r.mul=function(t,e){var n,r,i,o,a,s,l,u,h,c,d,f,p,g,v,m=this,y=m.c,w=(b=17,t=new _(t,e)).c;if(!(y&&w&&y[0]&&w[0]))return!m.s||!t.s||y&&!y[0]&&!w||w&&!w[0]&&!y?t.c=t.e=t.s=null:(t.s*=m.s,y&&w?(t.c=[0],t.e=0):t.c=t.e=null),t;for(r=Z(m.e/Y)+Z(t.e/Y),t.s*=m.s,(l=y.length)<(c=w.length)&&(p=y,y=w,w=p,i=l,l=c,c=i),i=l+c,p=[];i--;p.push(0));for(g=G,v=K,i=c;0<=--i;){for(n=0,d=w[i]%v,f=w[i]/v|0,o=i+(a=l);i<o;)n=((u=d*(u=y[--a]%v)+(s=f*u+(h=y[a]/v|0)*d)%v*v+p[o]+n)/g|0)+(s/v|0)+f*h,p[o--]=u%g;p[o]=n}return n?++r:p.splice(0,1),L(t,p,r)},r.toDigits=function(t,e){var n=new _(this);return t=null!=t&&S(t,1,q,18,"precision")?0|t:null,e=null!=e&&S(e,0,8,18,W)?0|e:y,t?H(n,t,e):n},r.toExponential=function(t,e){return I(this,null!=t&&S(t,0,q,19)?1+~~t:null,e,19)},r.toFixed=function(t,e){return I(this,null!=t&&S(t,0,q,20)?~~t+this.e+1:null,e,20)},r.toFormat=function(t,e){var n=I(this,null!=t&&S(t,0,q,21)?~~t+this.e+1:null,e,21);if(this.c){var r,i=n.split("."),o=+R.groupSize,a=+R.secondaryGroupSize,s=R.groupSeparator,l=i[0],u=i[1],h=this.s<0,c=h?l.slice(1):l,d=c.length;if(a&&(r=o,o=a,d-=a=r),0<o&&0<d){for(r=d%o||o,l=c.substr(0,r);r<d;r+=o)l+=s+c.substr(r,o);0<a&&(l+=s+c.slice(r)),h&&(l="-"+l)}n=u?l+R.decimalSeparator+((a=+R.fractionGroupSize)?u.replace(new RegExp("\\d{"+a+"}\\B","g"),"$&"+R.fractionGroupSeparator):u):l}return n},r.toFraction=function(t){var e,n,r,i,o,a,s,l,u,h=E,c=this,d=c.c,f=new _(m),p=n=new _(m),g=s=new _(m);if(null!=t&&(E=!1,a=new _(t),E=h,(h=a.isInt())&&!a.lt(m)||(E&&P(22,"max denominator "+(h?"out of range":"not an integer"),t),t=!h&&a.c&&H(a,a.e+1,1).gte(m)?a:null)),!d)return c.toString();for(u=Q(d),i=f.e=u.length-c.e-1,f.c[0]=X[(o=i%Y)<0?Y+o:o],t=!t||0<a.cmp(f)?0<i?f:p:a,o=C,C=1/0,a=new _(u),s.c[0]=0;l=v(a,f,0,1),1!=(r=n.plus(l.times(g))).cmp(t);)n=g,g=r,p=s.plus(l.times(r=p)),s=r,f=a.minus(l.times(r=f)),a=r;return r=v(t.minus(n),g,0,1),s=s.plus(r.times(p)),n=n.plus(r.times(g)),s.s=p.s=c.s,e=v(p,g,i*=2,y).minus(c).abs().cmp(v(s,n,i,y).minus(c).abs())<1?[p.toString(),g.toString()]:[s.toString(),n.toString()],C=o,e},r.toNumber=function(){return+this},r.toPower=r.pow=function(t,e){var n,r,i,o=V(t<0?-t:+t),a=this;if(null!=e&&(b=23,e=new _(e)),!S(t,-$,$,23,"exponent")&&(!isFinite(t)||$<o&&(t/=0)||parseFloat(t)!=t&&!(t=NaN))||0==t)return n=Math.pow(+a,t),new _(e?n%e:n);for(e?1<t&&a.gt(m)&&a.isInt()&&e.gt(m)&&e.isInt()?a=a.mod(e):(i=e,e=null):N&&(n=F(N/Y+2)),r=new _(m);;){if(o%2){if(!(r=r.times(a)).c)break;n?r.c.length>n&&(r.c.length=n):e&&(r=r.mod(e))}if(!(o=V(o/2)))break;a=a.times(a),n?a.c&&a.c.length>n&&(a.c.length=n):e&&(a=a.mod(e))}return e?r:(t<0&&(r=m.div(r)),i?r.mod(i):n?H(r,N,y):r)},r.toPrecision=function(t,e){return I(this,null!=t&&S(t,1,q,24,"precision")?0|t:null,e,24)},r.toString=function(t){var e,n=this.s,r=this.e;return null===r?n?(e="Infinity",n<0&&(e="-"+e)):e="NaN":(e=Q(this.c),e=null!=t&&S(t,2,64,25,"base")?M(rt(e,r),0|t,10,n):r<=f||g<=r?nt(e,r):rt(e,r),n<0&&this.c[0]&&(e="-"+e)),e},r.truncated=r.trunc=function(){return H(new _(this),this.e+1,1)},r.valueOf=r.toJSON=function(){var t,e=this.e;return null===e?this.toString():(t=Q(this.c),t=e<=f||g<=e?nt(t,e):rt(t,e),this.s<0?"-"+t:t)},r.isBigNumber=!0,null!=e&&_.config(e),_}()).default=e.BigNumber=e,void 0!==n&&n.exports?n.exports=e:(t=t||("undefined"!=typeof self?self:Function("return this")())).BigNumber=e}(this)},{}],2:[function(t,e,n){"use strict";e.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1==e?"st":2==e?"nd":3==e?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,e,n){"use strict";var R=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_=t("./globalState"),a=t("./validating"),s=t("./parsing"),r=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:r,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:r,marker:"d"}},M={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function i(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];if("string"==typeof e&&(e=s.parseFormat(e)),!a.validateFormat(e))return"ERROR: invalid format";var r=e.prefix||"",i=e.postfix||"",o=function(t,e,n){switch(e.output){case"currency":return e=l(e,_.currentCurrencyDefaultFormat()),function(t,e,n){var r=n.currentCurrency(),i=Object.assign({},M,e),o=void 0,a="",s=!!i.totalLength||!!i.forceAverage||i.average,l=e.currencyPosition||r.position,u=e.currencySymbol||r.symbol;i.spaceSeparated&&(a=" ");"infix"===l&&(o=a+u+a);var h=f({instance:t,providedFormat:e,state:n,decimalSeparator:o});"prefix"===l&&(h=t._value<0&&"sign"===i.negative?"-"+a+u+h.slice(1):u+a+h);l&&"postfix"!==l||(h=h+(a=s?"":a)+u);return h}(t,e,_);case"percent":return e=l(e,_.currentPercentageDefaultFormat()),function(t,e,n,r){var i=e.prefixSymbol,o=f({instance:r(100*t._value),providedFormat:e,state:n}),a=Object.assign({},M,e);if(i)return"%"+(a.spaceSeparated?" ":"")+o;return o+(a.spaceSeparated?" ":"")+"%"}(t,e,_,n);case"byte":return e=l(e,_.currentByteDefaultFormat()),function(t,e,n,r){var i=e.base||"binary",o=c[i],a=d(t._value,o.suffixes,o.scale),s=a.value,l=a.suffix,u=f({instance:r(s),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()}),h=n.currentAbbreviations();return u+(h.spaced?" ":"")+l}(t,e,_,n);case"time":return e=l(e,_.currentTimeDefaultFormat()),function(t){var e=Math.floor(t._value/60/60),n=Math.floor((t._value-60*e*60)/60),r=Math.round(t._value-60*e*60-60*n);return e+":"+(n<10?"0":"")+n+":"+(r<10?"0":"")+r}(t);case"ordinal":return e=l(e,_.currentOrdinalDefaultFormat()),function(t,e,n){var r=n.currentOrdinal(),i=Object.assign({},M,e),o=f({instance:t,providedFormat:e,state:n}),a=r(t._value);return o+(i.spaceSeparated?" ":"")+a}(t,e,_);case"number":default:return f({instance:t,providedFormat:e,numbro:n})}}(t,e,n);return o=function(t,e){return t+e}(o=function(t,e){return e+t}(o,r),i)}function d(t,e,n){var r=e[0],i=Math.abs(t);if(n<=i){for(var o=1;o<e.length;++o){var a=Math.pow(n,o),s=Math.pow(n,o+1);if(a<=i&&i<s){r=e[o],t/=a;break}}r===e[0]&&(t/=Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function p(t){for(var e="",n=0;n<t;n++)e+="0";return e}function A(t,e){return-1!==t.toString().indexOf("e")?function(t,e){var n=t.toString(),r=n.split("e"),i=R(r,2),o=i[0],a=i[1],s=o.split("."),l=R(s,2),u=l[0],h=l[1],c=void 0===h?"":h;if(0<+a)n=u+c+p(a-c.length);else{var d=".";d=+u<0?"-0"+d:"0"+d;var f=(p(-a-1)+Math.abs(u)+c).substr(0,e);f.length<e&&(f+=p(e-f.length)),n=d+f}return 0<+a&&0<e&&(n+="."+p(e)),n}(t,e):(Math.round(+(t+"e+"+e))/Math.pow(10,e)).toFixed(e)}function k(t,e,n,r,i){var o=r.currentDelimiters(),a=o.thousands;i=i||o.decimal;var s=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],h=l.split(".")[1];n&&(e<0&&(u=u.slice(1)),function(t,e){for(var n=[],r=0,i=t;0<i;i--)r===e&&(n.unshift(i),r=0),r++;return n}(u.length,s).forEach(function(t,e){u=u.slice(0,t+e)+a+u.slice(t+e)}),e<0&&(u="-"+u));return l=h?u+i+h:u}function f(t){var e=t.instance,n=t.providedFormat,r=t.state,i=void 0===r?_:r,o=t.decimalSeparator,a=t.defaults,s=void 0===a?i.currentDefaults():a,l=e._value;if(0===l&&i.hasZeroFormat())return i.getZeroFormat();if(!isFinite(l))return l.toString();var u=Object.assign({},M,s,n),h=u.totalLength,c=h?0:u.characteristic,d=u.optionalCharacteristic,f=u.forceAverage,p=!!h||!!f||u.average,g=h?-1:p&&void 0===n.mantissa?0:u.mantissa,v=!h&&(void 0===n.optionalMantissa?-1===g:u.optionalMantissa),m=u.trimMantissa,y=u.thousandSeparated,w=u.spaceSeparated,b=u.negative,C=u.forceSign,E=u.exponential,S="";if(p){var O=function(t){var e=t.value,n=t.forceAverage,r=t.abbreviations,i=t.spaceSeparated,o=void 0!==i&&i,a=t.totalLength,s=void 0===a?0:a,l="",u=Math.abs(e),h=-1;if(u>=Math.pow(10,12)&&!n||"trillion"===n?(l=r.trillion,e/=Math.pow(10,12)):u<Math.pow(10,12)&&u>=Math.pow(10,9)&&!n||"billion"===n?(l=r.billion,e/=Math.pow(10,9)):u<Math.pow(10,9)&&u>=Math.pow(10,6)&&!n||"million"===n?(l=r.million,e/=Math.pow(10,6)):(u<Math.pow(10,6)&&u>=Math.pow(10,3)&&!n||"thousand"===n)&&(l=r.thousand,e/=Math.pow(10,3)),l=l&&(o?" ":"")+l,s){var c=e.toString().split(".")[0];h=Math.max(s-c.length,0)}return{value:e,abbreviation:l,mantissaPrecision:h}}({value:l,forceAverage:f,abbreviations:i.currentAbbreviations(),spaceSeparated:w,totalLength:h});l=O.value,S+=O.abbreviation,h&&(g=O.mantissaPrecision)}if(E){var T=function(t){var e=t.value,n=t.characteristicPrecision,r=void 0===n?0:n,i=e.toExponential().split("e"),o=R(i,2),a=o[0],s=o[1],l=+a;return r&&1<r&&(l*=Math.pow(10,r-1),s=0<=(s=+s-(r-1))?"+"+s:s),{value:l,abbreviation:"e"+s}}({value:l,characteristicPrecision:c});l=T.value,S=T.abbreviation+S}var N=function(t,e,n,r,i){if(-1===r)return t;var o=A(e,r),a=o.toString().split("."),s=R(a,2),l=s[0],u=s[1],h=void 0===u?"":u;if(h.match(/^0+$/)&&(n||i))return l;var c=h.match(/0+$/);return i&&c?l+"."+h.toString().slice(0,c.index):o.toString()}(l.toString(),l,v,g,m);return N=k(N=function(t,e,n,r){var i=t,o=i.toString().split("."),a=R(o,2),s=a[0],l=a[1];if(s.match(/^-?0$/)&&n)return l?s.replace("0","")+"."+l:s.replace("0","");if(s.length<r)for(var u=r-s.length,h=0;h<u;h++)i="0"+i;return i.toString()}(N,0,d,c),l,y,i,o),(p||E)&&(N=function(t,e){return t+e}(N,S)),(C||l<0)&&(N=function(t,e,n){return 0===e?t:0==+t?t.replace("-",""):0<e?"+"+t:"sign"===n?t:"("+t.replace("-","")+")"}(N,l,b)),N}function l(t,e){if(!t)return e;var n=Object.keys(t);return 1===n.length&&"output"===n[0]?e:t}e.exports=function(r){return{format:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.apply(void 0,e.concat([r]))},getByteUnit:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){var e=c.general;return d(t._value,e.suffixes,e.scale).suffix}.apply(void 0,e.concat([r]))},getBinaryByteUnit:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){var e=c.binary;return d(t._value,e.suffixes,e.scale).suffix}.apply(void 0,e.concat([r]))},getDecimalByteUnit:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){var e=c.decimal;return d(t._value,e.suffixes,e.scale).suffix}.apply(void 0,e.concat([r]))},formatOrDefault:l}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,e,n){"use strict";var i=t("./en-US"),r=t("./validating"),o=t("./parsing"),a={},s=void 0,l={},u=null,h={};function c(t){s=t}function d(){return l[s]}a.languages=function(){return Object.assign({},l)},a.currentLanguage=function(){return s},a.currentCurrency=function(){return d().currency},a.currentAbbreviations=function(){return d().abbreviations},a.currentDelimiters=function(){return d().delimiters},a.currentOrdinal=function(){return d().ordinal},a.currentDefaults=function(){return Object.assign({},d().defaults,h)},a.currentOrdinalDefaultFormat=function(){return Object.assign({},a.currentDefaults(),d().ordinalFormat)},a.currentByteDefaultFormat=function(){return Object.assign({},a.currentDefaults(),d().byteFormat)},a.currentPercentageDefaultFormat=function(){return Object.assign({},a.currentDefaults(),d().percentageFormat)},a.currentCurrencyDefaultFormat=function(){return Object.assign({},a.currentDefaults(),d().currencyFormat)},a.currentTimeDefaultFormat=function(){return Object.assign({},a.currentDefaults(),d().timeFormat)},a.setDefaults=function(t){t=o.parseFormat(t),r.validateFormat(t)&&(h=t)},a.getZeroFormat=function(){return u},a.setZeroFormat=function(t){return u="string"==typeof t?t:null},a.hasZeroFormat=function(){return null!==u},a.languageData=function(t){if(t){if(l[t])return l[t];throw new Error('Unknown tag "'+t+'"')}return d()},a.registerLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!r.validateLanguage(t))throw new Error("Invalid language data");l[t.languageTag]=t,e&&c(t.languageTag)},a.setLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:i.languageTag;if(!l[t]){var n=t.split("-")[0],r=Object.keys(l).find(function(t){return t.split("-")[0]===n});return l[r]?void c(r):void c(e)}c(t)},a.registerLanguage(i),s=i.languageTag,e.exports=a},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,t,e){"use strict";t.exports=function(e){return{loadLanguagesInNode:function(t){return function(t,n){t.forEach(function(e){var t=void 0;try{t=r("../languages/"+e)}catch(t){console.error('Unable to load "'+e+'". No matching language file found.')}t&&n.registerLanguage(t)})}(t,e)}}}},{}],6:[function(t,e,n){"use strict";var o=t("bignumber.js");function i(t,e,n){var r=new o(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new o(i),t._value=r.minus(i).toNumber(),t}e.exports=function(n){return{add:function(t,e){return function(t,e,n){var r=new o(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new o(i),t._value=r.add(i).toNumber(),t}(t,e,n)},subtract:function(t,e){return i(t,e,n)},multiply:function(t,e){return function(t,e,n){var r=new o(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new o(i),t._value=r.times(i).toNumber(),t}(t,e,n)},divide:function(t,e){return function(t,e,n){var r=new o(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new o(i),t._value=r.dividedBy(i).toNumber(),t}(t,e,n)},set:function(t,e){return function(t,e,n){var r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}(t,e,n)},difference:function(t,e){return function(t,e,n){var r=n(t._value);return i(r,e,n),Math.abs(r._value)}(t,e,n)}}}},{"bignumber.js":1}],7:[function(t,e,n){"use strict";var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=t("./globalState"),a=t("./validating"),s=t("./loading")(g),l=t("./unformatting"),u=t("./formatting")(g),h=t("./manipulating")(g),c=t("./parsing"),d=(r(f,[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(t){var e=0<arguments.length&&void 0!==t?t:{};return u.format(this,e)}},{key:"formatCurrency",value:function(t){return"string"==typeof t&&(t=c.parseFormat(t)),(t=u.formatOrDefault(t,o.currentCurrencyDefaultFormat())).output="currency",u.format(this,t)}},{key:"formatTime",value:function(t){var e=0<arguments.length&&void 0!==t?t:{};return e.output="time",u.format(this,e)}},{key:"binaryByteUnits",value:function(){return u.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return u.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return u.getByteUnit(this)}},{key:"difference",value:function(t){return h.difference(this,t)}},{key:"add",value:function(t){return h.add(this,t)}},{key:"subtract",value:function(t){return h.subtract(this,t)}},{key:"multiply",value:function(t){return h.multiply(this,t)}},{key:"divide",value:function(t){return h.divide(this,t)}},{key:"set",value:function(t){return h.set(this,p(t))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}]),f);function f(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),this._value=t}function p(t){var e=t;return g.isNumbro(t)?e=t._value:"string"==typeof t?e=g.unformat(t):isNaN(t)&&(e=NaN),e}function g(t){return new d(p(t))}g.version="2.1.1",g.isNumbro=function(t){return t instanceof d},g.language=o.currentLanguage,g.registerLanguage=o.registerLanguage,g.setLanguage=o.setLanguage,g.languages=o.languages,g.languageData=o.languageData,g.zeroFormat=o.setZeroFormat,g.defaultFormat=o.currentDefaults,g.setDefaults=o.setDefaults,g.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,g.validate=a.validate,g.loadLanguagesInNode=s.loadLanguagesInNode,g.unformat=l.unformat,e.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,e,n){"use strict";e.exports={parseFormat:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof t?t:(function(t,e){if(-1===t.indexOf("$")){if(-1===t.indexOf("%"))return-1!==t.indexOf("bd")?(e.output="byte",e.base="general"):-1!==t.indexOf("b")?(e.output="byte",e.base="binary"):-1!==t.indexOf("d")?(e.output="byte",e.base="decimal"):-1===t.indexOf(":")?-1!==t.indexOf("o")&&(e.output="ordinal"):e.output="time";e.output="percent"}else e.output="currency"}(t=function(t,e){var n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}(t=function(t,e){var n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}(t,e),e),e),function(t,e){var n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}(t,e),function(t,e){var n=t.split(".")[0].match(/0+/);n&&(e.characteristic=n[0].length)}(t,e),function(t,e){if(-1!==t.indexOf(".")){var n=t.split(".")[0];e.optionalCharacteristic=-1===n.indexOf("0")}}(t,e),function(t,e){-1!==t.indexOf("a")&&(e.average=!0)}(t,e),function(t,e){-1!==t.indexOf("K")?e.forceAverage="thousand":-1!==t.indexOf("M")?e.forceAverage="million":-1!==t.indexOf("B")?e.forceAverage="billion":-1!==t.indexOf("T")&&(e.forceAverage="trillion")}(t,e),function(t,e){var n=t.split(".")[1];if(n){var r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}(t,e),function(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}(t,e),function(t,e){-1!==t.indexOf(",")&&(e.thousandSeparated=!0)}(t,e),function(t,e){-1!==t.indexOf(" ")&&(e.spaceSeparated=!0)}(t,e),function(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}(t,e),function(t,e){t.match(/^\+/)&&(e.forceSign=!0)}(t,e),e)}}},{}],9:[function(u,t,e){"use strict";var N=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function R(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function h(t,e,n,r,i,o,a){var s=2<arguments.length&&void 0!==n?n:"",l=r,u=i,h=o,c=a;if(""!==t)return isNaN(+t)?t===u?0:function t(e,n,r,i,o,a,s){var l=2<arguments.length&&void 0!==r?r:"",u=i,h=o,c=a,d=s;if(!isNaN(+e))return+e;var f="",p=e.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(p!==e)return-1*t(p,n,l,u,h,c,d);for(var g=0;g<N.length;g++){var v=N[g];if((f=e.replace(v.key,""))!==e)return t(f,n,l,u,h,c,d)*v.factor}if((f=e.replace("%",""))!==e)return t(f,n,l,u,h,c,d)/100;var m=parseFloat(e);if(!isNaN(m)){var y=u(m);if(y&&"."!==y&&(f=e.replace(new RegExp(R(y)+"$"),""))!==e)return t(f,n,l,u,h,c,d);var w={};Object.keys(c).forEach(function(t){w[c[t]]=t});for(var b=Object.keys(w).sort().reverse(),C=b.length,E=0;E<C;E++){var S=b[E],O=w[S];if((f=e.replace(S,""))!==e){var T=void 0;switch(O){case"thousand":T=Math.pow(10,3);break;case"million":T=Math.pow(10,6);break;case"billion":T=Math.pow(10,9);break;case"trillion":T=Math.pow(10,12)}return t(f,n,l,u,h,c,d)*T}}}}(function(t,e,n){var r=2<arguments.length&&void 0!==n?n:"",i=t.replace(r,"");return i=(i=i.replace(new RegExp("([0-9])"+R(e.thousands)+"([0-9])","g"),"$1$2")).replace(e.decimal,".")}(t,e,s),e,s,l,u,h,c):+t}t.exports={unformat:function(t,e){var n=u("./globalState"),r=n.currentDelimiters(),i=n.currentCurrency().symbol,o=n.currentOrdinal(),a=n.getZeroFormat(),s=n.currentAbbreviations(),l=void 0;if("string"==typeof t)l=function(t,e){if(!(t.indexOf(":")&&":"!==e.thousands))return!1;var n=t.split(":");if(3!==n.length)return!1;var r=+n[0],i=+n[1],o=+n[2];return!isNaN(r)&&!isNaN(i)&&!isNaN(o)}(t,r)?function(t){var e=t.split(":"),n=+e[0],r=+e[1];return+e[2]+60*r+3600*n}(t):h(t,r,i,o,a,s,e);else{if("number"!=typeof t)return;l=t}if(void 0!==l)return l}}},{"./globalState":4}],10:[function(t,e,n){"use strict";var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};var r=t("./unformatting"),i=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,d={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(t,e){return"byte"===e.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(t){return"byte"===t.output}},characteristic:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(t){return 0<=t},message:"value must be positive"},{restriction:function(t,e){return!e.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(t,e){return"percent"===e.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},o={languageTag:{type:"string",mandatory:!0,restriction:function(t){return t.match(i)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function a(t){return!!r.unformat(t)}function f(l,u,h,t){var e=3<arguments.length&&void 0!==t&&t,n=Object.keys(l).map(function(t){if(!u[t])return console.error(h+" Invalid key: "+t),!1;var e=l[t],n=u[t];if("string"==typeof n&&(n={type:n}),"format"===n.type){if(!f(e,d,"[Validate "+t+"]",!0))return!1}else if((void 0===e?"undefined":c(e))!==n.type)return console.error(h+" "+t+' type mismatched: "'+n.type+'" expected, "'+(void 0===e?"undefined":c(e))+'" provided'),!1;if(n.restrictions&&n.restrictions.length)for(var r=n.restrictions.length,i=0;i<r;i++){var o=n.restrictions[i],a=o.restriction,s=o.message;if(!a(e,l))return console.error(h+" "+t+" invalid value: "+s),!1}if(n.restriction&&!n.restriction(e,l))return console.error(h+" "+t+" invalid value: "+n.message),!1;if(n.validValues&&-1===n.validValues.indexOf(e))return console.error(h+" "+t+" invalid value: must be among "+JSON.stringify(n.validValues)+', "'+e+'" provided'),!1;if(n.children&&!f(e,n.children,"[Validate "+t+"]"))return!1;return!0});return e||n.push.apply(n,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(Object.keys(u).map(function(t){var e=u[t];if("string"==typeof e&&(e={type:e}),e.mandatory){var n=e.mandatory;if("function"==typeof n&&(n=n(l)),n&&void 0===l[t])return console.error(h+' Missing mandatory key "'+t+'"'),!1}return!0}))),n.reduce(function(t,e){return t&&e},!0)}function s(t){return f(t,d,"[Validate format]")}e.exports={validate:function(t,e){var n=a(t),r=s(e);return n&&r},validateFormat:s,validateInput:a,validateLanguage:function(t){return f(t,o,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.formulaParser=e():t.formulaParser=e()}("undefined"!=typeof self?self:this,function(){return Sr=[function(t,e){e.nil=new Error("#NULL!"),e.div0=new Error("#DIV/0!"),e.value=new Error("#VALUE!"),e.ref=new Error("#REF!"),e.name=new Error("#NAME?"),e.num=new Error("#NUM!"),e.na=new Error("#N/A"),e.error=new Error("#ERROR!"),e.data=new Error("#GETTING_DATA")},function(t,r,e){var i=e(0);r.flattenShallow=function(t){return t&&t.reduce?t.reduce(function(t,e){var n=Array.isArray(t),r=Array.isArray(e);return n&&r?t.concat(e):n?(t.push(e),t):r?[t].concat(e):[t,e]}):t},r.isFlat=function(t){if(!t)return!1;for(var e=0;e<t.length;++e)if(Array.isArray(t[e]))return!1;return!0},r.flatten=function(){for(var t=r.argsToArray.apply(null,arguments);!r.isFlat(t);)t=r.flattenShallow(t);return t},r.argsToArray=function(t){var e=[];return r.arrayEach(t,function(t){e.push(t)}),e},r.numbers=function(){return this.flatten.apply(null,arguments).filter(function(t){return"number"==typeof t})},r.cleanFloat=function(t){return Math.round(1e14*t)/1e14},r.parseBool=function(t){if("boolean"==typeof t)return t;if(t instanceof Error)return t;if("number"==typeof t)return 0!==t;if("string"==typeof t){var e=t.toUpperCase();if("TRUE"===e)return!0;if("FALSE"===e)return!1}return t instanceof Date&&!isNaN(t)||i.value},r.parseNumber=function(t){return void 0===t||""===t?i.value:isNaN(t)?i.value:parseFloat(t)},r.parseNumberArray=function(t){var e,n;if(!t||0===(e=t.length))return i.value;for(;e--;){if((n=r.parseNumber(t[e]))===i.value)return n;t[e]=n}return t},r.parseMatrix=function(t){var e;if(!t||0===t.length)return i.value;for(var n=0;n<t.length;n++)if(e=r.parseNumberArray(t[n]),(t[n]=e)instanceof Error)return e;return t};var n=new Date(1900,0,1);r.parseDate=function(t){if(isNaN(t))return"string"!=typeof t||(t=new Date(t),isNaN(t))?i.value:t;if(t instanceof Date)return new Date(t);var e=parseInt(t,10);return e<0?i.num:e<=60?new Date(n.getTime()+864e5*(e-1)):new Date(n.getTime()+864e5*(e-2))},r.parseDateArray=function(t){for(var e,n=t.length;n--;){if((e=this.parseDate(t[n]))===i.value)return e;t[n]=e}return t},r.anyIsError=function(){for(var t=arguments.length;t--;)if(arguments[t]instanceof Error)return!0;return!1},r.arrayValuesToNumbers=function(t){for(var e,n=t.length;n--;)if("number"!=typeof(e=t[n]))if(!0!==e)if(!1!==e){if("string"==typeof e){var r=this.parseNumber(e);r instanceof Error?t[n]=0:t[n]=r}}else t[n]=0;else t[n]=1;return t},r.rest=function(t,e){return e=e||1,t&&"function"==typeof t.slice?t.slice(e):t},r.initial=function(t,e){return e=e||1,t&&"function"==typeof t.slice?t.slice(0,t.length-e):t},r.arrayEach=function(t,e){for(var n=-1,r=t.length;++n<r&&!1!==e(t[n],n,t););return t},r.transpose=function(n){return n?n[0].map(function(t,e){return n.map(function(t){return t[e]})}):i.value}},function(t,e,n){"use strict";var r;e.__esModule=!0,e.default=function(t){var e=void 0;t=(t+"").replace(/#|!|\?/g,""),d[t]&&(e=d[t]);return e||null},e.isValidStrict=function(t){var e=!1;for(var n in d)if(Object.prototype.hasOwnProperty.call(d,n)&&d[n]===t){e=!0;break}return e};var i=e.ERROR="ERROR",o=e.ERROR_DIV_ZERO="DIV/0",a=e.ERROR_NAME="NAME",s=e.ERROR_NOT_AVAILABLE="N/A",l=e.ERROR_NULL="NULL",u=e.ERROR_NUM="NUM",h=e.ERROR_REF="REF",c=e.ERROR_VALUE="VALUE",d=((r={})[i]="#ERROR!",r[o]="#DIV/0!",r[a]="#NAME?",r[s]="#N/A",r[l]="#NULL!",r[u]="#NUM!",r[h]="#REF!",r[c]="#VALUE!",r)},function(t,e,n){"use strict";function r(t){var e=void 0;return"number"==typeof t?e=t:"string"==typeof t&&(e=-1<t.indexOf(".")?parseFloat(t):parseInt(t,10)),e}e.__esModule=!0,e.toNumber=r,e.invertNumber=function(t){return-1*r(t)}},function(module,exports,__webpack_require__){var utils=__webpack_require__(1),error=__webpack_require__(0),statistical=__webpack_require__(5),information=__webpack_require__(7);exports.ABS=function(t){return(t=utils.parseNumber(t))instanceof Error?t:Math.abs(t)},exports.ACOS=function(t){if((t=utils.parseNumber(t))instanceof Error)return t;var e=Math.acos(t);return isNaN(e)&&(e=error.num),e},exports.ACOSH=function(t){if((t=utils.parseNumber(t))instanceof Error)return t;var e=Math.log(t+Math.sqrt(t*t-1));return isNaN(e)&&(e=error.num),e},exports.ACOT=function(t){return(t=utils.parseNumber(t))instanceof Error?t:Math.atan(1/t)},exports.ACOTH=function(t){if((t=utils.parseNumber(t))instanceof Error)return t;var e=.5*Math.log((t+1)/(t-1));return isNaN(e)&&(e=error.num),e},exports.AGGREGATE=function(t,e,n,r){if(t=utils.parseNumber(t),e=utils.parseNumber(t),utils.anyIsError(t,e))return error.value;switch(t){case 1:return statistical.AVERAGE(n);case 2:return statistical.COUNT(n);case 3:return statistical.COUNTA(n);case 4:return statistical.MAX(n);case 5:return statistical.MIN(n);case 6:return exports.PRODUCT(n);case 7:return statistical.STDEV.S(n);case 8:return statistical.STDEV.P(n);case 9:return exports.SUM(n);case 10:return statistical.VAR.S(n);case 11:return statistical.VAR.P(n);case 12:return statistical.MEDIAN(n);case 13:return statistical.MODE.SNGL(n);case 14:return statistical.LARGE(n,r);case 15:return statistical.SMALL(n,r);case 16:return statistical.PERCENTILE.INC(n,r);case 17:return statistical.QUARTILE.INC(n,r);case 18:return statistical.PERCENTILE.EXC(n,r);case 19:return statistical.QUARTILE.EXC(n,r)}},exports.ARABIC=function(t){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))return error.value;var e=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(t){e+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[t]}),e},exports.ASIN=function(t){if((t=utils.parseNumber(t))instanceof Error)return t;var e=Math.asin(t);return isNaN(e)&&(e=error.num),e},exports.ASINH=function(t){return(t=utils.parseNumber(t))instanceof Error?t:Math.log(t+Math.sqrt(t*t+1))},exports.ATAN=function(t){return(t=utils.parseNumber(t))instanceof Error?t:Math.atan(t)},exports.ATAN2=function(t,e){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:Math.atan2(t,e)},exports.ATANH=function(t){if((t=utils.parseNumber(t))instanceof Error)return t;var e=Math.log((1+t)/(1-t))/2;return isNaN(e)&&(e=error.num),e},exports.BASE=function(t,e,n){if(n=n||0,t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n))return error.value;n=void 0===n?0:n;var r=t.toString(e);return new Array(Math.max(n+1-r.length,0)).join("0")+r},exports.CEILING=function(t,e,n){if(e=void 0===e?1:Math.abs(e),n=n||0,t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n))return error.value;if(0===e)return 0;var r=-Math.floor(Math.log(e)/Math.log(10));return 0<=t?exports.ROUND(Math.ceil(t/e)*e,r):0===n?-exports.ROUND(Math.floor(Math.abs(t)/e)*e,r):-exports.ROUND(Math.ceil(Math.abs(t)/e)*e,r)},exports.CEILING.MATH=exports.CEILING,exports.CEILING.PRECISE=exports.CEILING,exports.COMBIN=function(t,e){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:exports.FACT(t)/(exports.FACT(e)*exports.FACT(t-e))},exports.COMBINA=function(t,e){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:0===t&&0===e?1:exports.COMBIN(t+e-1,t-1)},exports.COS=function(t){return(t=utils.parseNumber(t))instanceof Error?t:Math.cos(t)},exports.COSH=function(t){return(t=utils.parseNumber(t))instanceof Error?t:(Math.exp(t)+Math.exp(-t))/2},exports.COT=function(t){return(t=utils.parseNumber(t))instanceof Error?t:1/Math.tan(t)},exports.COTH=function(t){if((t=utils.parseNumber(t))instanceof Error)return t;var e=Math.exp(2*t);return(e+1)/(e-1)},exports.CSC=function(t){return(t=utils.parseNumber(t))instanceof Error?t:1/Math.sin(t)},exports.CSCH=function(t){return(t=utils.parseNumber(t))instanceof Error?t:2/(Math.exp(t)-Math.exp(-t))},exports.DECIMAL=function(t,e){return arguments.length<1?error.value:parseInt(t,e)},exports.DEGREES=function(t){return(t=utils.parseNumber(t))instanceof Error?t:180*t/Math.PI},exports.EVEN=function(t){return(t=utils.parseNumber(t))instanceof Error?t:exports.CEILING(t,-2,-1)},exports.EXP=function(t){return arguments.length<1?error.na:"number"!=typeof t||1<arguments.length?error.error:t=Math.exp(t)};var MEMOIZED_FACT=[];exports.FACT=function(t){if((t=utils.parseNumber(t))instanceof Error)return t;var e=Math.floor(t);return 0===e||1===e?1:(0<MEMOIZED_FACT[e]||(MEMOIZED_FACT[e]=exports.FACT(e-1)*e),MEMOIZED_FACT[e])},exports.FACTDOUBLE=function(t){if((t=utils.parseNumber(t))instanceof Error)return t;var e=Math.floor(t);return e<=0?1:e*exports.FACTDOUBLE(e-2)},exports.FLOOR=function(t,e){if(t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e))return error.value;if(0===e)return 0;if(!(0<t&&0<e||t<0&&e<0))return error.num;e=Math.abs(e);var n=-Math.floor(Math.log(e)/Math.log(10));return 0<=t?exports.ROUND(Math.floor(t/e)*e,n):-exports.ROUND(Math.ceil(Math.abs(t)/e),n)},exports.FLOOR.MATH=function(t,e,n){if(e=void 0===e?1:e,n=void 0===n?0:n,t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n))return error.value;if(0===e)return 0;e=e?Math.abs(e):1;var r=-Math.floor(Math.log(e)/Math.log(10));return 0<=t?exports.ROUND(Math.floor(t/e)*e,r):0===n||void 0===n?-exports.ROUND(Math.ceil(Math.abs(t)/e)*e,r):-exports.ROUND(Math.floor(Math.abs(t)/e)*e,r)},exports.FLOOR.PRECISE=exports.FLOOR.MATH,exports.GCD=function(){var t=utils.parseNumberArray(utils.flatten(arguments));if(t instanceof Error)return t;for(var e=t.length,n=t[0],r=n<0?-n:n,i=1;i<e;i++){for(var o=t[i],a=o<0?-o:o;r&&a;)a<r?r%=a:a%=r;r+=a}return r},exports.INT=function(t){return(t=utils.parseNumber(t))instanceof Error?t:Math.floor(t)},exports.ISO={CEILING:exports.CEILING},exports.LCM=function(){var t=utils.parseNumberArray(utils.flatten(arguments));if(t instanceof Error)return t;for(var e,n,r,i,o=1;void 0!==(r=t.pop());)for(;1<r;){if(r%2){for(e=3,n=Math.floor(Math.sqrt(r));e<=n&&r%e;e+=2);i=e<=n?e:r}else i=2;for(r/=i,o*=i,e=t.length;e;t[--e]%i==0&&1==(t[e]/=i)&&t.splice(e,1));}return o},exports.LN=function(t){return(t=utils.parseNumber(t))instanceof Error?t:Math.log(t)},exports.LN10=function(){return Math.log(10)},exports.LN2=function(){return Math.log(2)},exports.LOG10E=function(){return Math.LOG10E},exports.LOG2E=function(){return Math.LOG2E},exports.LOG=function(t,e){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:(e=void 0===e?10:e,Math.log(t)/Math.log(e))},exports.LOG10=function(t){return(t=utils.parseNumber(t))instanceof Error?t:Math.log(t)/Math.log(10)},exports.MOD=function(t,e){if(t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e))return error.value;if(0===e)return error.div0;var n=Math.abs(t%e);return 0<e?n:-n},exports.MROUND=function(t,e){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:t*e<0?error.num:Math.round(t/e)*e},exports.MULTINOMIAL=function(){var t=utils.parseNumberArray(utils.flatten(arguments));if(t instanceof Error)return t;for(var e=0,n=1,r=0;r<t.length;r++)e+=t[r],n*=exports.FACT(t[r]);return exports.FACT(e)/n},exports.ODD=function(t){if((t=utils.parseNumber(t))instanceof Error)return t;var e=Math.ceil(Math.abs(t));return e=1&e?e:e+1,0<t?e:-e},exports.PI=function(){return Math.PI},exports.E=function(){return Math.E},exports.POWER=function(t,e){if(t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e))return error.value;var n=Math.pow(t,e);return isNaN(n)?error.num:n},exports.PRODUCT=function(){var t=utils.parseNumberArray(utils.flatten(arguments));if(t instanceof Error)return t;for(var e=1,n=0;n<t.length;n++)e*=t[n];return e},exports.QUOTIENT=function(t,e){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:parseInt(t/e,10)},exports.RADIANS=function(t){return(t=utils.parseNumber(t))instanceof Error?t:t*Math.PI/180},exports.RAND=function(){return Math.random()},exports.RANDBETWEEN=function(t,e){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:t+Math.ceil((e-t+1)*Math.random())-1},exports.ROMAN=function(t){if((t=utils.parseNumber(t))instanceof Error)return t;for(var e=String(t).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],r="",i=3;i--;)r=(n[+e.pop()+10*i]||"")+r;return new Array(+e.join("")+1).join("M")+r},exports.ROUND=function(t,e){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:Math.round(t*Math.pow(10,e))/Math.pow(10,e)},exports.ROUNDDOWN=function(t,e){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:(0<t?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,e))/Math.pow(10,e)},exports.ROUNDUP=function(t,e){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:(0<t?1:-1)*Math.ceil(Math.abs(t)*Math.pow(10,e))/Math.pow(10,e)},exports.SEC=function(t){return(t=utils.parseNumber(t))instanceof Error?t:1/Math.cos(t)},exports.SECH=function(t){return(t=utils.parseNumber(t))instanceof Error?t:2/(Math.exp(t)+Math.exp(-t))},exports.SERIESSUM=function(t,e,n,r){if(t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),r=utils.parseNumberArray(r),utils.anyIsError(t,e,n,r))return error.value;for(var i=r[0]*Math.pow(t,e),o=1;o<r.length;o++)i+=r[o]*Math.pow(t,e+o*n);return i},exports.SIGN=function(t){return(t=utils.parseNumber(t))instanceof Error?t:t<0?-1:0===t?0:1},exports.SIN=function(t){return(t=utils.parseNumber(t))instanceof Error?t:Math.sin(t)},exports.SINH=function(t){return(t=utils.parseNumber(t))instanceof Error?t:(Math.exp(t)-Math.exp(-t))/2},exports.SQRT=function(t){return(t=utils.parseNumber(t))instanceof Error?t:t<0?error.num:Math.sqrt(t)},exports.SQRTPI=function(t){return(t=utils.parseNumber(t))instanceof Error?t:Math.sqrt(t*Math.PI)},exports.SQRT1_2=function(){return 1/Math.sqrt(2)},exports.SQRT2=function(){return Math.sqrt(2)},exports.SUBTOTAL=function(t,e){if((t=utils.parseNumber(t))instanceof Error)return t;switch(t){case 1:return statistical.AVERAGE(e);case 2:return statistical.COUNT(e);case 3:return statistical.COUNTA(e);case 4:return statistical.MAX(e);case 5:return statistical.MIN(e);case 6:return exports.PRODUCT(e);case 7:return statistical.STDEV.S(e);case 8:return statistical.STDEV.P(e);case 9:return exports.SUM(e);case 10:return statistical.VAR.S(e);case 11:return statistical.VAR.P(e);case 101:return statistical.AVERAGE(e);case 102:return statistical.COUNT(e);case 103:return statistical.COUNTA(e);case 104:return statistical.MAX(e);case 105:return statistical.MIN(e);case 106:return exports.PRODUCT(e);case 107:return statistical.STDEV.S(e);case 108:return statistical.STDEV.P(e);case 109:return exports.SUM(e);case 110:return statistical.VAR.S(e);case 111:return statistical.VAR.P(e)}},exports.ADD=function(t,e){return 2!==arguments.length?error.na:(t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:t+e)},exports.MINUS=function(t,e){return 2!==arguments.length?error.na:(t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:t-e)},exports.DIVIDE=function(t,e){return 2!==arguments.length?error.na:(t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:0===e?error.div0:t/e)},exports.MULTIPLY=function(t,e){return 2!==arguments.length?error.na:(t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:t*e)},exports.GTE=function(t,e){return 2!==arguments.length?error.na:(t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.error:e<=t)},exports.LT=function(t,e){return 2!==arguments.length?error.na:(t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.error:t<e)},exports.LTE=function(t,e){return 2!==arguments.length?error.na:(t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.error:t<=e)},exports.EQ=function(t,e){return 2!==arguments.length?error.na:t===e},exports.NE=function(t,e){return 2!==arguments.length?error.na:t!==e},exports.POW=function(t,e){return 2!==arguments.length?error.na:(t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.error:exports.POWER(t,e))},exports.SUM=function(){var n=0;return utils.arrayEach(utils.argsToArray(arguments),function(t){if("number"==typeof t)n+=t;else if("string"==typeof t){var e=parseFloat(t);isNaN(e)||(n+=e)}else Array.isArray(t)&&(n+=exports.SUM.apply(null,t))}),n},exports.SUMIF=function(range,criteria){if(range=utils.parseNumberArray(utils.flatten(range)),range instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var args=utils.argsToArray(arguments),range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error)return range;for(var criteria=args,n_range_elements=range.length,n_criterias=criteria.length,result=0,i=0;i<n_range_elements;i++){for(var el=range[i],condition="",c=0;c<n_criterias;c++)condition+=el+criteria[c],c!==n_criterias-1&&(condition+="&&");eval(condition)&&(result+=el)}return result},exports.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return error.value;for(var t,e,n,r,i=arguments.length+1,o=0,a=0;a<arguments[0].length;a++)if(arguments[0][a]instanceof Array)for(var s=0;s<arguments[0][a].length;s++){for(e=t=1;e<i;e++){if((r=utils.parseNumber(arguments[e-1][a][s]))instanceof Error)return r;t*=r}o+=t}else{for(e=t=1;e<i;e++){if((n=utils.parseNumber(arguments[e-1][a]))instanceof Error)return n;t*=n}o+=t}return o},exports.SUMSQ=function(){var t=utils.parseNumberArray(utils.flatten(arguments));if(t instanceof Error)return t;for(var e=0,n=t.length,r=0;r<n;r++)e+=information.ISNUMBER(t[r])?t[r]*t[r]:0;return e},exports.SUMX2MY2=function(t,e){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e))return error.value;for(var n=0,r=0;r<t.length;r++)n+=t[r]*t[r]-e[r]*e[r];return n},exports.SUMX2PY2=function(t,e){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e))return error.value;var n=0;t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e));for(var r=0;r<t.length;r++)n+=t[r]*t[r]+e[r]*e[r];return n},exports.SUMXMY2=function(t,e){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e))return error.value;var n=0;t=utils.flatten(t),e=utils.flatten(e);for(var r=0;r<t.length;r++)n+=Math.pow(t[r]-e[r],2);return n},exports.TAN=function(t){return(t=utils.parseNumber(t))instanceof Error?t:Math.tan(t)},exports.TANH=function(t){if((t=utils.parseNumber(t))instanceof Error)return t;var e=Math.exp(2*t);return(e-1)/(e+1)},exports.TRUNC=function(t,e){return e=void 0===e?0:e,t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:(0<t?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,e))/Math.pow(10,e)}},function(module,exports,__webpack_require__){var mathTrig=__webpack_require__(4),text=__webpack_require__(6),jStat=__webpack_require__(11).jStat,utils=__webpack_require__(1),error=__webpack_require__(0),misc=__webpack_require__(12),SQRT2PI=2.5066282746310002;exports.AVEDEV=function(){var t=utils.parseNumberArray(utils.flatten(arguments));return t instanceof Error?t:jStat.sum(jStat(t).subtract(jStat.mean(t)).abs()[0])/t.length},exports.AVERAGE=function(){for(var t,e=utils.numbers(utils.flatten(arguments)),n=e.length,r=0,i=0,o=0;o<n;o++)r+=e[o],i+=1;return t=r/i,isNaN(t)&&(t=error.num),t},exports.AVERAGEA=function(){for(var t,e=utils.flatten(arguments),n=e.length,r=0,i=0,o=0;o<n;o++){var a=e[o];"number"==typeof a&&(r+=a),!0===a&&r++,null!==a&&i++}return t=r/i,isNaN(t)&&(t=error.num),t},exports.AVERAGEIF=function(range,criteria,average_range){if(arguments.length<=1)return error.na;if(average_range=average_range||range,range=utils.flatten(range),average_range=utils.parseNumberArray(utils.flatten(average_range)),average_range instanceof Error)return average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},exports.AVERAGEIFS=function(){for(var args=utils.argsToArray(arguments),criteria=(args.length-1)/2,range=utils.flatten(args[0]),count=0,result=0,i=0;i<range.length;i++){for(var condition="",j=0;j<criteria;j++)condition+=args[2*j+1][i]+args[2*j+2],j!==criteria-1&&(condition+="&&");eval(condition)&&(result+=range[i],count++)}var average=result/count;return isNaN(average)?0:average},exports.BETA={},exports.BETA.DIST=function(t,e,n,r,i,o){return arguments.length<4?error.value:(i=void 0===i?0:i,o=void 0===o?1:o,t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),i=utils.parseNumber(i),o=utils.parseNumber(o),utils.anyIsError(t,e,n,i,o)?error.value:(t=(t-i)/(o-i),r?jStat.beta.cdf(t,e,n):jStat.beta.pdf(t,e,n)))},exports.BETA.INV=function(t,e,n,r,i){return r=void 0===r?0:r,i=void 0===i?1:i,t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),r=utils.parseNumber(r),i=utils.parseNumber(i),utils.anyIsError(t,e,n,r,i)?error.value:jStat.beta.inv(t,e,n)*(i-r)+r},exports.BINOM={},exports.BINOM.DIST=function(t,e,n,r){return t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(t,e,n,r)?error.value:r?jStat.binomial.cdf(t,e,n):jStat.binomial.pdf(t,e,n)},exports.BINOM.DIST.RANGE=function(t,e,n,r){if(r=void 0===r?n:r,t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(t,e,n,r))return error.value;for(var i=0,o=n;o<=r;o++)i+=mathTrig.COMBIN(t,o)*Math.pow(e,o)*Math.pow(1-e,t-o);return i},exports.BINOM.INV=function(t,e,n){if(t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n))return error.value;for(var r=0;r<=t;){if(jStat.binomial.cdf(r,t,e)>=n)return r;r++}},exports.CHISQ={},exports.CHISQ.DIST=function(t,e,n){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:n?jStat.chisquare.cdf(t,e):jStat.chisquare.pdf(t,e)},exports.CHISQ.DIST.RT=function(t,e){return!t|!e?error.na:t<1||e>Math.pow(10,10)?error.num:"number"!=typeof t||"number"!=typeof e?error.value:1-jStat.chisquare.cdf(t,e)},exports.CHISQ.INV=function(t,e){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:jStat.chisquare.inv(t,e)},exports.CHISQ.INV.RT=function(t,e){return!t|!e?error.na:t<0||1<t||e<1||e>Math.pow(10,10)?error.num:"number"!=typeof t||"number"!=typeof e?error.value:jStat.chisquare.inv(1-t,e)},exports.CHISQ.TEST=function(t,e){if(2!==arguments.length)return error.na;if(!(t instanceof Array&&e instanceof Array))return error.value;if(t.length!==e.length)return error.value;if(t[0]&&e[0]&&t[0].length!==e[0].length)return error.value;var n,r,i,o=t.length;for(r=0;r<o;r++)t[r]instanceof Array||(n=t[r],t[r]=[],t[r].push(n)),e[r]instanceof Array||(n=e[r],e[r]=[],e[r].push(n));var a=t[0].length,s=1===a?o-1:(o-1)*(a-1),l=0,u=Math.PI;for(r=0;r<o;r++)for(i=0;i<a;i++)l+=Math.pow(t[r][i]-e[r][i],2)/e[r][i];return Math.round(1e6*function(t,e){var n=Math.exp(-.5*t);e%2==1&&(n*=Math.sqrt(2*t/u));for(var r=e;2<=r;)n=n*t/r,r-=2;for(var i=n,o=e;1e-10*n<i;)n+=i=i*t/(o+=2);return 1-n}(l,s))/1e6},exports.COLUMN=function(t,e){return 2!==arguments.length?error.na:e<0?error.num:t instanceof Array&&"number"==typeof e?0!==t.length?jStat.col(t,e):void 0:error.value},exports.COLUMNS=function(t){return 1!==arguments.length?error.na:t instanceof Array?0===t.length?0:jStat.cols(t):error.value},exports.CONFIDENCE={},exports.CONFIDENCE.NORM=function(t,e,n){return t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n)?error.value:jStat.normalci(1,t,e,n)[1]-1},exports.CONFIDENCE.T=function(t,e,n){return t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n)?error.value:jStat.tci(1,t,e,n)[1]-1},exports.CORREL=function(t,e){return t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e)?error.value:jStat.corrcoeff(t,e)},exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length},exports.COUNTA=function(){var t=utils.flatten(arguments);return t.length-exports.COUNTBLANK(t)},exports.COUNTIN=function(t,e){var n=0;t=utils.flatten(t);for(var r=0;r<t.length;r++)t[r]===e&&n++;return n},exports.COUNTBLANK=function(){for(var t,e=utils.flatten(arguments),n=0,r=0;r<e.length;r++)null!==(t=e[r])&&""!==t||n++;return n},exports.COUNTIF=function(range,criteria){range=utils.flatten(range),/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var matches=0,i=0;i<range.length;i++)"string"!=typeof range[i]?eval(range[i]+criteria)&&matches++:eval('"'+range[i]+'"'+criteria)&&matches++;return matches},exports.COUNTIFS=function(){for(var args=utils.argsToArray(arguments),results=new Array(utils.flatten(args[0]).length),i=0;i<results.length;i++)results[i]=!0;for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]),criteria=args[i+1];/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var j=0;j<range.length;j++)"string"!=typeof range[j]?results[j]=results[j]&&eval(range[j]+criteria):results[j]=results[j]&&eval('"'+range[j]+'"'+criteria)}var result=0;for(i=0;i<results.length;i++)results[i]&&result++;return result},exports.COUNTUNIQUE=function(){return misc.UNIQUE.apply(null,utils.flatten(arguments)).length},exports.COVARIANCE={},exports.COVARIANCE.P=function(t,e){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e))return error.value;for(var n=jStat.mean(t),r=jStat.mean(e),i=0,o=t.length,a=0;a<o;a++)i+=(t[a]-n)*(e[a]-r);return i/o},exports.COVARIANCE.S=function(t,e){return t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e)?error.value:jStat.covariance(t,e)},exports.DEVSQ=function(){var t=utils.parseNumberArray(utils.flatten(arguments));if(t instanceof Error)return t;for(var e=jStat.mean(t),n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n},exports.EXPON={},exports.EXPON.DIST=function(t,e,n){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:n?jStat.exponential.cdf(t,e):jStat.exponential.pdf(t,e)},exports.F={},exports.F.DIST=function(t,e,n,r){return t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n)?error.value:r?jStat.centralF.cdf(t,e,n):jStat.centralF.pdf(t,e,n)},exports.F.DIST.RT=function(t,e,n){return 3!==arguments.length?error.na:t<0||e<1||n<1?error.num:"number"!=typeof t||"number"!=typeof e||"number"!=typeof n?error.value:1-jStat.centralF.cdf(t,e,n)},exports.F.INV=function(t,e,n){return t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n)?error.value:t<=0||1<t?error.num:jStat.centralF.inv(t,e,n)},exports.F.INV.RT=function(t,e,n){return 3!==arguments.length?error.na:t<0||1<t||e<1||e>Math.pow(10,10)||n<1||n>Math.pow(10,10)?error.num:"number"!=typeof t||"number"!=typeof e||"number"!=typeof n?error.value:jStat.centralF.inv(1-t,e,n)},exports.F.TEST=function(t,e){if(!t||!e)return error.na;if(!(t instanceof Array&&e instanceof Array))return error.na;if(t.length<2||e.length<2)return error.div0;function n(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n}var r=mathTrig.SUM(t)/t.length,i=mathTrig.SUM(e)/e.length;return n(t,r)/(t.length-1)/(n(e,i)/(e.length-1))},exports.FISHER=function(t){return(t=utils.parseNumber(t))instanceof Error?t:Math.log((1+t)/(1-t))/2},exports.FISHERINV=function(t){if((t=utils.parseNumber(t))instanceof Error)return t;var e=Math.exp(2*t);return(e-1)/(e+1)},exports.FORECAST=function(t,e,n){if(t=utils.parseNumber(t),e=utils.parseNumberArray(utils.flatten(e)),n=utils.parseNumberArray(utils.flatten(n)),utils.anyIsError(t,e,n))return error.value;for(var r=jStat.mean(n),i=jStat.mean(e),o=n.length,a=0,s=0,l=0;l<o;l++)a+=(n[l]-r)*(e[l]-i),s+=Math.pow(n[l]-r,2);var u=a/s;return i-u*r+u*t},exports.FREQUENCY=function(t,e){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e))return error.value;for(var n=t.length,r=e.length,i=[],o=0;o<=r;o++)for(var a=i[o]=0;a<n;a++)0===o?t[a]<=e[0]&&(i[0]+=1):o<r?t[a]>e[o-1]&&t[a]<=e[o]&&(i[o]+=1):o===r&&t[a]>e[r-1]&&(i[r]+=1);return i},exports.GAMMA=function(t){return(t=utils.parseNumber(t))instanceof Error?t:0===t?error.num:parseInt(t,10)===t&&t<0?error.num:jStat.gammafn(t)},exports.GAMMA.DIST=function(t,e,n,r){return 4!==arguments.length?error.na:t<0||e<=0||n<=0?error.value:"number"!=typeof t||"number"!=typeof e||"number"!=typeof n?error.value:r?jStat.gamma.cdf(t,e,n,!0):jStat.gamma.pdf(t,e,n,!1)},exports.GAMMA.INV=function(t,e,n){return 3!==arguments.length?error.na:t<0||1<t||e<=0||n<=0?error.num:"number"!=typeof t||"number"!=typeof e||"number"!=typeof n?error.value:jStat.gamma.inv(t,e,n)},exports.GAMMALN=function(t){return(t=utils.parseNumber(t))instanceof Error?t:jStat.gammaln(t)},exports.GAMMALN.PRECISE=function(t){return 1!==arguments.length?error.na:t<=0?error.num:"number"!=typeof t?error.value:jStat.gammaln(t)},exports.GAUSS=function(t){return(t=utils.parseNumber(t))instanceof Error?t:jStat.normal.cdf(t,0,1)-.5},exports.GEOMEAN=function(){var t=utils.parseNumberArray(utils.flatten(arguments));return t instanceof Error?t:jStat.geomean(t)},exports.GROWTH=function(t,e,n,r){if((t=utils.parseNumberArray(t))instanceof Error)return t;var i;if(void 0===e)for(e=[],i=1;i<=t.length;i++)e.push(i);if(void 0===n)for(n=[],i=1;i<=t.length;i++)n.push(i);if(e=utils.parseNumberArray(e),n=utils.parseNumberArray(n),utils.anyIsError(e,n))return error.value;void 0===r&&(r=!0);var o,a,s=t.length,l=0,u=0,h=0,c=0;for(i=0;i<s;i++){var d=e[i],f=Math.log(t[i]);l+=d,u+=f,h+=d*f,c+=d*d}l/=s,u/=s,h/=s,c/=s,a=r?u-(o=(h-l*u)/(c-l*l))*l:(o=h/c,0);var p=[];for(i=0;i<n.length;i++)p.push(Math.exp(a+o*n[i]));return p},exports.HARMEAN=function(){var t=utils.parseNumberArray(utils.flatten(arguments));if(t instanceof Error)return t;for(var e=t.length,n=0,r=0;r<e;r++)n+=1/t[r];return e/n},exports.HYPGEOM={},exports.HYPGEOM.DIST=function(t,e,n,r,i){if(t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(t,e,n,r))return error.value;function a(t,e,n,r){return mathTrig.COMBIN(n,t)*mathTrig.COMBIN(r-n,e-t)/mathTrig.COMBIN(r,e)}return i?function(t,e,n,r){for(var i=0,o=0;o<=t;o++)i+=a(o,e,n,r);return i}(t,e,n,r):a(t,e,n,r)},exports.INTERCEPT=function(t,e){return t=utils.parseNumberArray(t),e=utils.parseNumberArray(e),utils.anyIsError(t,e)?error.value:t.length!==e.length?error.na:exports.FORECAST(0,t,e)},exports.KURT=function(){var t=utils.parseNumberArray(utils.flatten(arguments));if(t instanceof Error)return t;for(var e=jStat.mean(t),n=t.length,r=0,i=0;i<n;i++)r+=Math.pow(t[i]-e,4);return n*(n+1)/((n-1)*(n-2)*(n-3))*(r/=Math.pow(jStat.stdev(t,!0),4))-3*(n-1)*(n-1)/((n-2)*(n-3))},exports.LARGE=function(t,e){return t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumber(e),utils.anyIsError(t,e)?t:t.sort(function(t,e){return e-t})[e-1]},exports.LINEST=function(t,e){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e))return error.value;for(var n=jStat.mean(t),r=jStat.mean(e),i=e.length,o=0,a=0,s=0;s<i;s++)o+=(e[s]-r)*(t[s]-n),a+=Math.pow(e[s]-r,2);var l=o/a;return[l,n-l*r]},exports.LOGEST=function(t,e){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e))return error.value;for(var n=0;n<t.length;n++)t[n]=Math.log(t[n]);var r=exports.LINEST(t,e);return r[0]=Math.round(1e6*Math.exp(r[0]))/1e6,r[1]=Math.round(1e6*Math.exp(r[1]))/1e6,r},exports.LOGNORM={},exports.LOGNORM.DIST=function(t,e,n,r){return t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n)?error.value:r?jStat.lognormal.cdf(t,e,n):jStat.lognormal.pdf(t,e,n)},exports.LOGNORM.INV=function(t,e,n){return t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n)?error.value:jStat.lognormal.inv(t,e,n)},exports.MAX=function(){var t=utils.numbers(utils.flatten(arguments));return 0===t.length?0:Math.max.apply(Math,t)},exports.MAXA=function(){var t=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===t.length?0:Math.max.apply(Math,t)},exports.MEDIAN=function(){var t=utils.arrayValuesToNumbers(utils.flatten(arguments)),e=jStat.median(t);return isNaN(e)&&(e=error.num),e},exports.MIN=function(){var t=utils.numbers(utils.flatten(arguments));return 0===t.length?0:Math.min.apply(Math,t)},exports.MINA=function(){var t=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===t.length?0:Math.min.apply(Math,t)},exports.MODE={},exports.MODE.MULT=function(){var t=utils.parseNumberArray(utils.flatten(arguments));if(t instanceof Error)return t;for(var e,n=t.length,r={},i=[],o=0,a=0;a<n;a++)r[e=t[a]]=r[e]?r[e]+1:1,r[e]>o&&(o=r[e],i=[]),r[e]===o&&(i[i.length]=e);return i},exports.MODE.SNGL=function(){var t=utils.parseNumberArray(utils.flatten(arguments));return t instanceof Error?t:exports.MODE.MULT(t).sort(function(t,e){return t-e})[0]},exports.NEGBINOM={},exports.NEGBINOM.DIST=function(t,e,n,r){return t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n)?error.value:r?jStat.negbin.cdf(t,e,n):jStat.negbin.pdf(t,e,n)},exports.NORM={},exports.NORM.DIST=function(t,e,n,r){return t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n)?error.value:n<=0?error.num:r?jStat.normal.cdf(t,e,n):jStat.normal.pdf(t,e,n)},exports.NORM.INV=function(t,e,n){return t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n)?error.value:jStat.normal.inv(t,e,n)},exports.NORM.S={},exports.NORM.S.DIST=function(t,e){return(t=utils.parseNumber(t))instanceof Error?error.value:e?jStat.normal.cdf(t,0,1):jStat.normal.pdf(t,0,1)},exports.NORM.S.INV=function(t){return(t=utils.parseNumber(t))instanceof Error?error.value:jStat.normal.inv(t,0,1)},exports.PEARSON=function(t,e){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=jStat.mean(t),r=jStat.mean(e),i=t.length,o=0,a=0,s=0,l=0;l<i;l++)o+=(t[l]-n)*(e[l]-r),a+=Math.pow(t[l]-n,2),s+=Math.pow(e[l]-r,2);return o/Math.sqrt(a*s)},exports.PERCENTILE={},exports.PERCENTILE.EXC=function(t,e){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumber(e),utils.anyIsError(t,e))return error.value;var n=(t=t.sort(function(t,e){return t-e})).length;if(e<1/(n+1)||1-1/(n+1)<e)return error.num;var r=e*(n+1)-1,i=Math.floor(r);return utils.cleanFloat(r===i?t[r]:t[i]+(r-i)*(t[i+1]-t[i]))},exports.PERCENTILE.INC=function(t,e){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumber(e),utils.anyIsError(t,e))return error.value;var n=e*((t=t.sort(function(t,e){return t-e})).length-1),r=Math.floor(n);return utils.cleanFloat(n===r?t[n]:t[r]+(n-r)*(t[r+1]-t[r]))},exports.PERCENTRANK={},exports.PERCENTRANK.EXC=function(t,e,n){if(n=void 0===n?3:n,t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n))return error.value;t=t.sort(function(t,e){return t-e});for(var r=misc.UNIQUE.apply(null,t),i=t.length,o=r.length,a=Math.pow(10,n),s=0,l=!1,u=0;!l&&u<o;)e===r[u]?(s=(t.indexOf(r[u])+1)/(i+1),l=!0):e>=r[u]&&(e<r[u+1]||u===o-1)&&(s=(t.indexOf(r[u])+1+(e-r[u])/(r[u+1]-r[u]))/(i+1),l=!0),u++;return Math.floor(s*a)/a},exports.PERCENTRANK.INC=function(t,e,n){if(n=void 0===n?3:n,t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n))return error.value;t=t.sort(function(t,e){return t-e});for(var r=misc.UNIQUE.apply(null,t),i=t.length,o=r.length,a=Math.pow(10,n),s=0,l=!1,u=0;!l&&u<o;)e===r[u]?(s=t.indexOf(r[u])/(i-1),l=!0):e>=r[u]&&(e<r[u+1]||u===o-1)&&(s=(t.indexOf(r[u])+(e-r[u])/(r[u+1]-r[u]))/(i-1),l=!0),u++;return Math.floor(s*a)/a},exports.PERMUT=function(t,e){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:mathTrig.FACT(t)/mathTrig.FACT(t-e)},exports.PERMUTATIONA=function(t,e){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:Math.pow(t,e)},exports.PHI=function(t){return(t=utils.parseNumber(t))instanceof Error?error.value:Math.exp(-.5*t*t)/SQRT2PI},exports.POISSON={},exports.POISSON.DIST=function(t,e,n){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:n?jStat.poisson.cdf(t,e):jStat.poisson.pdf(t,e)},exports.PROB=function(t,e,n,r){if(void 0===n)return 0;if(r=void 0===r?n:r,t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(t,e,n,r))return error.value;if(n===r)return 0<=t.indexOf(n)?e[t.indexOf(n)]:0;for(var i=t.sort(function(t,e){return t-e}),o=i.length,a=0,s=0;s<o;s++)i[s]>=n&&i[s]<=r&&(a+=e[t.indexOf(i[s])]);return a},exports.QUARTILE={},exports.QUARTILE.EXC=function(t,e){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumber(e),utils.anyIsError(t,e))return error.value;switch(e){case 1:return exports.PERCENTILE.EXC(t,.25);case 2:return exports.PERCENTILE.EXC(t,.5);case 3:return exports.PERCENTILE.EXC(t,.75);default:return error.num}},exports.QUARTILE.INC=function(t,e){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumber(e),utils.anyIsError(t,e))return error.value;switch(e){case 1:return exports.PERCENTILE.INC(t,.25);case 2:return exports.PERCENTILE.INC(t,.5);case 3:return exports.PERCENTILE.INC(t,.75);default:return error.num}},exports.RANK={},exports.RANK.AVG=function(t,e,n){if(t=utils.parseNumber(t),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e))return error.value;for(var r=(n=n||!1)?function(t,e){return t-e}:function(t,e){return e-t},i=(e=(e=utils.flatten(e)).sort(r)).length,o=0,a=0;a<i;a++)e[a]===t&&o++;return 1<o?(2*e.indexOf(t)+o+1)/2:e.indexOf(t)+1},exports.RANK.EQ=function(t,e,n){if(t=utils.parseNumber(t),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e))return error.value;var r=(n=n||!1)?function(t,e){return t-e}:function(t,e){return e-t};return(e=e.sort(r)).indexOf(t)+1},exports.ROW=function(t,e){return 2!==arguments.length?error.na:e<0?error.num:t instanceof Array&&"number"==typeof e?0!==t.length?jStat.row(t,e):void 0:error.value},exports.ROWS=function(t){return 1!==arguments.length?error.na:t instanceof Array?0===t.length?0:jStat.rows(t):error.value},exports.RSQ=function(t,e){return t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e)?error.value:Math.pow(exports.PEARSON(t,e),2)},exports.SKEW=function(){var t=utils.parseNumberArray(utils.flatten(arguments));if(t instanceof Error)return t;for(var e=jStat.mean(t),n=t.length,r=0,i=0;i<n;i++)r+=Math.pow(t[i]-e,3);return n*r/((n-1)*(n-2)*Math.pow(jStat.stdev(t,!0),3))},exports.SKEW.P=function(){var t=utils.parseNumberArray(utils.flatten(arguments));if(t instanceof Error)return t;for(var e=jStat.mean(t),n=t.length,r=0,i=0,o=0;o<n;o++)i+=Math.pow(t[o]-e,3),r+=Math.pow(t[o]-e,2);return r/=n,(i/=n)/Math.pow(r,1.5)},exports.SLOPE=function(t,e){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e))return error.value;for(var n=jStat.mean(e),r=jStat.mean(t),i=e.length,o=0,a=0,s=0;s<i;s++)o+=(e[s]-n)*(t[s]-r),a+=Math.pow(e[s]-n,2);return o/a},exports.SMALL=function(t,e){return t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumber(e),utils.anyIsError(t,e)?t:t.sort(function(t,e){return t-e})[e-1]},exports.STANDARDIZE=function(t,e,n){return t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n)?error.value:(t-e)/n},exports.STDEV={},exports.STDEV.P=function(){var t=exports.VAR.P.apply(this,arguments),e=Math.sqrt(t);return isNaN(e)&&(e=error.num),e},exports.STDEV.S=function(){var t=exports.VAR.S.apply(this,arguments);return Math.sqrt(t)},exports.STDEVA=function(){var t=exports.VARA.apply(this,arguments);return Math.sqrt(t)},exports.STDEVPA=function(){var t=exports.VARPA.apply(this,arguments),e=Math.sqrt(t);return isNaN(e)&&(e=error.num),e},exports.STEYX=function(t,e){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e))return error.value;for(var n=jStat.mean(e),r=jStat.mean(t),i=e.length,o=0,a=0,s=0,l=0;l<i;l++)o+=Math.pow(t[l]-r,2),a+=(e[l]-n)*(t[l]-r),s+=Math.pow(e[l]-n,2);return Math.sqrt((o-a*a/s)/(i-2))},exports.TRANSPOSE=function(t){return t?jStat.transpose(t):error.na},exports.T=text.T,exports.T.DIST=function(t,e,n){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:n?jStat.studentt.cdf(t,e):jStat.studentt.pdf(t,e)},exports.T.DIST["2T"]=function(t,e){return 2!==arguments.length?error.na:t<0||e<1?error.num:"number"!=typeof t||"number"!=typeof e?error.value:2*(1-jStat.studentt.cdf(t,e))},exports.T.DIST.RT=function(t,e){return 2!==arguments.length?error.na:t<0||e<1?error.num:"number"!=typeof t||"number"!=typeof e?error.value:1-jStat.studentt.cdf(t,e)},exports.T.INV=function(t,e){return t=utils.parseNumber(t),e=utils.parseNumber(e),utils.anyIsError(t,e)?error.value:jStat.studentt.inv(t,e)},exports.T.INV["2T"]=function(t,e){return t=utils.parseNumber(t),e=utils.parseNumber(e),t<=0||1<t||e<1?error.num:utils.anyIsError(t,e)?error.value:Math.abs(jStat.studentt.inv(t/2,e))},exports.T.TEST=function(t,e){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e))return error.value;var n,r=jStat.mean(t),i=jStat.mean(e),o=0,a=0;for(n=0;n<t.length;n++)o+=Math.pow(t[n]-r,2);for(n=0;n<e.length;n++)a+=Math.pow(e[n]-i,2);o/=t.length-1,a/=e.length-1;var s=Math.abs(r-i)/Math.sqrt(o/t.length+a/e.length);return exports.T.DIST["2T"](s,t.length+e.length-2)},exports.TREND=function(t,e,n){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),n=utils.parseNumberArray(utils.flatten(n)),utils.anyIsError(t,e,n))return error.value;var r=exports.LINEST(t,e),i=r[0],o=r[1],a=[];return n.forEach(function(t){a.push(i*t+o)}),a},exports.TRIMMEAN=function(t,e){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumber(e),utils.anyIsError(t,e))return error.value;var n=mathTrig.FLOOR(t.length*e,2)/2;return jStat.mean(utils.initial(utils.rest(t.sort(function(t,e){return t-e}),n),n))},exports.VAR={},exports.VAR.P=function(){for(var t,e=utils.numbers(utils.flatten(arguments)),n=e.length,r=0,i=exports.AVERAGE(e),o=0;o<n;o++)r+=Math.pow(e[o]-i,2);return t=r/n,isNaN(t)&&(t=error.num),t},exports.VAR.S=function(){for(var t=utils.numbers(utils.flatten(arguments)),e=t.length,n=0,r=exports.AVERAGE(t),i=0;i<e;i++)n+=Math.pow(t[i]-r,2);return n/(e-1)},exports.VARA=function(){for(var t=utils.flatten(arguments),e=t.length,n=0,r=0,i=exports.AVERAGEA(t),o=0;o<e;o++){var a=t[o];n+="number"==typeof a?Math.pow(a-i,2):!0===a?Math.pow(1-i,2):Math.pow(0-i,2),null!==a&&r++}return n/(r-1)},exports.VARPA=function(){for(var t,e=utils.flatten(arguments),n=e.length,r=0,i=0,o=exports.AVERAGEA(e),a=0;a<n;a++){var s=e[a];r+="number"==typeof s?Math.pow(s-o,2):!0===s?Math.pow(1-o,2):Math.pow(0-o,2),null!==s&&i++}return t=r/i,isNaN(t)&&(t=error.num),t},exports.WEIBULL={},exports.WEIBULL.DIST=function(t,e,n,r){return t=utils.parseNumber(t),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(t,e,n)?error.value:r?1-Math.exp(-Math.pow(t/n,e)):Math.pow(t,e-1)*Math.exp(-Math.pow(t/n,e))*e/Math.pow(n,e)},exports.Z={},exports.Z.TEST=function(t,e,n){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumber(e),utils.anyIsError(t,e))return error.value;n=n||exports.STDEV.S(t);var r=t.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(t)-e)/(n/Math.sqrt(r)),!0)}},function(t,e,n){var o=n(1),a=n(0),i=n(9);e.ASC=function(){throw new Error("ASC is not implemented")},e.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},e.CHAR=function(t){return(t=o.parseNumber(t))instanceof Error?t:String.fromCharCode(t)},e.CLEAN=function(t){return(t=t||"").replace(/[\0-\x1F]/g,"")},e.CODE=function(t){var e=(t=t||"").charCodeAt(0);return isNaN(e)&&(e=a.na),e},e.CONCATENATE=function(){for(var t=o.flatten(arguments),e=0;-1<(e=t.indexOf(!0));)t[e]="TRUE";for(var n=0;-1<(n=t.indexOf(!1));)t[n]="FALSE";return t.join("")},e.DBCS=function(){throw new Error("DBCS is not implemented")},e.DOLLAR=function(t,e){if(e=void 0===e?2:e,t=o.parseNumber(t),e=o.parseNumber(e),o.anyIsError(t,e))return a.value;var n="";return e<=0?(t=Math.round(t*Math.pow(10,e))/Math.pow(10,e),n="($0,0)"):0<e&&(n="($0,0."+new Array(e+1).join("0")+")"),i(t).format(n)},e.EXACT=function(t,e){return 2!==arguments.length?a.na:t===e},e.FIND=function(t,e,n){return arguments.length<2?a.na:(n=void 0===n?0:n,e?e.indexOf(t,n-1)+1:null)},e.FIXED=function(t,e,n){if(e=void 0===e?2:e,n=void 0!==n&&n,t=o.parseNumber(t),e=o.parseNumber(e),o.anyIsError(t,e))return a.value;var r=n?"0":"0,0";return e<=0?t=Math.round(t*Math.pow(10,e))/Math.pow(10,e):0<e&&(r+="."+new Array(e+1).join("0")),i(t).format(r)},e.HTML2TEXT=function(t){var e="";return t&&(t instanceof Array?t.forEach(function(t){""!==e&&(e+="\n"),e+=t.replace(/<(?:.|\n)*?>/gm,"")}):e=t.replace(/<(?:.|\n)*?>/gm,"")),e},e.LEFT=function(t,e){return e=void 0===e?1:e,(e=o.parseNumber(e))instanceof Error||"string"!=typeof t?a.value:t?t.substring(0,e):null},e.LEN=function(t){return 0===arguments.length?a.error:"string"==typeof t?t?t.length:0:t.length?t.length:a.value},e.LOWER=function(t){return"string"!=typeof t?a.value:t?t.toLowerCase():t},e.MID=function(t,e,n){if(e=o.parseNumber(e),n=o.parseNumber(n),o.anyIsError(e,n)||"string"!=typeof t)return n;var r=e-1,i=r+n;return t.substring(r,i)},e.NUMBERVALUE=function(t,e,n){return e=void 0===e?".":e,n=void 0===n?",":n,Number(t.replace(e,".").replace(n,""))},e.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},e.PROPER=function(t){return void 0===t||0===t.length?a.value:(!0===t&&(t="TRUE"),!1===t&&(t="FALSE"),isNaN(t)&&"number"==typeof t?a.value:("number"==typeof t&&(t=""+t),t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})))},e.REGEXEXTRACT=function(t,e){if(arguments.length<2)return a.na;var n=t.match(new RegExp(e));return n?n[1<n.length?n.length-1:0]:null},e.REGEXMATCH=function(t,e,n){if(arguments.length<2)return a.na;var r=t.match(new RegExp(e));return n?r:!!r},e.REGEXREPLACE=function(t,e,n){return arguments.length<3?a.na:t.replace(new RegExp(e),n)},e.REPLACE=function(t,e,n,r){return e=o.parseNumber(e),n=o.parseNumber(n),o.anyIsError(e,n)||"string"!=typeof t||"string"!=typeof r?a.value:t.substr(0,e-1)+r+t.substr(e-1+n)},e.REPT=function(t,e){return(e=o.parseNumber(e))instanceof Error?e:new Array(e+1).join(t)},e.RIGHT=function(t,e){return e=void 0===e?1:e,(e=o.parseNumber(e))instanceof Error?e:t?t.substring(t.length-e):a.na},e.SEARCH=function(t,e,n){var r;return"string"!=typeof t||"string"!=typeof e?a.value:(n=void 0===n?0:n,0===(r=e.toLowerCase().indexOf(t.toLowerCase(),n-1)+1)?a.value:r)},e.SPLIT=function(t,e){return t.split(e)},e.SUBSTITUTE=function(t,e,n,r){if(arguments.length<2)return a.na;if(!(t&&e&&n))return t;if(void 0===r)return t.replace(new RegExp(e,"g"),n);for(var i=0,o=0;0<t.indexOf(e,i);)if(i=t.indexOf(e,i+1),++o===r)return t.substring(0,i)+n+t.substring(i+e.length)},e.T=function(t){return"string"==typeof t?t:""},e.TEXT=function(t,e){return t=o.parseNumber(t),o.anyIsError(t)?a.na:i(t).format(e)},e.TRIM=function(t){return"string"!=typeof t?a.value:t.replace(/ +/g," ").trim()},e.UNICHAR=e.CHAR,e.UNICODE=e.CODE,e.UPPER=function(t){return"string"!=typeof t?a.value:t.toUpperCase()},e.VALUE=function(t){if("string"!=typeof t)return a.value;var e=i().unformat(t);return void 0===e?0:e}},function(t,e,n){var r=n(0);e.CELL=function(){throw new Error("CELL is not implemented")},e.ERROR={},e.ERROR.TYPE=function(t){switch(t){case r.nil:return 1;case r.div0:return 2;case r.value:return 3;case r.ref:return 4;case r.name:return 5;case r.num:return 6;case r.na:return 7;case r.data:return 8}return r.na},e.INFO=function(){throw new Error("INFO is not implemented")},e.ISBLANK=function(t){return null===t},e.ISBINARY=function(t){return/^[01]{1,10}$/.test(t)},e.ISERR=function(t){return 0<=[r.value,r.ref,r.div0,r.num,r.name,r.nil].indexOf(t)||"number"==typeof t&&(isNaN(t)||!isFinite(t))},e.ISERROR=function(t){return e.ISERR(t)||t===r.na},e.ISEVEN=function(t){return!(1&Math.floor(Math.abs(t)))},e.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},e.ISLOGICAL=function(t){return!0===t||!1===t},e.ISNA=function(t){return t===r.na},e.ISNONTEXT=function(t){return"string"!=typeof t},e.ISNUMBER=function(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)},e.ISODD=function(t){return!!(1&Math.floor(Math.abs(t)))},e.ISREF=function(){throw new Error("ISREF is not implemented")},e.ISTEXT=function(t){return"string"==typeof t},e.N=function(t){return this.ISNUMBER(t)?t:t instanceof Date?t.getTime():!0===t?1:!1===t?0:this.ISERROR(t)?t:0},e.NA=function(){return r.na},e.SHEET=function(){throw new Error("SHEET is not implemented")},e.SHEETS=function(){throw new Error("SHEETS is not implemented")},e.TYPE=function(t){return this.ISNUMBER(t)?1:this.ISTEXT(t)?2:this.ISLOGICAL(t)?4:this.ISERROR(t)?16:Array.isArray(t)?64:void 0}},function(t,e,n){var f=n(0),p=n(1),r=new Date(1900,0,1),o=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],i=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],g=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function d(t){return 1===new Date(t,1,29).getMonth()}function v(t,e){return Math.ceil((e-t)/1e3/60/60/24)}function a(t){return(t-r)/864e5+(-22038912e5<t?2:1)}e.DATE=function(t,e,n){return t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),p.anyIsError(t,e,n)?f.value:t<0||e<0||n<0?f.num:new Date(t,e-1,n)},e.DATEVALUE=function(t){if("string"!=typeof t)return f.value;var e=Date.parse(t);return isNaN(e)?f.value:e<=-22038912e5?(e-r)/864e5+1:(e-r)/864e5+2},e.DAY=function(t){var e=p.parseDate(t);return e instanceof Error?e:e.getDate()},e.DAYS=function(t,e){return t=p.parseDate(t),e=p.parseDate(e),t instanceof Error?t:e instanceof Error?e:a(t)-a(e)},e.DAYS360=function(t,e,n){if(n=p.parseBool(n),t=p.parseDate(t),e=p.parseDate(e),t instanceof Error)return t;if(e instanceof Error)return e;if(n instanceof Error)return n;var r,i,o=t.getMonth(),a=e.getMonth();if(n)r=31===t.getDate()?30:t.getDate(),i=31===e.getDate()?30:e.getDate();else{var s=new Date(t.getFullYear(),o+1,0).getDate(),l=new Date(e.getFullYear(),a+1,0).getDate();r=t.getDate()===s?30:t.getDate(),i=e.getDate()===l?r<30?(a++,1):30:e.getDate()}return 360*(e.getFullYear()-t.getFullYear())+30*(a-o)+(i-r)},e.EDATE=function(t,e){return(t=p.parseDate(t))instanceof Error?t:isNaN(e)?f.value:(e=parseInt(e,10),t.setMonth(t.getMonth()+e),a(t))},e.EOMONTH=function(t,e){return(t=p.parseDate(t))instanceof Error?t:isNaN(e)?f.value:(e=parseInt(e,10),a(new Date(t.getFullYear(),t.getMonth()+e+1,0)))},e.HOUR=function(t){return(t=p.parseDate(t))instanceof Error?t:t.getHours()},e.INTERVAL=function(t){if("number"!=typeof t&&"string"!=typeof t)return f.value;t=parseInt(t,10);var e=Math.floor(t/94608e4);t%=94608e4;var n=Math.floor(t/2592e3);t%=2592e3;var r=Math.floor(t/86400);t%=86400;var i=Math.floor(t/3600);t%=3600;var o=Math.floor(t/60),a=t%=60;return"P"+(e=0<e?e+"Y":"")+(n=0<n?n+"M":"")+(r=0<r?r+"D":"")+"T"+(i=0<i?i+"H":"")+(o=0<o?o+"M":"")+(a=0<a?a+"S":"")},e.ISOWEEKNUM=function(t){if((t=p.parseDate(t))instanceof Error)return t;t.setHours(0,0,0),t.setDate(t.getDate()+4-(t.getDay()||7));var e=new Date(t.getFullYear(),0,1);return Math.ceil(((t-e)/864e5+1)/7)},e.MINUTE=function(t){return(t=p.parseDate(t))instanceof Error?t:t.getMinutes()},e.MONTH=function(t){return(t=p.parseDate(t))instanceof Error?t:t.getMonth()+1},e.NETWORKDAYS=function(t,e,n){return this.NETWORKDAYS.INTL(t,e,1,n)},e.NETWORKDAYS.INTL=function(t,e,n,r){if((t=p.parseDate(t))instanceof Error)return t;if((e=p.parseDate(e))instanceof Error)return e;if(!((n=void 0===n?g[1]:g[n])instanceof Array))return f.value;void 0===r?r=[]:r instanceof Array||(r=[r]);for(var i=0;i<r.length;i++){var o=p.parseDate(r[i]);if(o instanceof Error)return o;r[i]=o}var a=(e-t)/864e5+1,s=a,l=t;for(i=0;i<a;i++){var u=0<(new Date).getTimezoneOffset()?l.getUTCDay():l.getDay(),h=!1;u!==n[0]&&u!==n[1]||(h=!0);for(var c=0;c<r.length;c++){var d=r[c];if(d.getDate()===l.getDate()&&d.getMonth()===l.getMonth()&&d.getFullYear()===l.getFullYear()){h=!0;break}}h&&s--,l.setDate(l.getDate()+1)}return s},e.NOW=function(){return new Date},e.SECOND=function(t){return(t=p.parseDate(t))instanceof Error?t:t.getSeconds()},e.TIME=function(t,e,n){return t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),p.anyIsError(t,e,n)?f.value:t<0||e<0||n<0?f.num:(3600*t+60*e+n)/86400},e.TIMEVALUE=function(t){return(t=p.parseDate(t))instanceof Error?t:(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},e.TODAY=function(){return new Date},e.WEEKDAY=function(t,e){if((t=p.parseDate(t))instanceof Error)return t;void 0===e&&(e=1);var n=t.getDay();return i[e][n]},e.WEEKNUM=function(t,e){if((t=p.parseDate(t))instanceof Error)return t;if(void 0===e&&(e=1),21===e)return this.ISOWEEKNUM(t);var n=o[e],r=new Date(t.getFullYear(),0,1),i=r.getDay()<n?1:0;return r-=24*Math.abs(r.getDay()-n)*60*60*1e3,Math.floor((t-r)/864e5/7+1)+i},e.WORKDAY=function(t,e,n){return this.WORKDAY.INTL(t,e,1,n)},e.WORKDAY.INTL=function(t,e,n,r){if((t=p.parseDate(t))instanceof Error)return t;if((e=p.parseNumber(e))instanceof Error)return e;if(e<0)return f.num;if(!((n=void 0===n?g[1]:g[n])instanceof Array))return f.value;void 0===r?r=[]:r instanceof Array||(r=[r]);for(var i=0;i<r.length;i++){var o=p.parseDate(r[i]);if(o instanceof Error)return o;r[i]=o}for(var a=0;a<e;){t.setDate(t.getDate()+1);var s=t.getDay();if(s!==n[0]&&s!==n[1]){for(var l=0;l<r.length;l++){var u=r[l];if(u.getDate()===t.getDate()&&u.getMonth()===t.getMonth()&&u.getFullYear()===t.getFullYear()){a--;break}}a++}}return t},e.YEAR=function(t){return(t=p.parseDate(t))instanceof Error?t:t.getFullYear()},e.YEARFRAC=function(t,e,n){if((t=p.parseDate(t))instanceof Error)return t;if((e=p.parseDate(e))instanceof Error)return e;n=n||0;var r=t.getDate(),i=t.getMonth()+1,o=t.getFullYear(),a=e.getDate(),s=e.getMonth()+1,l=e.getFullYear();switch(n){case 0:return 31===r&&31===a?a=r=30:31===r?r=30:30===r&&31===a&&(a=30),(a+30*s+360*l-(r+30*i+360*o))/360;case 1:var u=365;if(o===l||o+1===l&&(s<i||i===s&&a<=r))return(o===l&&d(o)||function(t,e){var n=t.getFullYear(),r=new Date(n,2,1);if(d(n)&&t<r&&r<=e)return!0;var i=e.getFullYear(),o=new Date(i,2,1);return d(i)&&o<=e&&t<o}(t,e)||1===s&&29===a)&&(u=366),v(t,e)/u;var h=l-o+1,c=(new Date(l+1,0,1)-new Date(o,0,1))/1e3/60/60/24/h;return v(t,e)/c;case 2:return v(t,e)/360;case 3:return v(t,e)/365;case 4:return(a+30*s+360*l-(r+30*i+360*o))/360}}},function(w,b,C){(function(m){var y;(function(){"use strict";var h,c=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],d=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],t={general:{scale:1024,suffixes:d,marker:"bd"},binary:{scale:1024,suffixes:c,marker:"b"},decimal:{scale:1e3,suffixes:d,marker:"d"}},H=[t.general,t.binary,t.decimal],B={},o=B,F="en-US",V=null,n="0,0",r="0$",e=void 0!==w&&w.exports;function i(t){this._value=t}function j(t){return 0===t?1:Math.floor(Math.log(Math.abs(t))/Math.LN10)+1}function W(t){var e,n="";for(e=0;e<t;e++)n+="0";return n}function U(t,e,n,r){var i,o,a=Math.pow(10,e);return-1<t.toString().indexOf("e")?"-"===(o=function(t,e){var n,r,i,o,a,s;return n=(s=t.toString()).split("e")[0],o=s.split("e")[1],r=n.split(".")[0],i=n.split(".")[1]||"",s=0<+o?r+i+W(o-i.length):(a=+r<0?"-0":"0",0<e&&(a+="."),a+(W(-1*o-1)+Math.abs(r)+i).substr(0,e)),0<+o&&0<e&&(s+="."+W(e)),s}(t,e)).charAt(0)&&0<=+o&&(o=o.substr(1)):o=(n(t+"e+"+e)/a).toFixed(e),r&&(i=new RegExp("0{1,"+r+"}$"),o=o.replace(i,"")),o}function a(t,e,n){var r=e.replace(/\{[^\{\}]*\}/g,"");return-1<r.indexOf("$")?l(t,B[F].currency.symbol,e,n):-1<r.indexOf("%")?function(t,e,n){var r,i="",o=100*t._value;e=-1<e.indexOf(" %")?(i=" ",e.replace(" %","")):e.replace("%","");r=-1<(r=f(o,e,n)).indexOf(")")?((r=r.split("")).splice(-1,0,i+"%"),r.join("")):r+i+"%";return r}(t,e,n):-1<r.indexOf(":")?function(t){var e=Math.floor(t._value/60/60),n=Math.floor((t._value-60*e*60)/60),r=Math.round(t._value-60*e*60-60*n);return e+":"+(n<10?"0"+n:n)+":"+(r<10?"0"+r:r)}(t):f(t._value,e,n)}function s(t,e){var n,r,i,o,a,s=e,l=!1;if(-1<e.indexOf(":"))t._value=function(t){var e=t.split(":"),n=0;3===e.length?(n+=60*Number(e[0])*60,n+=60*Number(e[1]),n+=Number(e[2])):2===e.length&&(n+=60*Number(e[0]),n+=Number(e[1]));return Number(n)}(e);else if(e===V)t._value=0;else{for("."!==B[F].delimiters.decimal&&(e=e.replace(/\./g,"").replace(B[F].delimiters.decimal,".")),n=new RegExp("[^a-zA-Z]"+B[F].abbreviations.thousand+"(?:\\)|(\\"+B[F].currency.symbol+")?(?:\\))?)?$"),r=new RegExp("[^a-zA-Z]"+B[F].abbreviations.million+"(?:\\)|(\\"+B[F].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+B[F].abbreviations.billion+"(?:\\)|(\\"+B[F].currency.symbol+")?(?:\\))?)?$"),o=new RegExp("[^a-zA-Z]"+B[F].abbreviations.trillion+"(?:\\)|(\\"+B[F].currency.symbol+")?(?:\\))?)?$"),a=1;a<c.length&&!l;++a)-1<e.indexOf(c[a])?l=Math.pow(1024,a):-1<e.indexOf(d[a])&&(l=Math.pow(1e3,a));var u=e.replace(/[^0-9\.]+/g,"");""===u?t._value=NaN:(t._value=(l||1)*(s.match(n)?Math.pow(10,3):1)*(s.match(r)?Math.pow(10,6):1)*(s.match(i)?Math.pow(10,9):1)*(s.match(o)?Math.pow(10,12):1)*(-1<e.indexOf("%")?.01:1)*((e.split("-").length+Math.min(e.split("(").length-1,e.split(")").length-1))%2?1:-1)*Number(u),t._value=l?Math.ceil(t._value):t._value)}return t._value}function l(t,e,n,r){var i,o,a=n,s=a.indexOf("$"),l=a.indexOf("("),u=a.indexOf("+"),h=a.indexOf("-"),c="",d="";if(-1===a.indexOf("$")?"infix"===B[F].currency.position?(d=e,B[F].currency.spaceSeparated&&(d=" "+d+" ")):B[F].currency.spaceSeparated&&(c=" "):a=-1<a.indexOf(" $")?(c=" ",a.replace(" $","")):-1<a.indexOf("$ ")?(c=" ",a.replace("$ ","")):a.replace("$",""),o=f(t._value,a,r,d),-1===n.indexOf("$"))switch(B[F].currency.position){case"postfix":o=-1<o.indexOf(")")?((o=o.split("")).splice(-1,0,c+e),o.join("")):o+c+e;break;case"infix":break;case"prefix":o=-1<o.indexOf("(")||-1<o.indexOf("-")?(o=o.split(""),i=Math.max(l,h)+1,o.splice(i,0,e+c),o.join("")):e+c+o;break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]')}else o=s<=1?-1<o.indexOf("(")||-1<o.indexOf("+")||-1<o.indexOf("-")?(i=1,(s<l||s<u||s<h)&&(i=0),(o=o.split("")).splice(i,0,e+c),o.join("")):e+c+o:-1<o.indexOf(")")?((o=o.split("")).splice(-1,0,c+e),o.join("")):o+c+e;return o}function z(t,e,n){var r,i,o,a=e[0],s=Math.abs(t);if(n<=s){for(r=1;r<e.length;++r)if(i=Math.pow(n,r),o=Math.pow(n,r+1),i<=s&&s<o){a=e[r],t/=i;break}a===e[0]&&(t/=Math.pow(n,e.length-1),a=e[e.length-1])}return{value:t,suffix:a}}function f(t,e,n,r){var i,o,a,s,l,u,h,c,d,f,p,g,v,m,y,w=!1,b=!1,C=!1,E="",S=!1,O=!1,T=!1,N=!1,R=!1,_="",M="",A=Math.abs(t),k="",x=!1,I=!1;if(0===t&&null!==V)return V;if(!isFinite(t))return""+t;if(0===e.indexOf("{")){var D=e.indexOf("}");if(-1===D)throw Error('Format should also contain a "}"');f=e.slice(1,D),e=e.slice(D+1)}else f="";if(e.indexOf("}")===e.length-1&&e.length){var L=e.indexOf("{");if(-1===L)throw Error('Format should also contain a "{"');p=e.slice(L+1,-1),e=e.slice(0,L+1)}else p="";for(v=null===(y=-1===e.indexOf(".")?e.match(/([0-9]+).*/):e.match(/([0-9]+)\..*/))?-1:y[1].length,-1!==e.indexOf("-")&&(x=!0),-1<e.indexOf("(")?(w=!0,e=e.slice(1,-1)):-1<e.indexOf("+")&&(b=!0,e=e.replace(/\+/g,"")),-1<e.indexOf("a")&&(c=e.split(".")[0].match(/[0-9]+/g)||["0"],c=parseInt(c[0],10),S=0<=e.indexOf("aK"),O=0<=e.indexOf("aM"),T=0<=e.indexOf("aB"),N=0<=e.indexOf("aT"),R=S||O||T||N,e=-1<e.indexOf(" a")?(E=" ",e.replace(" a","")):e.replace("a",""),l=0===(l=(a=j(t))%3)?3:l,c&&0!==A&&(u=3*~~((Math.min(c,a)-l)/3),A/=Math.pow(10,u)),a!==c&&(A>=Math.pow(10,12)&&!R||N?(E+=B[F].abbreviations.trillion,t/=Math.pow(10,12)):A<Math.pow(10,12)&&A>=Math.pow(10,9)&&!R||T?(E+=B[F].abbreviations.billion,t/=Math.pow(10,9)):A<Math.pow(10,9)&&A>=Math.pow(10,6)&&!R||O?(E+=B[F].abbreviations.million,t/=Math.pow(10,6)):(A<Math.pow(10,6)&&A>=Math.pow(10,3)&&!R||S)&&(E+=B[F].abbreviations.thousand,t/=Math.pow(10,3))),s=j(t),c&&s<c&&-1===e.indexOf(".")&&(e+="[.]",e+=W(c-s))),m=0;m<H.length;++m)if(i=H[m],-1<e.indexOf(i.marker)){-1<e.indexOf(" "+i.marker)&&(_=" "),e=e.replace(_+i.marker,""),t=(o=z(t,i.suffixes,i.scale)).value,_+=o.suffix;break}if(-1<e.indexOf("o")&&(e=-1<e.indexOf(" o")?(M=" ",e.replace(" o","")):e.replace("o",""),B[F].ordinal&&(M+=B[F].ordinal(t))),-1<e.indexOf("[.]")&&(C=!0,e=e.replace("[.]",".")),d=e.split(".")[1],g=e.indexOf(","),d){var P=[];if(-1!==d.indexOf("*")?1<(P=(k=t.toString()).split(".")).length&&(k=U(t,P[1].length,n)):k=-1<d.indexOf("[")?U(t,(d=(d=d.replace("]","")).split("["))[0].length+d[1].length,n,d[1].length):U(t,d.length,n),h=(P=k.split("."))[0],1<P.length&&P[1].length)k=(r?E+r:B[F].delimiters.decimal)+P[1];else k="";C&&0===Number(k.slice(1))&&(k="")}else h=U(t,0,n);return-1<h.indexOf("-")&&(h=h.slice(1),I=!0),h.length<v&&(h=W(v-h.length)+h),-1<g&&(h=h.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+B[F].delimiters.thousands)),0===e.indexOf(".")&&(h=""),f+(e.indexOf("(")<e.indexOf("-")?(w&&I?"(":"")+(x&&I||!w&&I?"-":""):(x&&I||!w&&I?"-":"")+(w&&I?"(":""))+(!I&&b&&0!==t?"+":"")+h+k+(M||"")+(E&&!r?E:"")+(_||"")+(w&&I?")":"")+p}function u(t,e){B[t]=e}function p(t){var e=B[F=t].defaults;e&&e.format&&h.defaultFormat(e.format),e&&e.currencyFormat&&h.defaultCurrencyFormat(e.currencyFormat)}function g(t){var e=t.toString().split(".");return e.length<2?1:Math.pow(10,e[1].length)}function v(){return Array.prototype.slice.call(arguments).reduce(function(t,e){var n=g(t),r=g(e);return r<n?n:r},-1/0)}(h=function(t){return t=h.isNumbro(t)?t.value():"string"==typeof t||"number"==typeof t?h.fn.unformat(t):NaN,new i(Number(t))}).version="1.11.1",h.isNumbro=function(t){return t instanceof i},h.setLanguage=function(t,e){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var n=t,r=t.split("-")[0],i=null;o[n]||(Object.keys(o).forEach(function(t){i||t.split("-")[0]!==r||(i=t)}),n=i||e||"en-US"),p(n)},h.setCulture=function(t,e){var n=t,r=t.split("-")[1],i=null;B[n]||(r&&Object.keys(B).forEach(function(t){i||t.split("-")[1]!==r||(i=t)}),n=i||e||"en-US"),p(n)},h.language=function(t,e){if(console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead"),!t)return F;if(t&&!e){if(!o[t])throw new Error("Unknown language : "+t);p(t)}return!e&&o[t]||u(t,e),h},h.culture=function(t,e){if(!t)return F;if(t&&!e){if(!B[t])throw new Error("Unknown culture : "+t);p(t)}return!e&&B[t]||u(t,e),h},h.languageData=function(t){if(console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead"),!t)return o[F];if(!o[t])throw new Error("Unknown language : "+t);return o[t]},h.cultureData=function(t){if(!t)return B[F];if(!B[t])throw new Error("Unknown culture : "+t);return B[t]},h.culture("en-US",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1==e?"st":2==e?"nd":3==e?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}}),h.languages=function(){return console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead"),o},h.cultures=function(){return B},h.zeroFormat=function(t){V="string"==typeof t?t:null},h.defaultFormat=function(t){n="string"==typeof t?t:"0.0"},h.defaultCurrencyFormat=function(t){r="string"==typeof t?t:"0$"},h.validate=function(t,e){var n,r,i,o,a,s,l,u;if("string"!=typeof t&&(t+="",console.warn&&console.warn("Numbro.js: Value is not string. It has been co-erced to: ",t)),(t=(t=t.trim()).replace(/^[+-]?/,"")).match(/^\d+$/))return!0;if(""===t)return!1;try{l=h.cultureData(e)}catch(t){l=h.cultureData(h.culture())}return i=l.currency.symbol,a=l.abbreviations,n=l.delimiters.decimal,r="."===l.delimiters.thousands?"\\.":l.delimiters.thousands,(null===(u=t.match(/^[^\d\.\,]+/))||(t=t.substr(1),u[0]===i))&&((null===(u=t.match(/[^\d]+$/))||(t=t.slice(0,-1),u[0]===a.thousand||u[0]===a.million||u[0]===a.billion||u[0]===a.trillion))&&(s=new RegExp(r+"{2}"),!t.match(/[^\d.,]/g)&&(!(2<(o=t.split(n)).length)&&(o.length<2?!!o[0].match(/^\d+.*\d$/)&&!o[0].match(s):""===o[0]?!o[0].match(s)&&!!o[1].match(/^\d+$/):1===o[0].length?!!o[0].match(/^\d+$/)&&!o[0].match(s)&&!!o[1].match(/^\d+$/):!!o[0].match(/^\d+.*\d$/)&&!o[0].match(s)&&!!o[1].match(/^\d+$/)))))},h.loadLanguagesInNode=function(){console.warn("`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead"),h.loadCulturesInNode()},h.loadCulturesInNode=function(){var t=C(27);for(var e in t)e&&h.culture(e,t[e])},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(t,e){if(null==this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var n,r,i=this.length>>>0,o=!1;for(1<arguments.length&&(r=e,o=!0),n=0;n<i;++n)this.hasOwnProperty(n)&&(o?r=t(r,this[n],n,this):(r=this[n],o=!0));if(!o)throw new TypeError("Reduce of empty array with no initial value");return r}),h.fn=i.prototype={clone:function(){return h(this)},format:function(t,e){return a(this,t||n,void 0!==e?e:Math.round)},formatCurrency:function(t,e){return l(this,B[F].currency.symbol,t||r,void 0!==e?e:Math.round)},formatForeignCurrency:function(t,e,n){return function(t,e,n,r){return l(t,e,n,r)}(this,t,e||r,void 0!==n?n:Math.round)},unformat:function(t){if("number"==typeof t)return t;if("string"==typeof t){var e=s(this,t);return isNaN(e)?void 0:e}},binaryByteUnits:function(){return z(this._value,t.binary.suffixes,t.binary.scale).suffix},byteUnits:function(){return z(this._value,t.general.suffixes,t.general.scale).suffix},decimalByteUnits:function(){return z(this._value,t.decimal.suffixes,t.decimal.scale).suffix},value:function(){return this._value},valueOf:function(){return this._value},set:function(t){return this._value=Number(t),this},add:function(t){var n=v.call(null,this._value,t);return this._value=[this._value,t].reduce(function(t,e){return t+n*e},0)/n,this},subtract:function(t){var n=v.call(null,this._value,t);return this._value=[t].reduce(function(t,e){return t-n*e},this._value*n)/n,this},multiply:function(t){return this._value=[this._value,t].reduce(function(t,e){var n=v(t,e),r=t*n;return r*=e*n,r/=n*n},1),this},divide:function(t){return this._value=[this._value,t].reduce(function(t,e){var n=v(t,e);return t*n/(e*n)}),this},difference:function(t){return Math.abs(h(this._value).subtract(t).value())}},void 0!==m&&void 0===m.browser&&m.title&&(-1!==m.title.indexOf("node")||0<m.title.indexOf("meteor-tool")||"grunt"===m.title||"gulp"===m.title)&&h.loadCulturesInNode(),e?w.exports=h:("undefined"==typeof ender&&(this.numbro=h),void 0===(y=function(){return h}.apply(b,[]))||(w.exports=y))}).call("undefined"==typeof window?this:window)}).call(b,C(10))},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var l,u=[],h=!1,c=-1;function d(){h&&l&&(h=!1,l.length?u=l.concat(u):c=-1,u.length&&f())}function f(){if(!h){var t=s(d);h=!0;for(var e=u.length;e;){for(l=u,u=[];++c<e;)l&&l[c].run();c=-1,e=u.length}l=null,h=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new p(t,e)),1!==u.length||h||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){var o;o=function(){var v,m,E,S,y,g,s,l,o,e,u,h,c,a,n,d=function(s,l){var e=Array.prototype.concat,t=Array.prototype.slice,n=Object.prototype.toString;function u(t,e){var n=e<t?t:e;return s.pow(10,17-~~(s.log(0<n?n:-n)*s.LOG10E))}var h=Array.isArray||function(t){return"[object Array]"===n.call(t)};function c(t){return"[object Function]"===n.call(t)}function d(t){return"number"==typeof t&&t==t}function f(){return new f._init(arguments)}function r(){return 0}function o(){return 1}function a(t,e){return t===e?1:0}function p(t,e,n,r){var i,o=[],a=t.length;if(e===l&&n===l&&r===l)return f.copy(t);if(r=r||1,(e=0<=(e=e||0)?e:a+e)===(n=0<=(n=n||t.length)?n:a+n)||0===r)return[];if(e<n&&r<0)return[];if(n<e&&0<r)return[];if(0<r)for(i=e;i<n;i+=r)o.push(t[i]);else for(i=e;n<i;i+=r)o.push(t[i]);return o}f.fn=f.prototype,(f._init=function(t){if(h(t[0]))if(h(t[0][0])){c(t[1])&&(t[0]=f.map(t[0],t[1]));for(var e=0;e<t[0].length;e++)this[e]=t[0][e];this.length=t[0].length}else this[0]=c(t[1])?f.map(t[0],t[1]):t[0],this.length=1;else if(d(t[0]))this[0]=f.seq.apply(null,t),this.length=1;else{if(t[0]instanceof f)return f(t[0].toArray());this[0]=[],this.length=1}return this}).prototype=f.prototype,(f._init.constructor=f).utils={calcRdx:u,isArray:h,isFunction:c,isNumber:d,toVector:function(t){return e.apply([],t)}},f.extend=function(t){var e;if(1===arguments.length){for(e in t)f[e]=t[e];return this}for(var n=1;n<arguments.length;n++)for(e in arguments[n])t[e]=arguments[n][e];return t},f.rows=function(t){return t.length||1},f.cols=function(t){return t[0].length||1},f.dimensions=function(t){return{rows:f.rows(t),cols:f.cols(t)}},f.row=function(e,t){return h(t)?t.map(function(t){return f.row(e,t)}):e[t]},f.rowa=function(t,e){return f.row(t,e)},f.col=function(r,e){if(h(e)){var i=f.arange(r.length).map(function(t){return new Array(e.length)});return e.forEach(function(e,n){f.arange(r.length).forEach(function(t){i[t][n]=r[t][e]})}),i}for(var t=new Array(r.length),n=0;n<r.length;n++)t[n]=[r[n][e]];return t},f.cola=function(t,e){return f.col(t,e).map(function(t){return t[0]})},f.diag=function(t){for(var e=f.rows(t),n=new Array(e),r=0;r<e;r++)n[r]=[t[r][r]];return n},f.antidiag=function(t){for(var e=f.rows(t)-1,n=new Array(e),r=0;0<=e;e--,r++)n[r]=[t[r][e]];return n},f.transpose=function(t){var e,n,r,i,o=[];h(t[0])||(t=[t]),n=t.length,r=t[0].length;for(var a=0;a<r;a++){for(e=new Array(n),i=0;i<n;i++)e[i]=t[i][a];o.push(e)}return 1===o.length?o[0]:o},f.map=function(t,e,n){var r,i,o,a,s;for(h(t[0])||(t=[t]),i=t.length,o=t[0].length,a=n?t:new Array(i),r=0;r<i;r++)for(a[r]||(a[r]=new Array(o)),s=0;s<o;s++)a[r][s]=e(t[r][s],r,s);return 1===a.length?a[0]:a},f.cumreduce=function(t,e,n){var r,i,o,a,s;for(h(t[0])||(t=[t]),i=t.length,o=t[0].length,a=n?t:new Array(i),r=0;r<i;r++)for(a[r]||(a[r]=new Array(o)),0<o&&(a[r][0]=t[r][0]),s=1;s<o;s++)a[r][s]=e(a[r][s-1],t[r][s]);return 1===a.length?a[0]:a},f.alter=function(t,e){return f.map(t,e,!0)},f.create=function(t,e,n){var r,i=new Array(t);c(e)&&(n=e,e=t);for(var o=0;o<t;o++)for(i[o]=new Array(e),r=0;r<e;r++)i[o][r]=n(o,r);return i},f.zeros=function(t,e){return d(e)||(e=t),f.create(t,e,r)},f.ones=function(t,e){return d(e)||(e=t),f.create(t,e,o)},f.rand=function(t,e){return d(e)||(e=t),f.create(t,e,s.random)},f.identity=function(t,e){return d(e)||(e=t),f.create(t,e,a)},f.symmetric=function(t){var e,n,r=t.length;if(t.length!==t[0].length)return!1;for(e=0;e<r;e++)for(n=0;n<r;n++)if(t[n][e]!==t[e][n])return!1;return!0},f.clear=function(t){return f.alter(t,r)},f.seq=function(t,e,n,r){c(r)||(r=!1);var i,o=[],a=u(t,e),s=(e*a-t*a)/((n-1)*a),l=t;for(i=0;l<=e&&i<n;l=(t*a+s*a*++i)/a)o.push(r?r(l,i):l);return o},f.arange=function(t,e,n){var r=[];if(n=n||1,e===l&&(e=t,t=0),t===e||0===n)return[];if(t<e&&n<0)return[];if(e<t&&0<n)return[];if(0<n)for(i=t;i<e;i+=n)r.push(i);else for(i=t;i>e;i+=n)r.push(i);return r},f.slice=function(t,e){if(d((e=e||{}).row))return d(e.col)?t[e.row][e.col]:p(f.rowa(t,e.row),(r=e.col||{}).start,r.end,r.step);if(d(e.col))return p(f.cola(t,e.col),(n=e.row||{}).start,n.end,n.step);var n=e.row||{},r=e.col||{};return p(t,n.start,n.end,n.step).map(function(t){return p(t,r.start,r.end,r.step)})},f.sliceAssign=function(i,t,o){if(d(t.row)){if(d(t.col))return i[t.row][t.col]=o;t.col=t.col||{},t.col.start=t.col.start||0,t.col.end=t.col.end||i[0].length,t.col.step=t.col.step||1;var e=f.arange(t.col.start,s.min(i.length,t.col.end),t.col.step),n=t.row;return e.forEach(function(t,e){i[n][t]=o[e]}),i}if(d(t.col)){t.row=t.row||{},t.row.start=t.row.start||0,t.row.end=t.row.end||i.length,t.row.step=t.row.step||1;var r=f.arange(t.row.start,s.min(i[0].length,t.row.end),t.row.step),a=t.col;return r.forEach(function(t,e){i[t][a]=o[e]}),i}o[0].length===l&&(o=[o]),t.row.start=t.row.start||0,t.row.end=t.row.end||i.length,t.row.step=t.row.step||1,t.col.start=t.col.start||0,t.col.end=t.col.end||i[0].length,t.col.step=t.col.step||1;r=f.arange(t.row.start,s.min(i.length,t.row.end),t.row.step),e=f.arange(t.col.start,s.min(i[0].length,t.col.end),t.col.step);return r.forEach(function(n,r){e.forEach(function(t,e){i[n][t]=o[r][e]})}),i},f.diagonal=function(t){var n=f.zeros(t.length,t.length);return t.forEach(function(t,e){n[e][e]=t}),n},f.copy=function(t){return t.map(function(t){return d(t)?t:t.map(function(t){return t})})};var g=f.prototype;return g.length=0,g.push=Array.prototype.push,g.sort=Array.prototype.sort,g.splice=Array.prototype.splice,g.slice=Array.prototype.slice,g.toArray=function(){return 1<this.length?t.call(this):t.call(this)[0]},g.map=function(t,e){return f(f.map(this,t,e))},g.cumreduce=function(t,e){return f(f.cumreduce(this,t,e))},g.alter=function(t){return f.alter(this,t),this},function(t){for(var e=0;e<t.length;e++)!function(r){g[r]=function(t){var e,n=this;return t?(setTimeout(function(){t.call(n,g[r].call(n))}),this):(e=f[r](this),h(e)?f(e):e)}}(t[e])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(r){g[r]=function(t,e){var n=this;return e?(setTimeout(function(){e.call(n,g[r].call(n,t))}),this):f(f[r](this,t))}}(t[e])}("row col".split(" ")),function(t){for(var e=0;e<t.length;e++)n=t[e],g[n]=new Function("return jStat(jStat."+n+".apply(null, arguments));");var n}("create zeros ones rand identity".split(" ")),f}(Math);function w(t,e,n){var r=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],i=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],o=.5*t;if(8<=o)return 1;var a,s=2*E.normal.cdf(o,0,1,1,0)-1;s=s>=S.exp(-50/n)?S.pow(s,n):0;for(var l=o,u=(8-o)/(a=3<t?2:3),h=l+u,c=0,d=n-1,f=1;f<=a;f++){for(var p=0,g=.5*(h+l),v=.5*(h-l),m=1;m<=12;m++){var y,w=g+v*(6<m?r[(y=12-m+1)-1]:-r[(y=m)-1]),b=w*w;if(60<b)break;var C=.5*(2*E.normal.cdf(w,0,1,1,0))-.5*(2*E.normal.cdf(w,t,1,1,0));C>=S.exp(-30/d)&&(p+=C=i[y-1]*S.exp(-.5*b)*S.pow(C,d))}c+=p*=2*v*n/S.sqrt(2*S.PI),l=h,h+=u}return(s+=c)<=S.exp(-30/e)?0:1<=(s=S.pow(s,e))?1:s}function f(t){return e(t)||t instanceof y}function p(t,e,n,r){if(1<t||1<n||t<=0||n<=0)throw new Error("Proportions should be greater than 0 and less than 1");var i=(t*e+n*r)/(e+r);return(t-n)/h.sqrt(i*(1-i)*(1/e+1/r))}function b(t,e){var n=t.length,r=e[0].length-1,i=n-r-1,o=d.lstsq(e,t),a=d.multiply(e,o.map(function(t){return[t]})).map(function(t){return t[0]}),s=d.subtract(t,a),l=d.mean(t),u=d.sum(a.map(function(t){return Math.pow(t-l,2)})),h=d.sum(t.map(function(t,e){return Math.pow(t-a[e],2)})),c=u+h;return{exog:e,endog:t,nobs:n,df_model:r,df_resid:i,coef:o,predict:a,resid:s,ybar:l,SST:c,SSE:u,SSR:h,R2:u/c}}function C(n){var t=function(n){var r=n[0].length;return d.arange(r).map(function(e){var t=d.arange(r).filter(function(t){return t!==e});return b(d.col(n,e).map(function(t){return t[0]}),d.col(n,t))})}(n.exog),r=Math.sqrt(n.SSR/n.df_resid),i=t.map(function(t){var e=t.SST,n=t.R2;return r/Math.sqrt(e*(1-n))}),e=n.coef.map(function(t,e){return(t-0)/i[e]}),o=e.map(function(t){var e=d.studentt.cdf(t,n.df_resid);return 2*(.5<e?1-e:e)}),a=d.studentt.inv(.975,n.df_resid),s=n.coef.map(function(t,e){var n=a*i[e];return[t-n,t+n]});return{se:i,t:e,p:o,sigmaHat:r,interval95:s}}return function(l,d){var u=l.utils.isFunction;function f(t,e){return t-e}function p(t,e,n){return d.max(e,d.min(t,n))}l.sum=function(t){for(var e=0,n=t.length;0<=--n;)e+=t[n];return e},l.sumsqrd=function(t){for(var e=0,n=t.length;0<=--n;)e+=t[n]*t[n];return e},l.sumsqerr=function(t){for(var e,n=l.mean(t),r=0,i=t.length;0<=--i;)r+=(e=t[i]-n)*e;return r},l.sumrow=function(t){for(var e=0,n=t.length;0<=--n;)e+=t[n];return e},l.product=function(t){for(var e=1,n=t.length;0<=--n;)e*=t[n];return e},l.min=function(t){for(var e=t[0],n=0;++n<t.length;)t[n]<e&&(e=t[n]);return e},l.max=function(t){for(var e=t[0],n=0;++n<t.length;)t[n]>e&&(e=t[n]);return e},l.unique=function(t){for(var e={},n=[],r=0;r<t.length;r++)e[t[r]]||(e[t[r]]=!0,n.push(t[r]));return n},l.mean=function(t){return l.sum(t)/t.length},l.meansqerr=function(t){return l.sumsqerr(t)/t.length},l.geomean=function(t){return d.pow(l.product(t),1/t.length)},l.median=function(t){var e=t.length,n=t.slice().sort(f);return 1&e?n[e/2|0]:(n[e/2-1]+n[e/2])/2},l.cumsum=function(t){return l.cumreduce(t,function(t,e){return t+e})},l.cumprod=function(t){return l.cumreduce(t,function(t,e){return t*e})},l.diff=function(t){for(var e=[],n=t.length,r=1;r<n;r++)e.push(t[r]-t[r-1]);return e},l.rank=function(t){for(var e=t.length,n=t.slice().sort(f),r=new Array(e),i=0;i<e;i++){var o=n.indexOf(t[i]),a=n.lastIndexOf(t[i]);if(o===a)var s=o;else s=(o+a)/2;r[i]=s+1}return r},l.mode=function(t){for(var e=t.length,n=t.slice().sort(f),r=1,i=0,o=0,a=[],s=0;s<e;s++)n[s]===n[s+1]?r++:(i<r?(a=[n[s]],i=r,o=0):r===i&&(a.push(n[s]),o++),r=1);return 0===o?a[0]:a},l.range=function(t){return l.max(t)-l.min(t)},l.variance=function(t,e){return l.sumsqerr(t)/(t.length-(e?1:0))},l.pooledvariance=function(t){return t.reduce(function(t,e){return t+l.sumsqerr(e)},0)/(t.reduce(function(t,e){return t+e.length},0)-t.length)},l.deviation=function(t){for(var e=l.mean(t),n=t.length,r=new Array(n),i=0;i<n;i++)r[i]=t[i]-e;return r},l.stdev=function(t,e){return d.sqrt(l.variance(t,e))},l.pooledstdev=function(t){return d.sqrt(l.pooledvariance(t))},l.meandev=function(t){for(var e=l.mean(t),n=[],r=t.length-1;0<=r;r--)n.push(d.abs(t[r]-e));return l.mean(n)},l.meddev=function(t){for(var e=l.median(t),n=[],r=t.length-1;0<=r;r--)n.push(d.abs(t[r]-e));return l.median(n)},l.coeffvar=function(t){return l.stdev(t)/l.mean(t)},l.quartiles=function(t){var e=t.length,n=t.slice().sort(f);return[n[d.round(e/4)-1],n[d.round(e/2)-1],n[d.round(3*e/4)-1]]},l.quantiles=function(t,e,n,r){var i,o,a,s,l=t.slice().sort(f),u=[e.length],h=t.length;void 0===n&&(n=3/8),void 0===r&&(r=3/8);for(var c=0;c<e.length;c++)s=p((o=h*(i=e[c])+(n+i*(1-n-r)))-(a=d.floor(p(o,1,h-1))),0,1),u[c]=(1-s)*l[a-1]+s*l[a];return u},l.percentile=function(t,e){var n=t.slice().sort(f),r=e*(n.length-1),i=parseInt(r),o=r-i;return i+1<n.length?n[i]*(1-o)+n[i+1]*o:n[i]},l.percentileOfScore=function(t,e,n){var r,i=0,o=t.length,a=!1;"strict"===n&&(a=!0);for(var s=0;s<o;s++)r=t[s],(a&&r<e||!a&&r<=e)&&i++;return i/o},l.histogram=function(t,e){for(var n=l.min(t),r=e||4,i=(l.max(t)-n)/r,o=t.length,a=(e=[],0);a<r;a++)e[a]=0;for(a=0;a<o;a++)e[d.min(d.floor((t[a]-n)/i),r-1)]+=1;return e},l.covariance=function(t,e){for(var n=l.mean(t),r=l.mean(e),i=t.length,o=new Array(i),a=0;a<i;a++)o[a]=(t[a]-n)*(e[a]-r);return l.sum(o)/(i-1)},l.corrcoeff=function(t,e){return l.covariance(t,e)/l.stdev(t,1)/l.stdev(e,1)},l.spearmancoeff=function(t,e){return t=l.rank(t),e=l.rank(e),l.corrcoeff(t,e)},l.stanMoment=function(t,e){for(var n=l.mean(t),r=l.stdev(t),i=t.length,o=0,a=0;a<i;a++)o+=d.pow((t[a]-n)/r,e);return o/t.length},l.skewness=function(t){return l.stanMoment(t,3)},l.kurtosis=function(t){return l.stanMoment(t,4)-3};var h=l.prototype;!function(t){for(var e=0;e<t.length;e++)!function(o){h[o]=function(t,e){var n=[],r=0,i=this;if(u(t)&&(e=t,t=!1),e)return setTimeout(function(){e.call(i,h[o].call(i,t))}),this;if(1<this.length){for(i=!0===t?this:this.transpose();r<i.length;r++)n[r]=l[o](i[r]);return n}return l[o](this[0],t)}}(t[e])}("cumsum cumprod".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(o){h[o]=function(t,e){var n=[],r=0,i=this;if(u(t)&&(e=t,t=!1),e)return setTimeout(function(){e.call(i,h[o].call(i,t))}),this;if(1<this.length){for("sumrow"!==o&&(i=!0===t?this:this.transpose());r<i.length;r++)n[r]=l[o](i[r]);return!0===t?l[o](l.utils.toVector(n)):n}return l[o](this[0],t)}}(t[e])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(s){h[s]=function(){var t=[],e=0,n=this,r=Array.prototype.slice.call(arguments);if(u(r[r.length-1])){var i=r[r.length-1],o=r.slice(0,r.length-1);return setTimeout(function(){i.call(n,h[s].apply(n,o))}),this}i=void 0;var a=function(t){return l[s].apply(n,[t].concat(r))};if(1<this.length){for(n=n.transpose();e<n.length;e++)t[e]=a(n[e]);return t}return a(this[0])}}(t[e])}("quantiles percentileOfScore".split(" "))}(d,Math),v=d,m=Math,v.gammaln=function(t){var e,n,r,i=0,o=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(n=e=t)+5.5,r-=(e+.5)*m.log(r);i<6;i++)a+=o[i]/++n;return m.log(2.5066282746310007*a/e)-r},v.gammafn=function(t){var e,n,r,i=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],o=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],a=!1,s=0,l=0,u=0,h=t;if(h<=0){if(!(r=h%1+36e-17))return 1/0;a=(1&h?-1:1)*m.PI/m.sin(m.PI*r),h=1-h}e=(n=h)<1?h++:(h-=s=(0|h)-1)-1;for(var c=0;c<8;++c)u=(u+i[c])*e,l=l*e+o[c];if(r=u/l+1,n<h)r/=n;else if(h<n)for(c=0;c<s;++c)r*=h,h++;return a&&(r=a/r),r},v.gammap=function(t,e){return v.lowRegGamma(t,e)*v.gammafn(t)},v.lowRegGamma=function(t,e){var n,r=v.gammaln(t),i=t,o=1/t,a=o,s=e+1-t,l=1/1e-30,u=1/s,h=u,c=1,d=-~(8.5*m.log(1<=t?t:1/t)+.4*t+17);if(e<0||t<=0)return NaN;if(e<t+1){for(;c<=d;c++)o+=a*=e/++i;return o*m.exp(-e+t*m.log(e)-r)}for(;c<=d;c++)h*=(u=1/(u=(n=-c*(c-t))*u+(s+=2)))*(l=s+n/l);return 1-h*m.exp(-e+t*m.log(e)-r)},v.factorialln=function(t){return t<0?NaN:v.gammaln(t+1)},v.factorial=function(t){return t<0?NaN:v.gammafn(t+1)},v.combination=function(t,e){return 170<t||170<e?m.exp(v.combinationln(t,e)):v.factorial(t)/v.factorial(e)/v.factorial(t-e)},v.combinationln=function(t,e){return v.factorialln(t)-v.factorialln(e)-v.factorialln(t-e)},v.permutation=function(t,e){return v.factorial(t)/v.factorial(t-e)},v.betafn=function(t,e){if(!(t<=0||e<=0))return 170<t+e?m.exp(v.betaln(t,e)):v.gammafn(t)*v.gammafn(e)/v.gammafn(t+e)},v.betaln=function(t,e){return v.gammaln(t)+v.gammaln(e)-v.gammaln(t+e)},v.betacf=function(t,e,n){var r,i,o,a,s=1e-30,l=1,u=e+n,h=e+1,c=e-1,d=1,f=1-u*t/h;for(m.abs(f)<s&&(f=s),a=f=1/f;l<=100&&(f=1+(i=l*(n-l)*t/((c+(r=2*l))*(e+r)))*f,m.abs(f)<s&&(f=s),d=1+i/d,m.abs(d)<s&&(d=s),a*=(f=1/f)*d,f=1+(i=-(e+l)*(u+l)*t/((e+r)*(h+r)))*f,m.abs(f)<s&&(f=s),d=1+i/d,m.abs(d)<s&&(d=s),a*=o=(f=1/f)*d,!(m.abs(o-1)<3e-7));l++);return a},v.gammapinv=function(t,e){var n,r,i,o,a,s,l=0,u=e-1,h=v.gammaln(e);if(1<=t)return m.max(100,e+100*m.sqrt(e));if(t<=0)return 0;for(n=1<e?(a=m.log(u),s=m.exp(u*(a-1)-h),o=t<.5?t:1-t,n=(2.30753+.27061*(r=m.sqrt(-2*m.log(o))))/(1+r*(.99229+.04481*r))-r,t<.5&&(n=-n),m.max(.001,e*m.pow(1-1/(9*e)-n/(3*m.sqrt(e)),3))):t<(r=1-e*(.253+.12*e))?m.pow(t/r,1/e):1-m.log(1-(t-r)/(1-r));l<12;l++){if(n<=0)return 0;if((n-=r=(i=(v.lowRegGamma(e,n)-t)/(r=1<e?s*m.exp(-(n-u)+u*(m.log(n)-a)):m.exp(-n+u*m.log(n)-h)))/(1-.5*m.min(1,i*((e-1)/n-1))))<=0&&(n=.5*(n+r)),m.abs(r)<1e-8*n)break}return n},v.erf=function(t){var e,n,r,i,o=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],a=o.length-1,s=!1,l=0,u=0;for(t<0&&(t=-t,s=!0),n=4*(e=2/(2+t))-2;0<a;a--)l=n*(r=l)-u+o[a],u=r;return i=e*m.exp(-t*t+.5*(o[0]+n*l)-u),s?i-1:1-i},v.erfc=function(t){return 1-v.erf(t)},v.erfcinv=function(t){var e,n,r,i,o=0;if(2<=t)return-100;if(t<=0)return 100;for(i=t<1?t:2-t,e=-.70711*((2.30753+.27061*(r=m.sqrt(-2*m.log(i/2))))/(1+r*(.99229+.04481*r))-r);o<2;o++)e+=(n=v.erfc(e)-i)/(1.1283791670955126*m.exp(-e*e)-e*n);return t<1?e:-e},v.ibetainv=function(t,e,n){var r,i,o,a,s,l,u,h,c,d,f=e-1,p=n-1,g=0;if(t<=0)return 0;if(1<=t)return 1;for(l=1<=e&&1<=n?(o=t<.5?t:1-t,l=(2.30753+.27061*(a=m.sqrt(-2*m.log(o))))/(1+a*(.99229+.04481*a))-a,t<.5&&(l=-l),u=(l*l-3)/6,h=2/(1/(2*e-1)+1/(2*n-1)),c=l*m.sqrt(u+h)/h-(1/(2*n-1)-1/(2*e-1))*(u+5/6-2/(3*h)),e/(e+n*m.exp(2*c))):(r=m.log(e/(e+n)),i=m.log(n/(e+n)),t<(a=m.exp(e*r)/e)/(c=a+(s=m.exp(n*i)/n))?m.pow(e*c*t,1/e):1-m.pow(n*c*(1-t),1/n)),d=-v.gammaln(e)-v.gammaln(n)+v.gammaln(e+n);g<10;g++){if(0===l||1===l)return l;if((l-=a=(s=(v.ibeta(l,e,n)-t)/(a=m.exp(f*m.log(l)+p*m.log(1-l)+d)))/(1-.5*m.min(1,s*(f/l-p/(1-l)))))<=0&&(l=.5*(l+a)),1<=l&&(l=.5*(l+a+1)),m.abs(a)<1e-8*l&&0<g)break}return l},v.ibeta=function(t,e,n){var r=0===t||1===t?0:m.exp(v.gammaln(e+n)-v.gammaln(e)-v.gammaln(n)+e*m.log(t)+n*m.log(1-t));return!(t<0||1<t)&&(t<(e+1)/(e+n+2)?r*v.betacf(t,e,n)/e:1-r*v.betacf(1-t,n,e)/n)},v.randn=function(t,e){var n,r,i,o,a;if(e=e||t,t)return v.create(t,e,function(){return v.randn()});for(;n=m.random(),r=1.7156*(m.random()-.5),.27597<(a=(i=n-.449871)*i+(o=m.abs(r)+.386595)*(.196*o-.25472*i))&&(.27846<a||r*r>-4*m.log(n)*n*n););return r/n},v.randg=function(t,e,n){var r,i,o,a,s,l,u=t;if(n=n||e,t=t||1,e)return(l=v.zeros(e,n)).alter(function(){return v.randg(t)}),l;t<1&&(t+=1),r=t-1/3,i=1/m.sqrt(9*r);do{for(;(a=1+i*(s=v.randn()))<=0;);a*=a*a,o=m.random()}while(o>1-.331*m.pow(s,4)&&m.log(o)>.5*s*s+r*(1-a+m.log(a)));if(t==u)return r*a;for(;0===(o=m.random()););return m.pow(o,1/u)*r*a},function(t){for(var e=0;e<t.length;e++)!function(e){v.fn[e]=function(){return v(v.map(this,function(t){return v[e](t)}))}}(t[e])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){v.fn[t]=function(){return v(v[t].apply(null,arguments))}}(t[e])}("randn".split(" ")),E=d,S=Math,function(t){for(var e=0;e<t.length;e++)!function(o){E[o]=function(t,e,n){return this instanceof arguments.callee?(this._a=t,this._b=e,this._c=n,this):new arguments.callee(t,e,n)},E.fn[o]=function(t,e,n){var r=E[o](t,e,n);return r.data=this,r},E[o].prototype.sample=function(t){var e=this._a,n=this._b,r=this._c;return t?E.alter(t,function(){return E[o].sample(e,n,r)}):E[o].sample(e,n,r)},function(t){for(var e=0;e<t.length;e++)!function(i){E[o].prototype[i]=function(t){var e=this._a,n=this._b,r=this._c;return t||0===t||(t=this.data),"number"!=typeof t?E.fn.map.call(t,function(t){return E[o][i](t,e,n,r)}):E[o][i](t,e,n,r)}}(t[e])}("pdf cdf inv".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){E[o].prototype[t]=function(){return E[o][t](this._a,this._b,this._c)}}(t[e])}("mean median mode variance".split(" "))}(t[e])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),E.extend(E.beta,{pdf:function(t,e,n){return 1<t||t<0?0:1==e&&1==n?1:e<512&&n<512?S.pow(t,e-1)*S.pow(1-t,n-1)/E.betafn(e,n):S.exp((e-1)*S.log(t)+(n-1)*S.log(1-t)-E.betaln(e,n))},cdf:function(t,e,n){return 1<t||t<0?1*(1<t):E.ibeta(t,e,n)},inv:function(t,e,n){return E.ibetainv(t,e,n)},mean:function(t,e){return t/(t+e)},median:function(t,e){return E.ibetainv(.5,t,e)},mode:function(t,e){return(t-1)/(t+e-2)},sample:function(t,e){var n=E.randg(t);return n/(n+E.randg(e))},variance:function(t,e){return t*e/(S.pow(t+e,2)*(t+e+1))}}),E.extend(E.centralF,{pdf:function(t,e,n){var r;return t<0?0:e<=2?0===t&&e<2?1/0:0===t&&2===e?1:1/E.betafn(e/2,n/2)*S.pow(e/n,e/2)*S.pow(t,e/2-1)*S.pow(1+e/n*t,-(e+n)/2):(r=e*t/(n+t*e),e*(n/(n+t*e))/2*E.binomial.pdf((e-2)/2,(e+n-2)/2,r))},cdf:function(t,e,n){return t<0?0:E.ibeta(e*t/(e*t+n),e/2,n/2)},inv:function(t,e,n){return n/(e*(1/E.ibetainv(t,e/2,n/2)-1))},mean:function(t,e){return 2<e?e/(e-2):void 0},mode:function(t,e){return 2<t?e*(t-2)/(t*(e+2)):void 0},sample:function(t,e){return 2*E.randg(t/2)/t/(2*E.randg(e/2)/e)},variance:function(t,e){if(!(e<=4))return 2*e*e*(t+e-2)/(t*(e-2)*(e-2)*(e-4))}}),E.extend(E.cauchy,{pdf:function(t,e,n){return n<0?0:n/(S.pow(t-e,2)+S.pow(n,2))/S.PI},cdf:function(t,e,n){return S.atan((t-e)/n)/S.PI+.5},inv:function(t,e,n){return e+n*S.tan(S.PI*(t-.5))},median:function(t){return t},mode:function(t){return t},sample:function(t,e){return E.randn()*S.sqrt(1/(2*E.randg(.5)))*e+t}}),E.extend(E.chisquare,{pdf:function(t,e){return t<0?0:0===t&&2===e?.5:S.exp((e/2-1)*S.log(t)-t/2-e/2*S.log(2)-E.gammaln(e/2))},cdf:function(t,e){return t<0?0:E.lowRegGamma(e/2,t/2)},inv:function(t,e){return 2*E.gammapinv(t,.5*e)},mean:function(t){return t},median:function(t){return t*S.pow(1-2/(9*t),3)},mode:function(t){return 0<t-2?t-2:0},sample:function(t){return 2*E.randg(t/2)},variance:function(t){return 2*t}}),E.extend(E.exponential,{pdf:function(t,e){return t<0?0:e*S.exp(-e*t)},cdf:function(t,e){return t<0?0:1-S.exp(-e*t)},inv:function(t,e){return-S.log(1-t)/e},mean:function(t){return 1/t},median:function(t){return 1/t*S.log(2)},mode:function(){return 0},sample:function(t){return-1/t*S.log(S.random())},variance:function(t){return S.pow(t,-2)}}),E.extend(E.gamma,{pdf:function(t,e,n){return t<0?0:0===t&&1===e?1/n:S.exp((e-1)*S.log(t)-t/n-E.gammaln(e)-e*S.log(n))},cdf:function(t,e,n){return t<0?0:E.lowRegGamma(e,t/n)},inv:function(t,e,n){return E.gammapinv(t,e)*n},mean:function(t,e){return t*e},mode:function(t,e){if(1<t)return(t-1)*e},sample:function(t,e){return E.randg(t)*e},variance:function(t,e){return t*e*e}}),E.extend(E.invgamma,{pdf:function(t,e,n){return t<=0?0:S.exp(-(e+1)*S.log(t)-n/t-E.gammaln(e)+e*S.log(n))},cdf:function(t,e,n){return t<=0?0:1-E.lowRegGamma(e,n/t)},inv:function(t,e,n){return n/E.gammapinv(1-t,e)},mean:function(t,e){return 1<t?e/(t-1):void 0},mode:function(t,e){return e/(t+1)},sample:function(t,e){return e/E.randg(t)},variance:function(t,e){if(!(t<=2))return e*e/((t-1)*(t-1)*(t-2))}}),E.extend(E.kumaraswamy,{pdf:function(t,e,n){return 0===t&&1===e?n:1===t&&1===n?e:S.exp(S.log(e)+S.log(n)+(e-1)*S.log(t)+(n-1)*S.log(1-S.pow(t,e)))},cdf:function(t,e,n){return t<0?0:1<t?1:1-S.pow(1-S.pow(t,e),n)},inv:function(t,e,n){return S.pow(1-S.pow(1-t,1/n),1/e)},mean:function(t,e){return e*E.gammafn(1+1/t)*E.gammafn(e)/E.gammafn(1+1/t+e)},median:function(t,e){return S.pow(1-S.pow(2,-1/e),1/t)},mode:function(t,e){if(1<=t&&1<=e&&1!==t&&1!==e)return S.pow((t-1)/(t*e-1),1/t)},variance:function(){throw new Error("variance not yet implemented")}}),E.extend(E.lognormal,{pdf:function(t,e,n){return t<=0?0:S.exp(-S.log(t)-.5*S.log(2*S.PI)-S.log(n)-S.pow(S.log(t)-e,2)/(2*n*n))},cdf:function(t,e,n){return t<0?0:.5+.5*E.erf((S.log(t)-e)/S.sqrt(2*n*n))},inv:function(t,e,n){return S.exp(-1.4142135623730951*n*E.erfcinv(2*t)+e)},mean:function(t,e){return S.exp(t+e*e/2)},median:function(t){return S.exp(t)},mode:function(t,e){return S.exp(t-e*e)},sample:function(t,e){return S.exp(E.randn()*e+t)},variance:function(t,e){return(S.exp(e*e)-1)*S.exp(2*t+e*e)}}),E.extend(E.noncentralt,{pdf:function(t,e,n){return S.abs(n)<1e-14?E.studentt.pdf(t,e):S.abs(t)<1e-14?S.exp(E.gammaln((e+1)/2)-n*n/2-.5*S.log(S.PI*e)-E.gammaln(e/2)):e/t*(E.noncentralt.cdf(t*S.sqrt(1+2/e),e+2,n)-E.noncentralt.cdf(t,e,n))},cdf:function(t,e,n){var r=1e-14;if(S.abs(n)<r)return E.studentt.cdf(t,e);var i=!1;t<0&&(i=!0,n=-n);for(var o=E.normal.cdf(-n,0,1),a=1+r,s=a,l=t*t/(t*t+e),u=0,h=S.exp(-n*n/2),c=S.exp(-n*n/2-.5*S.log(2)-E.gammaln(1.5))*n;u<200||r<s||r<a;)s=a,0<u&&(h*=n*n/(2*u),c*=n*n/(2*(u+.5))),o+=.5*(a=h*E.beta.cdf(l,u+.5,e/2)+c*E.beta.cdf(l,u+1,e/2)),u++;return i?1-o:o}}),E.extend(E.normal,{pdf:function(t,e,n){return S.exp(-.5*S.log(2*S.PI)-S.log(n)-S.pow(t-e,2)/(2*n*n))},cdf:function(t,e,n){return.5*(1+E.erf((t-e)/S.sqrt(2*n*n)))},inv:function(t,e,n){return-1.4142135623730951*n*E.erfcinv(2*t)+e},mean:function(t,e){return t},median:function(t){return t},mode:function(t,e){return t},sample:function(t,e){return E.randn()*e+t},variance:function(t,e){return e*e}}),E.extend(E.pareto,{pdf:function(t,e,n){return t<e?0:n*S.pow(e,n)/S.pow(t,n+1)},cdf:function(t,e,n){return t<e?0:1-S.pow(e/t,n)},inv:function(t,e,n){return e/S.pow(1-t,1/n)},mean:function(t,e){if(!(e<=1))return e*S.pow(t,e)/(e-1)},median:function(t,e){return t*(e*S.SQRT2)},mode:function(t){return t},variance:function(t,e){if(!(e<=2))return t*t*e/(S.pow(e-1,2)*(e-2))}}),E.extend(E.studentt,{pdf:function(t,e){return e=1e100<e?1e100:e,1/(S.sqrt(e)*E.betafn(.5,e/2))*S.pow(1+t*t/e,-(e+1)/2)},cdf:function(t,e){var n=e/2;return E.ibeta((t+S.sqrt(t*t+e))/(2*S.sqrt(t*t+e)),n,n)},inv:function(t,e){var n=E.ibetainv(2*S.min(t,1-t),.5*e,.5);return n=S.sqrt(e*(1-n)/n),.5<t?n:-n},mean:function(t){return 1<t?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(t){return E.randn()*S.sqrt(t/(2*E.randg(t/2)))},variance:function(t){return 2<t?t/(t-2):1<t?1/0:void 0}}),E.extend(E.weibull,{pdf:function(t,e,n){return t<0||e<0||n<0?0:n/e*S.pow(t/e,n-1)*S.exp(-S.pow(t/e,n))},cdf:function(t,e,n){return t<0?0:1-S.exp(-S.pow(t/e,n))},inv:function(t,e,n){return e*S.pow(-S.log(1-t),1/n)},mean:function(t,e){return t*E.gammafn(1+1/e)},median:function(t,e){return t*S.pow(S.log(2),1/e)},mode:function(t,e){return e<=1?0:t*S.pow((e-1)/e,1/e)},sample:function(t,e){return t*S.pow(-S.log(S.random()),1/e)},variance:function(t,e){return t*t*E.gammafn(1+2/e)-S.pow(E.weibull.mean(t,e),2)}}),E.extend(E.uniform,{pdf:function(t,e,n){return t<e||n<t?0:1/(n-e)},cdf:function(t,e,n){return t<e?0:t<n?(t-e)/(n-e):1},inv:function(t,e,n){return e+t*(n-e)},mean:function(t,e){return.5*(t+e)},median:function(t,e){return E.mean(t,e)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,e){return t/2+e/2+(e/2-t/2)*(2*S.random()-1)},variance:function(t,e){return S.pow(e-t,2)/12}}),E.extend(E.binomial,{pdf:function(t,e,n){return 0===n||1===n?e*n===t?1:0:E.combination(e,t)*S.pow(n,t)*S.pow(1-n,e-t)},cdf:function(t,e,n){var r=[],i=0;if(t<0)return 0;if(t<e){for(;i<=t;i++)r[i]=E.binomial.pdf(i,e,n);return E.sum(r)}return 1}}),E.extend(E.negbin,{pdf:function(t,e,n){return t===t>>>0&&(t<0?0:E.combination(t+e-1,e-1)*S.pow(1-n,t)*S.pow(n,e))},cdf:function(t,e,n){var r=0,i=0;if(t<0)return 0;for(;i<=t;i++)r+=E.negbin.pdf(i,e,n);return r}}),E.extend(E.hypgeom,{pdf:function(t,e,n,r){if(t!=t|0)return!1;if(t<0||t<n-(e-r))return 0;if(r<t||n<t)return 0;if(e<2*n)return e<2*r?E.hypgeom.pdf(e-n-r+t,e,e-n,e-r):E.hypgeom.pdf(r-t,e,e-n,r);if(e<2*r)return E.hypgeom.pdf(n-t,e,n,e-r);if(n<r)return E.hypgeom.pdf(t,e,r,n);for(var i=1,o=0,a=0;a<t;a++){for(;1<i&&o<r;)i*=1-n/(e-o),o++;i*=(r-a)*(n-a)/((a+1)*(e-n-r+a+1))}for(;o<r;o++)i*=1-n/(e-o);return S.min(1,S.max(0,i))},cdf:function(t,e,n,r){if(t<0||t<n-(e-r))return 0;if(r<=t||n<=t)return 1;if(e<2*n)return e<2*r?E.hypgeom.cdf(e-n-r+t,e,e-n,e-r):1-E.hypgeom.cdf(r-t-1,e,e-n,r);if(e<2*r)return 1-E.hypgeom.cdf(n-t-1,e,n,e-r);if(n<r)return E.hypgeom.cdf(t,e,r,n);for(var i=1,o=1,a=0,s=0;s<t;s++){for(;1<i&&a<r;){var l=1-n/(e-a);o*=l,i*=l,a++}i+=o*=(r-s)*(n-s)/((s+1)*(e-n-r+s+1))}for(;a<r;a++)i*=1-n/(e-a);return S.min(1,S.max(0,i))}}),E.extend(E.poisson,{pdf:function(t,e){return e<0||t%1!=0||t<0?0:S.pow(e,t)*S.exp(-e)/E.factorial(t)},cdf:function(t,e){var n=[],r=0;if(t<0)return 0;for(;r<=t;r++)n.push(E.poisson.pdf(r,e));return E.sum(n)},mean:function(t){return t},variance:function(t){return t},sample:function(t){for(var e=1,n=0,r=S.exp(-t);n++,r<(e*=S.random()););return n-1}}),E.extend(E.triangular,{pdf:function(t,e,n,r){return n<=e||r<e||n<r?NaN:t<e||n<t?0:t<r?2*(t-e)/((n-e)*(r-e)):t===r?2/(n-e):2*(n-t)/((n-e)*(n-r))},cdf:function(t,e,n,r){return n<=e||r<e||n<r?NaN:t<=e?0:n<=t?1:t<=r?S.pow(t-e,2)/((n-e)*(r-e)):1-S.pow(n-t,2)/((n-e)*(n-r))},inv:function(t,e,n,r){return n<=e||r<e||n<r?NaN:t<=(r-e)/(n-e)?e+(n-e)*S.sqrt(t*((r-e)/(n-e))):e+(n-e)*(1-S.sqrt((1-t)*(1-(r-e)/(n-e))))},mean:function(t,e,n){return(t+e+n)/3},median:function(t,e,n){return n<=(t+e)/2?e-S.sqrt((e-t)*(e-n))/S.sqrt(2):(t+e)/2<n?t+S.sqrt((e-t)*(n-t))/S.sqrt(2):void 0},mode:function(t,e,n){return n},sample:function(t,e,n){var r=S.random();return r<(n-t)/(e-t)?t+S.sqrt(r*(e-t)*(n-t)):e-S.sqrt((1-r)*(e-t)*(e-n))},variance:function(t,e,n){return(t*t+e*e+n*n-t*e-t*n-e*n)/18}}),E.extend(E.arcsine,{pdf:function(t,e,n){return n<=e?NaN:t<=e||n<=t?0:2/S.PI*S.pow(S.pow(n-e,2)-S.pow(2*t-e-n,2),-.5)},cdf:function(t,e,n){return t<e?0:t<n?2/S.PI*S.asin(S.sqrt((t-e)/(n-e))):1},inv:function(t,e,n){return e+(.5-.5*S.cos(S.PI*t))*(n-e)},mean:function(t,e){return e<=t?NaN:(t+e)/2},median:function(t,e){return e<=t?NaN:(t+e)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,e){return(t+e)/2+(e-t)/2*S.sin(2*S.PI*E.uniform.sample(0,1))},variance:function(t,e){return e<=t?NaN:S.pow(e-t,2)/8}}),E.extend(E.laplace,{pdf:function(t,e,n){return n<=0?0:S.exp(-S.abs(t-e)/n)/(2*n)},cdf:function(t,e,n){return n<=0?0:t<e?.5*S.exp((t-e)/n):1-.5*S.exp(-(t-e)/n)},mean:function(t,e){return t},median:function(t,e){return t},mode:function(t,e){return t},variance:function(t,e){return 2*e*e},sample:function(t,e){var n=S.random()-.5;return t-e*function(t){return t/S.abs(t)}(n)*S.log(1-2*S.abs(n))}}),E.extend(E.tukey,{cdf:function(t,e,n){var r=e,i=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],o=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(t<=0)return 0;if(n<2||r<2)return NaN;if(!Number.isFinite(t))return 1;if(25e3<n)return w(t,1,r);var a,s=.5*n,l=s*S.log(n)-n*S.log(2)-E.gammaln(s),u=s-1,h=.25*n;a=n<=100?1:n<=800?.5:n<=5e3?.25:.125,l+=S.log(a);for(var c=0,d=1;d<=50;d++){for(var f=0,p=(2*d-1)*a,g=1;g<=16;g++){var v,m;if(-30<=(m=8<g?(v=g-8-1,l+u*S.log(p+i[v]*a)-(i[v]*a+p)*h):(v=g-1,l+u*S.log(p-i[v]*a)+(i[v]*a-p)*h)))f+=w(8<g?t*S.sqrt(.5*(i[v]*a+p)):t*S.sqrt(.5*(-i[v]*a+p)),1,r)*o[v]*S.exp(m)}if(1<=d*a&&f<=1e-14)break;c+=f}if(1e-14<f)throw new Error("tukey.cdf failed to converge");return 1<c&&(c=1),c},inv:function(t,e,n){if(n<2||e<2)return NaN;if(t<0||1<t)return NaN;if(0===t)return 0;if(1===t)return 1/0;var r,i=function(t,e,n){var r=.5-.5*t,i=S.sqrt(S.log(1/(r*r))),o=i+((((-453642210148e-16*i-.204231210125)*i-.342242088547)*i-1)*i+.322232421088)/((((.0038560700634*i+.10353775285)*i+.531103462366)*i+.588581570495)*i+.099348462606);n<120&&(o+=(o*o*o+o)/n/4);var a=.8832-.2368*o;return n<120&&(a+=-1.214/n+1.208*o/n),o*(a*S.log(e-1)+1.4142)}(t,e,n),o=E.tukey.cdf(i,e,n)-t;r=0<o?S.max(0,i-1):i+1;for(var a,s=E.tukey.cdf(r,e,n)-t,l=1;l<50;l++){if(a=r-s*(r-i)/(s-o),o=s,i=r,a<0&&(a=0,s=-t),s=E.tukey.cdf(a,e,n)-t,r=a,S.abs(r-i)<1e-4)return a}throw new Error("tukey.inv failed to converge")}}),y=d,g=Math,o=Array.prototype.push,e=y.utils.isArray,y.extend({add:function(t,r){return f(r)?(f(r[0])||(r=[r]),y.map(t,function(t,e,n){return t+r[e][n]})):y.map(t,function(t){return t+r})},subtract:function(t,r){return f(r)?(f(r[0])||(r=[r]),y.map(t,function(t,e,n){return t-r[e][n]||0})):y.map(t,function(t){return t-r})},divide:function(t,e){return f(e)?(f(e[0])||(e=[e]),y.multiply(t,y.inv(e))):y.map(t,function(t){return t/e})},multiply:function(t,e){var n,r,i,o,a,s,l,u;if(void 0===t.length&&void 0===e.length)return t*e;if(a=t.length,s=t[0].length,l=y.zeros(a,i=f(e)?e[0].length:s),u=0,f(e)){for(;u<i;u++)for(n=0;n<a;n++){for(r=o=0;r<s;r++)o+=t[n][r]*e[r][u];l[n][u]=o}return 1===a&&1===u?l[0][0]:l}return y.map(t,function(t){return t*e})},outer:function(t,e){return y.multiply(t.map(function(t){return[t]}),[e])},dot:function(t,e){f(t[0])||(t=[t]),f(e[0])||(e=[e]);for(var n,r,i=1===t[0].length&&1!==t.length?y.transpose(t):t,o=1===e[0].length&&1!==e.length?y.transpose(e):e,a=[],s=0,l=i.length,u=i[0].length;s<l;s++){for(a[s]=[],r=n=0;r<u;r++)n+=i[s][r]*o[s][r];a[s]=n}return 1===a.length?a[0]:a},pow:function(t,e){return y.map(t,function(t){return g.pow(t,e)})},exp:function(t){return y.map(t,function(t){return g.exp(t)})},log:function(t){return y.map(t,function(t){return g.log(t)})},abs:function(t){return y.map(t,function(t){return g.abs(t)})},norm:function(t,e){var n=0,r=0;for(isNaN(e)&&(e=2),f(t[0])&&(t=t[0]);r<t.length;r++)n+=g.pow(g.abs(t[r]),e);return g.pow(n,1/e)},angle:function(t,e){return g.acos(y.dot(t,e)/(y.norm(t)*y.norm(e)))},aug:function(t,e){for(var n=[],r=0;r<t.length;r++)n.push(t[r].slice());for(r=0;r<n.length;r++)o.apply(n[r],e[r]);return n},inv:function(t){for(var e,n=t.length,r=t[0].length,i=y.identity(n,r),o=y.gauss_jordan(t,i),a=[],s=0;s<n;s++)for(a[s]=[],e=r;e<o[0].length;e++)a[s][e-r]=o[s][e];return a},det:function(t){var e,n=t.length,r=2*n,i=new Array(r),o=n-1,a=r-1,s=o-n+1,l=a,u=0,h=0;if(2===n)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(;u<r;u++)i[u]=1;for(u=0;u<n;u++){for(e=0;e<n;e++)i[s<0?s+n:s]*=t[u][e],i[l<n?l+n:l]*=t[u][e],s++,l--;s=--o-n+1,l=--a}for(u=0;u<n;u++)h+=i[u];for(;u<r;u++)h-=i[u];return h},gauss_elimination:function(t,e){var n,r,i,o,a=0,s=0,l=t.length,u=t[0].length,h=1,c=0,d=[];n=(t=y.aug(t,e))[0].length;for(a=0;a<l;a++){for(r=t[a][a],o=(s=a)+1;o<u;o++)r<g.abs(t[o][a])&&(r=t[o][a],s=o);if(s!=a)for(o=0;o<n;o++)i=t[a][o],t[a][o]=t[s][o],t[s][o]=i;for(s=a+1;s<l;s++)for(h=t[s][a]/t[a][a],o=a;o<n;o++)t[s][o]=t[s][o]-h*t[a][o]}for(a=l-1;0<=a;a--){for(c=0,s=a+1;s<=l-1;s++)c+=d[s]*t[a][s];d[a]=(t[a][n-1]-c)/t[a][a]}return d},gauss_jordan:function(t,e){for(var n=y.aug(t,e),r=n.length,i=n[0].length,o=0,a=0;a<r;a++){for(var s=a,l=a+1;l<r;l++)g.abs(n[l][a])>g.abs(n[s][a])&&(s=l);var u=n[a];n[a]=n[s],n[s]=u;for(l=a+1;l<r;l++){o=n[l][a]/n[a][a];for(var h=a;h<i;h++)n[l][h]-=n[a][h]*o}}for(a=r-1;0<=a;a--){o=n[a][a];for(l=0;l<a;l++)for(h=i-1;a-1<h;h--)n[l][h]-=n[a][h]*n[l][a]/o;n[a][a]/=o;for(h=r;h<i;h++)n[a][h]/=o}return n},triaUpSolve:function(n,t){var r,i=n[0].length,o=y.zeros(1,i)[0],e=!1;return null!=t[0].length&&(t=t.map(function(t){return t[0]}),e=!0),y.arange(i-1,-1,-1).forEach(function(e){r=y.arange(e+1,i).map(function(t){return o[t]*n[e][t]}),o[e]=(t[e]-y.sum(r))/n[e][e]}),e?o.map(function(t){return[t]}):o},triaLowSolve:function(n,t){var r,e=n[0].length,i=y.zeros(1,e)[0],o=!1;return null!=t[0].length&&(t=t.map(function(t){return t[0]}),o=!0),y.arange(e).forEach(function(e){r=y.arange(e).map(function(t){return n[e][t]*i[t]}),i[e]=(t[e]-y.sum(r))/n[e][e]}),o?i.map(function(t){return[t]}):i},lu:function(r){var t,e=r.length,o=y.identity(e),a=y.zeros(r.length,r[0].length);return y.arange(e).forEach(function(t){a[0][t]=r[0][t]}),y.arange(1,e).forEach(function(n){y.arange(n).forEach(function(e){t=y.arange(e).map(function(t){return o[n][t]*a[t][e]}),o[n][e]=(r[n][e]-y.sum(t))/a[e][e]}),y.arange(n,e).forEach(function(e){t=y.arange(n).map(function(t){return o[n][t]*a[t][e]}),a[n][e]=r[i][e]-y.sum(t)})}),[o,a]},cholesky:function(t){var r,e=t.length,i=y.zeros(t.length,t[0].length);return y.arange(e).forEach(function(n){r=y.arange(n).map(function(t){return g.pow(i[n][t],2)}),i[n][n]=g.sqrt(t[n][n]-y.sum(r)),y.arange(n+1,e).forEach(function(e){r=y.arange(n).map(function(t){return i[n][t]*i[e][t]}),i[e][n]=(t[n][e]-y.sum(r))/i[n][n]})}),i},gauss_jacobi:function(t,e,n,r){for(var i,o,a,s,l=0,u=0,h=t.length,c=[],d=[],f=[];l<h;l++)for(c[l]=[],d[l]=[],f[l]=[],u=0;u<h;u++)u<l?(c[l][u]=t[l][u],d[l][u]=f[l][u]=0):l<u?(d[l][u]=t[l][u],c[l][u]=f[l][u]=0):(f[l][u]=t[l][u],c[l][u]=d[l][u]=0);for(a=y.multiply(y.multiply(y.inv(f),y.add(c,d)),-1),o=y.multiply(y.inv(f),e),i=n,s=y.add(y.multiply(a,n),o),l=2;g.abs(y.norm(y.subtract(s,i)))>r;)i=s,s=y.add(y.multiply(a,i),o),l++;return s},gauss_seidel:function(t,e,n,r){for(var i,o,a,s,l,u=0,h=t.length,c=[],d=[],f=[];u<h;u++)for(c[u]=[],d[u]=[],f[u]=[],i=0;i<h;i++)i<u?(c[u][i]=t[u][i],d[u][i]=f[u][i]=0):u<i?(d[u][i]=t[u][i],c[u][i]=f[u][i]=0):(f[u][i]=t[u][i],c[u][i]=d[u][i]=0);for(s=y.multiply(y.multiply(y.inv(y.add(f,c)),d),-1),a=y.multiply(y.inv(y.add(f,c)),e),o=n,l=y.add(y.multiply(s,n),a),u=2;g.abs(y.norm(y.subtract(l,o)))>r;)o=l,l=y.add(y.multiply(s,o),a),u+=1;return l},SOR:function(t,e,n,r,i){for(var o,a,s,l,u,h=0,c=t.length,d=[],f=[],p=[];h<c;h++)for(d[h]=[],f[h]=[],p[h]=[],o=0;o<c;o++)o<h?(d[h][o]=t[h][o],f[h][o]=p[h][o]=0):h<o?(f[h][o]=t[h][o],d[h][o]=p[h][o]=0):(p[h][o]=t[h][o],d[h][o]=f[h][o]=0);for(l=y.multiply(y.inv(y.add(p,y.multiply(d,i))),y.subtract(y.multiply(p,1-i),y.multiply(f,i))),s=y.multiply(y.multiply(y.inv(y.add(p,y.multiply(d,i))),e),i),a=n,u=y.add(y.multiply(l,n),s),h=2;g.abs(y.norm(y.subtract(u,a)))>r;)a=u,u=y.add(y.multiply(l,a),s),h++;return u},householder:function(t){for(var e,n,r,i,o=t.length,a=t[0].length,s=0,l=[],u=[];s<o-1;s++){for(e=0,i=s+1;i<a;i++)e+=t[i][s]*t[i][s];for(e=(0<t[s+1][s]?-1:1)*g.sqrt(e),n=g.sqrt((e*e-t[s+1][s]*e)/2),(l=y.zeros(o,1))[s+1][0]=(t[s+1][s]-e)/(2*n),r=s+2;r<o;r++)l[r][0]=t[r][s]/(2*n);u=y.subtract(y.identity(o,a),y.multiply(y.multiply(l,y.transpose(l)),2)),t=y.multiply(u,y.multiply(t,u))}return t},QR:(s=y.sum,l=y.arange,function(e){var t,n,i,o=e.length,a=e[0].length;for(e=y.copy(e),r=y.zeros(a,a),n=0;n<a;n++){for(r[n][n]=g.sqrt(s(l(o).map(function(t){return e[t][n]*e[t][n]}))),t=0;t<o;t++)e[t][n]=e[t][n]/r[n][n];for(i=n+1;i<a;i++)for(r[n][i]=s(l(o).map(function(t){return e[t][n]*e[t][i]})),t=0;t<o;t++)e[t][i]=e[t][i]-e[t][n]*r[n][i]}return[e,r]}),lstsq:function(t,e){var n=!1;void 0===e[0].length&&(e=e.map(function(t){return[t]}),n=!0);var r=y.QR(t),i=r[0],o=r[1],a=t[0].length,s=y.slice(i,{col:{end:a}}),l=function(s){var t=(s=y.copy(s)).length,l=y.identity(t);return y.arange(t-1,-1,-1).forEach(function(a){y.sliceAssign(l,{row:a},y.divide(y.slice(l,{row:a}),s[a][a])),y.sliceAssign(s,{row:a},y.divide(y.slice(s,{row:a}),s[a][a])),y.arange(a).forEach(function(t){var e=y.multiply(s[t][a],-1),n=y.slice(s,{row:t}),r=y.multiply(y.slice(s,{row:a}),e);y.sliceAssign(s,{row:t},y.add(n,r));var i=y.slice(l,{row:t}),o=y.multiply(y.slice(l,{row:a}),e);y.sliceAssign(l,{row:t},y.add(i,o))})}),l}(y.slice(o,{row:{end:a}})),u=y.transpose(s);void 0===u[0].length&&(u=[u]);var h=y.multiply(y.multiply(l,u),e);return void 0===h.length&&(h=[[h]]),n?h.map(function(t){return t[0]}):h},jacobi:function(t){for(var e,n,r,i,o,a,s=1,l=t.length,u=y.identity(l,l),h=[];1===s;){0,i=t[0][1],r=1;for(var c=n=0;c<l;c++)for(e=0;e<l;e++)c!=e&&i<g.abs(t[c][e])&&(i=g.abs(t[c][e]),n=c,r=e);o=t[n][n]===t[r][r]?0<t[n][r]?g.PI/4:-g.PI/4:g.atan(2*t[n][r]/(t[n][n]-t[r][r]))/2,(a=y.identity(l,l))[n][n]=g.cos(o),a[n][r]=-g.sin(o),a[r][n]=g.sin(o),a[r][r]=g.cos(o),u=y.multiply(u,a),t=y.multiply(y.multiply(y.inv(a),t),a),s=0;for(c=1;c<l;c++)for(e=1;e<l;e++)c!=e&&.001<g.abs(t[c][e])&&(s=1)}for(c=0;c<l;c++)h.push(t[c][c]);return[u,h]},rungekutta:function(t,e,n,r,i,o){var a,s,l;if(2===o)for(;r<=n;)i=i+((a=e*t(r,i))+(s=e*t(r+e,i+a)))/2,r+=e;if(4===o)for(;r<=n;)i=i+((a=e*t(r,i))+2*(s=e*t(r+e/2,i+a/2))+2*(l=e*t(r+e/2,i+s/2))+e*t(r+e,i+l))/6,r+=e;return i},romberg:function(t,e,n,r){for(var i,o,a,s,l,u=0,h=(n-e)/2,c=[],d=[],f=[];u<r/2;){for(l=t(e),a=e,s=0;a<=n;a+=h,s++)c[s]=a;for(i=c.length,a=1;a<i-1;a++)l+=(a%2!=0?4:2)*t(c[a]);l=h/3*(l+t(n)),f[u]=l,h/=2,u++}for(o=f.length,i=1;1!==o;){for(a=0;a<o-1;a++)d[a]=(g.pow(4,i)*f[a+1]-f[a])/(g.pow(4,i)-1);o=d.length,f=d,d=[],i++}return f},richardson:function(t,e,n,r){function i(t,e){for(var n,r=0,i=t.length;r<i;r++)t[r]===e&&(n=r);return n}t.length;for(var o,a,s,l,u,h=g.abs(n-t[i(t,n)+1]),c=0,d=[],f=[];h<=r;)o=i(t,n+r),a=i(t,n),d[c]=(e[o]-2*e[a]+e[2*a-o])/(r*r),r/=2,c++;for(l=d.length,s=1;1!=l;){for(u=0;u<l-1;u++)f[u]=(g.pow(4,s)*d[u+1]-d[u])/(g.pow(4,s)-1);l=f.length,d=f,f=[],s++}return d},simpson:function(t,e,n,r){for(var i,o=(n-e)/r,a=t(e),s=[],l=e,u=0,h=1;l<=n;l+=o,u++)s[u]=l;for(i=s.length;h<i-1;h++)a+=(h%2!=0?4:2)*t(s[h]);return o/3*(a+t(n))},hermite:function(t,e,n,r){for(var i,o=t.length,a=0,s=0,l=[],u=[],h=[],c=[];s<o;s++){for(l[s]=1,i=0;i<o;i++)s!=i&&(l[s]*=(r-t[i])/(t[s]-t[i]));for(i=u[s]=0;i<o;i++)s!=i&&(u[s]+=1/(t[s]-t[i]));h[s]=(1-2*(r-t[s])*u[s])*(l[s]*l[s]),c[s]=(r-t[s])*(l[s]*l[s]),a+=h[s]*e[s]+c[s]*n[s]}return a},lagrange:function(t,e,n){for(var r,i,o=0,a=0,s=t.length;a<s;a++){for(i=e[a],r=0;r<s;r++)a!=r&&(i*=(n-t[r])/(t[a]-t[r]));o+=i}return o},cubic_spline:function(t,e,n){for(var r,i,o=t.length,a=0,s=[],l=[],u=[],h=[],c=[],d=[];a<o-1;a++)h[a]=t[a+1]-t[a];u[0]=0;for(a=1;a<o-1;a++)u[a]=3/h[a]*(e[a+1]-e[a])-3/h[a-1]*(e[a]-e[a-1]);for(a=1;a<o-1;a++)s[a]=[],l[a]=[],s[a][a-1]=h[a-1],s[a][a]=2*(h[a-1]+h[a]),s[a][a+1]=h[a],l[a][0]=u[a];for(i=y.multiply(y.inv(s),l),r=0;r<o-1;r++)c[r]=(e[r+1]-e[r])/h[r]-h[r]*(i[r+1][0]+2*i[r][0])/3,d[r]=(i[r+1][0]-i[r][0])/(3*h[r]);for(r=0;r<o&&!(t[r]>n);r++);return e[r-=1]+(n-t[r])*c[r]+y.sq(n-t[r])*i[r]+(n-t[r])*y.sq(n-t[r])*d[r]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(t){var e,n,r,i,o,a=t.length,s=t[0].length,l=0,u=[],h=[],c=[],d=[],f=[],p=[],g=[];for(l=0;l<a;l++)u[l]=y.sum(t[l])/s;for(l=0;l<s;l++)for(f[l]=[],e=0;e<a;e++)f[l][e]=t[e][l]-u[e];f=y.transpose(f);for(l=0;l<a;l++)for(p[l]=[],e=0;e<a;e++)p[l][e]=y.dot([f[l]],[f[e]])/(s-1);o=(r=y.jacobi(p))[0],h=r[1],g=y.transpose(o);for(l=0;l<h.length;l++)for(e=l;e<h.length;e++)h[l]<h[e]&&(n=h[l],h[l]=h[e],h[e]=n,c=g[l],g[l]=g[e],g[e]=c);i=y.transpose(f);for(l=0;l<a;l++)for(d[l]=[],e=0;e<i.length;e++)d[l][e]=y.dot([g[l]],[i[e]]);return[t,h,g,d]}}),function(t){for(var e=0;e<t.length;e++)!function(r){y.fn[r]=function(t,e){var n=this;return e?(setTimeout(function(){e.call(n,y.fn[r].call(n,t))},15),this):"number"==typeof y[r](this,t)?y[r](this,t):y(y[r](this,t))}}(t[e])}("add divide multiply subtract dot pow exp log abs norm angle".split(" ")),u=d,h=Math,c=[].slice,a=u.utils.isNumber,n=u.utils.isArray,u.extend({zscore:function(){var t=c.call(arguments);return a(t[1])?(t[0]-t[1])/t[2]:(t[0]-u.mean(t[1]))/u.stdev(t[1],t[2])},ztest:function(){var t,e=c.call(arguments);return n(e[1])?(t=u.zscore(e[0],e[1],e[3]),1===e[2]?u.normal.cdf(-h.abs(t),0,1):2*u.normal.cdf(-h.abs(t),0,1)):2<e.length?(t=u.zscore(e[0],e[1],e[2]),1===e[3]?u.normal.cdf(-h.abs(t),0,1):2*u.normal.cdf(-h.abs(t),0,1)):(t=e[0],1===e[1]?u.normal.cdf(-h.abs(t),0,1):2*u.normal.cdf(-h.abs(t),0,1))}}),u.extend(u.fn,{zscore:function(t,e){return(t-this.mean())/this.stdev(e)},ztest:function(t,e,n){var r=h.abs(this.zscore(t,n));return 1===e?u.normal.cdf(-r,0,1):2*u.normal.cdf(-r,0,1)}}),u.extend({tscore:function(){var t=c.call(arguments);return 4===t.length?(t[0]-t[1])/(t[2]/h.sqrt(t[3])):(t[0]-u.mean(t[1]))/(u.stdev(t[1],!0)/h.sqrt(t[1].length))},ttest:function(){var t,e=c.call(arguments);return 5===e.length?(t=h.abs(u.tscore(e[0],e[1],e[2],e[3])),1===e[4]?u.studentt.cdf(-t,e[3]-1):2*u.studentt.cdf(-t,e[3]-1)):a(e[1])?(t=h.abs(e[0]),1==e[2]?u.studentt.cdf(-t,e[1]-1):2*u.studentt.cdf(-t,e[1]-1)):(t=h.abs(u.tscore(e[0],e[1])),1==e[2]?u.studentt.cdf(-t,e[1].length-1):2*u.studentt.cdf(-t,e[1].length-1))}}),u.extend(u.fn,{tscore:function(t){return(t-this.mean())/(this.stdev(!0)/h.sqrt(this.cols()))},ttest:function(t,e){return 1===e?1-u.studentt.cdf(h.abs(this.tscore(t)),this.cols()-1):2*u.studentt.cdf(-h.abs(this.tscore(t)),this.cols()-1)}}),u.extend({anovafscore:function(){var t,e,n,r,i,o,a,s=c.call(arguments);if(1===s.length){i=new Array(s[0].length);for(var l=0;l<s[0].length;l++)i[l]=s[0][l];s=i}if(2===s.length)return u.variance(s[0])/u.variance(s[1]);e=new Array;for(l=0;l<s.length;l++)e=e.concat(s[l]);n=u.mean(e);for(l=t=0;l<s.length;l++)t+=s[l].length*h.pow(u.mean(s[l])-n,2);t/=s.length-1;for(l=o=0;l<s.length;l++)for(r=u.mean(s[l]),a=0;a<s[l].length;a++)o+=h.pow(s[l][a]-r,2);return t/(o/=e.length-s.length)},anovaftest:function(){var t,e,n,r=c.call(arguments);if(a(r[0]))return 1-u.centralF.cdf(r[0],r[1],r[2]);anovafscore=u.anovafscore(r),t=r.length-1;for(var i=n=0;i<r.length;i++)n+=r[i].length;return e=n-t-1,1-u.centralF.cdf(anovafscore,t,e)},ftest:function(t,e,n){return 1-u.centralF.cdf(t,e,n)}}),u.extend(u.fn,{anovafscore:function(){return u.anovafscore(this.toArray())},anovaftes:function(){for(var t=0,e=0;e<this.length;e++)t+=this[e].length;return u.ftest(this.anovafscore(),this.length-1,t-this.length)}}),u.extend({qscore:function(){var t,e,n,r,i,o=c.call(arguments);return i=a(o[0])?(t=o[0],e=o[1],n=o[2],r=o[3],o[4]):(t=u.mean(o[0]),e=u.mean(o[1]),n=o[0].length,r=o[1].length,o[2]),h.abs(t-e)/(i*h.sqrt((1/n+1/r)/2))},qtest:function(){var t,e=c.call(arguments),n=(e=3===e.length?(t=e[0],e.slice(1)):7===e.length?(t=u.qscore(e[0],e[1],e[2],e[3],e[4]),e.slice(5)):(t=u.qscore(e[0],e[1],e[2]),e.slice(3)))[0],r=e[1];return 1-u.tukey.cdf(t,r,n-r)},tukeyhsd:function(t){for(var e=u.pooledstdev(t),n=t.map(function(t){return u.mean(t)}),r=t.reduce(function(t,e){return t+e.length},0),i=[],o=0;o<t.length;++o)for(var a=o+1;a<t.length;++a){var s=u.qtest(n[o],n[a],t[o].length,t[a].length,e,r,t.length);i.push([[o,a],s])}return i}}),u.extend({normalci:function(){var t,e=c.call(arguments),n=new Array(2);return t=4===e.length?h.abs(u.normal.inv(e[1]/2,0,1)*e[2]/h.sqrt(e[3])):h.abs(u.normal.inv(e[1]/2,0,1)*u.stdev(e[2])/h.sqrt(e[2].length)),n[0]=e[0]-t,n[1]=e[0]+t,n},tci:function(){var t,e=c.call(arguments),n=new Array(2);return t=4===e.length?h.abs(u.studentt.inv(e[1]/2,e[3]-1)*e[2]/h.sqrt(e[3])):h.abs(u.studentt.inv(e[1]/2,e[2].length-1)*u.stdev(e[2],!0)/h.sqrt(e[2].length)),n[0]=e[0]-t,n[1]=e[0]+t,n},significant:function(t,e){return t<e}}),u.extend(u.fn,{normalci:function(t,e){return u.normalci(t,e,this.toArray())},tci:function(t,e){return u.tci(t,e,this.toArray())}}),u.extend(u.fn,{oneSidedDifferenceOfProportions:function(t,e,n,r){var i=p(t,e,n,r);return u.ztest(i,1)},twoSidedDifferenceOfProportions:function(t,e,n,r){var i=p(t,e,n,r);return u.ztest(i,2)}}),d.models={ols:function(t,e){var n=b(t,e),r=C(n),i=function(t){var e,n,r,i=t.R2/t.df_model/((1-t.R2)/t.df_resid);return{F_statistic:i,pvalue:1-(e=i,n=t.df_model,r=t.df_resid,d.beta.cdf(e/(r/n+e),n/2,r/2))}}(n),o=1-(1-n.R2)*((n.nobs-1)/n.df_resid);return n.t=r,n.f=i,n.adjust_R2=o,n}},d.jStat=d},t.exports=o()},function(t,e,n){var r=n(1),i=n(9),l=n(0);e.UNIQUE=function(){for(var t=[],e=0;e<arguments.length;++e){for(var n=!1,r=arguments[e],i=0;i<t.length&&!(n=t[i]===r);++i);n||t.push(r)}return t},e.FLATTEN=r.flatten,e.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},e.REFERENCE=function(t,e){if(!arguments.length)return l.error;try{for(var n=e.split("."),r=t,i=0;i<n.length;++i){var o=n[i];if("]"===o[o.length-1]){var a=o.indexOf("["),s=o.substring(a+1,o.length-1);r=r[o.substring(0,a)][s]}else r=r[o]}return r}catch(t){}},e.JOIN=function(t,e){return t.join(e)},e.NUMBERS=function(){return r.flatten(arguments).filter(function(t){return"number"==typeof t})},e.NUMERAL=function(t,e){return i(t).format(e)}},function(t,h,e){var b=e(0),n=e(11).jStat,o=e(6),C=e(1),r=e(28);function i(t){return/^[01]{1,10}$/.test(t)}h.BESSELI=function(t,e){return t=C.parseNumber(t),e=C.parseNumber(e),C.anyIsError(t,e)?b.value:r.besseli(t,e)},h.BESSELJ=function(t,e){return t=C.parseNumber(t),e=C.parseNumber(e),C.anyIsError(t,e)?b.value:r.besselj(t,e)},h.BESSELK=function(t,e){return t=C.parseNumber(t),e=C.parseNumber(e),C.anyIsError(t,e)?b.value:r.besselk(t,e)},h.BESSELY=function(t,e){return t=C.parseNumber(t),e=C.parseNumber(e),C.anyIsError(t,e)?b.value:r.bessely(t,e)},h.BIN2DEC=function(t){if(!i(t))return b.num;var e=parseInt(t,2),n=t.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:e},h.BIN2HEX=function(t,e){if(!i(t))return b.num;var n=t.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);var r=parseInt(t,2).toString(16);return void 0===e?r:isNaN(e)?b.value:e<0?b.num:(e=Math.floor(e))>=r.length?o.REPT("0",e-r.length)+r:b.num},h.BIN2OCT=function(t,e){if(!i(t))return b.num;var n=t.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);var r=parseInt(t,2).toString(8);return void 0===e?r:isNaN(e)?b.value:e<0?b.num:(e=Math.floor(e))>=r.length?o.REPT("0",e-r.length)+r:b.num},h.BITAND=function(t,e){return t=C.parseNumber(t),e=C.parseNumber(e),C.anyIsError(t,e)?b.value:t<0||e<0?b.num:Math.floor(t)!==t||Math.floor(e)!==e?b.num:0xffffffffffff<t||0xffffffffffff<e?b.num:t&e},h.BITLSHIFT=function(t,e){return t=C.parseNumber(t),e=C.parseNumber(e),C.anyIsError(t,e)?b.value:t<0?b.num:Math.floor(t)!==t?b.num:0xffffffffffff<t?b.num:53<Math.abs(e)?b.num:0<=e?t<<e:t>>-e},h.BITOR=function(t,e){return t=C.parseNumber(t),e=C.parseNumber(e),C.anyIsError(t,e)?b.value:t<0||e<0?b.num:Math.floor(t)!==t||Math.floor(e)!==e?b.num:0xffffffffffff<t||0xffffffffffff<e?b.num:t|e},h.BITRSHIFT=function(t,e){return t=C.parseNumber(t),e=C.parseNumber(e),C.anyIsError(t,e)?b.value:t<0?b.num:Math.floor(t)!==t?b.num:0xffffffffffff<t?b.num:53<Math.abs(e)?b.num:0<=e?t>>e:t<<-e},h.BITXOR=function(t,e){return t=C.parseNumber(t),e=C.parseNumber(e),C.anyIsError(t,e)?b.value:t<0||e<0?b.num:Math.floor(t)!==t||Math.floor(e)!==e?b.num:0xffffffffffff<t||0xffffffffffff<e?b.num:t^e},h.COMPLEX=function(t,e,n){if(t=C.parseNumber(t),e=C.parseNumber(e),C.anyIsError(t,e))return t;if("i"!==(n=void 0===n?"i":n)&&"j"!==n)return b.value;if(0===t&&0===e)return 0;if(0===t)return 1===e?n:e.toString()+n;if(0===e)return t.toString();var r=0<e?"+":"";return t.toString()+r+(1===e?n:e.toString()+n)},h.CONVERT=function(t,e,n){if((t=C.parseNumber(t))instanceof Error)return t;for(var r,i=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["Ã¥ngstrÃ¶m","Ã",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic Ã¥ngstrÃ¶m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","Â°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["Årsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Î©",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestÃ¤rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square Ã¥ngstrÃ¶m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],o={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},a={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},s=null,l=null,u=e,h=n,c=1,d=1,f=0;f<i.length;f++)r=null===i[f][2]?[]:i[f][2],(i[f][1]===u||0<=r.indexOf(u))&&(s=i[f]),(i[f][1]===h||0<=r.indexOf(h))&&(l=i[f]);if(null===s){var p=o[e.substring(0,2)],g=a[e.substring(0,1)];"da"===e.substring(0,2)&&(g=["dekao",10,"da"]),p?(c=p[2],u=e.substring(2)):g&&(c=g[1],u=e.substring(g[2].length));for(var v=0;v<i.length;v++)r=null===i[v][2]?[]:i[v][2],(i[v][1]===u||0<=r.indexOf(u))&&(s=i[v])}if(null===l){var m=o[n.substring(0,2)],y=a[n.substring(0,1)];"da"===n.substring(0,2)&&(y=["dekao",10,"da"]),m?(d=m[2],h=n.substring(2)):y&&(d=y[1],h=n.substring(y[2].length));for(var w=0;w<i.length;w++)r=null===i[w][2]?[]:i[w][2],(i[w][1]===h||0<=r.indexOf(h))&&(l=i[w])}return null===s||null===l?b.na:s[3]!==l[3]?b.na:t*s[6]*c/(l[6]*d)},h.DEC2BIN=function(t,e){if((t=C.parseNumber(t))instanceof Error)return t;if(!/^-?[0-9]{1,3}$/.test(t)||t<-512||511<t)return b.num;if(t<0)return"1"+o.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);var n=parseInt(t,10).toString(2);return void 0===e?n:isNaN(e)?b.value:e<0?b.num:(e=Math.floor(e))>=n.length?o.REPT("0",e-n.length)+n:b.num},h.DEC2HEX=function(t,e){if((t=C.parseNumber(t))instanceof Error)return t;if(!/^-?[0-9]{1,12}$/.test(t)||t<-549755813888||549755813887<t)return b.num;if(t<0)return(1099511627776+t).toString(16);var n=parseInt(t,10).toString(16);return void 0===e?n:isNaN(e)?b.value:e<0?b.num:(e=Math.floor(e))>=n.length?o.REPT("0",e-n.length)+n:b.num},h.DEC2OCT=function(t,e){if((t=C.parseNumber(t))instanceof Error)return t;if(!/^-?[0-9]{1,9}$/.test(t)||t<-536870912||536870911<t)return b.num;if(t<0)return(1073741824+t).toString(8);var n=parseInt(t,10).toString(8);return void 0===e?n:isNaN(e)?b.value:e<0?b.num:(e=Math.floor(e))>=n.length?o.REPT("0",e-n.length)+n:b.num},h.DELTA=function(t,e){return e=void 0===e?0:e,t=C.parseNumber(t),e=C.parseNumber(e),C.anyIsError(t,e)?b.value:t===e?1:0},h.ERF=function(t,e){return e=void 0===e?0:e,t=C.parseNumber(t),e=C.parseNumber(e),C.anyIsError(t,e)?b.value:n.erf(t)},h.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")},h.ERFC=function(t){return isNaN(t)?b.value:n.erfc(t)},h.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")},h.GESTEP=function(t,e){return e=e||0,t=C.parseNumber(t),C.anyIsError(e,t)?t:e<=t?1:0},h.HEX2BIN=function(t,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return b.num;var n=10===t.length&&"f"===t.substring(0,1).toLowerCase(),r=n?parseInt(t,16)-1099511627776:parseInt(t,16);if(r<-512||511<r)return b.num;if(n)return"1"+o.REPT("0",9-(512+r).toString(2).length)+(512+r).toString(2);var i=r.toString(2);return void 0===e?i:isNaN(e)?b.value:e<0?b.num:(e=Math.floor(e))>=i.length?o.REPT("0",e-i.length)+i:b.num},h.HEX2DEC=function(t){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return b.num;var e=parseInt(t,16);return 549755813888<=e?e-1099511627776:e},h.HEX2OCT=function(t,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return b.num;var n=parseInt(t,16);if(536870911<n&&n<0xffe0000000)return b.num;if(0xffe0000000<=n)return(n-0xffc0000000).toString(8);var r=n.toString(8);return void 0===e?r:isNaN(e)?b.value:e<0?b.num:(e=Math.floor(e))>=r.length?o.REPT("0",e-r.length)+r:b.num},h.IMABS=function(t){var e=h.IMREAL(t),n=h.IMAGINARY(t);return C.anyIsError(e,n)?b.value:Math.sqrt(Math.pow(e,2)+Math.pow(n,2))},h.IMAGINARY=function(t){if(void 0===t||!0===t||!1===t)return b.value;if(0===t||"0"===t)return 0;if(0<=["i","j"].indexOf(t))return 1;var e=(t=t.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),n=t.indexOf("-");0===e&&(e=t.indexOf("+",1)),0===n&&(n=t.indexOf("-",1));var r=t.substring(t.length-1,t.length),i="i"===r||"j"===r;return 0<=e||0<=n?i?0<=e?isNaN(t.substring(0,e))||isNaN(t.substring(e+1,t.length-1))?b.num:Number(t.substring(e+1,t.length-1)):isNaN(t.substring(0,n))||isNaN(t.substring(n+1,t.length-1))?b.num:-Number(t.substring(n+1,t.length-1)):b.num:i?isNaN(t.substring(0,t.length-1))?b.num:t.substring(0,t.length-1):isNaN(t)?b.num:0},h.IMARGUMENT=function(t){var e=h.IMREAL(t),n=h.IMAGINARY(t);return C.anyIsError(e,n)?b.value:0===e&&0===n?b.div0:0===e&&0<n?Math.PI/2:0===e&&n<0?-Math.PI/2:0===n&&0<e?0:0===n&&e<0?-Math.PI:0<e?Math.atan(n/e):e<0&&0<=n?Math.atan(n/e)+Math.PI:Math.atan(n/e)-Math.PI},h.IMCONJUGATE=function(t){var e=h.IMREAL(t),n=h.IMAGINARY(t);if(C.anyIsError(e,n))return b.value;var r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i",0!==n?h.COMPLEX(e,-n,r):t},h.IMCOS=function(t){var e=h.IMREAL(t),n=h.IMAGINARY(t);if(C.anyIsError(e,n))return b.value;var r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i",h.COMPLEX(Math.cos(e)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(e)*(Math.exp(n)-Math.exp(-n))/2,r)},h.IMCOSH=function(t){var e=h.IMREAL(t),n=h.IMAGINARY(t);if(C.anyIsError(e,n))return b.value;var r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i",h.COMPLEX(Math.cos(n)*(Math.exp(e)+Math.exp(-e))/2,Math.sin(n)*(Math.exp(e)-Math.exp(-e))/2,r)},h.IMCOT=function(t){var e=h.IMREAL(t),n=h.IMAGINARY(t);return C.anyIsError(e,n)?b.value:h.IMDIV(h.IMCOS(t),h.IMSIN(t))},h.IMDIV=function(t,e){var n=h.IMREAL(t),r=h.IMAGINARY(t),i=h.IMREAL(e),o=h.IMAGINARY(e);if(C.anyIsError(n,r,i,o))return b.value;var a=t.substring(t.length-1),s=e.substring(e.length-1),l="i";if("j"===a?l="j":"j"===s&&(l="j"),0===i&&0===o)return b.num;var u=i*i+o*o;return h.COMPLEX((n*i+r*o)/u,(r*i-n*o)/u,l)},h.IMEXP=function(t){var e=h.IMREAL(t),n=h.IMAGINARY(t);if(C.anyIsError(e,n))return b.value;var r=t.substring(t.length-1);r="i"===r||"j"===r?r:"i";var i=Math.exp(e);return h.COMPLEX(i*Math.cos(n),i*Math.sin(n),r)},h.IMLN=function(t){var e=h.IMREAL(t),n=h.IMAGINARY(t);if(C.anyIsError(e,n))return b.value;var r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i",h.COMPLEX(Math.log(Math.sqrt(e*e+n*n)),Math.atan(n/e),r)},h.IMLOG10=function(t){var e=h.IMREAL(t),n=h.IMAGINARY(t);if(C.anyIsError(e,n))return b.value;var r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i",h.COMPLEX(Math.log(Math.sqrt(e*e+n*n))/Math.log(10),Math.atan(n/e)/Math.log(10),r)},h.IMLOG2=function(t){var e=h.IMREAL(t),n=h.IMAGINARY(t);if(C.anyIsError(e,n))return b.value;var r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i",h.COMPLEX(Math.log(Math.sqrt(e*e+n*n))/Math.log(2),Math.atan(n/e)/Math.log(2),r)},h.IMPOWER=function(t,e){e=C.parseNumber(e);var n=h.IMREAL(t),r=h.IMAGINARY(t);if(C.anyIsError(e,n,r))return b.value;var i=t.substring(t.length-1);i="i"===i||"j"===i?i:"i";var o=Math.pow(h.IMABS(t),e),a=h.IMARGUMENT(t);return h.COMPLEX(o*Math.cos(e*a),o*Math.sin(e*a),i)},h.IMPRODUCT=function(){var t=arguments[0];if(!arguments.length)return b.value;for(var e=1;e<arguments.length;e++){var n=h.IMREAL(t),r=h.IMAGINARY(t),i=h.IMREAL(arguments[e]),o=h.IMAGINARY(arguments[e]);if(C.anyIsError(n,r,i,o))return b.value;t=h.COMPLEX(n*i-r*o,n*o+r*i)}return t},h.IMREAL=function(t){if(void 0===t||!0===t||!1===t)return b.value;if(0===t||"0"===t)return 0;if(0<=["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(t))return 0;var e=t.indexOf("+"),n=t.indexOf("-");0===e&&(e=t.indexOf("+",1)),0===n&&(n=t.indexOf("-",1));var r=t.substring(t.length-1,t.length),i="i"===r||"j"===r;return 0<=e||0<=n?i?0<=e?isNaN(t.substring(0,e))||isNaN(t.substring(e+1,t.length-1))?b.num:Number(t.substring(0,e)):isNaN(t.substring(0,n))||isNaN(t.substring(n+1,t.length-1))?b.num:Number(t.substring(0,n)):b.num:i?isNaN(t.substring(0,t.length-1))?b.num:0:isNaN(t)?b.num:t},h.IMSEC=function(t){if(!0===t||!1===t)return b.value;var e=h.IMREAL(t),n=h.IMAGINARY(t);return C.anyIsError(e,n)?b.value:h.IMDIV("1",h.IMCOS(t))},h.IMSECH=function(t){var e=h.IMREAL(t),n=h.IMAGINARY(t);return C.anyIsError(e,n)?b.value:h.IMDIV("1",h.IMCOSH(t))},h.IMSIN=function(t){var e=h.IMREAL(t),n=h.IMAGINARY(t);if(C.anyIsError(e,n))return b.value;var r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i",h.COMPLEX(Math.sin(e)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(e)*(Math.exp(n)-Math.exp(-n))/2,r)},h.IMSINH=function(t){var e=h.IMREAL(t),n=h.IMAGINARY(t);if(C.anyIsError(e,n))return b.value;var r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i",h.COMPLEX(Math.cos(n)*(Math.exp(e)-Math.exp(-e))/2,Math.sin(n)*(Math.exp(e)+Math.exp(-e))/2,r)},h.IMSQRT=function(t){var e=h.IMREAL(t),n=h.IMAGINARY(t);if(C.anyIsError(e,n))return b.value;var r=t.substring(t.length-1);r="i"===r||"j"===r?r:"i";var i=Math.sqrt(h.IMABS(t)),o=h.IMARGUMENT(t);return h.COMPLEX(i*Math.cos(o/2),i*Math.sin(o/2),r)},h.IMCSC=function(t){if(!0===t||!1===t)return b.value;var e=h.IMREAL(t),n=h.IMAGINARY(t);return C.anyIsError(e,n)?b.num:h.IMDIV("1",h.IMSIN(t))},h.IMCSCH=function(t){if(!0===t||!1===t)return b.value;var e=h.IMREAL(t),n=h.IMAGINARY(t);return C.anyIsError(e,n)?b.num:h.IMDIV("1",h.IMSINH(t))},h.IMSUB=function(t,e){var n=this.IMREAL(t),r=this.IMAGINARY(t),i=this.IMREAL(e),o=this.IMAGINARY(e);if(C.anyIsError(n,r,i,o))return b.value;var a=t.substring(t.length-1),s=e.substring(e.length-1),l="i";return"j"===a?l="j":"j"===s&&(l="j"),this.COMPLEX(n-i,r-o,l)},h.IMSUM=function(){if(!arguments.length)return b.value;for(var t=C.flatten(arguments),e=t[0],n=1;n<t.length;n++){var r=this.IMREAL(e),i=this.IMAGINARY(e),o=this.IMREAL(t[n]),a=this.IMAGINARY(t[n]);if(C.anyIsError(r,i,o,a))return b.value;e=this.COMPLEX(r+o,i+a)}return e},h.IMTAN=function(t){if(!0===t||!1===t)return b.value;var e=h.IMREAL(t),n=h.IMAGINARY(t);return C.anyIsError(e,n)?b.value:this.IMDIV(this.IMSIN(t),this.IMCOS(t))},h.OCT2BIN=function(t,e){if(!/^[0-7]{1,10}$/.test(t))return b.num;var n=10===t.length&&"7"===t.substring(0,1),r=n?parseInt(t,8)-1073741824:parseInt(t,8);if(r<-512||511<r)return b.num;if(n)return"1"+o.REPT("0",9-(512+r).toString(2).length)+(512+r).toString(2);var i=r.toString(2);return void 0===e?i:isNaN(e)?b.value:e<0?b.num:(e=Math.floor(e))>=i.length?o.REPT("0",e-i.length)+i:b.num},h.OCT2DEC=function(t){if(!/^[0-7]{1,10}$/.test(t))return b.num;var e=parseInt(t,8);return 536870912<=e?e-1073741824:e},h.OCT2HEX=function(t,e){if(!/^[0-7]{1,10}$/.test(t))return b.num;var n=parseInt(t,8);if(536870912<=n)return"ff"+(n+3221225472).toString(16);var r=n.toString(16);return void 0===e?r:isNaN(e)?b.value:e<0?b.num:(e=Math.floor(e))>=r.length?o.REPT("0",e-r.length)+r:b.num}},function(t,e,n){"use strict";e.__esModule=!0;e.default=["ABS","ACCRINT","ACOS","ACOSH","ACOT","ACOTH","ADD","AGGREGATE","AND","ARABIC","ARGS2ARRAY","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","AVERAGEIFS","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETA.DIST","BETA.INV","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BINOMDIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHOOSE","CHOOSE","CLEAN","CODE","COLUMN","COLUMNS","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCE","CONFIDENCE.NORM","CONFIDENCE.T","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCE.P","COVARIANCE.S","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DIVIDE","DOLLAR","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","EQ","ERF","ERFC","EVEN","EXACT","EXP","EXPON.DIST","EXPONDIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","FACT","FACTDOUBLE","FALSE","FDIST","FDISTRT","FIND","FINV","FINVRT","FISHER","FISHERINV","FIXED","FLATTEN","FLOOR","FORECAST","FREQUENCY","FV","FVSCHEDULE","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMADIST","GAMMAINV","GAMMALN","GAMMALN.PRECISE","GAUSS","GCD","GEOMEAN","GESTEP","GROWTH","GTE","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","HOUR","HTML2TEXT","HYPGEOM.DIST","HYPGEOMDIST","IF","IMABS","IMAGINARY","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INT","INTERCEPT","INTERVAL","IPMT","IRR","ISBINARY","ISBLANK","ISEVEN","ISLOGICAL","ISNONTEXT","ISNUMBER","ISODD","ISODD","ISOWEEKNUM","ISPMT","ISTEXT","JOIN","KURT","LARGE","LCM","LEFT","LEN","LINEST","LN","LOG","LOG10","LOGEST","LOGNORM.DIST","LOGNORM.INV","LOGNORMDIST","LOGNORMINV","LOWER","LT","LTE","MATCH","MAX","MAXA","MEDIAN","MID","MIN","MINA","MINUS","MINUTE","MIRR","MOD","MODE.MULT","MODE.SNGL","MODEMULT","MODESNGL","MONTH","MROUND","MULTINOMIAL","MULTIPLY","NE","NEGBINOM.DIST","NEGBINOMDIST","NETWORKDAYS","NOMINAL","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NORMDIST","NORMINV","NORMSDIST","NORMSINV","NOT","NOW","NPER","NPV","NUMBERS","NUMERAL","OCT2BIN","OCT2DEC","OCT2HEX","ODD","OR","PDURATION","PEARSON","PERCENTILEEXC","PERCENTILEINC","PERCENTRANKEXC","PERCENTRANKINC","PERMUT","PERMUTATIONA","PHI","PI","PMT","POISSON.DIST","POISSONDIST","POW","POWER","PPMT","PROB","PRODUCT","PROPER","PV","QUARTILE.EXC","QUARTILE.INC","QUARTILEEXC","QUARTILEINC","QUOTIENT","RADIANS","RAND","RANDBETWEEN","RANK.AVG","RANK.EQ","RANKAVG","RANKEQ","RATE","REFERENCE","REGEXEXTRACT","REGEXMATCH","REGEXREPLACE","REPLACE","REPT","RIGHT","ROMAN","ROUND","ROUNDDOWN","ROUNDUP","ROW","ROWS","RRI","RSQ","SEARCH","SEC","SECH","SECOND","SERIESSUM","SIGN","SIN","SINH","SKEW","SKEW.P","SKEWP","SLN","SLOPE","SMALL","SPLIT","SPLIT","SQRT","SQRTPI","STANDARDIZE","STDEV.P","STDEV.S","STDEVA","STDEVP","STDEVPA","STDEVS","STEYX","SUBSTITUTE","SUBTOTAL","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","SWITCH","SYD","T","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","TAN","TANH","TBILLEQ","TBILLPRICE","TBILLYIELD","TDIST","TDIST2T","TDISTRT","TEXT","TIME","TIMEVALUE","TINV","TINV2T","TODAY","TRANSPOSE","TREND","TRIM","TRIMMEAN","TRUE","TRUNC","UNICHAR","UNICODE","UNIQUE","UPPER","VALUE","VAR.P","VAR.S","VARA","VARP","VARPA","VARS","WEEKDAY","WEEKNUM","WEIBULL.DIST","WEIBULLDIST","WORKDAY","XIRR","XNPV","XOR","YEAR","YEARFRAC"]},function(t,e,n){"use strict";function a(t){var e=parseInt(t,10);return e=isNaN(e)?-1:Math.max(e-1,-1)}function r(t){var e="";return 0<=t&&(e=""+(t+1)),e}e.__esModule=!0,e.rowLabelToIndex=a,e.rowIndexToLabel=r,e.columnLabelToIndex=s,e.columnIndexToLabel=l,e.extractLabel=function(t){if("string"!=typeof t||!u.test(t))return[];var e=t.toUpperCase().match(u),n=e[1],r=e[2],i=e[3],o=e[4];return[{index:a(o),label:o,isAbsolute:"$"===i},{index:s(r),label:r,isAbsolute:"$"===n}]},e.toLabel=function(t,e){var n=(t.isAbsolute?"$":"")+r(t.index);return(e.isAbsolute?"$":"")+l(e.index)+n};var i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",o=i.length;function s(t){var e=0;if("string"==typeof t)for(var n=0,r=(t=t.toUpperCase()).length-1;n<t.length;n+=1,r-=1)e+=Math.pow(o,r)*(i.indexOf(t[n])+1);return--e}function l(t){for(var e="";0<=t;)e=String.fromCharCode(t%o+97)+e,t=Math.floor(t/o)-1;return e.toUpperCase()}var u=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/},function(t,e,n){"use strict";e.__esModule=!0,e.rowLabelToIndex=e.rowIndexToLabel=e.columnLabelToIndex=e.columnIndexToLabel=e.toLabel=e.extractLabel=e.error=e.Parser=e.ERROR_VALUE=e.ERROR_REF=e.ERROR_NUM=e.ERROR_NULL=e.ERROR_NOT_AVAILABLE=e.ERROR_NAME=e.ERROR_DIV_ZERO=e.ERROR=e.SUPPORTED_FORMULAS=void 0;var r=l(n(17)),i=l(n(14)),o=n(2),a=l(o),s=n(15);function l(t){return t&&t.__esModule?t:{default:t}}e.SUPPORTED_FORMULAS=i.default,e.ERROR=o.ERROR,e.ERROR_DIV_ZERO=o.ERROR_DIV_ZERO,e.ERROR_NAME=o.ERROR_NAME,e.ERROR_NOT_AVAILABLE=o.ERROR_NOT_AVAILABLE,e.ERROR_NULL=o.ERROR_NULL,e.ERROR_NUM=o.ERROR_NUM,e.ERROR_REF=o.ERROR_REF,e.ERROR_VALUE=o.ERROR_VALUE,e.Parser=r.default,e.error=a.default,e.extractLabel=s.extractLabel,e.toLabel=s.toLabel,e.columnIndexToLabel=s.columnIndexToLabel,e.columnLabelToIndex=s.columnLabelToIndex,e.rowIndexToLabel=s.rowIndexToLabel,e.rowLabelToIndex=s.rowLabelToIndex},function(t,e,n){"use strict";e.__esModule=!0;var r=h(n(18)),o=h(n(19)),i=n(41),a=n(43),s=n(3),l=n(2),u=h(l),c=n(15);function h(t){return t&&t.__esModule?t:{default:t}}var d,f=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(p,d=r.default),p.prototype.parse=function(t){var e=null,n=null;try{e=""===t?"":this.parser.parse(t)}catch(t){var r=(0,u.default)(t.message);n=r||(0,u.default)(l.ERROR)}return e instanceof Error&&(n=(0,u.default)(e.message)||(0,u.default)(l.ERROR),e=null),{error:n,result:e}},p.prototype.setVariable=function(t,e){return this.variables[t]=e,this},p.prototype.getVariable=function(t){return this.variables[t]},p.prototype._callVariable=function(t){var e=this.getVariable(t);if(this.emit("callVariable",t,function(t){void 0!==t&&(e=t)}),void 0===e)throw Error(l.ERROR_NAME);return e},p.prototype.setFunction=function(t,e){return this.functions[t]=e,this},p.prototype.getFunction=function(t){return this.functions[t]},p.prototype._callFunction=function(t,e){var n=1<arguments.length&&void 0!==e?e:[],r=this.getFunction(t),i=void 0;return r&&(i=r(n)),this.emit("callFunction",t,n,function(t){void 0!==t&&(i=t)}),void 0===i?(0,o.default)(t,n):i},p.prototype._callCellValue=function(t){t=t.toUpperCase();var e=(0,c.extractLabel)(t),n=e[0],r=e[1],i=void 0;return this.emit("callCellValue",{label:t,row:n,column:r},function(t){i=t}),i},p.prototype._callRangeValue=function(t,e){t=t.toUpperCase(),e=e.toUpperCase();var n=(0,c.extractLabel)(t),r=n[0],i=n[1],o=(0,c.extractLabel)(e),a=o[0],s=o[1],l={},u={};r.index<=a.index?(l.row=r,u.row=a):(l.row=a,u.row=r),i.index<=s.index?(l.column=i,u.column=s):(l.column=s,u.column=i),l.label=(0,c.toLabel)(l.row,l.column),u.label=(0,c.toLabel)(u.row,u.column);var h=[];return this.emit("callRangeValue",l,u,function(){h=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]}),h},p.prototype._throwError=function(t){if((0,l.isValidStrict)(t))throw Error(t);throw Error(l.ERROR)},p);function p(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,d.call(this));return n.parser=new i.Parser,n.parser.yy={toNumber:s.toNumber,trimEdges:a.trimEdges,invertNumber:s.invertNumber,throwError:function(t){return n._throwError(t)},callVariable:function(t){return n._callVariable(t)},evaluateByOperator:o.default,callFunction:function(t,e){return n._callFunction(t,e)},cellValue:function(t){return n._callCellValue(t)},rangeValue:function(t,e){return n._callRangeValue(t,e)}},n.variables=Object.create(null),n.functions=Object.create(null),n.setVariable("TRUE",!0).setVariable("FALSE",!1).setVariable("NULL",null),n}e.default=f},function(t,e){function n(){}n.prototype={on:function(t,e,n){var r=this.e||(this.e={});return(r[t]||(r[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var r=this;function i(){r.off(t,i),e.apply(n,arguments)}return i._=e,this.on(t,i,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),r=0,i=n.length;r<i;r++)n[r].fn.apply(n[r].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),r=n[t],i=[];if(r&&e)for(var o=0,a=r.length;o<a;o++)r[o].fn!==e&&r[o].fn._!==e&&i.push(r[o]);return i.length?n[t]=i:delete n[t],this}},t.exports=n},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(t=t.toUpperCase(),y[t])return y[t].apply(y,e);throw Error(v.ERROR_NAME)},e.registerOperation=w;var r=m(n(20)),i=m(n(21)),o=m(n(22)),a=m(n(23)),s=m(n(24)),l=m(n(33)),u=m(n(34)),h=m(n(35)),c=m(n(36)),d=m(n(37)),f=m(n(38)),p=m(n(39)),g=m(n(40)),v=n(2);function m(t){return t&&t.__esModule?t:{default:t}}var y=Object.create(null);function w(t,e){Array.isArray(t)||(t=[t.toUpperCase()]),t.forEach(function(t){e.isFactory?y[t]=e(t):y[t]=e})}w(r.default.SYMBOL,r.default),w(i.default.SYMBOL,i.default),w(o.default.SYMBOL,o.default),w(a.default.SYMBOL,a.default),w(g.default.SYMBOL,g.default),w(s.default.SYMBOL,s.default),w(l.default.SYMBOL,l.default),w(u.default.SYMBOL,u.default),w(h.default.SYMBOL,h.default),w(c.default.SYMBOL,c.default),w(f.default.SYMBOL,f.default),w(p.default.SYMBOL,p.default),w(d.default.SYMBOL,d.default)},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=i;var o=n(3),a=n(2),r=e.SYMBOL="+";function i(t){for(var e=arguments.length,n=Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=n.reduce(function(t,e){return t+(0,o.toNumber)(e)},(0,o.toNumber)(t));if(isNaN(i))throw Error(a.ERROR_VALUE);return i}i.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.default=i;var r=e.SYMBOL="&";function i(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(function(t,e){return t+e.toString()},"")}i.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=i;var o=n(3),a=n(2),r=e.SYMBOL="/";function i(t){for(var e=arguments.length,n=Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=n.reduce(function(t,e){return t/(0,o.toNumber)(e)},(0,o.toNumber)(t));if(i===1/0)throw Error(a.ERROR_DIV_ZERO);if(isNaN(i))throw Error(a.ERROR_VALUE);return i}i.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.default=i;var r=e.SYMBOL="=";function i(t,e){return t===e}i.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=u;var r,s=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(25)),i=n(14),o=(r=i)&&r.__esModule?r:{default:r},l=n(2);var a=e.SYMBOL=o.default;function u(a){return function(){var t=(a=a.toUpperCase()).split("."),e=!1,n=void 0;if(1===t.length)s[t[0]]&&(e=!0,n=s[t[0]].apply(s,arguments));else{for(var r=t.length,i=0,o=s;i<r;)if(o=o[t[i]],i++,!o){o=null;break}o&&(e=!0,n=o.apply(void 0,arguments))}if(!e)throw Error(l.ERROR_NAME);return n}}u.isFactory=!0,u.SYMBOL=a},function(t,e,n){var r=[n(26),n(29),n(13),n(30),n(4),n(6),n(8),n(31),n(7),n(32),n(5),n(12)];for(var i in r){var o=r[i];for(var a in o)e[a]=e[a]||o[a]}},function(t,e,n){var r=n(4),i=n(5),o=n(13),a=n(8);function s(t,e){if(e)for(var n in e)t[n]=e[n];return t}e.BETADIST=i.BETA.DIST,e.BETAINV=i.BETA.INV,e.BINOMDIST=i.BINOM.DIST,e.CEILING=e.ISOCEILING=s(r.CEILING.MATH,r.CEILING),e.CEILINGMATH=r.CEILING.MATH,e.CEILINGPRECISE=r.CEILING.PRECISE,e.CHIDIST=i.CHISQ.DIST,e.CHIDISTRT=i.CHISQ.DIST.RT,e.CHIINV=i.CHISQ.INV,e.CHIINVRT=i.CHISQ.INV.RT,e.CHITEST=i.CHISQ.TEST,e.CONFIDENCE=s(i.CONFIDENCE.NORM,i.CONFIDENCE),e.COVAR=i.COVARIANCE.P,e.COVARIANCEP=i.COVARIANCE.P,e.COVARIANCES=i.COVARIANCE.S,e.CRITBINOM=i.BINOM.INV,e.EXPONDIST=i.EXPON.DIST,e.ERFCPRECISE=o.ERFC.PRECISE,e.ERFPRECISE=o.ERF.PRECISE,e.FDIST=i.F.DIST,e.FDISTRT=i.F.DIST.RT,e.FINVRT=i.F.INV.RT,e.FINV=i.F.INV,e.FLOOR=s(r.FLOOR.MATH,r.FLOOR),e.FLOORMATH=r.FLOOR.MATH,e.FLOORPRECISE=r.FLOOR.PRECISE,e.FTEST=i.F.TEST,e.GAMMADIST=i.GAMMA.DIST,e.GAMMAINV=i.GAMMA.INV,e.GAMMALNPRECISE=i.GAMMALN.PRECISE,e.HYPGEOMDIST=i.HYPGEOM.DIST,e.LOGINV=i.LOGNORM.INV,e.LOGNORMINV=i.LOGNORM.INV,e.LOGNORMDIST=i.LOGNORM.DIST,e.MODE=s(i.MODE.SNGL,i.MODE),e.MODEMULT=i.MODE.MULT,e.MODESNGL=i.MODE.SNGL,e.NEGBINOMDIST=i.NEGBINOM.DIST,e.NETWORKDAYSINTL=a.NETWORKDAYS.INTL,e.NORMDIST=i.NORM.DIST,e.NORMINV=i.NORM.INV,e.NORMSDIST=i.NORM.S.DIST,e.NORMSINV=i.NORM.S.INV,e.PERCENTILE=s(i.PERCENTILE.EXC,i.PERCENTILE),e.PERCENTILEEXC=i.PERCENTILE.EXC,e.PERCENTILEINC=i.PERCENTILE.INC,e.PERCENTRANK=s(i.PERCENTRANK.INC,i.PERCENTRANK),e.PERCENTRANKEXC=i.PERCENTRANK.EXC,e.PERCENTRANKINC=i.PERCENTRANK.INC,e.POISSON=s(i.POISSON.DIST,i.POISSON),e.POISSONDIST=i.POISSON.DIST,e.QUARTILE=s(i.QUARTILE.INC,i.QUARTILE),e.QUARTILEEXC=i.QUARTILE.EXC,e.QUARTILEINC=i.QUARTILE.INC,e.RANK=s(i.RANK.EQ,i.RANK),e.RANKAVG=i.RANK.AVG,e.RANKEQ=i.RANK.EQ,e.SKEWP=i.SKEW.P,e.STDEV=s(i.STDEV.S,i.STDEV),e.STDEVP=i.STDEV.P,e.STDEVS=i.STDEV.S,e.TDIST=i.T.DIST,e.TDISTRT=i.T.DIST.RT,e.TINV=i.T.INV,e.TTEST=i.T.TEST,e.VAR=s(i.VAR.S,i.VAR),e.VARP=i.VAR.P,e.VARS=i.VAR.S,e.WEIBULL=s(i.WEIBULL.DIST,i.WEIBULL),e.WEIBULLDIST=i.WEIBULL.DIST,e.WORKDAYINTL=a.WORKDAY.INTL,e.ZTEST=i.Z.TEST},function(t,e){},function(t,e,n){var h=Math;function u(t,n){return t.reduce(function(t,e){return n*t+e},0)}function c(t,e,n,r,i){i=i||-1;var o,a=2/t;if(0===e)return n;if(1===e)return r;for(var s=1;s!=e;++s)o=r*s*a+i*n,n=r,r=o;return r}function r(n,r,i,o,a){return function(t,e){if(0===e)return n(t);if(1===e)return r(t);if(e<0)throw i+": Order ("+e+") must be nonnegative";if(1==o&&0===t)throw i+": Undefined when x == 0";if(2==o&&t<=0)throw i+": Undefined when x <= 0";return c(t,e,n(t),r(t),a)}}var o,a,s,l,d,f,p,g,v=(o=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),a=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),s=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),l=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),d=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),f=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),p=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),g=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),function(t,e){if(0===(e=Math.round(e)))return m(h.abs(t));if(1===e)return y(h.abs(t));if(e<0)throw"BESSELJ: Order ("+e+") must be nonnegative";if(0===h.abs(t))return 0;var n,r,i,o,a,s,l,u=2/h.abs(t);if(h.abs(t)>e)n=c(t,e,m(h.abs(t)),y(h.abs(t)),-1);else{for(a=n=o=i=0,s=1,r=2*h.floor((e+h.floor(h.sqrt(40*e)))/2);0<r;r--)l=r*u*s-a,a=s,s=l,1e10<h.abs(s)&&(s*=1e-10,a*=1e-10,n*=1e-10,o*=1e-10),i&&(o+=s),i=!i,r==e&&(n=a);n/=o=2*o-s}return t<0&&e%2?-n:n});function m(t){var e,n,r=t*t,i=h.abs(t)-.785398164;return h.abs(t)<8?(e=u(o,r))/(n=u(a,r)):(e=u(s,r=64/r),n=u(l,r),h.sqrt(.636619772/h.abs(t))*(h.cos(i)*e-h.sin(i)*n*8/h.abs(t)))}function y(t){var e,n,r,i=t*t,o=h.abs(t)-2.356194491;return Math.abs(t)<8?e=(n=t*u(d,i))/(r=u(f,i)):(n=u(p,i=64/i),r=u(g,i),e=h.sqrt(.636619772/h.abs(t))*(h.cos(o)*n-h.sin(o)*r*8/h.abs(t)),t<0&&(e=-e)),e}var w,b,C,E,S,O,T,N,R,_,M,A,k,i,x,I,D,L=(w=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),b=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),C=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),E=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),S=.636619772,O=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),T=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),N=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),R=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),r(function(t){var e,n,r=t*t,i=t-.785398164;return t<8?(e=u(w,r))/(n=u(b,r))+S*v(t,0)*h.log(t):(e=u(C,r=64/r),n=u(E,r),h.sqrt(S/t)*(h.sin(i)*e+h.cos(i)*n*8/t))},function(t){var e,n,r=t*t,i=t-2.356194491;return t<8?(e=t*u(O,r))/(n=u(T,r))+S*(v(t,1)*h.log(t)-1/t):(e=u(N,r=64/r),n=u(R,r),h.sqrt(S/t)*(h.sin(i)*e+h.cos(i)*n*8/t))},"BESSELY",1,-1)),P=(_=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),M=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),A=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),k=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function t(e,n){if(0===(n=Math.round(n)))return function(t){return t<=3.75?u(_,t*t/14.0625):h.exp(h.abs(t))/h.sqrt(h.abs(t))*u(M,3.75/h.abs(t))}(e);if(1==n)return function(t){return t<3.75?t*u(A,t*t/14.0625):(t<0?-1:1)*h.exp(h.abs(t))/h.sqrt(h.abs(t))*u(k,3.75/h.abs(t))}(e);if(n<0)throw"BESSELI Order ("+n+") must be nonnegative";if(0===h.abs(e))return 0;var r,i,o,a,s,l=2/h.abs(e);for(o=r=0,a=1,i=2*h.round((n+h.round(h.sqrt(40*n)))/2);0<i;i--)s=i*l*a+o,o=a,a=s,1e10<h.abs(a)&&(a*=1e-10,o*=1e-10,r*=1e-10),i==n&&(r=o);return r*=t(e,0)/a,e<0&&n%2?-r:r}),H=(i=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),x=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),I=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),D=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse(),r(function(t){return t<=2?-h.log(t/2)*P(t,0)+u(i,t*t/4):h.exp(-t)/h.sqrt(t)*u(x,2/t)},function(t){return t<=2?h.log(t/2)*P(t,1)+1/t*u(I,t*t/4):h.exp(-t)/h.sqrt(t)*u(D,2/t)},"BESSELK",2,1));e.besselj=v,e.bessely=L,e.besseli=P,e.besselk=H},function(module,exports,__webpack_require__){var error=__webpack_require__(0),stats=__webpack_require__(5),maths=__webpack_require__(4),utils=__webpack_require__(1);function compact(t){var e=[];return utils.arrayEach(t,function(t){t&&e.push(t)}),e}function findResultIndex(database,criterias){for(var matches={},i=1;i<database[0].length;++i)matches[i]=!0;var maxCriteriaLength=criterias[0].length;for(i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){for(var currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0;j<criterias.length;++j){var criteria=criterias[j];if(!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField){hasMatchingCriteria=!0;for(var p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(var result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result}exports.FINDFIELD=function(t,n){var r=null;return utils.arrayEach(t,function(t,e){if(t[0]===n)return r=e,!1}),null==r?error.value:r},exports.DAVERAGE=function(t,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var r=findResultIndex(t,n),i=[];if("string"==typeof e){var o=exports.FINDFIELD(t,e);i=utils.rest(t[o])}else i=utils.rest(t[e]);var a=0;return utils.arrayEach(r,function(t){a+=i[t]}),0===r.length?error.div0:a/r.length},exports.DCOUNT=function(t,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var r=findResultIndex(t,n),i=[];if("string"==typeof e){var o=exports.FINDFIELD(t,e);i=utils.rest(t[o])}else i=utils.rest(t[e]);var a=[];return utils.arrayEach(r,function(t){a.push(i[t])}),stats.COUNT(a)},exports.DCOUNTA=function(t,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var r=findResultIndex(t,n),i=[];if("string"==typeof e){var o=exports.FINDFIELD(t,e);i=utils.rest(t[o])}else i=utils.rest(t[e]);var a=[];return utils.arrayEach(r,function(t){a.push(i[t])}),stats.COUNTA(a)},exports.DGET=function(t,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var r=findResultIndex(t,n),i=[];if("string"==typeof e){var o=exports.FINDFIELD(t,e);i=utils.rest(t[o])}else i=utils.rest(t[e]);return 0===r.length?error.value:1<r.length?error.num:i[r[0]]},exports.DMAX=function(t,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var r=findResultIndex(t,n),i=[];if("string"==typeof e){var o=exports.FINDFIELD(t,e);i=utils.rest(t[o])}else i=utils.rest(t[e]);var a=i[r[0]];return utils.arrayEach(r,function(t){a<i[t]&&(a=i[t])}),a},exports.DMIN=function(t,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var r=findResultIndex(t,n),i=[];if("string"==typeof e){var o=exports.FINDFIELD(t,e);i=utils.rest(t[o])}else i=utils.rest(t[e]);var a=i[r[0]];return utils.arrayEach(r,function(t){a>i[t]&&(a=i[t])}),a},exports.DPRODUCT=function(t,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var r=findResultIndex(t,n),i=[];if("string"==typeof e){var o=exports.FINDFIELD(t,e);i=utils.rest(t[o])}else i=utils.rest(t[e]);var a=[];utils.arrayEach(r,function(t){a.push(i[t])}),a=compact(a);var s=1;return utils.arrayEach(a,function(t){s*=t}),s},exports.DSTDEV=function(t,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var r=findResultIndex(t,n),i=[];if("string"==typeof e){var o=exports.FINDFIELD(t,e);i=utils.rest(t[o])}else i=utils.rest(t[e]);var a=[];return utils.arrayEach(r,function(t){a.push(i[t])}),a=compact(a),stats.STDEV.S(a)},exports.DSTDEVP=function(t,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var r=findResultIndex(t,n),i=[];if("string"==typeof e){var o=exports.FINDFIELD(t,e);i=utils.rest(t[o])}else i=utils.rest(t[e]);var a=[];return utils.arrayEach(r,function(t){a.push(i[t])}),a=compact(a),stats.STDEV.P(a)},exports.DSUM=function(t,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var r=findResultIndex(t,n),i=[];if("string"==typeof e){var o=exports.FINDFIELD(t,e);i=utils.rest(t[o])}else i=utils.rest(t[e]);var a=[];return utils.arrayEach(r,function(t){a.push(i[t])}),maths.SUM(a)},exports.DVAR=function(t,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var r=findResultIndex(t,n),i=[];if("string"==typeof e){var o=exports.FINDFIELD(t,e);i=utils.rest(t[o])}else i=utils.rest(t[e]);var a=[];return utils.arrayEach(r,function(t){a.push(i[t])}),stats.VAR.S(a)},exports.DVARP=function(t,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var r=findResultIndex(t,n),i=[];if("string"==typeof e){var o=exports.FINDFIELD(t,e);i=utils.rest(t[o])}else i=utils.rest(t[e]);var a=[];return utils.arrayEach(r,function(t){a.push(i[t])}),stats.VAR.P(a)}},function(t,e,n){var l=n(0),r=n(1),i=n(7);e.AND=function(){for(var t=r.flatten(arguments),e=!0,n=0;n<t.length;n++)t[n]||(e=!1);return e},e.CHOOSE=function(){if(arguments.length<2)return l.na;var t=arguments[0];return t<1||254<t?l.value:arguments.length<t+1?l.value:arguments[t]},e.FALSE=function(){return!1},e.IF=function(t,e,n){return t?e:n},e.IFERROR=function(t,e){return i.ISERROR(t)?e:t},e.IFNA=function(t,e){return t===l.na?e:t},e.NOT=function(t){return!t},e.OR=function(){for(var t=r.flatten(arguments),e=!1,n=0;n<t.length;n++)t[n]&&(e=!0);return e},e.TRUE=function(){return!0},e.XOR=function(){for(var t=r.flatten(arguments),e=0,n=0;n<t.length;n++)t[n]&&e++;return!!(1&Math.floor(Math.abs(e)))},e.SWITCH=function(){var t;if(0<arguments.length){var e=arguments[0],n=arguments.length-1,r=Math.floor(n/2),i=!1,o=n%2!=0,a=n%2==0?null:arguments[arguments.length-1];if(r)for(var s=0;s<r;s++)if(e===arguments[2*s+1]){t=arguments[2*s+2],i=!0;break}i||(t=o?a:l.na)}else t=l.value;return t}},function(t,u,e){var f=e(0),s=e(8),p=e(1);function l(t){return t&&t.getTime&&!isNaN(t.getTime())}function h(t){return t instanceof Date?t:new Date(t)}u.ACCRINT=function(t,e,n,r,i,o,a){return t=h(t),e=h(e),n=h(n),l(t)&&l(e)&&l(n)?r<=0||i<=0?f.num:-1===[1,2,4].indexOf(o)?f.num:-1===[0,1,2,3,4].indexOf(a)?f.num:n<=t?f.num:(a=a||0,(i=i||0)*r*s.YEARFRAC(t,n,a)):f.value},u.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},u.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},u.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},u.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},u.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},u.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},u.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},u.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},u.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},u.CUMIPMT=function(t,e,n,r,i,o){if(t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),p.anyIsError(t,e,n))return f.value;if(t<=0||e<=0||n<=0)return f.num;if(r<1||i<1||i<r)return f.num;if(0!==o&&1!==o)return f.num;var a=u.PMT(t,e,n,0,o),s=0;1===r&&0===o&&(s=-n,r++);for(var l=r;l<=i;l++)s+=1===o?u.FV(t,l-2,a,n,1)-a:u.FV(t,l-1,a,n,0);return s*=t},u.CUMPRINC=function(t,e,n,r,i,o){if(t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),p.anyIsError(t,e,n))return f.value;if(t<=0||e<=0||n<=0)return f.num;if(r<1||i<1||i<r)return f.num;if(0!==o&&1!==o)return f.num;var a=u.PMT(t,e,n,0,o),s=0;1===r&&(s=0===o?a+n*t:a,r++);for(var l=r;l<=i;l++)s+=0<o?a-(u.FV(t,l-2,a,n,1)-a)*t:a-u.FV(t,l-1,a,n,0)*t;return s},u.DB=function(t,e,n,r,i){if(i=void 0===i?12:i,t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),r=p.parseNumber(r),i=p.parseNumber(i),p.anyIsError(t,e,n,r,i))return f.value;if(t<0||e<0||n<0||r<0)return f.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(i))return f.num;if(n<r)return f.num;if(t<=e)return 0;for(var o=(1-Math.pow(e/t,1/n)).toFixed(3),a=t*o*i/12,s=a,l=0,u=r===n?n-1:r,h=2;h<=u;h++)s+=l=(t-s)*o;return 1===r?a:r===n?(t-s)*o:l},u.DDB=function(t,e,n,r,i){if(i=void 0===i?2:i,t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),r=p.parseNumber(r),i=p.parseNumber(i),p.anyIsError(t,e,n,r,i))return f.value;if(t<0||e<0||n<0||r<0||i<=0)return f.num;if(n<r)return f.num;if(t<=e)return 0;for(var o=0,a=0,s=1;s<=r;s++)o+=a=Math.min(i/n*(t-o),t-e-o);return a},u.DISC=function(){throw new Error("DISC is not implemented")},u.DOLLARDE=function(t,e){if(t=p.parseNumber(t),e=p.parseNumber(e),p.anyIsError(t,e))return f.value;if(e<0)return f.num;if(0<=e&&e<1)return f.div0;e=parseInt(e,10);var n=parseInt(t,10);n+=t%1*Math.pow(10,Math.ceil(Math.log(e)/Math.LN10))/e;var r=Math.pow(10,Math.ceil(Math.log(e)/Math.LN2)+1);return n=Math.round(n*r)/r},u.DOLLARFR=function(t,e){if(t=p.parseNumber(t),e=p.parseNumber(e),p.anyIsError(t,e))return f.value;if(e<0)return f.num;if(0<=e&&e<1)return f.div0;e=parseInt(e,10);var n=parseInt(t,10);return n+=t%1*Math.pow(10,-Math.ceil(Math.log(e)/Math.LN10))*e},u.DURATION=function(){throw new Error("DURATION is not implemented")},u.EFFECT=function(t,e){return t=p.parseNumber(t),e=p.parseNumber(e),p.anyIsError(t,e)?f.value:t<=0||e<1?f.num:(e=parseInt(e,10),Math.pow(1+t/e,e)-1)},u.FV=function(t,e,n,r,i){if(r=r||0,i=i||0,t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),r=p.parseNumber(r),i=p.parseNumber(i),p.anyIsError(t,e,n,r,i))return f.value;var o;if(0===t)o=r+n*e;else{var a=Math.pow(1+t,e);o=1===i?r*a+n*(1+t)*(a-1)/t:r*a+n*(a-1)/t}return-o},u.FVSCHEDULE=function(t,e){if(t=p.parseNumber(t),e=p.parseNumberArray(p.flatten(e)),p.anyIsError(t,e))return f.value;for(var n=e.length,r=t,i=0;i<n;i++)r*=1+e[i];return r},u.INTRATE=function(){throw new Error("INTRATE is not implemented")},u.IPMT=function(t,e,n,r,i,o){if(i=i||0,o=o||0,t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),r=p.parseNumber(r),i=p.parseNumber(i),o=p.parseNumber(o),p.anyIsError(t,e,n,r,i,o))return f.value;var a=u.PMT(t,n,r,i,o);return(1===e?1===o?0:-r:1===o?u.FV(t,e-2,a,r,1)-a:u.FV(t,e-1,a,r,0))*t},u.IRR=function(t,e){if(e=e||0,t=p.parseNumberArray(p.flatten(t)),e=p.parseNumber(e),p.anyIsError(t,e))return f.value;function n(t,e,n){for(var r=n+1,i=t[0],o=1;o<t.length;o++)i+=t[o]/Math.pow(r,(e[o]-e[0])/365);return i}function r(t,e,n){for(var r=n+1,i=0,o=1;o<t.length;o++){var a=(e[o]-e[0])/365;i-=a*t[o]/Math.pow(r,1+a)}return i}for(var i=[],o=!1,a=!1,s=0;s<t.length;s++)i[s]=0===s?0:i[s-1]+365,0<t[s]&&(o=!0),t[s]<0&&(a=!0);if(!o||!a)return f.num;for(var l,u,h,c=e=void 0===e?.1:e;l=c-(h=n(t,i,c))/r(t,i,c),u=Math.abs(l-c),c=l,1e-10<u&&1e-10<Math.abs(h););return c},u.ISPMT=function(t,e,n,r){return t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),r=p.parseNumber(r),p.anyIsError(t,e,n,r)?f.value:r*t*(e/n-1)},u.MDURATION=function(){throw new Error("MDURATION is not implemented")},u.MIRR=function(t,e,n){if(t=p.parseNumberArray(p.flatten(t)),e=p.parseNumber(e),n=p.parseNumber(n),p.anyIsError(t,e,n))return f.value;for(var r=t.length,i=[],o=[],a=0;a<r;a++)t[a]<0?i.push(t[a]):o.push(t[a]);var s=-u.NPV(n,o)*Math.pow(1+n,r-1),l=u.NPV(e,i)*(1+e);return Math.pow(s/l,1/(r-1))-1},u.NOMINAL=function(t,e){return t=p.parseNumber(t),e=p.parseNumber(e),p.anyIsError(t,e)?f.value:t<=0||e<1?f.num:(e=parseInt(e,10),(Math.pow(t+1,1/e)-1)*e)},u.NPER=function(t,e,n,r,i){if(i=void 0===i?0:i,r=void 0===r?0:r,t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),r=p.parseNumber(r),i=p.parseNumber(i),p.anyIsError(t,e,n,r,i))return f.value;var o=e*(1+t*i)-r*t,a=n*t+e*(1+t*i);return Math.log(o/a)/Math.log(1+t)},u.NPV=function(){var t=p.parseNumberArray(p.flatten(arguments));if(t instanceof Error)return t;for(var e=t[0],n=0,r=1;r<t.length;r++)n+=t[r]/Math.pow(1+e,r);return n},u.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},u.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},u.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},u.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},u.PDURATION=function(t,e,n){return t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),p.anyIsError(t,e,n)?f.value:t<=0?f.num:(Math.log(n)-Math.log(e))/Math.log(1+t)},u.PMT=function(t,e,n,r,i){if(r=r||0,i=i||0,t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),r=p.parseNumber(r),i=p.parseNumber(i),p.anyIsError(t,e,n,r,i))return f.value;var o;if(0===t)o=(n+r)/e;else{var a=Math.pow(1+t,e);o=1===i?(r*t/(a-1)+n*t/(1-1/a))/(1+t):r*t/(a-1)+n*t/(1-1/a)}return-o},u.PPMT=function(t,e,n,r,i,o){return i=i||0,o=o||0,t=p.parseNumber(t),n=p.parseNumber(n),r=p.parseNumber(r),i=p.parseNumber(i),o=p.parseNumber(o),p.anyIsError(t,n,r,i,o)?f.value:u.PMT(t,n,r,i,o)-u.IPMT(t,e,n,r,i,o)},u.PRICE=function(){throw new Error("PRICE is not implemented")},u.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")},u.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},u.PV=function(t,e,n,r,i){return r=r||0,i=i||0,t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),r=p.parseNumber(r),i=p.parseNumber(i),p.anyIsError(t,e,n,r,i)?f.value:0===t?-n*e-r:((1-Math.pow(1+t,e))/t*n*(1+t*i)-r)/Math.pow(1+t,e)},u.RATE=function(t,e,n,r,i,o){if(o=void 0===o?.01:o,r=void 0===r?0:r,i=void 0===i?0:i,t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),r=p.parseNumber(r),i=p.parseNumber(i),o=p.parseNumber(o),p.anyIsError(t,e,n,r,i,o))return f.value;var a,s,l,u=0,h=0,c=0,d=o;for(Math.abs(d)<1e-10?n*(1+t*d)+e*(1+d*i)*t+r:n*(h=Math.exp(t*Math.log(1+d)))+e*(1/d+i)*(h-1)+r,a=n+e*t+r,s=n*h+e*(1/d+i)*(h-1)+r,c=l=0,u=d;1e-10<Math.abs(a-s)&&c<50;)d=(s*l-a*u)/(s-a),l=u,u=d,a=s,s=Math.abs(d)<1e-10?n*(1+t*d)+e*(1+d*i)*t+r:n*(h=Math.exp(t*Math.log(1+d)))+e*(1/d+i)*(h-1)+r,++c;return d},u.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},u.RRI=function(t,e,n){return t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),p.anyIsError(t,e,n)?f.value:0===t||0===e?f.num:Math.pow(n/e,1/t)-1},u.SLN=function(t,e,n){return t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),p.anyIsError(t,e,n)?f.value:0===n?f.num:(t-e)/n},u.SYD=function(t,e,n,r){return t=p.parseNumber(t),e=p.parseNumber(e),n=p.parseNumber(n),r=p.parseNumber(r),p.anyIsError(t,e,n,r)?f.value:0===n?f.num:r<1||n<r?f.num:(t-e)*(n-(r=parseInt(r,10))+1)*2/(n*(n+1))},u.TBILLEQ=function(t,e,n){return t=p.parseDate(t),e=p.parseDate(e),n=p.parseNumber(n),p.anyIsError(t,e,n)?f.value:n<=0?f.num:e<t?f.num:31536e6<e-t?f.num:365*n/(360-n*s.DAYS360(t,e,!1))},u.TBILLPRICE=function(t,e,n){return t=p.parseDate(t),e=p.parseDate(e),n=p.parseNumber(n),p.anyIsError(t,e,n)?f.value:n<=0?f.num:e<t?f.num:31536e6<e-t?f.num:100*(1-n*s.DAYS360(t,e,!1)/360)},u.TBILLYIELD=function(t,e,n){return t=p.parseDate(t),e=p.parseDate(e),n=p.parseNumber(n),p.anyIsError(t,e,n)?f.value:n<=0?f.num:e<t?f.num:31536e6<e-t?f.num:360*(100-n)/(n*s.DAYS360(t,e,!1))},u.VDB=function(){throw new Error("VDB is not implemented")},u.XNPV=function(t,e,n){if(t=p.parseNumber(t),e=p.parseNumberArray(p.flatten(e)),n=p.parseDateArray(p.flatten(n)),p.anyIsError(t,e,n))return f.value;for(var r=0,i=0;i<e.length;i++)r+=e[i]/Math.pow(1+t,s.DAYS(n[i],n[0])/365);return r},u.YIELD=function(){throw new Error("YIELD is not implemented")},u.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},u.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},function(t,e,n){var s=n(0),l=n(1);e.MATCH=function(t,e,n){if(!t&&!e)return s.na;if(2===arguments.length&&(n=1),!(e instanceof Array))return s.na;if(-1!==n&&0!==n&&1!==n)return s.na;for(var r,i,o=0;o<e.length;o++)if(1===n){if(e[o]===t)return o+1;e[o]<t&&(i?e[o]>i&&(r=o+1,i=e[o]):(r=o+1,i=e[o]))}else if(0===n){if("string"==typeof t){if(t=t.replace(/\?/g,"."),e[o].toLowerCase().match(t.toLowerCase()))return o+1}else if(e[o]===t)return o+1}else if(-1===n){if(e[o]===t)return o+1;e[o]>t&&(i?e[o]<i&&(r=o+1,i=e[o]):(r=o+1,i=e[o]))}return r||s.na},e.VLOOKUP=function(t,e,n,r){if(!t||!e||!n)return s.na;r=r||!1;for(var i=0;i<e.length;i++){var o=e[i];if(!r&&o[0]===t||o[0]===t||r&&"string"==typeof o[0]&&-1!==o[0].toLowerCase().indexOf(t.toLowerCase()))return n<o.length+1?o[n-1]:s.ref}return s.na},e.HLOOKUP=function(t,e,n,r){if(!t||!e||!n)return s.na;r=r||!1;for(var i=l.transpose(e),o=0;o<i.length;o++){var a=i[o];if(!r&&a[0]===t||a[0]===t||r&&"string"==typeof a[0]&&-1!==a[0].toLowerCase().indexOf(t.toLowerCase()))return n<a.length+1?a[n-1]:s.ref}return s.na}},function(t,e,n){"use strict";e.__esModule=!0,e.default=i;var r=e.SYMBOL=">";function i(t,e){return e<t}i.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.default=i;var r=e.SYMBOL=">=";function i(t,e){return e<=t}i.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.default=i;var r=e.SYMBOL="<";function i(t,e){return t<e}i.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.default=i;var r=e.SYMBOL="<=";function i(t,e){return t<=e}i.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=i;var o=n(3),a=n(2),r=e.SYMBOL="-";function i(t){for(var e=arguments.length,n=Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=n.reduce(function(t,e){return t-(0,o.toNumber)(e)},(0,o.toNumber)(t));if(isNaN(i))throw Error(a.ERROR_VALUE);return i}i.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=i;var o=n(3),a=n(2),r=e.SYMBOL="*";function i(t){for(var e=arguments.length,n=Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=n.reduce(function(t,e){return t*(0,o.toNumber)(e)},(0,o.toNumber)(t));if(isNaN(i))throw Error(a.ERROR_VALUE);return i}i.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.default=i;var r=e.SYMBOL="<>";function i(t,e){return t!==e}i.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=a;var r=n(3),i=n(2),o=e.SYMBOL="^";function a(t,e){var n=Math.pow((0,r.toNumber)(t),(0,r.toNumber)(e));if(isNaN(n))throw Error(i.ERROR_VALUE);return n}a.SYMBOL=o},function(module,exports,__webpack_require__){(function(module,process){var grammarParser=function(){var o=function(t,e,n,r){for(n=n||{},r=t.length;r--;n[t[r]]=e);return n},$V0=[1,5],$V1=[1,8],$V2=[1,6],$V3=[1,7],$V4=[1,9],$V5=[1,14],$V6=[1,15],$V7=[1,16],$V8=[1,12],$V9=[1,13],$Va=[1,17],$Vb=[1,19],$Vc=[1,20],$Vd=[1,21],$Ve=[1,22],$Vf=[1,23],$Vg=[1,24],$Vh=[1,25],$Vi=[1,26],$Vj=[1,27],$Vk=[1,28],$Vl=[5,9,10,11,13,14,15,16,17,18,19,20,29,30],$Vm=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,32],$Vn=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,34],$Vo=[5,10,11,13,14,15,16,17,29,30],$Vp=[5,10,13,14,15,16,29,30],$Vq=[5,10,11,13,14,15,16,17,18,19,29,30],$Vr=[13,29,30],parser={trace:function(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,number:7,STRING:8,"&":9,"=":10,"+":11,"(":12,")":13,"<":14,">":15,NOT:16,"-":17,"*":18,"/":19,"^":20,FUNCTION:21,expseq:22,cell:23,ABSOLUTE_CELL:24,RELATIVE_CELL:25,MIXED_CELL:26,":":27,ARRAY:28,";":29,",":30,VARIABLE:31,DECIMAL:32,NUMBER:33,"%":34,ERROR:35,$accept:0,$end:1},terminals_:{5:"EOF",8:"STRING",9:"&",10:"=",11:"+",12:"(",13:")",14:"<",15:">",16:"NOT",17:"-",18:"*",19:"/",20:"^",21:"FUNCTION",24:"ABSOLUTE_CELL",25:"RELATIVE_CELL",26:"MIXED_CELL",27:":",28:"ARRAY",29:";",30:",",31:"VARIABLE",32:"DECIMAL",33:"NUMBER",34:"%",35:"ERROR"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[23,1],[23,1],[23,1],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[22,1],[22,1],[22,3],[22,3],[6,1],[6,3],[7,1],[7,3],[7,2],[2,1]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return $$[$0-1];case 2:this.$=yy.callVariable($$[$0][0]);break;case 3:this.$=yy.toNumber($$[$0]);break;case 4:this.$=yy.trimEdges($$[$0]);break;case 5:this.$=yy.evaluateByOperator("&",[$$[$0-2],$$[$0]]);break;case 6:this.$=yy.evaluateByOperator("=",[$$[$0-2],$$[$0]]);break;case 7:this.$=yy.evaluateByOperator("+",[$$[$0-2],$$[$0]]);break;case 8:this.$=$$[$0-1];break;case 9:this.$=yy.evaluateByOperator("<=",[$$[$0-3],$$[$0]]);break;case 10:this.$=yy.evaluateByOperator(">=",[$$[$0-3],$$[$0]]);break;case 11:this.$=yy.evaluateByOperator("<>",[$$[$0-3],$$[$0]]);break;case 12:this.$=yy.evaluateByOperator("NOT",[$$[$0-2],$$[$0]]);break;case 13:this.$=yy.evaluateByOperator(">",[$$[$0-2],$$[$0]]);break;case 14:this.$=yy.evaluateByOperator("<",[$$[$0-2],$$[$0]]);break;case 15:this.$=yy.evaluateByOperator("-",[$$[$0-2],$$[$0]]);break;case 16:this.$=yy.evaluateByOperator("*",[$$[$0-2],$$[$0]]);break;case 17:this.$=yy.evaluateByOperator("/",[$$[$0-2],$$[$0]]);break;case 18:this.$=yy.evaluateByOperator("^",[$$[$0-2],$$[$0]]);break;case 19:var n1=yy.invertNumber($$[$0]);this.$=n1,isNaN(this.$)&&(this.$=0);break;case 20:var n1=yy.toNumber($$[$0]);this.$=n1,isNaN(this.$)&&(this.$=0);break;case 21:this.$=yy.callFunction($$[$0-2]);break;case 22:this.$=yy.callFunction($$[$0-3],$$[$0-1]);break;case 26:case 27:case 28:this.$=yy.cellValue($$[$0]);break;case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:this.$=yy.rangeValue($$[$0-2],$$[$0]);break;case 38:case 42:this.$=[$$[$0]];break;case 39:var result=[],arr=eval("["+yytext+"]");arr.forEach(function(t){result.push(t)}),this.$=result;break;case 40:case 41:$$[$0-2].push($$[$0]),this.$=$$[$0-2];break;case 43:this.$=Array.isArray($$[$0-2])?$$[$0-2]:[$$[$0-2]],this.$.push($$[$0]);break;case 44:this.$=$$[$0];break;case 45:this.$=1*($$[$0-2]+"."+$$[$0]);break;case 46:this.$=.01*$$[$0-1];break;case 47:this.$=yy.throwError($$[$0])}},table:[{2:11,3:1,4:2,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{1:[3]},{5:[1,18],9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk},o($Vl,[2,2],{32:[1,29]}),o($Vl,[2,3],{34:[1,30]}),o($Vl,[2,4]),{2:11,4:31,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:32,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:33,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{12:[1,34]},o($Vl,[2,23]),o($Vl,[2,24],{2:35,35:$Va}),o($Vm,[2,42]),o($Vn,[2,44],{32:[1,36]}),o($Vl,[2,26],{27:[1,37]}),o($Vl,[2,27],{27:[1,38]}),o($Vl,[2,28],{27:[1,39]}),o([5,9,10,11,13,14,15,16,17,18,19,20,29,30,35],[2,47]),{1:[2,1]},{2:11,4:40,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:41,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:42,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:45,6:3,7:4,8:$V0,10:[1,43],11:$V1,12:$V2,15:[1,44],17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:47,6:3,7:4,8:$V0,10:[1,46],11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:48,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:49,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:50,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:51,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:52,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{31:[1,53]},o($Vn,[2,46]),{9:$Vb,10:$Vc,11:$Vd,13:[1,54],14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk},o($Vo,[2,19],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,20],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:57,6:3,7:4,8:$V0,11:$V1,12:$V2,13:[1,55],17:$V3,21:$V4,22:56,23:10,24:$V5,25:$V6,26:$V7,28:[1,58],31:$V8,33:$V9,35:$Va},o($Vl,[2,25]),{33:[1,59]},{24:[1,60],25:[1,61],26:[1,62]},{24:[1,63],25:[1,64],26:[1,65]},{24:[1,66],25:[1,67],26:[1,68]},o($Vl,[2,5]),o([5,10,13,29,30],[2,6],{9:$Vb,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,7],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:69,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:70,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vp,[2,14],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:71,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vp,[2,13],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o([5,10,13,16,29,30],[2,12],{9:$Vb,11:$Vd,14:$Ve,15:$Vf,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,15],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),o($Vq,[2,16],{9:$Vb,20:$Vk}),o($Vq,[2,17],{9:$Vb,20:$Vk}),o([5,10,11,13,14,15,16,17,18,19,20,29,30],[2,18],{9:$Vb}),o($Vm,[2,43]),o($Vl,[2,8]),o($Vl,[2,21]),{13:[1,72],29:[1,73],30:[1,74]},o($Vr,[2,38],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vr,[2,39]),o($Vn,[2,45]),o($Vl,[2,29]),o($Vl,[2,30]),o($Vl,[2,31]),o($Vl,[2,32]),o($Vl,[2,33]),o($Vl,[2,34]),o($Vl,[2,35]),o($Vl,[2,36]),o($Vl,[2,37]),o($Vp,[2,9],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vp,[2,11],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vp,[2,10],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vl,[2,22]),{2:11,4:75,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:76,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vr,[2,40],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vr,[2,41],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk})],defaultActions:{18:[2,1]},parseError:function(t,e){if(!e.recoverable){function n(t,e){this.message=t,this.hash=e}throw n.prototype=Error,new n(t,e)}this.trace(t)},parse:function(t){var e=this,r=[0],n=[null],i=[],o=this.table,a="",s=0,l=0,u=0,h=2,c=i.slice.call(arguments,1),d=Object.create(this.lexer),f={yy:{}};for(var p in this.yy)Object.prototype.hasOwnProperty.call(this.yy,p)&&(f.yy[p]=this.yy[p]);d.setInput(t,f.yy),f.yy.lexer=d,f.yy.parser=this,void 0===d.yylloc&&(d.yylloc={});var g=d.yylloc;i.push(g);var v=d.options&&d.options.ranges;"function"==typeof f.yy.parseError?this.parseError=f.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function m(){var t;return"number"!=typeof(t=d.lex()||1)&&(t=e.symbols_[t]||t),t}for(var y,w,b,C,E,S,O,T,N,R,_={};;){if(b=r[r.length-1],void 0===(C=this.defaultActions[b]?this.defaultActions[b]:(null==y&&(y=m()),o[b]&&o[b][y]))||!C.length||!C[0]){var M,A="";function k(t){for(var e=r.length-1,n=0;;){if(h.toString()in o[t])return n;if(0===t||e<2)return!1;t=r[e-=2],++n}}if(u)1!==w&&(M=k(b));else{for(S in M=k(b),N=[],o[b])this.terminals_[S]&&h<S&&N.push("'"+this.terminals_[S]+"'");A=d.showPosition?"Parse error on line "+(s+1)+":\n"+d.showPosition()+"\nExpecting "+N.join(", ")+", got '"+(this.terminals_[y]||y)+"'":"Parse error on line "+(s+1)+": Unexpected "+(1==y?"end of input":"'"+(this.terminals_[y]||y)+"'"),this.parseError(A,{text:d.match,token:this.terminals_[y]||y,line:d.yylineno,loc:g,expected:N,recoverable:!1!==M})}if(3==u){if(1===y||1===w)throw new Error(A||"Parsing halted while starting to recover from another error.");l=d.yyleng,a=d.yytext,s=d.yylineno,g=d.yylloc,y=m()}if(!1===M)throw new Error(A||"Parsing halted. No suitable error recovery rule available.");R=M,r.length=r.length-2*R,n.length=n.length-R,i.length=i.length-R,w=y==h?null:y,y=h,b=r[r.length-1],C=o[b]&&o[b][h],u=3}if(C[0]instanceof Array&&1<C.length)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+y);switch(C[0]){case 1:r.push(y),n.push(d.yytext),i.push(d.yylloc),r.push(C[1]),y=null,w?(y=w,w=null):(l=d.yyleng,a=d.yytext,s=d.yylineno,g=d.yylloc,0<u&&u--);break;case 2:if(O=this.productions_[C[1]][1],_.$=n[n.length-O],_._$={first_line:i[i.length-(O||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(O||1)].first_column,last_column:i[i.length-1].last_column},v&&(_._$.range=[i[i.length-(O||1)].range[0],i[i.length-1].range[1]]),void 0!==(E=this.performAction.apply(_,[a,l,s,f.yy,C[1],n,i].concat(c))))return E;O&&(r=r.slice(0,-1*O*2),n=n.slice(0,-1*O),i=i.slice(0,-1*O)),r.push(this.productions_[C[1]][0]),n.push(_.$),i.push(_._$),T=o[r[r.length-2]][r[r.length-1]],r.push(T);break;case 3:return!0}}return!0}},lexer={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(20<t.length?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(20<t.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var n,r,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(r=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],n=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var o in i)this[o]=i[o];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,n,r;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),o=0;o<i.length;o++)if((n=this._input.match(this.rules[i[o]]))&&(!e||n[0].length>e[0].length)){if(e=n,r=o,this.options.backtrack_lexer){if(!1!==(t=this.test_match(n,i[o])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,i[r]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return 0<=(t=this.conditionStack.length-1-Math.abs(t||0))?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,n){switch(n){case 0:break;case 1:case 2:return 8;case 3:return 21;case 4:return 35;case 5:return 24;case 6:case 7:return 26;case 8:return 25;case 9:return 21;case 10:case 11:return 31;case 12:return 33;case 13:return 28;case 14:return 9;case 15:return" ";case 16:return 32;case 17:return 27;case 18:return 29;case 19:return 30;case 20:return 18;case 21:return 19;case 22:return 17;case 23:return 11;case 24:return 20;case 25:return 12;case 26:return 13;case 27:return 15;case 28:return 14;case 29:return 16;case 30:return'"';case 31:return"'";case 32:return"!";case 33:return 10;case 34:return 34;case 35:return"#";case 36:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/,/^(?:#[A-Z0-9\/]+(!|\?)?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z\.]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],inclusive:!0}}};function Parser(){this.yy={}}return parser.lexer=lexer,Parser.prototype=parser,parser.Parser=Parser,new Parser}();exports.parser=grammarParser,exports.Parser=grammarParser.Parser,exports.parse=function(){return grammarParser.parse.apply(grammarParser,arguments)},void 0!==module&&__webpack_require__.c[__webpack_require__.s]===module&&exports.main(process.argv.slice(1))}).call(exports,__webpack_require__(42)(module),__webpack_require__(10))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";e.__esModule=!0,e.trimEdges=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return t=t.substring(e,t.length-e)}}],Tr={},Ur.m=Sr,Ur.c=Tr,Ur.d=function(t,e,n){Ur.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},Ur.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return Ur.d(e,"a",e),e},Ur.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},Ur.p="",Ur(Ur.s=16);function Ur(t){if(Tr[t])return Tr[t].exports;var e=Tr[t]={i:t,l:!1,exports:{}};return Sr[t].call(e.exports,e,e.exports,Ur),e.l=!0,e.exports}var Sr,Tr}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("moment"),require("pikaday"),require("numbro"),require("hot-formula-parser")):"function"==typeof define&&define.amd?define("Handsontable",["moment","pikaday","numbro","hot-formula-parser"],e):"object"==typeof exports?exports.Handsontable=e(require("moment"),require("pikaday"),require("numbro"),require("hot-formula-parser")):t.Handsontable=e(t.moment,t.Pikaday,t.numbro,t.formulaParser)}("undefined"!=typeof self?self:this,function(n,r,i,o){return(l={},a.m=s=[function(t,e,n){"use strict";function r(t,e,n,r){var i=-1,o=t,a=n;Array.isArray(t)||(o=Array.from(t));var s=o.length;for(r&&s&&(a=o[i+=1]),i+=1;i<s;)a=e(a,o[i],i,o),i+=1;return a}function i(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));for(var i=r.length;n<i&&!1!==e(r[n],n,r);)n+=1;return t}function o(t){return r(t,function(t,e){return t+e},0)}e.__esModule=!0,e.to2dArray=function(t){var e=t.length,n=0;for(;n<e;)t[n]=[t[n]],n+=1},e.extendArray=function(t,e){var n=e.length,r=0;for(;r<n;)t.push(e[r]),r+=1},e.pivot=function(t){var e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;for(var n=t.length,r=t[0].length,i=0;i<n;i++)for(var o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e},e.arrayReduce=r,e.arrayFilter=function(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));var i=r.length,o=[],a=-1;for(;n<i;){var s=r[n];e(s,n,r)&&(o[a+=1]=s),n+=1}return o},e.arrayMap=function(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));var i=r.length,o=[],a=-1;for(;n<i;){var s=r[n];o[a+=1]=e(s,n,r),n+=1}return o},e.arrayEach=i,e.arraySum=o,e.arrayMax=function(t){return r(t,function(t,e){return e<t?t:e},Array.isArray(t)?t[0]:void 0)},e.arrayMin=function(t){return r(t,function(t,e){return t<e?t:e},Array.isArray(t)?t[0]:void 0)},e.arrayAvg=function(t){return t.length?o(t)/t.length:0},e.arrayFlatten=function n(t){return r(t,function(t,e){return t.concat(Array.isArray(e)?n(e):e)},[])},e.arrayUnique=function(t){var e=[];return i(t,function(t){-1===e.indexOf(t)&&e.push(t)}),e}},function(t,e,n){"use strict";e.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.duckSchema=function n(t){var r=void 0;Array.isArray(t)?r=[]:(r={},h(t,function(t,e){"__children"!==e&&(t&&"object"===(void 0===t?"undefined":o(t))&&!Array.isArray(t)?r[e]=n(t):Array.isArray(t)?t.length&&"object"===o(t[0])&&!Array.isArray(t[0])?r[e]=[n(t[0])]:r[e]=[]:r[e]=null)}));return r},e.inherit=function(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t},e.extend=function(n,t){return h(t,function(t,e){n[e]=t}),n},e.deepExtend=function n(r,i){h(i,function(t,e){i[e]&&"object"===o(i[e])?(r[e]||(Array.isArray(i[e])?r[e]=[]:"[object Date]"===Object.prototype.toString.call(i[e])?r[e]=i[e]:r[e]={}),n(r[e],i[e])):r[e]=i[e]})},e.deepClone=l,e.clone=function(t){var n={};return h(t,function(t,e){n[e]=t}),n},e.mixin=function(s){s.MIXINS||(s.MIXINS=[]);for(var t=arguments.length,e=Array(1<t?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];return(0,r.arrayEach)(e,function(t){s.MIXINS.push(t.MIXIN_NAME),h(t,function(t,e){if(void 0!==s.prototype[e])throw new Error("Mixin conflict. Property '"+e+"' already exist and cannot be overwritten.");if("function"==typeof t)s.prototype[e]=t;else{Object.defineProperty(s.prototype,e,{get:(i=e,o=t,a="_"+i,function(){return void 0===this[a]&&(this[a]=function(t){var e=t;return(Array.isArray(e)||u(e))&&(e=l(e)),e}(o)),this[a]}),set:(n=e,r="_"+n,function(t){this[r]=t}),configurable:!0})}var n,r,i,o,a})}),s},e.isObjectEqual=function(t,e){return JSON.stringify(t)===JSON.stringify(e)},e.isObject=u,e.defineGetter=function(t,e,n,r){r.value=n,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(t,e,r)},e.objectEach=h,e.getProperty=function(t,e){var n=e.split("."),r=t;return h(n,function(t){if(void 0===(r=r[t]))return r=void 0,!1}),r},e.deepObjectSize=function(t){return u(t)?function e(t){var n=0;return u(t)?h(t,function(t){n+=e(t)}):n+=1,n}(t):0},e.createObjectPropListener=function(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"value",r="_"+n,i=(a(e={_touched:!1},r,t),a(e,"isTouched",function(){return this._touched}),e);return Object.defineProperty(i,n,{get:function(){return this[r]},set:function(t){this._touched=!0,this[r]=t},enumerable:!0,configurable:!0}),i},e.hasOwnProperty=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};var r=n(0);function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t){return"object"===(void 0===t?"undefined":o(t))?JSON.parse(JSON.stringify(t)):t}function u(t){return"[object Object]"===Object.prototype.toString.call(t)}function h(t,e){for(var n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&!1===e(t[n],n,t))break;return t}},function(t,e,n){"use strict";e.__esModule=!0,e.HTML_CHARACTERS=void 0,e.getParent=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null,i=t;for(;null!==i;){if(n===e){r=i;break}i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:(n+=1,i.parentNode)}return r},e.closest=a,e.closestDown=function(t,e,n){var r=[],i=t;for(;(i=i&&a(i,e,n))&&(!n||n.contains(i));)r.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode;var o=r.length;return o?r[o-1]:null},e.isChildOf=function(t,e){var n=t.parentNode,r=[];"string"==typeof e?r=Array.prototype.slice.call(document.querySelectorAll(e),0):r.push(e);for(;null!==n;){if(-1<r.indexOf(n))return!0;n=n.parentNode}return!1},e.isChildOfWebComponentTable=function(t){var e="hot-table",n=!1,r=l(t);function i(t){return t.nodeType===Node.ELEMENT_NODE&&t.nodeName===e.toUpperCase()}for(;null!==r;){if(i(r)){n=!0;break}if(r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n=i(r.host))break;r=r.host}r=r.parentNode}return n},e.polymerWrap=l,e.polymerUnwrap=i,e.index=function(t){var e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e},e.overlayContainsElement=function(t,e){var n=document.querySelector(".ht_clone_"+t);return n?n.contains(e):null},e.hasClass=function(t,e){return c(t,e)},e.addClass=function(t,e){return d(t,e)},e.removeClass=function(t,e){return f(t,e)},e.removeTextNodes=function t(e,n){if(3===e.nodeType)n.removeChild(e);else if(-1<["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName))for(var r=e.childNodes,i=r.length-1;0<=i;i--)t(r[i],e)},e.empty=m,e.fastInnerHTML=function(t,e){y.test(e)?t.innerHTML=e:C(t,e)},e.fastInnerText=C,e.isVisible=function t(e){var n=e;for(;i(n)!==document.documentElement;){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return t(n.host.impl);if(n.host)return t(n.host);throw new Error("Lost in Web Components world")}return!1}if("none"===n.style.display)return!1;n=n.parentNode}return!0},e.offset=function(t){var e=document.documentElement,n=t,r=void 0,i=void 0,o=void 0,a=void 0;if((0,s.hasCaptionProblem)()&&n.firstChild&&"CAPTION"===n.firstChild.nodeName)return{top:(a=n.getBoundingClientRect()).top+(window.pageYOffset||e.scrollTop)-(e.clientTop||0),left:a.left+(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0)};r=n.offsetLeft,i=n.offsetTop,o=n;for(;(n=n.offsetParent)&&n!==document.body;)r+=n.offsetLeft,i+=n.offsetTop,o=n;o&&"fixed"===o.style.position&&(r+=window.pageXOffset||e.scrollLeft,i+=window.pageYOffset||e.scrollTop);return{left:r,top:i}},e.getWindowScrollTop=E,e.getWindowScrollLeft=S,e.getScrollTop=function(t){return t!==window?t.scrollTop:E()},e.getScrollLeft=function(t){return t!==window?t.scrollLeft:S()},e.getScrollableElement=function(t){var e=["auto","scroll"],n=t.parentNode,r=void 0,i=void 0,o=void 0,a="",s="",l="",u="";for(;n&&n.style&&document.body!==n;){if(r=n.style.overflow,i=n.style.overflowX,o=n.style.overflowY,"scroll"===r||"scroll"===i||"scroll"===o)return n;if(window.getComputedStyle&&(a=window.getComputedStyle(n),s=a.getPropertyValue("overflow"),l=a.getPropertyValue("overflow-y"),u=a.getPropertyValue("overflow-x"),"scroll"===s||"scroll"===u||"scroll"===l))return n;if(n.clientHeight<=n.scrollHeight+1&&(-1!==e.indexOf(o)||-1!==e.indexOf(r)||-1!==e.indexOf(s)||-1!==e.indexOf(l)))return n;if(n.clientWidth<=n.scrollWidth+1&&(-1!==e.indexOf(i)||-1!==e.indexOf(r)||-1!==e.indexOf(s)||-1!==e.indexOf(u)))return n;n=n.parentNode}return window},e.getTrimmingContainer=function(t){var e=t.parentNode;for(;e&&e.style&&document.body!==e;){if("visible"!==e.style.overflow&&""!==e.style.overflow)return e;var n=O(e),r=["scroll","hidden","auto"],i=n.getPropertyValue("overflow"),o=n.getPropertyValue("overflow-y"),a=n.getPropertyValue("overflow-x");if(r.includes(i)||r.includes(o)||r.includes(a))return e;e=e.parentNode}return window},e.getStyle=function(t,e){{if(!t)return;if(t===window)return"width"===e?window.innerWidth+"px":"height"===e?window.innerHeight+"px":void 0}var n,r=t.style[e];{if(""!==r&&void 0!==r)return r;if(""!==(n=O(t))[e]&&void 0!==n[e])return n[e]}},e.getComputedStyle=O,e.outerWidth=function(t){return t.offsetWidth},e.outerHeight=function(t){if((0,s.hasCaptionProblem)()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName)return t.offsetHeight+t.firstChild.offsetHeight;return t.offsetHeight},e.innerHeight=function(t){return t.clientHeight||t.innerHeight},e.innerWidth=function(t){return t.clientWidth||t.innerWidth},e.addEvent=function(t,e,n){window.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)},e.removeEvent=function(t,e,n){window.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent("on"+e,n)},e.getCaretPosition=function(t){{if(t.selectionStart)return t.selectionStart;if(document.selection){t.focus();var e=document.selection.createRange();if(null==e)return 0;var n=t.createTextRange(),r=n.duplicate();return n.moveToBookmark(e.getBookmark()),r.setEndPoint("EndToStart",n),r.text.length}}return 0},e.getSelectionEndPosition=function(t){{if(t.selectionEnd)return t.selectionEnd;if(document.selection){var e=document.selection.createRange();return null==e?0:t.createTextRange().text.indexOf(e.text)+e.text.length}}return 0},e.getSelectionText=function(){var t="";window.getSelection?t=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(t=document.selection.createRange().text);return t},e.setCaretPosition=function(e,n,r){void 0===r&&(r=n);if(e.setSelectionRange){e.focus();try{e.setSelectionRange(n,r)}catch(t){var i=e.parentNode,o=i.style.display;i.style.display="block",e.setSelectionRange(n,r),i.style.display=o}}else if(e.createTextRange){var t=e.createTextRange();t.collapse(!0),t.moveEnd("character",r),t.moveStart("character",n),t.select()}},e.getScrollbarWidth=function(){void 0===w&&(w=function(){var t=document.createElement("div");t.style.height="200px",t.style.width="100%";var e=document.createElement("div");e.style.boxSizing="content-box",e.style.height="150px",e.style.left="0px",e.style.overflow="hidden",e.style.position="absolute",e.style.top="0px",e.style.width="200px",e.style.visibility="hidden",e.appendChild(t),(document.body||document.documentElement).appendChild(e);var n=t.offsetWidth;e.style.overflow="scroll";var r=t.offsetWidth;n==r&&(r=e.clientWidth);return(document.body||document.documentElement).removeChild(e),n-r}());return w},e.hasVerticalScrollbar=function(t){return t.offsetWidth!==t.clientWidth},e.hasHorizontalScrollbar=function(t){return t.offsetHeight!==t.clientHeight},e.setOverlayPosition=function(t,e,n){(0,r.isIE8)()||(0,r.isIE9)()?(t.style.top=n,t.style.left=e):(0,r.isSafari)()?t.style["-webkit-transform"]="translate3d("+e+","+n+",0)":t.style.transform="translate3d("+e+","+n+",0)"},e.getCssTransform=function(t){var e=void 0;{if(t.style.transform&&""!==(e=t.style.transform))return["transform",e];if(t.style["-webkit-transform"]&&""!==(e=t.style["-webkit-transform"]))return["-webkit-transform",e]}return-1},e.resetCssTransform=function(t){t.style.transform&&""!==t.style.transform?t.style.transform="":t.style["-webkit-transform"]&&""!==t.style["-webkit-transform"]&&(t.style["-webkit-transform"]="")},e.isInput=T,e.isOutsideInput=function(t){return T(t)&&-1==t.className.indexOf("handsontableInput")&&-1==t.className.indexOf("copyPaste")};var r=n(42),s=n(43);function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function a(t,e,n){for(var r=t;null!==r&&r!==n;){if(r.nodeType===Node.ELEMENT_NODE&&(-1<e.indexOf(r.nodeName)||-1<e.indexOf(r)))return r;r=r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r.host:r.parentNode}return null}function l(t){return"undefined"!=typeof Polymer&&"function"==typeof wrap?wrap(t):t}function i(t){return"undefined"!=typeof Polymer&&"function"==typeof unwrap?unwrap(t):t}var u,h=!!document.documentElement.classList,c=void 0,d=void 0,f=void 0;function p(t){var e=[];if(!t||!t.length)return e;for(var n=0;t[n];)e.push(t[n]),n+=1;return e}if(h){var g=((u=document.createElement("div")).classList.add("test","test2"),u.classList.contains("test2"));c=function(t,e){return void 0!==t.classList&&"string"==typeof e&&""!==e&&t.classList.contains(e)},d=function(t,e){var n,r=e;if("string"==typeof r&&(r=r.split(" ")),0<(r=p(r)).length)if(g)(n=t.classList).add.apply(n,o(r));else for(var i=0;r&&r[i];)t.classList.add(r[i]),i+=1},f=function(t,e){var n,r=e;if("string"==typeof r&&(r=r.split(" ")),0<(r=p(r)).length)if(g)(n=t.classList).remove.apply(n,o(r));else for(var i=0;r&&r[i];)t.classList.remove(r[i]),i+=1}}else{var v=function(t){return new RegExp("(\\s|^)"+t+"(\\s|$)")};c=function(t,e){return void 0!==t.className&&v(e).test(t.className)},d=function(t,e){var n=0,r=t.className,i=e;if("string"==typeof i&&(i=i.split(" ")),""===r)r=i.join(" ");else for(;i&&i[n];)v(i[n]).test(r)||(r+=" "+i[n]),n+=1;t.className=r},f=function(t,e){var n=0,r=t.className,i=e;for("string"==typeof i&&(i=i.split(" "));i&&i[n];)r=r.replace(v(i[n])," ").trim(),n+=1;t.className!==r&&(t.className=r)}}function m(t){for(var e=void 0;e=t.lastChild;)t.removeChild(e)}var y=e.HTML_CHARACTERS=/(<(.*)>|&(.*);)/;var w,b=!!document.createTextNode("test").textContent;function C(t,e){var n=t.firstChild;n&&3===n.nodeType&&null===n.nextSibling?b?n.textContent=e:n.data=e:(m(t),t.appendChild(document.createTextNode(e)))}function E(){var t=window.scrollY;return void 0===t&&(t=document.documentElement.scrollTop),t}function S(){var t=window.scrollX;return void 0===t&&(t=document.documentElement.scrollLeft),t}function O(t){return t.currentStyle||document.defaultView.getComputedStyle(t)}function T(t){return t&&(-1<["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)||"true"===t.contentEditable)}},function(t,e,n){"use strict";e.__esModule=!0;var r=e.CONTEXT_MENU_ITEMS_NAMESPACE="ContextMenu:items",i=(e.CONTEXTMENU_ITEMS_ROW_ABOVE=r+".insertRowAbove",e.CONTEXTMENU_ITEMS_ROW_BELOW=r+".insertRowBelow",e.CONTEXTMENU_ITEMS_INSERT_LEFT=r+".insertColumnOnTheLeft",e.CONTEXTMENU_ITEMS_INSERT_RIGHT=r+".insertColumnOnTheRight",e.CONTEXTMENU_ITEMS_REMOVE_ROW=r+".removeRow",e.CONTEXTMENU_ITEMS_REMOVE_COLUMN=r+".removeColumn",e.CONTEXTMENU_ITEMS_UNDO=r+".undo",e.CONTEXTMENU_ITEMS_REDO=r+".redo",e.CONTEXTMENU_ITEMS_READ_ONLY=r+".readOnly",e.CONTEXTMENU_ITEMS_CLEAR_COLUMN=r+".clearColumn",e.CONTEXTMENU_ITEMS_COPY=r+".copy",e.CONTEXTMENU_ITEMS_CUT=r+".cut",e.CONTEXTMENU_ITEMS_FREEZE_COLUMN=r+".freezeColumn",e.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=r+".unfreezeColumn",e.CONTEXTMENU_ITEMS_MERGE_CELLS=r+".mergeCells",e.CONTEXTMENU_ITEMS_UNMERGE_CELLS=r+".unmergeCells",e.CONTEXTMENU_ITEMS_ADD_COMMENT=r+".addComment",e.CONTEXTMENU_ITEMS_EDIT_COMMENT=r+".editComment",e.CONTEXTMENU_ITEMS_REMOVE_COMMENT=r+".removeComment",e.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=r+".readOnlyComment",e.CONTEXTMENU_ITEMS_ALIGNMENT=r+".align",e.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=r+".align.left",e.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=r+".align.center",e.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=r+".align.right",e.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=r+".align.justify",e.CONTEXTMENU_ITEMS_ALIGNMENT_TOP=r+".align.top",e.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=r+".align.middle",e.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=r+".align.bottom",e.CONTEXTMENU_ITEMS_BORDERS=r+".borders",e.CONTEXTMENU_ITEMS_BORDERS_TOP=r+".borders.top",e.CONTEXTMENU_ITEMS_BORDERS_RIGHT=r+".borders.right",e.CONTEXTMENU_ITEMS_BORDERS_BOTTOM=r+".borders.bottom",e.CONTEXTMENU_ITEMS_BORDERS_LEFT=r+".borders.left",e.CONTEXTMENU_ITEMS_REMOVE_BORDERS=r+".borders.remove",e.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=r+".nestedHeaders.insertChildRow",e.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=r+".nestedHeaders.detachFromParent",e.CONTEXTMENU_ITEMS_HIDE_COLUMN=r+".hideColumn",e.CONTEXTMENU_ITEMS_SHOW_COLUMN=r+".showColumn",e.CONTEXTMENU_ITEMS_HIDE_ROW=r+".hideRow",e.CONTEXTMENU_ITEMS_SHOW_ROW=r+".showRow",e.FILTERS_NAMESPACE="Filters:"),o=e.FILTERS_CONDITIONS_NAMESPACE=i+"conditions";e.FILTERS_CONDITIONS_NONE=o+".none",e.FILTERS_CONDITIONS_EMPTY=o+".isEmpty",e.FILTERS_CONDITIONS_NOT_EMPTY=o+".isNotEmpty",e.FILTERS_CONDITIONS_EQUAL=o+".isEqualTo",e.FILTERS_CONDITIONS_NOT_EQUAL=o+".isNotEqualTo",e.FILTERS_CONDITIONS_BEGINS_WITH=o+".beginsWith",e.FILTERS_CONDITIONS_ENDS_WITH=o+".endsWith",e.FILTERS_CONDITIONS_CONTAINS=o+".contains",e.FILTERS_CONDITIONS_NOT_CONTAIN=o+".doesNotContain",e.FILTERS_CONDITIONS_BY_VALUE=o+".byValue",e.FILTERS_CONDITIONS_GREATER_THAN=o+".greaterThan",e.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=o+".greaterThanOrEqualTo",e.FILTERS_CONDITIONS_LESS_THAN=o+".lessThan",e.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=o+".lessThanOrEqualTo",e.FILTERS_CONDITIONS_BETWEEN=o+".isBetween",e.FILTERS_CONDITIONS_NOT_BETWEEN=o+".isNotBetween",e.FILTERS_CONDITIONS_AFTER=o+".after",e.FILTERS_CONDITIONS_BEFORE=o+".before",e.FILTERS_CONDITIONS_TODAY=o+".today",e.FILTERS_CONDITIONS_TOMORROW=o+".tomorrow",e.FILTERS_CONDITIONS_YESTERDAY=o+".yesterday",e.FILTERS_DIVS_FILTER_BY_CONDITION=i+"labels.filterByCondition",e.FILTERS_DIVS_FILTER_BY_VALUE=i+"labels.filterByValue",e.FILTERS_LABELS_CONJUNCTION=i+"labels.conjunction",e.FILTERS_LABELS_DISJUNCTION=i+"labels.disjunction",e.FILTERS_VALUES_BLANK_CELLS=i+"values.blankCells",e.FILTERS_BUTTONS_SELECT_ALL=i+"buttons.selectAll",e.FILTERS_BUTTONS_CLEAR=i+"buttons.clear",e.FILTERS_BUTTONS_OK=i+"buttons.ok",e.FILTERS_BUTTONS_CANCEL=i+"buttons.cancel",e.FILTERS_BUTTONS_PLACEHOLDER_SEARCH=i+"buttons.placeholder.search",e.FILTERS_BUTTONS_PLACEHOLDER_VALUE=i+"buttons.placeholder.value",e.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=i+"buttons.placeholder.secondValue"},function(t,e,n){"use strict";e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.isNumeric=function(t){var e=void 0===t?"undefined":r(t);return"number"==e?!isNaN(t)&&isFinite(t):"string"==e?!!t.length&&(1==t.length?/\d/.test(t):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(t)):"object"==e&&!(!t||"number"!=typeof t.valueOf()||t instanceof Date)},e.rangeEach=function(t,e,n){var r=-1;"function"==typeof e?(n=e,e=t):r=t-1;for(;++r<=e&&!1!==n(r););},e.rangeEachReverse=function(t,e,n){var r=t+1;"function"==typeof e&&(n=e,e=0);for(;--r>=e&&!1!==n(r););},e.valueAccordingPercent=function(t,e){return e=parseInt(e.toString().replace("%",""),10),e=parseInt(t*e/100,10)}},function(t,e,n){"use strict";e.__esModule=!0,e.getPluginName=e.getRegistredPluginNames=e.getPlugin=e.registerPlugin=void 0;var r,i=n(17),o=(r=i)&&r.__esModule?r:{default:r},a=n(1),s=n(31);var l=new WeakMap;e.registerPlugin=function(t,e){var n=(0,s.toUpperCaseFirst)(t);o.default.getSingleton().add("construct",function(){l.has(this)||l.set(this,{});var t=l.get(this);t[n]||(t[n]=new e(this))}),o.default.getSingleton().add("afterDestroy",function(){if(l.has(this)){var t=l.get(this);(0,a.objectEach)(t,function(t){return t.destroy()}),l.delete(this)}})},e.getPlugin=function(t,e){if("string"!=typeof e)throw Error('Only strings can be passed as "plugin" parameter');var n=(0,s.toUpperCaseFirst)(e);if(l.has(t)&&l.get(t)[n])return l.get(t)[n]},e.getRegistredPluginNames=function(t){return l.has(t)?Object.keys(l.get(t)):[]},e.getPluginName=function(t,n){var r=null;return l.has(t)&&(0,a.objectEach)(l.get(t),function(t,e){t===n&&(r=e)}),r}},function(t,e,n){var g=n(16),v=n(50),m=n(37),y=n(36),w=n(38),b="prototype",C=function(t,e,n){var r,i,o,a,s=t&C.F,l=t&C.G,u=t&C.S,h=t&C.P,c=t&C.B,d=l?g:u?g[e]||(g[e]={}):(g[e]||{})[b],f=l?v:v[e]||(v[e]={}),p=f[b]||(f[b]={});for(r in l&&(n=e),n)o=((i=!s&&d&&void 0!==d[r])?d:n)[r],a=c&&i?w(o,g):h&&"function"==typeof o?w(Function.call,o):o,d&&y(d,r,o,t&C.U),f[r]!=o&&m(f,r,a),h&&p[r]!=o&&(p[r]=o)};g.core=v,C.F=1,C.G=2,C.S=4,C.P=8,C.B=16,C.W=32,C.U=64,C.R=128,t.exports=C},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(1),a=n(0),s=n(55),l=n(5);var u=new WeakMap,h=null,c=(r(d,[{key:"init",value:function(){this.pluginName=(0,l.getPluginName)(this.hot,this),this.isEnabled&&this.isEnabled()&&this.enablePlugin(),0<=(h=h||(0,l.getRegistredPluginNames)(this.hot)).indexOf(this.pluginName)&&h.splice(h.indexOf(this.pluginName),1),h.length||this.hot.runHooks("afterPluginsInitialized"),this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(t,e){u.get(this).hooks[t]=u.get(this).hooks[t]||[];var n=u.get(this).hooks[t];this.hot.addHook(t,e),n.push(e),u.get(this).hooks[t]=n}},{key:"removeHooks",value:function(e){var n=this;(0,a.arrayEach)(u.get(this).hooks[e]||[],function(t){n.hot.removeHook(e,t)})}},{key:"clearHooks",value:function(){var n=this,t=u.get(this).hooks;(0,o.objectEach)(t,function(t,e){return n.removeHooks(e)}),t.length=0}},{key:"callOnPluginsReady",value:function(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}},{key:"onAfterPluginsInitialized",value:function(){(0,a.arrayEach)(this.pluginsInitializedCallbacks,function(t){return t()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var n=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),(0,o.objectEach)(this,function(t,e){"hot"!==e&&"t"!==e&&(n[e]=null)}),delete this.t,delete this.hot}}]),d);function d(t){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),(0,o.defineGetter)(this,"hot",t,{writable:!1}),(0,o.defineGetter)(this,"t",(0,s.getTranslator)(t),{writable:!1}),u.set(this,{hooks:{}}),h=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return e.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(t){return e.onUpdateSettings(t)}),this.hot.addHook("beforeInit",function(){return e.init()})}e.default=c},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.getListenersCounter=function(){return a};var u=n(2),h=n(1),c=n(43),d=n(12);var a=0,f=(r(o,[{key:"addEventListener",value:function(t,e,n){var r=this,i=this.context;function o(t){n.call(this,function(t,e){var n="HOT-TABLE",r=void 0,i=void 0,o=void 0,a=void 0,s=void 0;e.isTargetWebComponent=!1,e.realTarget=e.target;var l=e.stopImmediatePropagation;if(e.stopImmediatePropagation=function(){l.apply(this),(0,d.stopImmediatePropagation)(this)},!f.isHotTableEnv)return e;for(e=(0,u.polymerWrap)(e),s=e.path?e.path.length:0;s;){if(s-=1,e.path[s].nodeName===n)r=!0;else if(r&&e.path[s].shadowRoot){a=e.path[s];break}0!==s||a||(a=e.path[s])}return a=a||e.target,e.isTargetWebComponent=!0,(0,c.isWebComponentSupportedNatively)()?e.realTarget=e.srcElement||e.toElement:((0,h.hasOwnProperty)(t,"hot")||t.isHotTableEnv||t.wtTable)&&((0,h.hasOwnProperty)(t,"hot")?i=t.hot?t.hot.view.wt.wtTable.TABLE:null:t.isHotTableEnv?i=t.view.activeWt.wtTable.TABLE.parentNode.parentNode:t.wtTable&&(i=t.wtTable.TABLE.parentNode.parentNode),o=(0,u.closest)(e.target,[n],i),e.realTarget=o&&i.querySelector(n)||e.target),Object.defineProperty(e,"target",{get:function(){return(0,u.polymerWrap)(a)},enumerable:!0,configurable:!0}),e}(i,t))}return this.context.eventListeners.push({element:t,event:e,callback:n,callbackProxy:o}),window.addEventListener?t.addEventListener(e,o,!1):t.attachEvent("on"+e,o),a+=1,function(){r.removeEventListener(t,e,n)}}},{key:"removeEventListener",value:function(t,e,n){for(var r=this.context.eventListeners.length,i=void 0;r;)if(r-=1,(i=this.context.eventListeners[r]).event===e&&i.element===t){if(n&&n!==i.callback)continue;this.context.eventListeners.splice(r,1),i.element.removeEventListener?i.element.removeEventListener(i.event,i.callbackProxy,!1):i.element.detachEvent("on"+i.event,i.callbackProxy),a-=1}}},{key:"clearEvents",value:function(){if(this.context)for(var t=this.context.eventListeners.length;t;){t-=1;var e=this.context.eventListeners[t];e&&this.removeEventListener(e.element,e.event,e.callback)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"fireEvent",value:function(t,e){var n={bubbles:!0,cancelable:"mousemove"!==e,view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},r=void 0;document.createEvent?(r=document.createEvent("MouseEvents")).initMouseEvent(e,n.bubbles,n.cancelable,n.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget||document.body.parentNode):r=document.createEventObject(),t.dispatchEvent?t.dispatchEvent(r):t.fireEvent("on"+e,r)}}]),o);function o(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}e.default=f},function(t,e,n){"use strict";e.__esModule=!0,e.Viewport=e.TableRenderer=e.Table=e.Settings=e.Selection=e.Scroll=e.Overlays=e.Event=e.Core=e.default=e.Border=e.BottomLeftCornerOverlay=e.BottomOverlay=e.TopLeftCornerOverlay=e.TopOverlay=e.LeftOverlay=e.DebugOverlay=e.RowFilter=e.ColumnFilter=e.CellRange=e.CellCoords=e.ViewportRowsCalculator=e.ViewportColumnsCalculator=void 0,n(89),n(98),n(99),n(100),n(101),n(104),n(106),n(107),n(108),n(109),n(110),n(111),n(112),n(113),n(114),n(115),n(116),n(117),n(118),n(119),n(120),n(121),n(122),n(123),n(124),n(127),n(128),n(129),n(130),n(131),n(132),n(133),n(134),n(136),n(137),n(138),n(139),n(140),n(83),n(141),n(142),n(143),n(144),n(145),n(146),n(147),n(148),n(149),n(150),n(151),n(152),n(153),n(154),n(155);var r=T(n(194)),i=T(n(195)),o=T(n(65)),a=T(n(196)),s=T(n(197)),l=T(n(198)),u=T(n(262)),h=T(n(263)),c=T(n(264)),d=T(n(265)),f=T(n(266)),p=T(n(267)),g=T(n(207)),v=T(n(199)),m=T(n(200)),y=T(n(201)),w=T(n(202)),b=T(n(268)),C=T(n(203)),E=T(n(204)),S=T(n(205)),O=T(n(206));function T(t){return t&&t.__esModule?t:{default:t}}e.ViewportColumnsCalculator=r.default,e.ViewportRowsCalculator=i.default,e.CellCoords=o.default,e.CellRange=a.default,e.ColumnFilter=s.default,e.RowFilter=l.default,e.DebugOverlay=u.default,e.LeftOverlay=h.default,e.TopOverlay=c.default,e.TopLeftCornerOverlay=d.default,e.BottomOverlay=f.default,e.BottomLeftCornerOverlay=p.default,e.Border=g.default,e.default=v.default,e.Core=v.default,e.Event=m.default,e.Overlays=y.default,e.Scroll=w.default,e.Selection=b.default,e.Settings=C.default,e.Table=E.default,e.TableRenderer=S.default,e.Viewport=O.default},function(t,e,n){"use strict";e.__esModule=!0;var r,i,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=(r=["\n          Your license key of Handsontable Pro has expired.ââââ \n          Renew your maintenance plan at https://handsontable.com or downgrade to the previous version of the software.\n          "],i=["\n          Your license key of Handsontable Pro has expired.ââââ \n          Renew your maintenance plan at https://handsontable.com or downgrade to the previous version of the software.\n          "],Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(i)}})));e.stringify=function(t){var e=void 0;switch(void 0===t?"undefined":o(t)){case"string":case"number":e=""+t;break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString()}return e},e.isDefined=function(t){return void 0!==t},e.isUndefined=l,e.isEmpty=f,e.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},e._injectProductInfo=function(t,e){t=w(t||"");var n="",r=!0,i=function(t){var e=[][p],n=e;if(t[p]!==y("Z"))return!1;for(var r="",i="B<H4P+".split(""),o=y(i.shift());o;o=y(i.shift()||"A"))--o<""[p]?n|=(v(""+v(g(r)+(g(m(t,Math.abs(o),2))+[]).padStart(2,"0")))%97||2)>>1:r=m(t,o,o?1===i[p]?9:8:6);return n===e}(t),o=C(),a=f(t)||"trial"===t;if(a||i)if(i){var s=Math.floor((0,c.default)("14/11/2018","DD/MM/YYYY").toDate().getTime()/864e5),l=b(t);(45e3<l||l!==parseInt(l,10))&&(n="The license key provided to Handsontable Pro is invalid. Make sure you pass it correctly."),n||(l+1<s&&(n=(0,d.toSingleLine)(h)),r=l+15<s)}else n="Evaluation version of Handsontable Pro. Not licensed for use in a production environment.";else n="The license key provided to Handsontable Pro is invalid. Make sure you pass it correctly.";o&&(r=n=!1);n&&!E&&(console[a?"info":"warn"](n),E=!0);if(r&&e.parentNode){var u=document.createElement("div");u.id="hot-display-license-info",u.appendChild(document.createTextNode("Evaluation version of Handsontable Pro.")),u.appendChild(document.createElement("br")),u.appendChild(document.createTextNode("Not licensed for production use.")),e.parentNode.insertBefore(u,e.nextSibling)}};var a,s=n(32),c=(a=s)&&a.__esModule?a:{default:a},d=n(25);function l(t){return void 0===t}function f(t){return null===t||""===t||l(t)}var p="length",g=function(t){return parseInt(t,16)},v=function(t){return parseInt(t,10)},m=function(t,e,n){return t.substr(e,n)},y=function(t){return t.codePointAt(0)-65},w=function(t){return(""+t).replace(/\-/g,"")},b=function(t){return g(m(w(t),g("12"),y("F")))/(g(m(w(t),y("B"),~~![][p]))||9)},C=function(){return!0},E=!1},function(t,e,n){"use strict";e.__esModule=!0,e.getCondition=function(t,e){if(!a[t])throw Error('Filter condition "'+t+'" does not exist.');var n=a[t],r=n.condition,i=n.descriptor,o=e;i.inputValuesDecorator&&(o=i.inputValuesDecorator(o));return function(t){return r.apply(t.meta.instance,[].concat([t],[o]))}},e.getConditionDescriptor=function(t){if(a[t])return a[t].descriptor;throw Error('Filter condition "'+t+'" does not exist.')},e.registerCondition=function(t,e,n){n.key=t,a[t]={condition:e,descriptor:n}};var a=e.conditions={}},function(t,e,n){"use strict";e.__esModule=!0,e.stopImmediatePropagation=function(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0},e.isImmediatePropagationStopped=function(t){return!1===t.isImmediatePropagationEnabled},e.stopPropagation=function(t){"function"==typeof t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},e.pageX=function(t){if(t.pageX)return t.pageX;return t.clientX+(0,r.getWindowScrollLeft)()},e.pageY=function(t){if(t.pageY)return t.pageY;return t.clientY+(0,r.getWindowScrollTop)()},e.isRightClick=function(t){return 2===t.button},e.isLeftClick=function(t){return 0===t.button};var r=n(2)},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var r=n(95)("wks"),i=n(59),o=n(16).Symbol,a="function"==typeof o;(t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))}).store=r},function(t,e,n){"use strict";e.__esModule=!0,e.getRegisteredRenderers=e.getRegisteredRendererNames=e.hasRenderer=e.getRenderer=e.registerRenderer=void 0;var r=c(n(41)),i=c(n(278)),o=c(n(279)),a=c(n(280)),s=c(n(281)),l=c(n(282)),u=c(n(284)),h=c(n(285));function c(t){return t&&t.__esModule?t:{default:t}}var d=(0,r.default)("renderers"),f=d.register,p=d.getItem,g=d.hasItem,v=d.getNames,m=d.getValues;f("base",i.default),f("autocomplete",o.default),f("checkbox",a.default),f("html",s.default),f("numeric",l.default),f("password",u.default),f("text",h.default),e.registerRenderer=f,e.getRenderer=function(t){if("function"==typeof t)return t;if(!g(t))throw Error('No registered renderer found under "'+t+'" name');return p(t)},e.hasRenderer=g,e.getRegisteredRendererNames=v,e.getRegisteredRenderers=m},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=n(0),o=n(1);var a=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyCol","unmodifyCol","unmodifyRow","modifyColHeader","modifyColWidth","modifyRow","modifyRowHeader","modifyRowHeight","modifyData","modifyRowData","modifyGetCellCoords","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","skipLengthCache","afterTrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","hiddenColumn","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten"],l=(r(u,null,[{key:"getSingleton",value:function(){return h}}]),r(u,[{key:"createEmptyBucket",value:function(){var e=Object.create(null);return(0,s.arrayEach)(a,function(t){return e[t]=[]}),e}},{key:"getBucket",value:function(t){var e=0<arguments.length&&void 0!==t?t:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}},{key:"add",value:function(n,r,t){var e=this,i=2<arguments.length&&void 0!==t?t:null;if(Array.isArray(r))(0,s.arrayEach)(r,function(t){return e.add(n,t,i)});else{var o=this.getBucket(i);if(void 0===o[n]&&(this.register(n),o[n]=[]),r.skip=!1,-1===o[n].indexOf(r)){var a=!1;r.initialHook&&(0,s.arrayEach)(o[n],function(t,e){if(t.initialHook)return o[n][e]=r,!(a=!0)}),a||o[n].push(r)}}return this}},{key:"once",value:function(e,t,n){var r=this,i=2<arguments.length&&void 0!==n?n:null;Array.isArray(t)?(0,s.arrayEach)(t,function(t){return r.once(e,t,i)}):(t.runOnce=!0,this.add(e,t,i))}},{key:"remove",value:function(t,e,n){var r=2<arguments.length&&void 0!==n?n:null,i=this.getBucket(r);return void 0!==i[t]&&0<=i[t].indexOf(e)&&(e.skip=!0)}},{key:"has",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:null,r=this.getBucket(n);return!(void 0===r[t]||!r[t].length)}},{key:"run",value:function(t,e,n,r,i,o,a,s){var l=this.globalBucket[e],u=l?l.length:0,h=0;if(u)for(;h<u;)if(l[h]&&!l[h].skip){var c=l[h].call(t,n,r,i,o,a,s);void 0!==c&&(n=c),l[h]&&l[h].runOnce&&this.remove(e,l[h]),h+=1}else h+=1;var d=this.getBucket(t)[e],f=d?d.length:0,p=0;if(f)for(;p<f;)if(d[p]&&!d[p].skip){var g=d[p].call(t,n,r,i,o,a,s);void 0!==g&&(n=g),d[p]&&d[p].runOnce&&this.remove(e,d[p],t),p+=1}else p+=1;return n}},{key:"destroy",value:function(t){var e=0<arguments.length&&void 0!==t?t:null;(0,o.objectEach)(this.getBucket(e),function(t,e,n){return n[e].length=0})}},{key:"register",value:function(t){this.isRegistered(t)||a.push(t)}},{key:"deregister",value:function(t){this.isRegistered(t)&&a.splice(a.indexOf(t),1)}},{key:"isRegistered",value:function(t){return 0<=a.indexOf(t)}},{key:"getRegistered",value:function(){return a}}]),u);function u(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),this.globalBucket=this.createEmptyBucket()}var h=new l;e.default=l},function(t,e,n){"use strict";e.__esModule=!0,e.KEY_CODES=void 0,e.isPrintableChar=function(t){return 32===t||48<=t&&t<=57||96<=t&&t<=111||186<=t&&t<=192||219<=t&&t<=222||226<=t||65<=t&&t<=90},e.isMetaKey=function(t){return-1!==[o.ARROW_DOWN,o.ARROW_UP,o.ARROW_LEFT,o.ARROW_RIGHT,o.HOME,o.END,o.DELETE,o.BACKSPACE,o.F1,o.F2,o.F3,o.F4,o.F5,o.F6,o.F7,o.F8,o.F9,o.F10,o.F11,o.F12,o.TAB,o.PAGE_DOWN,o.PAGE_UP,o.ENTER,o.ESCAPE,o.SHIFT,o.CAPS_LOCK,o.ALT].indexOf(t)},e.isCtrlKey=function(t){var e=[];window.navigator.platform.includes("Mac")?e.push(o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX):e.push(o.CONTROL);return e.includes(t)},e.isCtrlMetaKey=function(t){return[o.CONTROL,o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX].includes(t)},e.isKey=function(e,t){var n=t.split("|"),r=!1;return(0,i.arrayEach)(n,function(t){if(e===o[t])return!(r=!0)}),r};var i=n(0),o=e.KEY_CODES={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL:17,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88}},function(t,e,n){"use strict";e.__esModule=!0,e.getRegisteredEditors=e.getRegisteredEditorNames=e.hasEditor=e.getEditorInstance=e.getEditor=e.registerEditor=void 0,e.RegisteredEditor=S,e._getEditorInstance=O;var r=g(n(41)),i=g(n(17)),o=g(n(64)),a=g(n(208)),s=g(n(270)),l=g(n(271)),u=g(n(274)),h=g(n(209)),c=g(n(275)),d=g(n(276)),f=g(n(277)),p=g(n(66));function g(t){return t&&t.__esModule?t:{default:t}}var v=new WeakMap,m=(0,r.default)("editors"),y=m.register,w=m.getItem,b=m.hasItem,C=m.getNames,E=m.getValues;function S(t){var e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new n(t)),e[t.guid]},i.default.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function O(t,e){var n=void 0;if("function"==typeof t)v.get(t)||T(null,t),n=v.get(t);else{if("string"!=typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');n=w(t)}if(!n)throw Error('No editor registered under name "'+t+'"');return n.getInstance(e)}function T(t,e){var n=new S(e);"string"==typeof t&&y(t,n),v.set(e,n)}T("base",o.default),T("autocomplete",a.default),T("checkbox",s.default),T("date",l.default),T("dropdown",u.default),T("handsontable",h.default),T("numeric",c.default),T("password",d.default),T("select",f.default),T("text",p.default),e.registerEditor=T,e.getEditor=function(t){if(!b(t))throw Error('No registered editor found under "'+t+'" name');return w(t).getConstructor()},e.getEditorInstance=O,e.hasEditor=b,e.getRegisteredEditorNames=C,e.getRegisteredEditors=E},function(t,e,n){"use strict";e.__esModule=!0;var o=n(0),r=n(1),i={_localHooks:Object.create(null),addLocalHook:function(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks:function(t){for(var e=this,n=arguments.length,r=Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this._localHooks[t]&&(0,o.arrayEach)(this._localHooks[t],function(t){return t.apply(e,r)})},clearLocalHooks:function(){return this._localHooks={},this}};(0,r.defineGetter)(i,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),e.default=i},function(t,e,n){var r=n(13);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){"use strict";e.__esModule=!0,e.log=function(){var t;(0,r.isDefined)(console)&&(t=console).log.apply(t,arguments)},e.warn=function(){var t;(0,r.isDefined)(console)&&(t=console).warn.apply(t,arguments)},e.info=function(){var t;(0,r.isDefined)(console)&&(t=console).info.apply(t,arguments)},e.error=function(){var t;(0,r.isDefined)(console)&&(t=console).error.apply(t,arguments)};var r=n(10)},function(t,e,n){"use strict";e.__esModule=!0,e.normalizeSelection=function(t){return(0,i.arrayMap)(t,function(t){return{start:t.getTopLeftCorner(),end:t.getBottomRightCorner()}})},e.isSeparator=function(t){return(0,r.hasClass)(t,"htSeparator")},e.hasSubMenu=function(t){return(0,r.hasClass)(t,"htSubmenu")},e.isDisabled=function(t){return(0,r.hasClass)(t,"htDisabled")},e.isSelectionDisabled=function(t){return(0,r.hasClass)(t,"htSelectionDisabled")},e.getValidSelection=function(t){var e=t.getSelected();if(!e)return null;if(e[0]<0)return null;return e},e.prepareVerticalAlignClass=l,e.prepareHorizontalAlignClass=u,e.getAlignmentClasses=function(t,o){var a={};return(0,i.arrayEach)(t,function(t){for(var e=t.from,n=t.to,r=e.row;r<=n.row;r++)for(var i=e.col;i<=n.col;i++)a[r]||(a[r]=[]),a[r][i]=o(r,i)}),a},e.align=function(t,o,a,s,l){(0,i.arrayEach)(t,function(t){var e=t.from,n=t.to;if(e.row===n.row&&e.col===n.col)h(e.row,e.col,o,a,s,l);else for(var r=e.row;r<=n.row;r++)for(var i=e.col;i<=n.col;i++)h(r,i,o,a,s,l)})},e.checkSelectionConsistency=function(t,n){var r=!1;Array.isArray(t)&&(0,i.arrayEach)(t,function(t){return t.forAll(function(t,e){if(n(t,e))return!(r=!0)}),r});return r},e.markLabelAsSelected=function(t){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+t},e.isItemHidden=function(t,e){return!t.hidden||!("function"==typeof t.hidden&&t.hidden.call(e))},e.filterSeparators=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:o.KEY,n=t.slice(0);return n=function(t){var n=[];return(0,i.arrayEach)(t,function(t,e){0<e?n[n.length-1].name!==t.name&&n.push(t):n.push(t)}),n}(n=function(t,e){var n=t.slice(0);return n.reverse(),(n=a(n,e)).reverse(),n}(n=a(n,e),e))};var i=n(0),r=n(2),o=n(161);function l(t,e){return-1!==t.indexOf(e)?t:t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")+" "+e}function u(t,e){return-1!==t.indexOf(e)?t:t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")+" "+e}function h(t,e,n,r,i,o){var a=i(t,e),s=r;a.className&&(s="vertical"===n?l(a.className,r):u(a.className,r)),o(t,e,"className",s)}function a(t,e){for(var n=t.slice(0);0<n.length&&n[0].name===e;)n.shift();return n}},function(t,e,n){var r=n(21),i=n(170),o=n(91),a=Object.defineProperty;e.f=n(26)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){"use strict";e.__esModule=!0,e.toSingleLine=function(t){for(var e=arguments.length,r=Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return(0,i.arrayReduce)(t,function(t,e,n){return t+e.replace(/(?:\r?\n\s+)/g,"")+(r[n]?r[n]:"")},"").trim()};var i=n(0)},function(t,e,n){t.exports=!n(27)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(93),i=n(49);t.exports=function(t){return r(i(t))}},function(t,e,n){var r=n(72),i=Math.min;t.exports=function(t){return 0<t?i(r(t),9007199254740991):0}},function(t,e,n){var i=n(6),o=n(50),a=n(27);t.exports=function(t,e){var n=(o.Object||{})[t]||Object[t],r={};r[t]=e(n),i(i.S+i.F*a(function(){n(1)}),"Object",r)}},function(t,e,n){"use strict";e.__esModule=!0,e.toUpperCaseFirst=function(t){return t[0].toUpperCase()+t.substr(1)},e.equalsIgnoreCase=function(){for(var t=[],e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n.length;for(;i;){i-=1;var o=(0,a.stringify)(n[i]).toLowerCase();-1===t.indexOf(o)&&t.push(o)}return 1===t.length},e.randomString=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()},e.isPercentValue=function(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)},e.substitute=function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return(""+t).replace(/(?:\\)?\[([^[\]]+)]/g,function(t,e){return"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===n[e]?"":n[e]})},e.stripTags=function(t){return(""+t).replace(r,"")};var a=n(10);var r=/<\/?\w+\/?>|<\w+[\s|/][^>]*>/gi},function(t,e){t.exports=n},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(2),a=n(1),s=n(0),l=h(n(8)),u=h(n(199));function h(t){return t&&t.__esModule?t:{default:t}}var c={},d=(r(f,null,[{key:"registerOverlay",value:function(t,e){if(-1===f.CLONE_TYPES.indexOf(t))throw new Error("Unsupported overlay ("+t+").");c[t]=e}},{key:"createOverlay",value:function(t,e){return new c[t](e)}},{key:"hasOverlay",value:function(t){return void 0!==c[t]}},{key:"isOverlayTypeOf",value:function(t,e){return!(!t||!c[e])&&t instanceof c[e]}},{key:"CLONE_TOP",get:function(){return"top"}},{key:"CLONE_BOTTOM",get:function(){return"bottom"}},{key:"CLONE_LEFT",get:function(){return"left"}},{key:"CLONE_TOP_LEFT_CORNER",get:function(){return"top_left_corner"}},{key:"CLONE_BOTTOM_LEFT_CORNER",get:function(){return"bottom_left_corner"}},{key:"CLONE_DEBUG",get:function(){return"debug"}},{key:"CLONE_TYPES",get:function(){return[f.CLONE_TOP,f.CLONE_BOTTOM,f.CLONE_LEFT,f.CLONE_TOP_LEFT_CORNER,f.CLONE_BOTTOM_LEFT_CORNER,f.CLONE_DEBUG]}}]),r(f,[{key:"updateStateOfRendering",value:function(){var t=this.needFullRender;this.needFullRender=this.shouldBeRendered();var e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=(0,o.getTrimmingContainer)(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){this.mainTableScrollableElement=(0,o.getScrollableElement)(this.wot.wtTable.TABLE)}},{key:"makeClone",value:function(t){if(-1===f.CLONE_TYPES.indexOf(t))throw new Error('Clone type "'+t+'" is not supported.');var e=document.createElement("DIV"),n=document.createElement("TABLE");e.className="ht_clone_"+t+" handsontable",e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.overflow="hidden",n.className=this.wot.wtTable.TABLE.className,e.appendChild(n),this.type=t,this.wot.wtTable.wtRootElement.parentNode.appendChild(e);var r=this.wot.getSetting("preventOverflow");return!0===r||"horizontal"===r&&this.type===f.CLONE_TOP||"vertical"===r&&this.type===f.CLONE_LEFT?this.mainTableScrollableElement=window:this.mainTableScrollableElement=(0,o.getScrollableElement)(this.wot.wtTable.TABLE),new u.default({cloneSource:this.wot,cloneOverlay:this,table:n})}},{key:"refresh",value:function(t){var e=0<arguments.length&&void 0!==t&&t,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,n=t.style,r=e.style,i=t.parentNode.style;(0,s.arrayEach)([n,r,i],function(t){t.width="",t.height=""})}}},{key:"destroy",value:function(){new l.default(this.clone).destroy()}}]),f);function f(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(0,a.defineGetter)(this,"wot",t,{writable:!1}),this.instance=this.wot,this.type="",this.mainTableScrollableElement=null,this.TABLE=this.wot.wtTable.TABLE,this.hider=this.wot.wtTable.hider,this.spreader=this.wot.wtTable.spreader,this.holder=this.wot.wtTable.holder,this.wtRootElement=this.wot.wtTable.wtRootElement,this.trimmingContainer=(0,o.getTrimmingContainer)(this.hider.parentNode.parentNode),this.areElementSizesAdjusted=!1,this.updateStateOfRendering()}e.default=d},function(t,e,n){"use strict";e.__esModule=!0,e.isFunction=function(t){return"function"==typeof t},e.throttle=a,e.throttleAfterHits=function(r){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:200,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:10,i=a(r,t),o=e;function n(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return o?(o-=1,r.apply(this,e)):i.apply(this,e)}return n.clearHits=function(){o=e},n},e.debounce=function(i){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:200,a=null,s=void 0;return function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return a&&clearTimeout(a),a=setTimeout(function(){s=i.apply(t,n)},o),s}},e.pipe=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],i=e.slice(1);return function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(0,o.arrayReduce)(i,function(t,e){return e(t)},r.apply(this,e))}},e.partial=function(r){for(var t=arguments.length,i=Array(1<t?t-1:0),e=1;e<t;e++)i[e-1]=arguments[e];return function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.apply(this,i.concat(e))}},e.curry=function(a){var s=a.length;return function i(o){return function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=o.concat(e);return r.length>=s?a.apply(this,r):i(r)}}([])},e.curryRight=function(a){var s=a.length;return function i(o){return function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=o.concat(e.reverse());return r.length>=s?a.apply(this,r):i(r)}}([])};var o=n(0);function a(s){var l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:200,u=0,h={lastCallThrottled:!0},c=null;return function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=Date.now(),o=!1;h.lastCallThrottled=!0,u||(u=i,o=!0);var a=l-(i-u);return o?(h.lastCallThrottled=!1,s.apply(this,n)):(c&&clearTimeout(c),c=setTimeout(function(){h.lastCallThrottled=!1,s.apply(t,n),c=void(u=0)},a)),h}}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var o=n(16),a=n(37),s=n(35),l=n(59)("src"),r="toString",i=Function[r],u=(""+i).split(r);n(50).inspectSource=function(t){return i.call(t)},(t.exports=function(t,e,n,r){var i="function"==typeof n;i&&(s(n,"name")||a(n,"name",e)),t[e]!==n&&(i&&(s(n,l)||a(n,l,t[e]?""+t[e]:u.join(String(e)))),t===o?t[e]=n:r?t[e]?t[e]=n:a(t,e,n):(delete t[e],a(t,e,n)))})(Function.prototype,r,function(){return"function"==typeof this&&this[l]||i.call(this)})},function(t,e,n){var r=n(24),i=n(60);t.exports=n(26)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var o=n(75);t.exports=function(r,i,t){if(o(r),void 0===i)return r;switch(t){case 1:return function(t){return r.call(i,t)};case 2:return function(t,e){return r.call(i,t,e)};case 3:return function(t,e,n){return r.call(i,t,e,n)}}return function(){return r.apply(i,arguments)}}},function(t,e,n){var r=n(49);t.exports=function(t){return Object(r(t))}},function(t,e,n){function r(t){s(t,i,{value:{i:"O"+ ++l,w:{}}})}var i=n(59)("meta"),o=n(13),a=n(35),s=n(24).f,l=0,u=Object.isExtensible||function(){return!0},h=!n(27)(function(){return u(Object.preventExtensions({}))}),c=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,i)){if(!u(t))return"F";if(!e)return"E";r(t)}return t[i].i},getWeak:function(t,e){if(!a(t,i)){if(!u(t))return!0;if(!e)return!1;r(t)}return t[i].w},onFreeze:function(t){return h&&c.NEED&&u(t)&&!a(t,i)&&r(t),t}}},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}e.__esModule=!0,e.default=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"common";i.has(t)||i.set(t,new Map);var n=i.get(t);return{register:function(t,e){n.set(t,e)},getItem:function(t){return n.get(t)},hasItem:function(t){return n.has(t)},getNames:function(){return[].concat(r(n.keys()))},getValues:function(){return[].concat(r(n.values()))}}};var i=e.collection=new Map},function(t,e,n){"use strict";e.__esModule=!0,e.setBrowserMeta=i,e.isChrome=function(){return a.chrome.value},e.isEdge=function(){return a.edge.value},e.isIE=function(){return a.ie.value},e.isIE8=function(){return a.ie8.value},e.isIE9=function(){return a.ie9.value},e.isMSBrowser=function(){return a.ie.value||a.edge.value},e.isMobileBrowser=function(){return a.mobile.value},e.isSafari=function(){return a.safari.value};function r(n){var r={value:!1,test:function(t,e){r.value=n(t,e)}};return r}var o=n(1),a={chrome:r(function(t,e){return/Chrome/.test(t)&&/Google/.test(e)}),edge:r(function(t){return/Edge/.test(t)}),ie:r(function(t){return/Trident/.test(t)}),ie8:r(function(){return!document.createTextNode("test").textContent}),ie9:r(function(){return!!document.documentMode}),mobile:r(function(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)}),safari:r(function(t,e){return/Safari/.test(t)&&/Apple Computer/.test(e)})};function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.userAgent,n=void 0===e?navigator.userAgent:e,r=t.vendor,i=void 0===r?navigator.vendor:r;(0,o.objectEach)(a,function(t){(0,t.test)(n,i)})}i()},function(t,e,n){"use strict";e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.requestAnimationFrame=function(t){return a.call(window,t)},e.cancelAnimationFrame=function(t){s.call(window,t)},e.isTouchSupported=function(){return"ontouchstart"in window},e.isWebComponentSupportedNatively=function(){var t=document.createElement("div");return!(!t.createShadowRoot||!t.createShadowRoot.toString().match(/\[native code\]/))},e.hasCaptionProblem=function(){void 0===u&&function(){var t=document.createElement("TABLE");t.style.borderSpacing=0,t.style.borderWidth=0,t.style.padding=0;var e=document.createElement("TBODY");t.appendChild(e),e.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding=0,n.style.margin=0,t.insertBefore(n,e),document.body.appendChild(t),u=t.offsetHeight<2*t.lastChild.offsetHeight,document.body.removeChild(t)}();return u},e.getComparisonFunction=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(h)return h;h="object"===("undefined"==typeof Intl?"undefined":r(Intl))?new Intl.Collator(t,e).compare:"function"==typeof String.prototype.localeCompare?function(t,e){return(""+t).localeCompare(e)}:function(t,e){return t===e?0:e<t?-1:1};return h};for(var i=0,o=["ms","moz","webkit","o"],a=window.requestAnimationFrame,s=window.cancelAnimationFrame,l=0;l<o.length&&!a;++l)a=window[o[l]+"RequestAnimationFrame"],s=window[o[l]+"CancelAnimationFrame"]||window[o[l]+"CancelRequestAnimationFrame"];a=a||function(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-i)),r=window.setTimeout(function(){t(e+n)},n);return i=e+n,r},s=s||function(t){clearTimeout(t)};var u=void 0;var h=void 0},function(t,e,n){"use strict";e.__esModule=!0,e.getRegisteredValidators=e.getRegisteredValidatorNames=e.hasValidator=e.getValidator=e.registerValidator=void 0;var r=l(n(41)),i=l(n(286)),o=l(n(287)),a=l(n(288)),s=l(n(289));function l(t){return t&&t.__esModule?t:{default:t}}var u=(0,r.default)("validators"),h=u.register,c=u.getItem,d=u.hasItem,f=u.getNames,p=u.getValues;h("autocomplete",i.default),h("date",o.default),h("numeric",a.default),h("time",s.default),e.registerValidator=h,e.getValidator=function(t){if("function"==typeof t)return t;if(!d(t))throw Error('No registered validator found under "'+t+'" name');return c(t)},e.hasValidator=d,e.getRegisteredValidatorNames=f,e.getRegisteredValidators=p},function(t,e,n){"use strict";var r;e.__esModule=!0,e.ITEMS=e.UNDO=e.SEPARATOR=e.ROW_BELOW=e.ROW_ABOVE=e.REMOVE_ROW=e.REMOVE_COLUMN=e.REDO=e.READ_ONLY=e.COLUMN_RIGHT=e.COLUMN_LEFT=e.CLEAR_COLUMN=e.ALIGNMENT=void 0;var i=n(341);Object.defineProperty(e,"ALIGNMENT",{enumerable:!0,get:function(){return i.KEY}});var o=n(342);Object.defineProperty(e,"CLEAR_COLUMN",{enumerable:!0,get:function(){return o.KEY}});var a=n(343);Object.defineProperty(e,"COLUMN_LEFT",{enumerable:!0,get:function(){return a.KEY}});var s=n(344);Object.defineProperty(e,"COLUMN_RIGHT",{enumerable:!0,get:function(){return s.KEY}});var l=n(345);Object.defineProperty(e,"READ_ONLY",{enumerable:!0,get:function(){return l.KEY}});var u=n(346);Object.defineProperty(e,"REDO",{enumerable:!0,get:function(){return u.KEY}});var h=n(347);Object.defineProperty(e,"REMOVE_COLUMN",{enumerable:!0,get:function(){return h.KEY}});var c=n(348);Object.defineProperty(e,"REMOVE_ROW",{enumerable:!0,get:function(){return c.KEY}});var d=n(349);Object.defineProperty(e,"ROW_ABOVE",{enumerable:!0,get:function(){return d.KEY}});var f=n(350);Object.defineProperty(e,"ROW_BELOW",{enumerable:!0,get:function(){return f.KEY}});var p=n(161);Object.defineProperty(e,"SEPARATOR",{enumerable:!0,get:function(){return p.KEY}});var g=n(351);Object.defineProperty(e,"UNDO",{enumerable:!0,get:function(){return g.KEY}}),e.predefinedItems=function(){var n={};return(0,v.objectEach)(x,function(t,e){n[e]=t()}),n},e.addItem=function(t,e){-1===k.indexOf(t)&&(x[t]=e)};var v=n(1),m=M(i),y=M(o),w=M(a),b=M(s),C=M(l),E=M(u),S=M(h),O=M(c),T=M(d),N=M(f),R=M(p),_=M(g);function M(t){return t&&t.__esModule?t:{default:t}}function A(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var k=e.ITEMS=[d.KEY,f.KEY,a.KEY,s.KEY,o.KEY,c.KEY,h.KEY,g.KEY,u.KEY,l.KEY,i.KEY,p.KEY],x=(A(r={},p.KEY,R.default),A(r,d.KEY,T.default),A(r,f.KEY,N.default),A(r,a.KEY,w.default),A(r,s.KEY,b.default),A(r,o.KEY,y.default),A(r,c.KEY,O.default),A(r,h.KEY,S.default),A(r,g.KEY,_.default),A(r,u.KEY,E.default),A(r,l.KEY,C.default),A(r,i.KEY,m.default),r)},function(t,e,n){"use strict";function r(t){return"string"==typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}e.__esModule=!0,e.isFormulaExpression=function(t){return"string"==typeof t&&2<=t.length&&"="===t.charAt(0)},e.isFormulaExpressionEscaped=r,e.unescapeFormulaExpression=function(t){return r(t)?t.substr(1):t},e.toUpperCaseFormula=function(t){var e=/(\\"|"(?:\\"|[^"])*"|(\+))|(\\'|'(?:\\'|[^'])*'|(\+))/g,n=t.match(e)||[],r=-1;return t.toUpperCase().replace(e,function(){return n[r+=1]})},e.cellCoordFactory=function(e,n){return function(t){return{row:"row"===e?n:t.row,column:"column"===e?n:t.column}}}},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(70),s=n(0),l=n(237),u=(o=l)&&o.__esModule?o:{default:o};var h=[1,2,3],c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(d,u.default),r(d,null,[{key:"STATE_OUT_OFF_DATE",get:function(){return 1}},{key:"STATE_COMPUTING",get:function(){return 2}},{key:"STATE_UP_TO_DATE",get:function(){return 3}}]),r(d,[{key:"setValue",value:function(t){this.value=t}},{key:"getValue",value:function(){return this.value}},{key:"setError",value:function(t){this.error=t}},{key:"getError",value:function(){return this.error}},{key:"hasError",value:function(){return null!==this.error}},{key:"setState",value:function(t){if(-1===h.indexOf(t))throw Error("Unrecognized state: "+t);this.state=t}},{key:"isState",value:function(t){return this.state===t}},{key:"addPrecedent",value:function(t){if(this.isEqual(t))throw Error(a.ERROR_REF);this.hasPrecedent(t)||this.precedents.push(t)}},{key:"removePrecedent",value:function(e){if(this.isEqual(e))throw Error(a.ERROR_REF);this.precedents=(0,s.arrayFilter)(this.precedents,function(t){return!t.isEqual(e)})}},{key:"clearPrecedents",value:function(){this.precedents.length=0}},{key:"getPrecedents",value:function(){return this.precedents}},{key:"hasPrecedents",value:function(){return 0<this.precedents.length}},{key:"hasPrecedent",value:function(e){return 0<(0,s.arrayFilter)(this.precedents,function(t){return t.isEqual(e)}).length}}]),d);function d(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,t,e));return n.precedents=[],n.value=null,n.error=null,n.state=d.STATE_UP_TO_DATE,n}e.default=c},function(t,e,n){var r=n(171),i=n(96);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){var n=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},function(t,e,n){"use strict";e.__esModule=!0,e.sort=e.DO_NOT_SWAP=e.FIRST_BEFORE_SECOND=e.FIRST_AFTER_SECOND=e.getCompareFunctionFactory=e.getRootComparator=e.registerRootComparator=void 0;var r=n(221),i=n(333);e.registerRootComparator=r.registerRootComparator,e.getRootComparator=r.getRootComparator,e.getCompareFunctionFactory=r.getCompareFunctionFactory,e.FIRST_AFTER_SECOND=i.FIRST_AFTER_SECOND,e.FIRST_BEFORE_SECOND=i.FIRST_BEFORE_SECOND,e.DO_NOT_SWAP=i.DO_NOT_SWAP,e.sort=i.sort},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var r=n(13);t.exports=function(t,e){if(!r(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){var r=n(14)("unscopables"),i=Array.prototype;null==i[r]&&n(37)(i,r,{}),t.exports=function(t){i[r][t]=!0}},function(t,e,n){"use strict";e.__esModule=!0,e.RecordTranslator=void 0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.registerIdentity=function(t,e){c.set(t,e)},e.getTranslator=function(t){var e=t instanceof s.default?t:f(t),n=void 0;d.has(e)?n=d.get(e):(n=new u(e),d.set(e,n));return n},e.getIdentity=f;var o,a=n(157),s=(o=a)&&o.__esModule?o:{default:o},l=n(1);var u=e.RecordTranslator=(r(h,[{key:"toVisualRow",value:function(t){return this.hot.runHooks("unmodifyRow",t)}},{key:"toVisualColumn",value:function(t){return this.hot.runHooks("unmodifyCol",t)}},{key:"toVisual",value:function(t,e){return(0,l.isObject)(t)?{row:this.toVisualRow(t.row),column:this.toVisualColumn(t.column)}:[this.toVisualRow(t),this.toVisualColumn(e)]}},{key:"toPhysicalRow",value:function(t){return this.hot.runHooks("modifyRow",t)}},{key:"toPhysicalColumn",value:function(t){return this.hot.runHooks("modifyCol",t)}},{key:"toPhysical",value:function(t,e){return(0,l.isObject)(t)?{row:this.toPhysicalRow(t.row),column:this.toPhysicalColumn(t.column)}:[this.toPhysicalRow(t),this.toPhysicalColumn(e)]}}]),h);function h(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),this.hot=t}var c=new WeakMap,d=new WeakMap;function f(t){if(!c.has(t))throw Error("Record translator was not registered for this object identity");return c.get(t)}},function(t,e,n){"use strict";e.__esModule=!0;var a=n(0),r=n(1),s=n(4);var i={_arrayMap:[],getValueByIndex:function(t){var e=null;return t<this._arrayMap.length&&(e=this._arrayMap[t]),e},getIndexByValue:function(t){var e;return-1===(e=this._arrayMap.indexOf(t))?null:e},insertItems:function(e,t){var n=this,r=1<arguments.length&&void 0!==t?t:1,i=(0,a.arrayMax)(this._arrayMap)+1,o=[];return(0,s.rangeEach)(r-1,function(t){o.push(n._arrayMap.splice(e+t,0,i+t))}),o},removeItems:function(t,e){var n=this,r=1<arguments.length&&void 0!==e?e:1,i=[];if(Array.isArray(t)){var o=[].concat(this._arrayMap);t.sort(function(t,e){return e-t}),i=(0,a.arrayReduce)(t,function(t,e){return n._arrayMap.splice(e,1),t.concat(o.slice(e,e+1))},[])}else i=this._arrayMap.splice(t,r);return i},unshiftItems:function(t,e){var n=1<arguments.length&&void 0!==e?e:1,i=this.removeItems(t,n);this._arrayMap=(0,a.arrayMap)(this._arrayMap,function(t){var e=t,n=function(r){return(0,a.arrayReduce)(i,function(t,e){var n=t;return e<r&&(n+=1),n},0)}(e);return n&&(e-=n),e})},shiftItems:function(n,t){var e=this,r=1<arguments.length&&void 0!==t?t:1;this._arrayMap=(0,a.arrayMap)(this._arrayMap,function(t){var e=t;return n<=e&&(e+=r),e}),(0,s.rangeEach)(r-1,function(t){e._arrayMap.splice(n+t,0,n+t)})},swapIndexes:function(t,e){var n;(n=this._arrayMap).splice.apply(n,[e,0].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(this._arrayMap.splice(t,1))))},clearMap:function(){this._arrayMap.length=0}};(0,r.defineGetter)(i,"MIXIN_NAME","arrayMapper",{writable:!1,enumerable:!1}),e.default=i},function(t,e,n){"use strict";e.__esModule=!0,e.createId=r,e.createDefaultCustomBorder=i,e.createSingleEmptyBorder=o,e.createDefaultHtBorder=l,e.createEmptyBorders=function(t,e){return{id:r(t,e),border:{width:1,color:"#000",cornerVisible:!1},row:t,col:e,top:{hide:!0},right:{hide:!0},bottom:{hide:!0},left:{hide:!0}}},e.extendDefaultBorder=function(t,e){(0,a.hasOwnProperty)(e,"border")&&(t.border=e.border);(0,a.hasOwnProperty)(e,"top")&&(e.top?(0,a.isObject)(e.top)||(e.top={width:1,color:"#000"}):e.top={hide:!0},t.top=e.top);(0,a.hasOwnProperty)(e,"right")&&(e.right?(0,a.isObject)(e.right)||(e.right={width:1,color:"#000"}):e.right={hide:!0},t.right=e.right);(0,a.hasOwnProperty)(e,"bottom")&&(e.bottom?(0,a.isObject)(e.bottom)||(e.bottom={width:1,color:"#000"}):e.bottom={hide:!0},t.bottom=e.bottom);(0,a.hasOwnProperty)(e,"left")&&(e.left?(0,a.isObject)(e.left)||(e.left={width:1,color:"#000"}):e.left={hide:!0},t.left=e.left);return t},e.checkSelectionBorders=function(r,i){var o=!1;return(0,s.arrayEach)(r.getSelectedRange(),function(t){t.forAll(function(t,e){var n=r.getCellMeta(t,e).borders;if(n){if(!i)return!(o=!0);if(!(0,a.hasOwnProperty)(n[i],"hide")||!1===n[i].hide)return!(o=!0)}})}),o},e.markSelected=function(t){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+t};var a=n(1),s=n(0);function r(t,e){return"border_row"+t+"col"+e}function i(){return{width:1,color:"#000"}}function o(){return{hide:!0}}function l(){return{width:1,color:"#000",cornerVisible:!1}}},function(t,e){t.exports=!1},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){t.exports={}},function(t,e,n){var r=n(24).f,i=n(35),o=n(14)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){"use strict";e.__esModule=!0,e.EditorState=void 0;var r=n(9),i=n(10),s=e.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};function o(t){this.instance=t,this.state=s.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.init()}o.prototype._fireCallbacks=function(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)},o.prototype.init=function(){},o.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},o.prototype.setValue=function(){throw Error("Editor setValue() method unimplemented")},o.prototype.open=function(){throw Error("Editor open() method unimplemented")},o.prototype.close=function(){throw Error("Editor close() method unimplemented")},o.prototype.prepare=function(t,e,n,r,i,o){this.TD=r,this.row=t,this.col=e,this.prop=n,this.originalValue=i,this.cellProperties=o,this.state=s.VIRGIN},o.prototype.extend=function(){var t,r=this.constructor;return t=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];r.apply(this,e)},e.prototype=r.prototype,t.prototype=new e,t.prototype.constructor=t;function e(){}},o.prototype.saveValue=function(t,e){var n=void 0,r=void 0;e?((n=this.instance.getSelectedLast())[0]>n[2]&&(r=n[0],n[0]=n[2],n[2]=r),n[1]>n[3]&&(r=n[1],n[1]=n[3],n[3]=r)):n=[this.row,this.col,null,null],this.instance.populateFromArray(n[0],n[1],t,n[2],n[3],"edit")},o.prototype.beginEditing=function(t,e){if(this.state===s.VIRGIN){if(this.instance.view.scrollViewport(new r.CellCoords(this.row,this.col)),this.state=s.EDITING,this.isInFullEditMode()){var n="string"==typeof t?t:(0,i.stringify)(this.originalValue);this.setValue(n)}this.open(e),this._opened=!0,this.focus(),this.instance.view.render(),this.instance.runHooks("afterBeginEditing",this.row,this.col)}},o.prototype.finishEditing=function(t,e,n){var r=this,i=void 0;if(n){var o=this._closeCallback;this._closeCallback=function(t){o&&o(t),n(t),r.instance.view.render()}}if(!this.isWaiting())if(this.state!==s.VIRGIN){if(this.state===s.EDITING){if(t)return this.cancelChanges(),void this.instance.view.render();var a=this.getValue();i=this.instance.getSettings().trimWhitespace?[["string"==typeof a?String.prototype.trim.call(a||""):a]]:[[a]],this.state=s.WAITING,this.saveValue(i,e),this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(t){r.state=s.FINISHED,r.discardEditor(t)}):(this.state=s.FINISHED,this.discardEditor(!0))}}else this.instance._registerTimeout(function(){r._fireCallbacks(!0)})},o.prototype.cancelChanges=function(){this.state=s.FINISHED,this.discardEditor()},o.prototype.discardEditor=function(t){this.state===s.FINISHED&&(!1===t&&!0!==this.cellProperties.allowInvalid?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=s.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=s.VIRGIN,this._fireCallbacks(!0)))},o.prototype.enableFullEditMode=function(){this._fullEditMode=!0},o.prototype.isInFullEditMode=function(){return this._fullEditMode},o.prototype.isOpened=function(){return this._opened},o.prototype.isWaiting=function(){return this.state===s.WAITING},o.prototype.checkEditorSection=function(){var t=this.instance.countRows(),e="";return this.row<this.instance.getSettings().fixedRowsTop?e=this.col<this.instance.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.instance.getSettings().fixedRowsBottom&&this.row>=t-this.instance.getSettings().fixedRowsBottom?e=this.col<this.instance.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.instance.getSettings().fixedColumnsLeft&&(e="left"),e},e.default=o},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.__esModule=!0;var i=(function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}(o,[{key:"isValid",value:function(t){return!(this.row<0||this.col<0||this.row>=t.getSetting("totalRows")||this.col>=t.getSetting("totalColumns"))}},{key:"isEqual",value:function(t){return t===this||this.row===t.row&&this.col===t.col}},{key:"isSouthEastOf",value:function(t){return this.row>=t.row&&this.col>=t.col}},{key:"isNorthWestOf",value:function(t){return this.row<=t.row&&this.col<=t.col}},{key:"isSouthWestOf",value:function(t){return this.row>=t.row&&this.col<=t.col}},{key:"isNorthEastOf",value:function(t){return this.row<=t.row&&this.col>=t.col}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),o);function o(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.row=null,this.col=null,void 0!==t&&void 0!==e&&(this.row=t,this.col=e)}e.default=i},function(t,e,n){"use strict";e.__esModule=!0;var x=n(2),r=o(n(269)),I=n(64),f=o(I),i=o(n(8)),s=n(18),l=n(12);function o(t){return t&&t.__esModule?t:{default:t}}var a=f.default.prototype.extend();a.prototype.init=function(){var t=this;this.createElements(),this.eventManager=new i.default(this),this.bindEvents(),this.autoResize=(0,r.default)(),this.holderZIndex=-1,this.instance.addHook("afterDestroy",function(){t.destroy()})},a.prototype.prepare=function(t,e,n,r,i,o){for(var a=this,s=this.state,l=arguments.length,u=Array(6<l?l-6:0),h=6;h<l;h++)u[h-6]=arguments[h];if(f.default.prototype.prepare.apply(this,[t,e,n,r,i,o].concat(u)),!o.readOnly){this.refreshDimensions(!0);var c=o.allowInvalid,d=o.fragmentSelection;c&&(this.TEXTAREA.value=""),s!==I.EditorState.FINISHED&&this.hideEditableElement(),d||this.instance._registerImmediate(function(){return a.focus()})}},a.prototype.hideEditableElement=function(){this.textareaParentStyle.top="-9999px",this.textareaParentStyle.left="-9999px",this.textareaParentStyle.zIndex="-1",this.textareaParentStyle.position="fixed"},a.prototype.showEditableElement=function(){this.textareaParentStyle.zIndex=0<=this.holderZIndex?this.holderZIndex:"",this.textareaParentStyle.position=""},a.prototype.getValue=function(){return this.TEXTAREA.value},a.prototype.setValue=function(t){this.TEXTAREA.value=t},a.prototype.beginEditing=function(){if(this.state===I.EditorState.VIRGIN){this.TEXTAREA.value="";for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];f.default.prototype.beginEditing.apply(this,e)}};function u(t){var e=this.getActiveEditor(),n=(t.ctrlKey||t.metaKey)&&!t.altKey;if(t.target===e.TEXTAREA&&!(0,l.isImmediatePropagationStopped)(t)){switch(t.keyCode){case s.KEY_CODES.ARROW_RIGHT:case s.KEY_CODES.ARROW_LEFT:e.isInFullEditMode()&&((e.isWaiting()||e.allowKeyEventPropagation)&&(e.isWaiting()||!e.allowKeyEventPropagation||e.allowKeyEventPropagation(t.keyCode))||(0,l.stopImmediatePropagation)(t));break;case s.KEY_CODES.ARROW_UP:case s.KEY_CODES.ARROW_DOWN:e.isInFullEditMode()&&((e.isWaiting()||e.allowKeyEventPropagation)&&(e.isWaiting()||!e.allowKeyEventPropagation||e.allowKeyEventPropagation(t.keyCode))||(0,l.stopImmediatePropagation)(t));break;case s.KEY_CODES.ENTER:var r=this.selection.isMultiple();if(n&&!r||t.altKey){if(e.isOpened()){var i=(0,x.getCaretPosition)(e.TEXTAREA),o=e.getValue(),a=o.slice(0,i)+"\n"+o.slice(i);e.setValue(a),(0,x.setCaretPosition)(e.TEXTAREA,i+1)}else e.beginEditing(e.originalValue+"\n");(0,l.stopImmediatePropagation)(t)}t.preventDefault();break;case s.KEY_CODES.BACKSPACE:case s.KEY_CODES.DELETE:case s.KEY_CODES.HOME:case s.KEY_CODES.END:(0,l.stopImmediatePropagation)(t)}-1===[s.KEY_CODES.ARROW_UP,s.KEY_CODES.ARROW_RIGHT,s.KEY_CODES.ARROW_DOWN,s.KEY_CODES.ARROW_LEFT].indexOf(t.keyCode)&&e.autoResize.resize(String.fromCharCode(t.keyCode))}}a.prototype.open=function(){this.refreshDimensions(),this.showEditableElement(),this.instance.addHook("beforeKeyDown",u)},a.prototype.close=function(){this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.hideEditableElement(),this.instance.removeHook("beforeKeyDown",u)},a.prototype.focus=function(){this.TEXTAREA.select(),(0,x.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)},a.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA"),this.TEXTAREA.tabIndex=-1,(0,x.addClass)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),(0,x.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.zIndex="-1",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT)},a.prototype.getEditedCell=function(){var t=void 0;switch(this.checkEditorSection()){case"top":t=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.holderZIndex=101;break;case"top-left-corner":t=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.holderZIndex=103;break;case"bottom-left-corner":t=this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.holderZIndex=103;break;case"left":t=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.holderZIndex=102;break;case"bottom":t=this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.holderZIndex=102;break;default:t=this.instance.getCell(this.row,this.col),this.holderZIndex=-1}return-1!==t&&-2!==t?t:void 0},a.prototype.refreshValue=function(){var t=this.instance.toPhysicalRow(this.row),e=this.instance.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()},a.prototype.refreshDimensions=function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.state===I.EditorState.EDITING||t)if(this.TD=this.getEditedCell(),this.TD){var e=(0,x.offset)(this.TD),n=(0,x.offset)(this.instance.rootElement),r=this.instance.view.wt.wtOverlays.topOverlay.mainTableScrollableElement,i=this.instance.view.wt.wtOverlays.leftOverlay.mainTableScrollableElement,o=this.instance.countRows(),a=r!==window?r.scrollTop:0,s=i!==window?i.scrollLeft:0,l=this.checkEditorSection(),u=["","left"].includes(l)?a:0,h=["","top","bottom"].includes(l)?s:0,c=e.top===n.top?0:1,d=this.instance.getSettings(),f=this.instance.hasColHeaders(),p=this.TD.style.backgroundColor,g=e.top-n.top-c-u,v=e.left-n.left-1-h,m=void 0;switch(l){case"top":m=(0,x.getCssTransform)(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":m=(0,x.getCssTransform)(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":m=(0,x.getCssTransform)(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":m=(0,x.getCssTransform)(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":m=(0,x.getCssTransform)(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}(f&&0===this.instance.getSelectedLast()[0]||d.fixedRowsBottom&&this.instance.getSelectedLast()[0]===o-d.fixedRowsBottom)&&(g+=1),0===this.instance.getSelectedLast()[1]&&(v+=1),m&&-1!==m?this.textareaParentStyle[m[0]]=m[1]:(0,x.resetCssTransform)(this.TEXTAREA_PARENT),this.textareaParentStyle.top=g+"px",this.textareaParentStyle.left=v+"px",this.showEditableElement();var y=this.instance.view.wt.wtViewport.rowsRenderCalculator.startPosition,w=this.instance.view.wt.wtViewport.columnsRenderCalculator.startPosition,b=this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition(),C=this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),E=(0,x.getScrollbarWidth)(),S=this.TD.offsetTop+y-C,O=this.TD.offsetLeft+w-b,T=(0,x.innerWidth)(this.TD)-8,N=(0,x.hasVerticalScrollbar)(r)?E:0,R=(0,x.hasHorizontalScrollbar)(i)?E:0,_=this.instance.view.maximumVisibleElementWidth(O)-9-N,M=this.TD.scrollHeight+1,A=Math.max(this.instance.view.maximumVisibleElementHeight(S)-R,23),k=(0,x.getComputedStyle)(this.TD);this.TEXTAREA.style.fontSize=k.fontSize,this.TEXTAREA.style.fontFamily=k.fontFamily,this.TEXTAREA.style.backgroundColor=p,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(M,A),maxHeight:A,minWidth:Math.min(T,_),maxWidth:_},!0)}else t||this.close(!0)},a.prototype.bindEvents=function(){var t=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(t){(0,l.stopPropagation)(t)}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(t){(0,l.stopPropagation)(t)}),this.instance.addHook("afterScrollHorizontally",function(){t.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){t.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){t.refreshDimensions(),t.focus()}),this.instance.addHook("afterRowResize",function(){t.refreshDimensions(),t.focus()}),this.instance.addHook("afterDestroy",function(){t.eventManager.destroy()})},a.prototype.destroy=function(){this.eventManager.destroy()},e.default=a},function(t,e,n){"use strict";e.__esModule=!0,e.sortComparison=function(t,e){return"number"!=typeof t||"number"!=typeof e?i(t,e):t-e},e.toVisualValue=u,e.createArrayAssertion=h,e.toEmptyString=function(t){return null==t?"":t},e.unifyColumnValues=function(t){var e=t;e=a?Array.from(new Set(e)):(0,l.arrayUnique)(e);return e=e.sort(function(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t===e?0:e<t?1:-1})},e.intersectValues=function(t,e,r,i){var o=[],a=t===e,s=void 0;a||(s=h(e));return(0,l.arrayEach)(t,function(t){var e=!1;(a||s(t))&&(e=!0);var n={checked:e,value:t,visualValue:u(t,r)};i&&i(n),o.push(n)}),o};var r=n(43),l=n(0),i=(0,r.getComparisonFunction)();function u(t,e){var n=t;return""===n&&(n="("+e+")"),n}var o=new Set([1]).has(1),a=o&&"function"==typeof Array.from;function h(t){var e=t;return o&&(e=new Set(e)),function(t){return o?e.has(t):!!~e.indexOf(t)}}},function(t,e,n){"use strict";e.__esModule=!0,e.getOperationFunc=function(t){if(!r[t])throw Error('Operation with id "'+t+'" does not exist.');var n=r[t].func;return function(t,e){return n(t,e)}},e.getOperationName=function(t){return r[t].name},e.registerOperation=function(t,e,n){r[t]={name:e,func:n}};var r=e.operations={}},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(1),a=c(n(20)),s=c(n(8)),l=n(2),u=n(0),h=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3));function c(t){return t&&t.__esModule?t:{default:t}}var d="building",f=["click","input","keydown","keypress","keyup","focus","blur","change"],p=(r(g,null,[{key:"DEFAULTS",get:function(){return(0,o.clone)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),r(g,[{key:"setValue",value:function(t){this.options.value=t,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"isBuilt",value:function(){return"built"===this.buildState}},{key:"translateIfPossible",value:function(t){return"string"==typeof t&&t.startsWith(h.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(t):t}},{key:"build",value:function(){function e(t,e){n.eventManager.addEventListener(t,e,function(t){return n.runLocalHooks(e,t,n)})}var n=this;if(this.buildState||(this.buildState=d),this.options.className&&(0,l.addClass)(this._element,this.options.className),this.options.children.length)(0,u.arrayEach)(this.options.children,function(t){return n._element.appendChild(t.element)});else if(this.options.wrapIt){var r=document.createElement(this.options.tagName);(0,o.objectEach)(this.options,function(t,e){void 0!==r[e]&&"className"!==e&&"tagName"!==e&&"children"!==e&&(r[e]=n.translateIfPossible(t))}),this._element.appendChild(r),(0,u.arrayEach)(f,function(t){return e(r,t)})}else(0,u.arrayEach)(f,function(t){return e(n._element,t)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}},{key:"element",get:function(){return this.buildState===d||("built"===this.buildState?this.update():(this.buildState=d,this.build(),this.buildState="built")),this._element}}]),g);function g(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),this.hot=t,this.eventManager=new s.default(this),this.options=(0,o.extend)(g.DEFAULTS,e),this._element=document.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=!1}(0,o.mixin)(p,a.default),e.default=p},function(t,e){t.exports=o},function(t,e,n){"use strict";e.__esModule=!0;var p=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,g=n(70),s=n(0),a=n(1),l=n(20),u=(o=l)&&o.__esModule?o:{default:o},h=n(46);var c=/^\$?[A-Z]+\$?\d+$/,d=/\$?[A-Z]+\$?\d+/,f=/(?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ])/g,v=/\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+/g,m=/((?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ]))|(\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+)/g,y=(r(w,[{key:"setExpression",value:function(t){return this.cells.length=0,this.expression=(0,h.toUpperCaseFormula)(t),this._extractCells(),this._extractCellsRange(),this}},{key:"useCustomModifier",value:function(t){this.customModifier=t}},{key:"translate",value:function(t,e){var n=this,r=t.row,i=t.column,o=1<arguments.length&&void 0!==e?e:{};return(0,s.arrayEach)(this.cells,function(t){null!=r&&n._translateCell(t,"row",r,o.row),null!=i&&n._translateCell(t,"column",i,o.column)}),this}},{key:"toString",value:function(){var l=this,t=this.expression.replace(m,function(t,e,n){var r=-1===t.indexOf(":"),i=t,o=t,a=null;r&&(o=c.test(e)?e:n);var s=l._searchCell(o);return s&&(a=s.refError?(0,g.error)(g.ERROR_REF):s.toLabel(),i=r?t.replace(o,a):a),i});return t.startsWith("=")||(t="="+t),t}},{key:"_translateCell",value:function(t,e,n,r){var i=t.start,o=t.end,a=i[e].index,s=o[e].index,l=n,u=n,h=!1;if(this.customModifier){var c=this.customModifier(t,e,n,r),d=p(c,3);l=d[0],u=d[1],h=d[2]}else i[e].isAbsolute&&(l=0),o[e].isAbsolute&&(u=0);l&&!h&&(a+l<0&&(h=!0),i[e].index=Math.max(a+l,0)),u&&!h&&(s+u<0&&(h=!0),o[e].index=Math.max(s+u,0)),h&&(t.refError=!0)}},{key:"_extractCells",value:function(){var a=this,t=this.expression.match(f);t&&(0,s.arrayEach)(t,function(t){var e=t.match(d);if(e){var n=(0,g.extractLabel)(e[0]),r=p(n,2),i=r[0],o=r[1];a.cells.push(a._createCell({row:i,column:o},{row:i,column:o},e[0]))}})}},{key:"_extractCellsRange",value:function(){var f=this,t=this.expression.match(v);t&&(0,s.arrayEach)(t,function(t){var e=t.split(":"),n=p(e,2),r=n[0],i=n[1],o=(0,g.extractLabel)(r),a=p(o,2),s=a[0],l=a[1],u=(0,g.extractLabel)(i),h=p(u,2),c={row:s,column:l},d={row:h[0],column:h[1]};f.cells.push(f._createCell(c,d,t))})}},{key:"_searchCell",value:function(e){var t=(0,s.arrayFilter)(this.cells,function(t){return t.origLabel===e});return p(t,1)[0]||null}},{key:"_createCell",value:function(t,e,n){return{start:t,end:e,origLabel:n,type:-1===n.indexOf(":")?"cell":"range",refError:!1,toLabel:function(){var t=(0,g.toLabel)(this.start.row,this.start.column);return"range"===this.type&&(t+=":"+(0,g.toLabel)(this.end.row,this.end.column)),t}}}}]),w);function w(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,w),this.expression="",this.cells=[],this.customModifier=null,"string"==typeof t&&this.setExpression(t)}(0,a.mixin)(y,u.default),e.default=y},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(0<t?r:n)(t)}},function(t,e,n){var r=n(72),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=r(t))<0?i(t+e,0):o(t,e)}},function(t,e,n){var i=n(36);t.exports=function(t,e,n){for(var r in e)i(t,r,e[r],n);return t}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var d=n(38),f=n(174),p=n(175),g=n(21),v=n(29),m=n(176),y={},w={};(e=t.exports=function(t,e,n,r,i){var o,a,s,l,u=i?function(){return t}:m(t),h=d(n,r,e?2:1),c=0;if("function"!=typeof u)throw TypeError(t+" is not iterable!");if(p(u)){for(o=v(t.length);c<o;c++)if((l=e?h(g(a=t[c])[0],a[1]):h(t[c]))===y||l===w)return l}else for(s=u.call(t);!(a=s.next()).done;)if((l=f(s,h,a.value,e))===y||l===w)return l}).BREAK=y,e.RETURN=w},function(t,e,n){"use strict";var m=n(16),y=n(6),w=n(36),b=n(74),C=n(40),E=n(77),S=n(76),O=n(13),T=n(27),N=n(97),R=n(62),_=n(242);t.exports=function(r,t,e,n,i,o){function a(t){var n=h[t];w(h,t,"delete"==t?function(t){return!(o&&!O(t))&&n.call(this,0===t?0:t)}:"has"==t?function(t){return!(o&&!O(t))&&n.call(this,0===t?0:t)}:"get"==t?function(t){return o&&!O(t)?void 0:n.call(this,0===t?0:t)}:"add"==t?function(t){return n.call(this,0===t?0:t),this}:function(t,e){return n.call(this,0===t?0:t,e),this})}var s=m[r],l=s,u=i?"set":"add",h=l&&l.prototype,c={};if("function"==typeof l&&(o||h.forEach&&!T(function(){(new l).entries().next()}))){var d=new l,f=d[u](o?{}:-0,1)!=d,p=T(function(){d.has(1)}),g=N(function(t){new l(t)}),v=!o&&T(function(){for(var t=new l,e=5;e--;)t[u](e,e);return!t.has(-0)});g||(((l=t(function(t,e){S(t,l,r);var n=_(new s,t,l);return null!=e&&E(e,i,n[u],n),n})).prototype=h).constructor=l),(p||v)&&(a("delete"),a("has"),i&&a("get")),(v||f)&&a(u),o&&h.clear&&delete h.clear}else l=n.getConstructor(t,r,i,u),b(l.prototype,e),C.NEED=!0;return R(l,r),c[r]=l,y(y.G+y.W+y.F*(l!=s),c),o||n.setStrong(l,r,i),l}},function(t,e,n){var r=n(63),i=n(60),o=n(28),a=n(91),s=n(35),l=n(170),u=Object.getOwnPropertyDescriptor;e.f=n(26)?u:function(t,e){if(t=o(t),e=a(e,!0),l)try{return u(t,e)}catch(t){}if(s(t,e))return i(!r.f.call(t,e),t[e])}},function(t,e,n){var w=n(38),b=n(93),C=n(39),E=n(29),r=n(243);t.exports=function(c,t){var d=1==c,f=2==c,p=3==c,g=4==c,v=6==c,m=5==c||v,y=t||r;return function(t,e,n){for(var r,i,o=C(t),a=b(o),s=w(e,n,3),l=E(a.length),u=0,h=d?y(t,l):f?y(t,0):void 0;u<l;u++)if((m||u in a)&&(i=s(r=a[u],u,o),c))if(d)h[u]=i;else if(i)switch(c){case 3:return!0;case 5:return r;case 6:return u;case 2:h.push(r)}else if(g)return!1;return v?-1:p||g?g:h}}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){"use strict";var s=n(37),l=n(36),u=n(27),h=n(49),c=n(14);t.exports=function(e,t,n){var r=c(e),i=n(h,r,""[e]),o=i[0],a=i[1];u(function(){var t={};return t[r]=function(){return 7},7!=""[e](t)})&&(l(String.prototype,e,o),s(RegExp.prototype,r,2==t?function(t,e){return a.call(t,this,e)}:function(t){return a.call(t,this)}))}},function(t,e,n){"use strict";var r=n(54),i=n(180),o=n(61),a=n(28);t.exports=n(178)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e,n){"use strict";e.__esModule=!0,e.spreadsheetColumnLabel=l,e.spreadsheetColumnIndex=function(t){var e=0;if(t)for(var n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=Math.pow(s,r)*(i.indexOf(t[n])+1);return e-=1},e.createSpreadsheetData=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:100,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:4,n=[],r=void 0,i=void 0;for(r=0;r<t;r++){var o=[];for(i=0;i<e;i++)o.push(l(i)+(r+1));n.push(o)}return n},e.createSpreadsheetObjectData=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:100,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:4,n=[],r=void 0,i=void 0;for(r=0;r<t;r++){var o={};for(i=0;i<e;i++)o["prop"+i]=l(i)+(r+1);n.push(o)}return n},e.createEmptySpreadsheetData=function(t,e){for(var n=[],r=void 0,i=0;i<t;i++){r=[];for(var o=0;o<e;o++)r.push("");n.push(r)}return n},e.translateRowsToColumns=function(t){var e,n=[],r=void 0,i=void 0,o=void 0,a=0;for(r=0,e=t.length;r<e;r++)for(i=0,o=t[r].length;i<o;i++)i===a&&(n.push([]),a+=1),n[i].push(t[r][i]);return n},e.cellMethodLookupFactory=function(r,t){var i=void 0===t||t;return function(t,e){return function t(e){if(e){if((0,a.hasOwnProperty)(e,r)&&void 0!==e[r])return e[r];if((0,a.hasOwnProperty)(e,"type")&&e.type){if("string"!=typeof e.type)throw new Error("Cell type must be a string ");var n=(0,o.getCellType)(e.type);if((0,a.hasOwnProperty)(n,r))return n[r];if(i)return}return t(Object.getPrototypeOf(e))}}("number"==typeof t?this.getCellMeta(t,e):t)}};var o=n(156),a=n(1),i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",s=i.length;function l(t){for(var e=t+1,n="",r=void 0;0<e;)r=(e-1)%s,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/s,10);return n}},function(t,e,n){"use strict";e.__esModule=!0,e.DEFAULT_LANGUAGE_CODE=e.getLanguagesDictionaries=e.getDefaultLanguageDictionary=e.hasLanguageDictionary=e.getLanguageDictionary=e.registerLanguageDictionary=void 0;var i=n(1),o=n(216),r=s(n(41)),a=s(n(305));function s(t){return t&&t.__esModule?t:{default:t}}var l=a.default.languageCode,u=(0,r.default)("languagesDictionaries"),h=u.register,c=u.getItem,d=u.hasItem,f=u.getValues;function p(t,e){var n=t,r=e;return(0,i.isObject)(t)&&(n=(r=t).languageCode),function(t,e){t!==l&&(0,o.extendNotExistingKeys)(e,c(l))}(n,r),h(n,(0,i.deepClone)(r)),(0,i.deepClone)(r)}function g(t){return d(t)}e.registerLanguageDictionary=p,e.getLanguageDictionary=function(t){return g(t)?(0,i.deepClone)(c(t)):null},e.hasLanguageDictionary=g,e.getDefaultLanguageDictionary=function(){return a.default},e.getLanguagesDictionaries=function(){return f()},e.DEFAULT_LANGUAGE_CODE=l,p(a.default)},function(t,e,n){"use strict";e.__esModule=!0,e.stopObserving=e.startObserving=e.isPressedCtrlKey=e.isPressed=e._resetState=e._getRefCount=void 0;var r,i=n(8),o=(r=i)&&r.__esModule?r:{default:r},a=n(18);var s=new o.default,l=new Set,u=0;function h(){s.clearEvents(),l.clear(),u=0}e._getRefCount=function(){return u},e._resetState=h,e.isPressed=function(e){return Array.from(l.values()).some(function(t){return(0,a.isKey)(t,e)})},e.isPressedCtrlKey=function(){return Array.from(l.values()).some(function(t){return(0,a.isCtrlMetaKey)(t)})},e.startObserving=function(){0===u&&(s.addEventListener(document,"keydown",function(t){l.has(t.keyCode)||l.add(t.keyCode)}),s.addEventListener(document,"keyup",function(t){l.has(t.keyCode)&&l.delete(t.keyCode)}),s.addEventListener(document,"visibilitychange",function(){document.hidden&&l.clear()}),s.addEventListener(window,"blur",function(){l.clear()})),u+=1},e.stopObserving=function(){0<u&&(u-=1),0===u&&h()}},function(t,e,n){"use strict";e.__esModule=!0,e.SELECTION_TYPES=e.SELECTION_TYPE_OBJECT=e.SELECTION_TYPE_ARRAY=e.SELECTION_TYPE_EMPTY=e.SELECTION_TYPE_UNRECOGNIZED=void 0;var s=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.detectSelectionType=y,e.normalizeSelectionFactory=i,e.transformSelectionToColumnDistance=function(t){var e=y(t);if(e===h||e===c)return[];var o=i(e),a=new Set;(0,u.arrayEach)(t,function(t){var e=o(t),n=s(e,4),r=n[1],i=n[3]-r+1;(0,u.arrayEach)(Array.from(new Array(i),function(t,e){return r+e}),function(t){a.has(t)||a.add(t)})});var n=Array.from(a).sort(function(t,e){return t-e});return(0,u.arrayReduce)(n,function(t,e,n,r){return 0!==n&&e===r[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t},[])},e.transformSelectionToRowDistance=function(t){var e=y(t);if(e===h||e===c)return[];var o=i(e),a=new Set;(0,u.arrayEach)(t,function(t){var e=o(t),n=s(e,3),r=n[0],i=n[2]-r+1;(0,u.arrayEach)(Array.from(new Array(i),function(t,e){return r+e}),function(t){a.has(t)||a.add(t)})});var n=Array.from(a).sort(function(t,e){return t-e});return(0,u.arrayReduce)(n,function(t,e,n,r){return 0!==n&&e===r[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t},[])},e.isValidCoord=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1/0;return"number"==typeof t&&0<=t&&t<e};var l=n(9),u=n(0),f=n(10),h=e.SELECTION_TYPE_UNRECOGNIZED=0,c=e.SELECTION_TYPE_EMPTY=1,d=e.SELECTION_TYPE_ARRAY=2,p=e.SELECTION_TYPE_OBJECT=3,r=e.SELECTION_TYPES=[p,d],g=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],v=Symbol("root"),m=Symbol("child");function y(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:v;if(e!==v&&e!==m)throw new Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(t),r=e===v,i=h;if(n){var o=t[0];if(0===t.length)i=c;else if(r&&o instanceof l.CellRange)i=p;else if(r&&Array.isArray(o))i=y(o,m);else if(2<=t.length&&t.length<=4){!t.some(function(t,e){return!g[e].includes(void 0===t?"undefined":a(t))})&&(i=d)}}return i}function i(h){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=t.keepDirection,c=void 0!==e&&e,d=t.propToCol;if(!r.includes(h))throw new Error("Unsupported selection ranges schema type was provided.");return function(t){var e=h===p,n=e?t.from.row:t[0],r=e?t.from.col:t[1],i=e?t.to.row:t[2],o=e?t.to.col:t[3];if("function"==typeof d&&("string"==typeof r&&(r=d(r)),"string"==typeof o&&(o=d(o))),(0,f.isUndefined)(i)&&(i=n),(0,f.isUndefined)(o)&&(o=r),!c){var a=n,s=r,l=i,u=o;n=Math.min(a,l),r=Math.min(s,u),i=Math.max(a,l),o=Math.max(s,u)}return[n,r,i,o]}}},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(0),a=n(1),s=u(n(20)),l=u(n(423));function u(t){return t&&t.__esModule?t:{default:t}}var h=(r(c,[{key:"reset",value:function(){(0,o.arrayEach)(this.elements,function(t){return t.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hidden}},{key:"destroy",value:function(){this.clearLocalHooks(),(0,o.arrayEach)(this.elements,function(t){return t.destroy()}),this.elements=null,this.hot=null}}]),c);function c(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),this.hot=t,this.elements=[],this.hidden=!1}(0,a.mixin)(h,s.default),(0,a.mixin)(h,l.default),e.default=h},function(t,e,n){"use strict";var r=n(169),i=n(53);t.exports=n(78)("Map",function(e){return function(t){return e(this,0<arguments.length?t:void 0)}},{get:function(t){var e=r.getEntry(i(this,"Map"),t);return e&&e.v},set:function(t,e){return r.def(i(this,"Map"),0===t?0:t,e)}},r,!0)},function(t,e,n){var r=n(13),i=n(16).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,n){var i=n(13);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,r){function i(){}var o=r(21),a=r(240),s=r(96),l=r(94)("IE_PROTO"),u="prototype",h=function(){var t,e=r(90)("iframe"),n=s.length;for(e.style.display="none",r(173).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),h=t.F;n--;)delete h[u][s[n]];return h()};t.exports=Object.create||function(t,e){var n;return null!==t?(i[u]=o(t),n=new i,i[u]=null,n[l]=t):n=h(),void 0===e?n:a(n,e)}},function(t,e,n){var r=n(52);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e,n){var r=n(95)("keys"),i=n(59);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e,n){var r=n(50),i=n(16),o="__core-js_shared__",a=i[o]||(i[o]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n(58)?"pure":"global",copyright:"Â© 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var o=n(14)("iterator"),a=!1;try{var r=[7][o]();r.return=function(){a=!0},Array.from(r,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!a)return!1;var n=!1;try{var r=[7],i=r[o]();i.next=function(){return{done:n=!0}},r[o]=function(){return i},t(r)}catch(t){}return n}},function(t,e,n){"use strict";var r=n(169),i=n(53);t.exports=n(78)("Set",function(e){return function(t){return e(this,0<arguments.length?t:void 0)}},{add:function(t){return r.def(i(this,"Set"),t=0===t?0:t,t)}},r)},function(t,e,n){"use strict";function r(e){return function(t){return e(this,0<arguments.length?t:void 0)}}var o,i=n(80)(0),a=n(36),s=n(40),l=n(184),u=n(185),h=n(13),c=n(27),d=n(53),f="WeakMap",p=s.getWeak,g=Object.isExtensible,v=u.ufstore,m={},y={get:function(t){if(h(t)){var e=p(t);return!0===e?v(d(this,f)).get(t):e?e[this._i]:void 0}},set:function(t,e){return u.def(d(this,f),t,e)}},w=t.exports=n(78)(f,r,y,u,!0,!0);c(function(){return 7!=(new w).set((Object.freeze||Object)(m),7).get(m)})&&(l((o=u.getConstructor(r,f)).prototype,y),s.NEED=!0,i(["delete","has","get","set"],function(r){var t=w.prototype,i=t[r];a(t,r,function(t,e){if(!h(t)||g(t))return i.call(this,t,e);this._f||(this._f=new o);var n=this._f[r](t,e);return"set"==r?this:n})}))},function(t,e,n){"use strict";var r=n(185),i=n(53);n(78)("WeakSet",function(e){return function(t){return e(this,0<arguments.length?t:void 0)}},{add:function(t){return r.def(i(this,"WeakSet"),t,!0)}},r,!1,!0)},function(t,e,n){"use strict";function r(){}function c(t){var e;return!(!v(t)||"function"!=typeof(e=t.then))&&e}function i(h,n){if(!h._n){h._n=!0;var r=h._c;E(function(){for(var l=h._v,u=1==h._s,t=0,e=function(t){var e,n,r,i=u?t.ok:t.fail,o=t.resolve,a=t.reject,s=t.domain;try{i?(u||(2==h._h&&B(h),h._h=1),!0===i?e=l:(s&&s.enter(),e=i(l),s&&(s.exit(),r=!0)),e===t.promise?a(_("Promise-chain cycle")):(n=c(e))?n.call(e,o,a):o(e)):a(l)}catch(t){s&&!r&&s.exit(),a(t)}};r.length>t;)e(r[t++]);h._c=[],h._n=!1,n&&!h._h&&P(h)})}}function o(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),i(e,!0))}var a,s,l,u,h=n(58),d=n(16),f=n(38),p=n(177),g=n(6),v=n(13),m=n(75),y=n(76),w=n(77),b=n(245),C=n(102).set,E=n(247)(),S=n(186),O=n(248),T=n(103),N=n(249),R="Promise",_=d.TypeError,M=d.process,A=M&&M.versions,k=A&&A.v8||"",x=d[R],I="process"==p(M),D=s=S.f,L=!!function(){try{var t=x.resolve(1),e=(t.constructor={})[n(14)("species")]=function(t){t(r,r)};return(I||"function"==typeof PromiseRejectionEvent)&&t.then(r)instanceof e&&0!==k.indexOf("6.6")&&-1===T.indexOf("Chrome/66")}catch(t){}}(),P=function(o){C.call(d,function(){var t,e,n,r=o._v,i=H(o);if(i&&(t=O(function(){I?M.emit("unhandledRejection",r,o):(e=d.onunhandledrejection)?e({promise:o,reason:r}):(n=d.console)&&n.error&&n.error("Unhandled promise rejection",r)}),o._h=I||H(o)?2:1),o._a=void 0,i&&t.e)throw t.v})},H=function(t){return 1!==t._h&&0===(t._a||t._c).length},B=function(e){C.call(d,function(){var t;I?M.emit("rejectionHandled",e):(t=d.onrejectionhandled)&&t({promise:e,reason:e._v})})},F=function(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw _("Promise can't be resolved itself");(n=c(t))?E(function(){var e={_w:r,_d:!1};try{n.call(t,f(F,e,1),f(o,e,1))}catch(t){o.call(e,t)}}):(r._v=t,r._s=1,i(r,!1))}catch(t){o.call({_w:r,_d:!1},t)}}};L||(x=function(t){y(this,x,R,"_h"),m(t),a.call(this);try{t(f(F,this,1),f(o,this,1))}catch(t){o.call(this,t)}},(a=function(){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(74)(x.prototype,{then:function(t,e){var n=D(b(this,x));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=I?M.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&i(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),l=function(){var t=new a;this.promise=t,this.resolve=f(F,t,1),this.reject=f(o,t,1)},S.f=D=function(t){return t===x||t===u?new l(t):s(t)}),g(g.G+g.W+g.F*!L,{Promise:x}),n(62)(x,R),n(181)(R),u=n(50)[R],g(g.S+g.F*!L,R,{reject:function(t){var e=D(this);return(0,e.reject)(t),e.promise}}),g(g.S+g.F*(h||!L),R,{resolve:function(t){return N(h&&this===u?x:this,t)}}),g(g.S+g.F*!(L&&n(97)(function(t){x.all(t).catch(r)})),R,{all:function(t){var a=this,e=D(a),s=e.resolve,l=e.reject,n=O(function(){var r=[],i=0,o=1;w(t,!1,function(t){var e=i++,n=!1;r.push(void 0),o++,a.resolve(t).then(function(t){n||(n=!0,r[e]=t,--o||s(r))},l)}),--o||s(r)});return n.e&&l(n.v),e.promise},race:function(t){var e=this,n=D(e),r=n.reject,i=O(function(){w(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}})},function(t,e,n){function r(){var t=+this;if(w.hasOwnProperty(t)){var e=w[t];delete w[t],e()}}function i(t){r.call(t.data)}var o,a,s,l=n(38),u=n(246),h=n(173),c=n(90),d=n(16),f=d.process,p=d.setImmediate,g=d.clearImmediate,v=d.MessageChannel,m=d.Dispatch,y=0,w={},b="onreadystatechange";p&&g||(p=function(t){for(var e=[],n=1;n<arguments.length;)e.push(arguments[n++]);return w[++y]=function(){u("function"==typeof t?t:Function(t),e)},o(y),y},g=function(t){delete w[t]},"process"==n(52)(f)?o=function(t){f.nextTick(l(r,t,1))}:m&&m.now?o=function(t){m.now(l(r,t,1))}:v?(s=(a=new v).port2,a.port1.onmessage=i,o=l(s.postMessage,s,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(o=function(t){d.postMessage(t+"","*")},d.addEventListener("message",i,!1)):o=b in c("script")?function(t){h.appendChild(c("script"))[b]=function(){h.removeChild(this),r.call(t)}}:function(t){setTimeout(l(r,t,1),0)}),t.exports={set:p,clear:g}},function(t,e,n){var r=n(16).navigator;t.exports=r&&r.userAgent||""},function(t,e,n){"use strict";function r(t){var e=G[t]=M(H[V]);return e._k=t,e}function i(t,e){O(t);for(var n,r=E(e=N(e)),i=0,o=r.length;i<o;)J(t,n=r[i++],e[n]);return t}function o(t){var e=U.call(this,t=R(t,!0));return!(this===$&&h(G,t)&&!h(Y,t))&&(!(e||!h(this,t)||!h(G,t)||h(this,j)&&this[j][t])||e)}function a(t,e){if(t=N(t),e=R(e,!0),t!==$||!h(G,e)||h(Y,e)){var n=D(t,e);return!n||!h(G,e)||h(t,j)&&t[j][e]||(n.enumerable=!0),n}}function s(t){for(var e,n=P(N(t)),r=[],i=0;n.length>i;)h(G,e=n[i++])||e==j||e==p||r.push(e);return r}function l(t){for(var e,n=t===$,r=P(n?Y:N(t)),i=[],o=0;r.length>o;)!h(G,e=r[o++])||n&&!h($,e)||i.push(G[e]);return i}var u=n(16),h=n(35),c=n(26),d=n(6),f=n(36),p=n(40).KEY,g=n(27),v=n(95),m=n(62),y=n(59),w=n(14),b=n(187),C=n(250),E=n(251),S=n(183),O=n(21),T=n(13),N=n(28),R=n(91),_=n(60),M=n(92),A=n(188),k=n(79),x=n(24),I=n(48),D=k.f,L=x.f,P=A.f,H=u.Symbol,B=u.JSON,F=B&&B.stringify,V="prototype",j=w("_hidden"),W=w("toPrimitive"),U={}.propertyIsEnumerable,z=v("symbol-registry"),G=v("symbols"),Y=v("op-symbols"),$=Object[V],X="function"==typeof H,K=u.QObject,q=!K||!K[V]||!K[V].findChild,Z=c&&g(function(){return 7!=M(L({},"a",{get:function(){return L(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=D($,e);r&&delete $[e],L(t,e,n),r&&t!==$&&L($,e,r)}:L,Q=X&&"symbol"==typeof H.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof H},J=function(t,e,n){return t===$&&J(Y,e,n),O(t),e=R(e,!0),O(n),h(G,e)?(n.enumerable?(h(t,j)&&t[j][e]&&(t[j][e]=!1),n=M(n,{enumerable:_(0,!1)})):(h(t,j)||L(t,j,_(1,{})),t[j][e]=!0),Z(t,e,n)):L(t,e,n)};X||(f((H=function(t){if(this instanceof H)throw TypeError("Symbol is not a constructor!");var e=y(0<arguments.length?t:void 0),n=function(t){this===$&&n.call(Y,t),h(this,j)&&h(this[j],e)&&(this[j][e]=!1),Z(this,e,_(1,t))};return c&&q&&Z($,e,{configurable:!0,set:n}),r(e)})[V],"toString",function(){return this._k}),k.f=a,x.f=J,n(105).f=A.f=s,n(63).f=o,n(81).f=l,c&&!n(58)&&f($,"propertyIsEnumerable",o,!0),b.f=function(t){return r(w(t))}),d(d.G+d.W+d.F*!X,{Symbol:H});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;tt.length>et;)w(tt[et++]);for(var nt=I(w.store),rt=0;nt.length>rt;)C(nt[rt++]);d(d.S+d.F*!X,"Symbol",{for:function(t){return h(z,t+="")?z[t]:z[t]=H(t)},keyFor:function(t){if(!Q(t))throw TypeError(t+" is not a symbol!");for(var e in z)if(z[e]===t)return e},useSetter:function(){q=!0},useSimple:function(){q=!1}}),d(d.S+d.F*!X,"Object",{create:function(t,e){return void 0===e?M(t):i(M(t),e)},defineProperty:J,defineProperties:i,getOwnPropertyDescriptor:a,getOwnPropertyNames:s,getOwnPropertySymbols:l}),B&&d(d.S+d.F*(!X||g(function(){var t=H();return"[null]"!=F([t])||"{}"!=F({a:t})||"{}"!=F(Object(t))})),"JSON",{stringify:function(t){for(var e,n,r=[t],i=1;i<arguments.length;)r.push(arguments[i++]);if(n=e=r[1],(T(e)||void 0!==t)&&!Q(t))return S(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Q(e))return e}),r[1]=e,F.apply(B,r)}}),H[V][W]||n(37)(H[V],W,H[V].valueOf),m(H,"Symbol"),m(Math,"Math",!0),m(u.JSON,"JSON",!0)},function(t,e,n){var r=n(171),i=n(96).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e,n){var r=n(13),i=n(40).onFreeze;n(30)("freeze",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(t,e,n){var r=n(13),i=n(40).onFreeze;n(30)("seal",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(t,e,n){var r=n(13),i=n(40).onFreeze;n(30)("preventExtensions",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(t,e,n){var r=n(13);n(30)("isFrozen",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(t,e,n){var r=n(13);n(30)("isSealed",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(t,e,n){var r=n(13);n(30)("isExtensible",function(e){return function(t){return!!r(t)&&(!e||e(t))}})},function(t,e,n){var r=n(28),i=n(79).f;n(30)("getOwnPropertyDescriptor",function(){return function(t,e){return i(r(t),e)}})},function(t,e,n){var r=n(39),i=n(179);n(30)("getPrototypeOf",function(){return function(t){return i(r(t))}})},function(t,e,n){var r=n(39),i=n(48);n(30)("keys",function(){return function(t){return i(r(t))}})},function(t,e,n){n(30)("getOwnPropertyNames",function(){return n(188).f})},function(t,e,n){var r=n(6);r(r.S+r.F,"Object",{assign:n(184)})},function(t,e,n){var r=n(6);r(r.S,"Object",{is:n(252)})},function(t,e,n){var r=n(6);r(r.S,"Object",{setPrototypeOf:n(182).set})},function(t,e,n){var r=n(24).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||n(26)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},function(t,e,n){var r=n(6),a=n(28),s=n(29);r(r.S,"String",{raw:function(t){for(var e=a(t.raw),n=s(e.length),r=arguments.length,i=[],o=0;o<n;)i.push(String(e[o++])),o<r&&i.push(String(arguments[o]));return i.join("")}})},function(t,e,n){var r=n(6),o=n(73),a=String.fromCharCode,i=String.fromCodePoint;r(r.S+r.F*(!!i&&1!=i.length),"String",{fromCodePoint:function(t){for(var e,n=[],r=arguments.length,i=0;i<r;){if(e=+arguments[i++],o(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?a(e):a(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},function(t,e,n){"use strict";var r=n(6),i=n(253)(!1);r(r.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,e,n){var r=n(6);r(r.P,"String",{repeat:n(189)})},function(t,e,n){"use strict";var r=n(6),o=n(29),a=n(125),s="startsWith",l=""[s];r(r.P+r.F*n(126)(s),"String",{startsWith:function(t,e){var n=a(this,t,s),r=o(Math.min(1<arguments.length?e:void 0,n.length)),i=String(t);return l?l.call(n,i,r):n.slice(r,r+i.length)===i}})},function(t,e,n){var r=n(190),i=n(49);t.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(t))}},function(t,e,n){var r=n(14)("match");t.exports=function(e){var n=/./;try{"/./"[e](n)}catch(t){try{return n[r]=!1,!"/./"[e](n)}catch(t){}}return!0}},function(t,e,n){"use strict";var r=n(6),s=n(29),l=n(125),u="endsWith",h=""[u];r(r.P+r.F*n(126)(u),"String",{endsWith:function(t,e){var n=l(this,t,u),r=1<arguments.length?e:void 0,i=s(n.length),o=void 0===r?i:Math.min(s(r),i),a=String(t);return h?h.call(n,a,o):n.slice(o-a.length,o)===a}})},function(t,e,n){"use strict";var r=n(6),i=n(125);r(r.P+r.F*n(126)("includes"),"String",{includes:function(t,e){return!!~i(this,t,"includes").indexOf(t,1<arguments.length?e:void 0)}})},function(t,e,n){n(26)&&"g"!=/./g.flags&&n(24).f(RegExp.prototype,"flags",{configurable:!0,get:n(254)})},function(t,e,n){n(82)("match",1,function(r,i,t){return[function(t){"use strict";var e=r(this),n=null==t?void 0:t[i];return void 0!==n?n.call(t,e):new RegExp(t)[i](String(e))},t]})},function(t,e,n){n(82)("replace",2,function(i,o,a){return[function(t,e){"use strict";var n=i(this),r=null==t?void 0:t[o];return void 0!==r?r.call(t,n,e):a.call(String(n),t,e)},a]})},function(t,e,n){n(82)("split",2,function(i,o,a){"use strict";var f=n(190),p=a,g=[].push,t="split",v="length";if("c"=="abbc"[t](/(b)*/)[1]||4!="test"[t](/(?:)/,-1)[v]||2!="ab"[t](/(?:ab)*/)[v]||4!="."[t](/(.?)(.?)/)[v]||1<"."[t](/()()/)[v]||""[t](/.?/)[v]){var m=void 0===/()??/.exec("")[1];a=function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!f(t))return p.call(n,t,e);var r,i,o,a,s,l=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,c=void 0===e?4294967295:e>>>0,d=new RegExp(t.source,u+"g");for(m||(r=new RegExp("^"+d.source+"$(?!\\s)",u));(i=d.exec(n))&&!(h<(o=i.index+i[0][v])&&(l.push(n.slice(h,i.index)),!m&&1<i[v]&&i[0].replace(r,function(){for(s=1;s<arguments[v]-2;s++)void 0===arguments[s]&&(i[s]=void 0)}),1<i[v]&&i.index<n[v]&&g.apply(l,i.slice(1)),a=i[0][v],h=o,l[v]>=c));)d.lastIndex===i.index&&d.lastIndex++;return h===n[v]?!a&&d.test("")||l.push(""):l.push(n.slice(h)),l[v]>c?l.slice(0,c):l}}else"0"[t](void 0,0)[v]&&(a=function(t,e){return void 0===t&&0===e?[]:p.call(this,t,e)});return[function(t,e){var n=i(this),r=null==t?void 0:t[o];return void 0!==r?r.call(t,n,e):a.call(String(n),t,e)},a]})},function(t,e,n){n(82)("search",1,function(r,i,t){return[function(t){"use strict";var e=r(this),n=null==t?void 0:t[i];return void 0!==n?n.call(t,e):new RegExp(t)[i](String(e))},t]})},function(t,e,n){"use strict";var p=n(38),r=n(6),g=n(39),v=n(174),m=n(175),y=n(29),w=n(135),b=n(176);r(r.S+r.F*!n(97)(function(t){Array.from(t)}),"Array",{from:function(t,e,n){var r,i,o,a,s=g(t),l="function"==typeof this?this:Array,u=arguments.length,h=1<u?e:void 0,c=void 0!==h,d=0,f=b(s);if(c&&(h=p(h,2<u?n:void 0,2)),null==f||l==Array&&m(f))for(i=new l(r=y(s.length));d<r;d++)w(i,d,c?h(s[d],d):s[d]);else for(a=f.call(s),i=new l;!(o=a.next()).done;d++)w(i,d,c?v(a,h,[o.value,d],!0):o.value);return i.length=d,i}})},function(t,e,n){"use strict";var r=n(24),i=n(60);t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},function(t,e,n){"use strict";var r=n(6),i=n(135);r(r.S+r.F*n(27)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);t<e;)i(n,t,arguments[t++]);return n.length=e,n}})},function(t,e,n){var r=n(6);r(r.P,"Array",{copyWithin:n(255)}),n(54)("copyWithin")},function(t,e,n){"use strict";var r=n(6),i=n(80)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),r(r.P+r.F*o,"Array",{find:function(t,e){return i(this,t,1<arguments.length?e:void 0)}}),n(54)("find")},function(t,e,n){"use strict";var r=n(6),i=n(80)(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),r(r.P+r.F*a,"Array",{findIndex:function(t,e){return i(this,t,1<arguments.length?e:void 0)}}),n(54)(o)},function(t,e,n){var r=n(6);r(r.P,"Array",{fill:n(256)}),n(54)("fill")},function(t,e,n){var r=n(6),i=n(16).isFinite;r(r.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,e,n){var r=n(6);r(r.S,"Number",{isInteger:n(191)})},function(t,e,n){var r=n(6),i=n(191),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,e,n){var r=n(6);r(r.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){var r=n(6);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var r=n(6);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){var r=n(6);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){"use strict";var r=n(6),i=n(172)(!0);r(r.P,"Array",{includes:function(t,e){return i(this,t,1<arguments.length?e:void 0)}}),n(54)("includes")},function(t,e,n){var r=n(6),i=n(192)(!1);r(r.S,"Object",{values:function(t){return i(t)}})},function(t,e,n){var r=n(6),i=n(192)(!0);r(r.S,"Object",{entries:function(t){return i(t)}})},function(t,e,n){var r=n(6),l=n(257),u=n(28),h=n(79),c=n(135);r(r.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,r=u(t),i=h.f,o=l(r),a={},s=0;o.length>s;)void 0!==(n=i(r,e=o[s++]))&&c(a,e,n);return a}})},function(t,e,n){"use strict";var r=n(6),i=n(193),o=n(103);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padStart:function(t,e){return i(this,t,1<arguments.length?e:void 0,!0)}})},function(t,e,n){"use strict";var r=n(6),i=n(193),o=n(103);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padEnd:function(t,e){return i(this,t,1<arguments.length?e:void 0,!1)}})},function(t,e,n){var r=n(6),i=n(102);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,e,n){for(var r=n(83),i=n(48),o=n(36),a=n(16),s=n(37),l=n(61),u=n(14),h=u("iterator"),c=u("toStringTag"),d=l.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(f),g=0;g<p.length;g++){var v,m=p[g],y=f[m],w=a[m],b=w&&w.prototype;if(b&&(b[h]||s(b,h,d),b[c]||s(b,c,m),l[m]=d,y))for(v in r)b[v]||o(b,v,r[v],!0)}},function(t,e,n){"use strict";e.__esModule=!0,e.getRegisteredCellTypes=e.getRegisteredCellTypeNames=e.hasCellType=e.getCellType=e.registerCellType=void 0;var r=v(n(41)),o=n(19),a=n(15),s=n(44),i=v(n(290)),l=v(n(291)),u=v(n(292)),h=v(n(293)),c=v(n(294)),d=v(n(295)),f=v(n(296)),p=v(n(297)),g=v(n(298));function v(t){return t&&t.__esModule?t:{default:t}}var m=(0,r.default)("cellTypes"),y=m.register,w=m.getItem,b=m.hasItem,C=m.getNames,E=m.getValues;function S(t,e){var n=e.editor,r=e.renderer,i=e.validator;n&&(0,o.registerEditor)(t,n),r&&(0,a.registerRenderer)(t,r),i&&(0,s.registerValidator)(t,i),y(t,e)}S("autocomplete",i.default),S("checkbox",l.default),S("date",u.default),S("dropdown",h.default),S("handsontable",c.default),S("numeric",d.default),S("password",f.default),S("text",p.default),S("time",g.default),e.registerCellType=S,e.getCellType=function(t){if(!b(t))throw Error('You declared cell type "'+t+'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by "Handsontable.cellTypes.registerCellType" method');return w(t)},e.hasCellType=b,e.getRegisteredCellTypeNames=C,e.getRegisteredCellTypes=E},function(t,e,n){"use strict";e.__esModule=!0;var r,i,j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=(r=["Deprecation warning: This method is going to be removed in the next release.\n      If you want to select a cell using props, please use the `selectCell` method."],i=["Deprecation warning: This method is going to be removed in the next release.\n      If you want to select a cell using props, please use the \\`selectCell\\` method."],Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(i)}})));e.default=function(t,e){var d=this,n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],f=!1,F=this,g=function(){},r=new M.default(F),V=void 0,m=void 0,h=void 0,y=void 0,v=void 0;(0,U.extend)(g.prototype,K.default.prototype),(0,U.extend)(g.prototype,e),(0,U.extend)(g.prototype,S(e)),(0,J.applyLanguageSetting)(g.prototype,e.language),(0,Y.hasValidParameter)(n)&&(0,Y.registerAsRootInstance)(this);(0,tt.startObserving)(),this.isDestroyed=!1,this.rootElement=t,this.isHotTableEnv=(0,T.isChildOfWebComponentTable)(this.rootElement),M.default.isHotTableEnv=this.isHotTableEnv,this.container=document.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),(0,Y.isRootInstance)(this)&&(0,W._injectProductInfo)(e.licenseKey,t);this.guid="ht_"+(0,L.randomString)();var w=(0,G.getTranslator)(F);h=new B.default(F),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);V={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width","language"],settings:new g,selRange:null,isPopulated:null,scrollable:null,firstRun:!0};var b=new et.Selection(V.settings,{countCols:function(){return F.countCols()},countRows:function(){return F.countRows()},propToCol:function(t){return m.propToCol(t)},isEditorOpened:function(){return!!F.getActiveEditor()&&F.getActiveEditor().isOpened()}});function p(){var t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function c(i,e,n){var t,r,o,a=new p;a.onQueueEmpty=function(){var t=void 0;i.length&&(t=F.runHooks("beforeChange",i,e||"edit"),(0,R.isFunction)(t)?(0,_.warn)("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):!1===t&&i.splice(0,i.length));n()};for(var s=i.length-1;0<=s;s--)if(null===i[s])i.splice(s,1);else{var l=O(i[s],4),u=l[0],h=l[1],c=l[3],d=m.propToCol(h),f=F.getCellMeta(u,d);"numeric"===f.type&&"string"==typeof c&&(0<(o=c).length&&/^-?[\d\s]*(\.|,)?\d*$/.test(o))&&(i[s][3]=(void 0,r=(t=c).replace(",","."),!1===isNaN(parseFloat(r))?parseFloat(r):t)),F.getCellValidator(f)&&(a.addValidatorToQueue(),F.validateCell(i[s][3],f,function(n,r){return function(t){if("boolean"!=typeof t)throw new Error("Validation error: result is not boolean");if(!1===t&&!1===r.allowInvalid){i.splice(n,1),r.valid=!0;var e=F.getCell(r.visualRow,r.visualCol);null!==e&&(0,T.removeClass)(e,F.getSettings().invalidCellClassName)}a.removeValidatorFormQueue()}}(s,f),e))}a.checkIfQueueIsEmpty()}function C(t,e){var n=t.length-1;if(!(n<0)){for(;0<=n;n--){var r=!1;if(null!==t[n]){if(null!==t[n][2]&&void 0!==t[n][2]||null!==t[n][3]&&void 0!==t[n][3]){if(V.settings.allowInsertRow)for(;t[n][0]>F.countRows()-1;){if(0===m.createRow(void 0,void 0,e)){r=!0;break}}if(!r){if("array"===F.dataType&&(!V.settings.columns||0===V.settings.columns.length)&&V.settings.allowInsertColumn)for(;m.propToCol(t[n][1])>F.countCols()-1;)m.createCol(void 0,void 0,e);m.set(t[n][0],t[n][1],t[n][3])}}}else t.splice(n,1)}F.forceFullRender=!0,y.adjustRowsAndCols(),F.runHooks("beforeChangeRender",t,e),v.lockEditor(),F._refreshBorders(null),v.unlockEditor(),F.view.wt.wtOverlays.adjustElementsSize(),F.runHooks("afterChange",t,e||"edit");var i=F.getActiveEditor();i&&(0,W.isDefined)(i.refreshValue)&&i.refreshValue()}}function E(t,e,n){return"object"===(void 0===t?"undefined":j(t))?t:[[t,e,n]]}function S(t){if((0,U.hasOwnProperty)(t,"type")){var e={},n=void 0;for(var r in"object"===j(t.type)?n=t.type:"string"==typeof t.type&&(n=(0,q.getCellType)(t.type)),n)(0,U.hasOwnProperty)(n,r)&&!(0,U.hasOwnProperty)(t,r)&&(e[r]=n[r]);return e}}this.selection=b,this.selection.addLocalHook("beforeSetRangeStart",function(t){d.runHooks("beforeSetRangeStart",t)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(t){d.runHooks("beforeSetRangeStartOnly",t)}),this.selection.addLocalHook("beforeSetRangeEnd",function(t){d.runHooks("beforeSetRangeEnd",t),t.row<0&&(t.row=d.view.wt.wtTable.getFirstVisibleRow()),t.col<0&&(t.col=d.view.wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(t){var e=(0,U.createObjectPropListener)(!1),n=d.selection.getSelectedRange(),r=n.current(),i=r.from,o=r.to,a=n.size()-1;d.runHooks("afterSelection",i.row,i.col,o.row,o.col,e,a),d.runHooks("afterSelectionByProp",i.row,F.colToProp(i.col),o.row,F.colToProp(o.col),e,a);var s=d.selection.isSelectedByAnyHeader(),l=d.selection.selectedRange.current(),u=!0;f&&(u=!1),e.isTouched()&&(u=!e.value);var h=d.selection.isSelectedByRowHeader(),c=d.selection.isSelectedByColumnHeader();!1!==u&&(s?h?d.view.scrollViewportVertically(t.row):c&&d.view.scrollViewportHorizontally(t.col):l&&!d.selection.isMultiple()?d.view.scrollViewport(l.from):d.view.scrollViewport(t)),h&&c?(0,T.addClass)(d.rootElement,["ht__selection--rows","ht__selection--columns"]):h?((0,T.removeClass)(d.rootElement,"ht__selection--columns"),(0,T.addClass)(d.rootElement,"ht__selection--rows")):c?((0,T.removeClass)(d.rootElement,"ht__selection--rows"),(0,T.addClass)(d.rootElement,"ht__selection--columns")):(0,T.removeClass)(d.rootElement,["ht__selection--rows","ht__selection--columns"]),d._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(t){var e=t.length-1,n=t[e],r=n.from,i=n.to;d.runHooks("afterSelectionEnd",r.row,r.col,i.row,i.col,e),d.runHooks("afterSelectionEndByProp",r.row,F.colToProp(r.col),i.row,F.colToProp(i.col),e)}),this.selection.addLocalHook("afterIsMultipleSelection",function(t){var e=d.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)}),this.selection.addLocalHook("beforeModifyTransformStart",function(t){d.runHooks("modifyTransformStart",t)}),this.selection.addLocalHook("afterModifyTransformStart",function(t,e,n){d.runHooks("afterModifyTransformStart",t,e,n)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(t){d.runHooks("modifyTransformEnd",t)}),this.selection.addLocalHook("afterModifyTransformEnd",function(t,e,n){d.runHooks("afterModifyTransformEnd",t,e,n)}),this.selection.addLocalHook("afterDeselect",function(){v.destroyEditor(),d._refreshBorders(),(0,T.removeClass)(d.rootElement,["ht__selection--rows","ht__selection--columns"]),d.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(t){d.alter("insert_row",t,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(t){d.alter("insert_col",t,1,"auto")}),y={alter:function(t,e,n,r,i){var u=2<arguments.length&&void 0!==n?n:1,h=r,o=i,a=void 0;function s(t,e,n,r){var i=(0,A.arrayMap)(new Array(n),function(){return function(){var t=void 0;return"array"===r?t=[]:"object"===r&&(t={}),t}()});i.unshift(e,0),t.splice.apply(t,nt(i))}function l(t){if(0===t.length)return[];var e=[].concat(nt(t));return e.sort(function(t,e){var n=O(t,1)[0],r=O(e,1)[0];return n===r?0:r<n?1:-1}),(0,A.arrayReduce)(e,function(t,e){var n=O(e,2),r=n[0],i=n[1],o=t[t.length-1],a=O(o,2),s=a[0]+a[1];if(r<=s){var l=Math.max(i-(s-r),0);o[1]+=l}else t.push([r,i]);return t},[e[0]])}switch(t){case"insert_row":var c=F.countSourceRows();if(F.getSettings().maxRows===c)return;e=(0,W.isDefined)(e)?e:c,a=m.createRow(e,u,h),s(V.cellSettings,e,u,"array"),a&&(b.isSelected()&&b.selectedRange.current().from.row>=e?(b.selectedRange.current().from.row+=a,b.transformEnd(a,0)):F._refreshBorders());break;case"insert_col":a=m.createCol(e,u,h);for(var d=0,f=F.countSourceRows();d<f;d++)V.cellSettings[d]&&s(V.cellSettings[d],e,u);if(a){if(Array.isArray(F.getSettings().colHeaders)){var p=[e,0];p.length+=a,Array.prototype.splice.apply(F.getSettings().colHeaders,p)}b.isSelected()&&b.selectedRange.current().from.col>=e?(b.selectedRange.current().from.col+=a,b.transformEnd(0,a)):F._refreshBorders()}break;case"remove_row":var g=function(t){var l=0;(0,A.arrayEach)(t,function(t){var e=O(t,2),n=e[0],r=e[1],i=(0,W.isEmpty)(n)?F.countRows()-1:Math.max(n-l,0);Number.isInteger(n)&&(n=Math.max(n-l,0)),m.removeRow(n,r,h),V.cellSettings.splice(i,u);var o=F.countRows(),a=F.getSettings().fixedRowsTop;i+1<=a&&(F.getSettings().fixedRowsTop-=Math.min(r,a-i));var s=F.getSettings().fixedRowsBottom;s&&o-s<=i&&(F.getSettings().fixedRowsBottom-=Math.min(r,s)),l+=r})};Array.isArray(e)?g(l(e)):g([[e,u]]),y.adjustRowsAndCols(),F._refreshBorders();break;case"remove_col":var v=function(t){var u=0;(0,A.arrayEach)(t,function(t){var e=O(t,2),n=e[0],r=e[1],i=(0,W.isEmpty)(n)?F.countCols()-1:Math.max(n-u,0),o=w.toPhysicalColumn(i);Number.isInteger(n)&&(n=Math.max(n-u,0)),m.removeCol(n,r,h);for(var a=0,s=F.countSourceRows();a<s;a++)V.cellSettings[a]&&V.cellSettings[a].splice(o,r);var l=F.getSettings().fixedColumnsLeft;i+1<=l&&(F.getSettings().fixedColumnsLeft-=Math.min(r,l-i)),Array.isArray(F.getSettings().colHeaders)&&(void 0===o&&(o=-1),F.getSettings().colHeaders.splice(o,r)),u+=r})};Array.isArray(e)?v(l(e)):v([[e,u]]),y.adjustRowsAndCols(),F._refreshBorders();break;default:throw new Error('There is no such action "'+t+'"')}o||y.adjustRowsAndCols()},adjustRowsAndCols:function(){if(V.settings.minRows){var t=F.countRows();if(t<V.settings.minRows)for(var e=0,n=V.settings.minRows;e<n-t;e++)m.createRow(F.countRows(),1,"auto")}if(V.settings.minSpareRows){var r=F.countEmptyRows(!0);if(r<V.settings.minSpareRows)for(;r<V.settings.minSpareRows&&F.countSourceRows()<V.settings.maxRows;r++)m.createRow(F.countRows(),1,"auto")}var i=void 0;if((V.settings.minCols||V.settings.minSpareCols)&&(i=F.countEmptyCols(!0)),V.settings.minCols&&!V.settings.columns&&F.countCols()<V.settings.minCols)for(;F.countCols()<V.settings.minCols;i++)m.createCol(F.countCols(),1,"auto");if(V.settings.minSpareCols&&!V.settings.columns&&"array"===F.dataType&&i<V.settings.minSpareCols)for(;i<V.settings.minSpareCols&&F.countCols()<V.settings.maxCols;i++)m.createCol(F.countCols(),1,"auto");var a=F.countRows(),s=F.countCols();0!==a&&0!==s||b.deselect(),b.isSelected()&&(0,A.arrayEach)(b.selectedRange,function(t){var e=!1,n=t.from.row,r=t.from.col,i=t.to.row,o=t.to.col;a-1<n?(e=!0,(n=a-1)<i&&(i=n)):a-1<i&&(e=!0,(i=a-1)<n&&(n=i)),s-1<r?(e=!0,(r=s-1)<o&&(o=r)):s-1<o&&(e=!0,(o=s-1)<r&&(r=o)),e&&F.selectCell(n,r,i,o)}),F.view&&F.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(t,i,e,n,r,o,a){var s=void 0,l=void 0,u=void 0,h=void 0,c=[],d={};if(0===(l=i.length))return!1;var f=void 0,p=void 0,g=void 0,v=void 0;switch(r){case"shift_down":for(f=e?e.col-t.col+1:0,p=e?e.row-t.row+1:0,h=(i=(u=0,z.translateRowsToColumns)(i)).length,g=Math.max(h,f);u<g;u++)if(u<h){var m;for(s=0,l=i[u].length;s<p-l;s++)i[u].push(i[u][s%l]);i[u].unshift(t.col+u,t.row,0),(m=F).spliceCol.apply(m,nt(i[u]))}else{var y;i[u%h][0]=t.col+u,(y=F).spliceCol.apply(y,nt(i[u%h]))}break;case"shift_right":for(f=e?e.col-t.col+1:0,p=e?e.row-t.row+1:0,s=0,l=i.length,v=Math.max(l,p);s<v;s++)if(s<l){var w;for(u=0,h=i[s].length;u<f-h;u++)i[s].push(i[s][u%h]);i[s].unshift(t.row+s,t.col,0),(w=F).spliceRow.apply(w,nt(i[s]))}else{var b;i[s%l][0]=t.row+s,(b=F).spliceRow.apply(b,nt(i[s%l]))}break;case"overwrite":default:d.row=t.row,d.col=t.col;var C={row:e&&t?e.row-t.row+1:1,col:e&&t?e.col-t.col+1:1},E=0,S=0,O=!0,T=void 0,N=function(t,e){var n=1<arguments.length&&void 0!==e?e:null,r=i[t%i.length];return null!==n?r[n%r.length]:r},R=i.length,_=e?e.row-t.row+1:0;for(l=e?_:Math.max(R,_),s=0;s<l&&!(e&&d.row>e.row&&R<_||!V.settings.allowInsertRow&&d.row>F.countRows()-1||d.row>=V.settings.maxRows);s++){var M=s-E,A=N(M).length,k=e?e.col-t.col+1:0;if(h=e?k:Math.max(A,k),d.col=t.col,T=F.getCellMeta(d.row,d.col),"CopyPaste.paste"!==n&&"Autofill.autofill"!==n||!T.skipRowOnPaste){for(u=S=0;u<h&&!(e&&d.col>e.col&&A<k||!V.settings.allowInsertColumn&&d.col>F.countCols()-1||d.col>=V.settings.maxCols);u++)if(T=F.getCellMeta(d.row,d.col),"CopyPaste.paste"!==n&&"Autofill.fill"!==n||!T.skipColumnOnPaste)if(T.readOnly)d.col+=1;else{var x=u-S,I=N(M,x),D=F.getDataAtCell(d.row,d.col),L={row:M,col:x};if("Autofill.fill"===n){var P=F.runHooks("beforeAutofillInsidePopulate",L,o,i,a,{},C);P&&(I=(0,W.isUndefined)(P.value)?I:P.value)}if(null!==I&&"object"===(void 0===I?"undefined":j(I)))if(null===D||"object"!==(void 0===D?"undefined":j(D)))O=!1;else{var H=(0,U.duckSchema)(D[0]||D),B=(0,U.duckSchema)(I[0]||I);(0,U.isObjectEqual)(H,B)?I=(0,U.deepClone)(I):O=!1}else null!==D&&"object"===(void 0===D?"undefined":j(D))&&(O=!1);O&&c.push([d.row,d.col,I]),O=!0,d.col+=1}else S+=1,d.col+=1,h+=1;d.row+=1}else E+=1,d.row+=1,l+=1}F.setDataAtCell(c,null,null,n||"populateFromArray")}}},this.init=function(){h.setData(V.settings.data),F.runHooks("beforeInit"),(0,s.isMobileBrowser)()&&(0,T.addClass)(F.rootElement,"mobile"),this.updateSettings(V.settings,!0),this.view=new H.default(this),v=u.default.getInstance(F,V,b,m),this.forceFullRender=!0,F.runHooks("init"),this.view.render(),"object"===j(V.firstRun)&&(F.runHooks("afterChange",V.firstRun[0],V.firstRun[1]),V.firstRun=!1),F.runHooks("afterInit")},this.validateCell=function(e,o,a,n){var r,t=F.getCellValidator(o);function i(t,e){if((!(1<arguments.length&&void 0!==e)||e)&&!0!==o.hidden){var n=o.visualCol,r=o.visualRow,i=F.getCell(r,n,!0);i&&"TH"!==i.nodeName&&F.view.wt.wtSettings.settings.cellRenderer(r,n,i),a(t)}else a(t)}(0,W.isRegExp)(t)&&(r=t,t=function(t,e){e(r.test(t))}),(0,R.isFunction)(t)?(e=F.runHooks("beforeValidate",e,o.visualRow,o.prop,n),F._registerTimeout(setTimeout(function(){t.call(o,e,function(t){t=F.runHooks("afterValidate",t,e,o.visualRow,o.prop,n),i(o.valid=t),F.runHooks("postAfterValidate",t,e,o.visualRow,o.prop,n)})},0))):F._registerTimeout(setTimeout(function(){o.valid=!0,i(o.valid,!1)},0))},this.setDataAtCell=function(t,e,n,r){var i,o=E(t,e,n),a=[],s=r,l=void 0,u=void 0;for(l=0,i=o.length;l<i;l++){if("object"!==j(o[l]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof o[l][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");u=m.colToProp(o[l][1]),a.push([o[l][0],u,h.getAtCell(w.toPhysicalRow(o[l][0]),o[l][1]),o[l][2]])}s||"object"!==(void 0===t?"undefined":j(t))||(s=e),F.runHooks("afterSetDataAtCell",a,s),c(a,s,function(){C(a,s)})},this.setDataAtRowProp=function(t,e,n,r){var i,o=E(t,e,n),a=[],s=r,l=void 0;for(l=0,i=o.length;l<i;l++)a.push([o[l][0],o[l][1],h.getAtCell(w.toPhysicalRow(o[l][0]),o[l][1]),o[l][2]]);s||"object"!==(void 0===t?"undefined":j(t))||(s=e),F.runHooks("afterSetDataAtRowProp",a,s),c(a,s,function(){C(a,s)})},this.listen=function(){if(!(0<arguments.length&&void 0!==arguments[0])||arguments[0]){var t=!document.activeElement||document.activeElement&&void 0===document.activeElement.nodeName;document.activeElement&&document.activeElement!==document.body&&!t?document.activeElement.blur():t&&document.body.focus()}F&&!F.isListening()&&(rt=F.guid,F.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(rt=null,F.runHooks("afterUnlisten"))},this.isListening=function(){return rt===F.guid},this.destroyEditor=function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];F._refreshBorders(t,e)},this.populateFromArray=function(t,e,n,r,i,o,a,s,l){if("object"!==(void 0===n?"undefined":j(n))||"object"!==j(n[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");var u="number"==typeof r?new $.CellCoords(r,i):null;return y.populateFromArray(new $.CellCoords(t,e),n,u,o,a,s,l)},this.spliceCol=function(t,e,n){for(var r,i=arguments.length,o=Array(3<i?i-3:0),a=3;a<i;a++)o[a-3]=arguments[a];return(r=m).spliceCol.apply(r,[t,e,n].concat(o))},this.spliceRow=function(t,e,n){for(var r,i=arguments.length,o=Array(3<i?i-3:0),a=3;a<i;a++)o[a-3]=arguments[a];return(r=m).spliceRow.apply(r,[t,e,n].concat(o))},this.getSelected=function(){if(b.isSelected())return(0,A.arrayMap)(b.getSelectedRange(),function(t){var e=t.from,n=t.to;return[e.row,e.col,n.row,n.col]})},this.getSelectedLast=function(){var t=this.getSelected(),e=void 0;return t&&0<t.length&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(b.isSelected())return Array.from(b.getSelectedRange())},this.getSelectedRangeLast=function(){var t=this.getSelectedRange(),e=void 0;return t&&0<t.length&&(e=t[t.length-1]),e},this.emptySelectedCells=function(){var i=this;if(b.isSelected()){var o=[];(0,A.arrayEach)(b.getSelectedRange(),function(t){var n=t.getTopLeftCorner(),r=t.getBottomRightCorner();(0,P.rangeEach)(n.row,r.row,function(e){(0,P.rangeEach)(n.col,r.col,function(t){i.getCellMeta(e,t).readOnly||o.push([e,t,""])})})}),0<o.length&&this.setDataAtCell(o)}},this.render=function(){F.view&&(F.renderCall=!0,F.forceFullRender=!0,v.lockEditor(),F._refreshBorders(null),v.unlockEditor())},this.loadData=function(t){if(Array.isArray(V.settings.dataSchema)?F.dataType="array":(0,R.isFunction)(V.settings.dataSchema)?F.dataType="function":F.dataType="object",m&&m.destroy(),m=new l.default(F,V,g),"object"===(void 0===t?"undefined":j(t))&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error("loadData only accepts array of objects or array of arrays ("+(void 0===t?"undefined":j(t))+" given)");var e=m.getSchema();t=[];var n,r=void 0,i=0;for(i=0,n=V.settings.startRows;i<n;i++)if("object"!==F.dataType&&"function"!==F.dataType||!V.settings.dataSchema)if("array"===F.dataType)r=(0,U.deepClone)(e[0]),t.push(r);else{r=[];for(var o=0,a=V.settings.startCols;o<a;o++)r.push(null);t.push(r)}else r=(0,U.deepClone)(e),t.push(r)}V.isPopulated=!1,g.prototype.data=t,Array.isArray(t[0])&&(F.dataType="array"),m.dataSource=t,h.data=t,h.dataType=F.dataType,h.colToProp=m.colToProp.bind(m),h.propToCol=m.propToCol.bind(m),V.cellSettings.length=0,y.adjustRowsAndCols(),F.runHooks("afterLoadData",V.firstRun),V.firstRun?V.firstRun=[null,"loadData"]:(F.runHooks("afterChange",null,"loadData"),F.render()),V.isPopulated=!0},this.getData=function(t,e,n,r){return(0,W.isUndefined)(t)?m.getAll():m.getRange(new $.CellCoords(t,e),new $.CellCoords(n,r),m.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,n,r){return m.getCopyableText(new $.CellCoords(t,e),new $.CellCoords(n,r))},this.getCopyableData=function(t,e){return m.getCopyable(t,m.colToProp(e))},this.getSchema=function(){return m.getSchema()},this.updateSettings=function(t){var e,n,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=!1,o=void 0,a=void 0,s=void 0;if((0,W.isDefined)(t.rows))throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if((0,W.isDefined)(t.cols))throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(o in t)"data"!==o&&("language"!==o?-1<X.default.getSingleton().getRegistered().indexOf(o)?((0,R.isFunction)(t[o])||Array.isArray(t[o]))&&(t[o].initialHook=!0,F.addHook(o,t[o])):!r&&(0,U.hasOwnProperty)(t,o)&&(g.prototype[o]=t[o]):(e=t.language,void 0,n=(0,J.normalizeLanguageCode)(e),(0,Q.hasLanguageDictionary)(n)?(F.runHooks("beforeLanguageChange",n),g.prototype.language=n,F.runHooks("afterLanguageChange",n)):(0,J.warnUserAboutLanguageRegistration)(e)));void 0===t.data&&void 0===V.settings.data?F.loadData(null):void 0!==t.data?F.loadData(t.data):void 0!==t.columns&&m.createMap(),s=F.countCols();var l=t.columns||g.prototype.columns;if(l&&(0,R.isFunction)(l)&&(s=F.countSourceCols(),i=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||(V.cellSettings.length=0),0<s){var u=void 0,h=void 0;for(a=o=0;o<s;o++)i&&!l(o)||(V.columnSettings[a]=(0,N.columnFactory)(g,V.columnsSettingConflicts),u=V.columnSettings[a].prototype,l&&(h=i?l(o):l[a])&&((0,U.extend)(u,h),(0,U.extend)(u,S(h))),a+=1)}(0,W.isDefined)(t.cell)&&(0,U.objectEach)(t.cell,function(t){F.setCellMetaObject(t.row,t.col,t)}),F.runHooks("afterCellMetaReset"),(0,W.isDefined)(t.className)&&(g.prototype.className&&(0,T.removeClass)(F.rootElement,g.prototype.className),t.className&&(0,T.addClass)(F.rootElement,t.className));var c=F.rootElement.style.height;""!==c&&(c=parseInt(F.rootElement.style.height,10));var d=t.height;(0,R.isFunction)(d)&&(d=d()),!r||F.rootElement.getAttribute("style")&&F.rootElement.setAttribute("data-initialstyle",F.rootElement.getAttribute("style"));if(null===d){var f=F.rootElement.getAttribute("data-initialstyle");f&&(-1<f.indexOf("height")||-1<f.indexOf("overflow"))?F.rootElement.setAttribute("style",f):(F.rootElement.style.height="",F.rootElement.style.overflow="")}else void 0!==d&&(F.rootElement.style.height=d+"px",F.rootElement.style.overflow="hidden");if(void 0!==t.width){var p=t.width;(0,R.isFunction)(p)&&(p=p()),F.rootElement.style.width=p+"px"}r||(m.clearLengthCache(),F.view&&F.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),F.runHooks("afterUpdateSettings",t)),y.adjustRowsAndCols(),F.view&&!V.firstRun&&(F.forceFullRender=!0,v.lockEditor(),F._refreshBorders(null),v.unlockEditor()),r||!F.view||""!==c&&""!==d&&void 0!==d||c===d||F.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var t=F.getSelectedLast();if(g.prototype.getValue){if((0,R.isFunction)(g.prototype.getValue))return g.prototype.getValue.call(F);if(t)return F.getData()[t[0][0]][g.prototype.getValue]}else if(t)return F.getDataAtCell(t[0],t[1])},this.getSettings=function(){return V.settings},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,n,r,i){y.alter(t,e,n,r,i)},this.getCell=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return F.view.getCellAtCoords(new $.CellCoords(t,e),n)},this.getCoords=function(t){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,t)},this.colToProp=function(t){return m.colToProp(t)},this.propToCol=function(t){return m.propToCol(t)},this.toVisualRow=function(t){return w.toVisualRow(t)},this.toVisualColumn=function(t){return w.toVisualColumn(t)},this.toPhysicalRow=function(t){return w.toPhysicalRow(t)},this.toPhysicalColumn=function(t){return w.toPhysicalColumn(t)},this.getDataAtCell=function(t,e){return m.get(t,m.colToProp(e))},this.getDataAtRowProp=function(t,e){return m.get(t,e)},this.getDataAtCol=function(t){var e;return(e=[]).concat.apply(e,nt(m.getRange(new $.CellCoords(0,t),new $.CellCoords(V.settings.data.length-1,t),m.DESTINATION_RENDERER)))},this.getDataAtProp=function(t){var e,n=m.getRange(new $.CellCoords(0,m.propToCol(t)),new $.CellCoords(V.settings.data.length-1,m.propToCol(t)),m.DESTINATION_RENDERER);return(e=[]).concat.apply(e,nt(n))},this.getSourceData=function(t,e,n,r){return void 0===t?h.getData():h.getByRange(new $.CellCoords(t,e),new $.CellCoords(n,r))},this.getSourceDataArray=function(t,e,n,r){return void 0===t?h.getData(!0):h.getByRange(new $.CellCoords(t,e),new $.CellCoords(n,r),!0)},this.getSourceDataAtCol=function(t){return h.getAtColumn(t)},this.getSourceDataAtRow=function(t){return h.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return h.getAtCell(t,e)},this.getDataAtRow=function(t){return m.getRange(new $.CellCoords(t,0),new $.CellCoords(t,this.countCols()-1),m.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(t,e,n,r){var i=this,o=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,n,r],a=o[0],s=o[1],l=o[2],u=o[3],h=null,c=null;void 0===l&&(l=a),void 0===u&&(u=s);var d="mixed";return(0,P.rangeEach)(Math.min(a,l),Math.max(a,l),function(n){var r=!0;return(0,P.rangeEach)(Math.min(s,u),Math.max(s,u),function(t){var e=i.getCellMeta(n,t);return c=e.type,h?r=h===c:h=c,r}),d=r?c:"mixed",r}),d},this.removeCellMeta=function(t,e,n){var r=w.toPhysical(t,e),i=O(r,2),o=i[0],a=i[1],s=V.cellSettings[o][a][n];!1!==F.runHooks("beforeRemoveCellMeta",t,e,n,s)&&(delete V.cellSettings[o][a][n],F.runHooks("afterRemoveCellMeta",t,e,n,s)),s=null},this.spliceCellsMeta=function(t,e){for(var n,r=arguments.length,i=Array(2<r?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];(n=V.cellSettings).splice.apply(n,[t,e].concat(i))},this.setCellMetaObject=function(n,r,t){var i=this;"object"===(void 0===t?"undefined":j(t))&&(0,U.objectEach)(t,function(t,e){i.setCellMeta(n,r,e,t)})},this.setCellMeta=function(t,e,n,r){var i=w.toPhysical(t,e),o=O(i,2),a=o[0],s=o[1];V.columnSettings[s]||(V.columnSettings[s]=(0,N.columnFactory)(g,V.columnsSettingConflicts)),V.cellSettings[a]||(V.cellSettings[a]=[]),V.cellSettings[a][s]||(V.cellSettings[a][s]=new V.columnSettings[s]),V.cellSettings[a][s][n]=r,F.runHooks("afterSetCellMeta",t,e,n,r)},this.getCellsMeta=function(){return(0,A.arrayFlatten)(V.cellSettings)},this.getCellMeta=function(t,e){var n=m.colToProp(e),r=w.toPhysical(t,e),i=O(r,2),o=i[0],a=i[1],s=o;null===s&&(s=t),V.columnSettings[a]||(V.columnSettings[a]=(0,N.columnFactory)(g,V.columnsSettingConflicts)),V.cellSettings[s]||(V.cellSettings[s]=[]),V.cellSettings[s][a]||(V.cellSettings[s][a]=new V.columnSettings[a]);var l=V.cellSettings[s][a];if(l.row=s,l.col=a,l.visualRow=t,l.visualCol=e,l.prop=n,(l.instance=F).runHooks("beforeGetCellMeta",t,e,l),(0,U.extend)(l,S(l)),l.cells){var u=l.cells.call(l,s,a,n);u&&((0,U.extend)(l,u),(0,U.extend)(l,S(u)))}return F.runHooks("afterGetCellMeta",t,e,l),l},this.getCellMetaAtRow=function(t){return V.cellSettings[t]},this.isColumnModificationAllowed=function(){return!("object"===F.dataType||F.getSettings().columns)};var i=(0,z.cellMethodLookupFactory)("renderer");this.getCellRenderer=function(t,e){return(0,I.getRenderer)(i.call(this,t,e))},this.getCellEditor=(0,z.cellMethodLookupFactory)("editor");var o=(0,z.cellMethodLookupFactory)("validator");this.getCellValidator=function(t,e){var n=o.call(this,t,e);return"string"==typeof n&&(n=(0,D.getValidator)(n)),n},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,n){var r=new p;t&&(r.onQueueEmpty=t);for(var i=F.countRows()-1;0<=i;)if(void 0===e||-1!==e.indexOf(i)){for(var o=F.countCols()-1;0<=o;)(void 0===n||-1!==n.indexOf(o))&&(r.addValidatorToQueue(),F.validateCell(F.getDataAtCell(i,o),F.getCellMeta(i,o),function(t){if("boolean"!=typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(r.valid=!1),r.removeValidatorFormQueue()},"validateCells")),o-=1;i-=1}else i-=1;r.checkIfQueueIsEmpty()},this.getRowHeader=function(t){var e=V.settings.rowHeaders,n=t;return void 0!==n&&(n=F.runHooks("modifyRowHeader",n)),void 0===n?(e=[],(0,P.rangeEach)(F.countRows()-1,function(t){e.push(F.getRowHeader(t))})):Array.isArray(e)&&void 0!==e[n]?e=e[n]:(0,R.isFunction)(e)?e=e(n):e&&"string"!=typeof e&&"number"!=typeof e&&(e=n+1),e},this.hasRowHeaders=function(){return!!V.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==V.settings.colHeaders&&null!==V.settings.colHeaders)return!!V.settings.colHeaders;for(var t=0,e=F.countCols();t<e;t++)if(F.getColHeader(t))return!0;return!1},this.getColHeader=function(t){var e=V.settings.columns&&(0,R.isFunction)(V.settings.columns),n=F.runHooks("modifyColHeader",t),r=V.settings.colHeaders;if(void 0===n){for(var i=[],o=e?F.countSourceCols():F.countCols(),a=0;a<o;a++)i.push(F.getColHeader(a));r=i}else{var s=n,l=F.runHooks("modifyCol",s),u=function(t){for(var e=[],n=F.countSourceCols(),r=0;r<n;r++)(0,R.isFunction)(F.getSettings().columns)&&F.getSettings().columns(r)&&e.push(r);return e[t]}(l);!1===V.settings.colHeaders?r=null:V.settings.columns&&(0,R.isFunction)(V.settings.columns)&&V.settings.columns(u)&&V.settings.columns(u).title?r=V.settings.columns(u).title:V.settings.columns&&V.settings.columns[l]&&V.settings.columns[l].title?r=V.settings.columns[l].title:Array.isArray(V.settings.colHeaders)&&void 0!==V.settings.colHeaders[l]?r=V.settings.colHeaders[l]:(0,R.isFunction)(V.settings.colHeaders)?r=V.settings.colHeaders(l):V.settings.colHeaders&&"string"!=typeof V.settings.colHeaders&&"number"!=typeof V.settings.colHeaders&&(r=(0,z.spreadsheetColumnLabel)(s))}return r},this._getColWidthFromSettings=function(t){var e=F.getCellMeta(0,t),n=e.width;if(void 0!==n&&n!==V.settings.width||(n=e.colWidths),null!=n){switch(void 0===n?"undefined":j(n)){case"object":n=n[t];break;case"function":n=n(t)}"string"==typeof n&&(n=parseInt(n,10))}return n},this.getColWidth=function(t){var e=F._getColWidthFromSettings(t);return void 0===(e=F.runHooks("modifyColWidth",e,t))&&(e=$.ViewportColumnsCalculator.DEFAULT_WIDTH),e},this._getRowHeightFromSettings=function(t){var e=V.settings.rowHeights;if(null!=e){switch(void 0===e?"undefined":j(e)){case"object":e=e[t];break;case"function":e=e(t)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){var e=F._getRowHeightFromSettings(t);return e=F.runHooks("modifyRowHeight",e,t)},this.countSourceRows=function(){return F.runHooks("modifySourceLength")||(F.getSourceData()?F.getSourceData().length:0)},this.countSourceCols=function(){var t=F.getSourceData()&&F.getSourceData()[0]?F.getSourceData()[0]:[];return(0,U.isObject)(t)?(0,U.deepObjectSize)(t):t.length||0},this.countRows=function(){return m.getLength()},this.countCols=function(){var t=this.getSettings().maxCols,e=!1,n=0;if("array"===F.dataType&&(e=V.settings.data&&V.settings.data[0]&&V.settings.data[0].length),e&&(n=V.settings.data[0].length),V.settings.columns)if((0,R.isFunction)(V.settings.columns))if("array"===F.dataType){for(var r=0,i=0;i<n;i++)V.settings.columns(i)&&(r+=1);n=r}else"object"!==F.dataType&&"function"!==F.dataType||(n=m.colToPropCache.length);else n=V.settings.columns.length;else"object"!==F.dataType&&"function"!==F.dataType||(n=m.colToPropCache.length);return Math.min(t,n)},this.rowOffset=function(){return F.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return F.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return F.view.wt.drawn?F.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return F.view.wt.drawn?F.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return F.view.wt.drawn?F.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return F.view.wt.drawn?F.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=0;return(0,P.rangeEachReverse)(F.countRows()-1,function(t){if(F.isEmptyRow(t))n+=1;else if(!0===e)return!1}),n},this.countEmptyCols=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(F.countRows()<1)return 0;var n=0;return(0,P.rangeEachReverse)(F.countCols()-1,function(t){if(F.isEmptyCol(t))n+=1;else if(!0===e)return!1}),n},this.isEmptyRow=function(t){return V.settings.isEmptyRow.call(F,t)},this.isEmptyCol=function(t){return V.settings.isEmptyCol.call(F,t)},this.selectCell=function(t,e,n,r){var i=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],o=!(5<arguments.length&&void 0!==arguments[5])||arguments[5];return!(0,W.isUndefined)(t)&&!(0,W.isUndefined)(e)&&this.selectCells([[t,e,n,r]],i,o)},this.selectCells=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[[]],e=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];!1===(!(1<arguments.length&&void 0!==arguments[1])||arguments[1])&&(f=!0);var n=b.selectCells(t);return n&&e&&F.listen(),f=!1,n},this.selectCellByProp=function(t,e,n,r){var i=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],o=!(5<arguments.length&&void 0!==arguments[5])||arguments[5];return(0,_.warn)((0,k.toSingleLine)(a)),this.selectCells([[t,e,n,r]],i,o)},this.selectColumns=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:t;return b.selectColumns(t,e)},this.selectRows=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:t;return b.selectRows(t,e)},this.deselectCell=function(){b.deselect()},this.selectAll=function(){f=!0,b.selectAll(),f=!1},this.scrollViewportTo=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=3<arguments.length&&void 0!==arguments[3]&&arguments[3],i=!n,o=!r,a=!1;return void 0!==t&&void 0!==e&&(a=F.view.scrollViewport(new $.CellCoords(t,e),i,r,n,o)),"number"==typeof t&&"number"!=typeof e&&(a=F.view.scrollViewportVertically(t,i,n)),"number"==typeof e&&"number"!=typeof t&&(a=F.view.scrollViewportHorizontally(e,r,o)),a},this.destroy=function(){if(F._clearTimeouts(),F._clearImmediates(),F.view&&F.view.destroy(),h&&h.destroy(),h=null,(0,tt.stopObserving)(),(0,Y.isRootInstance)(F)){var t=document.querySelector("#hot-display-license-info");t&&t.parentNode.removeChild(t)}(0,T.empty)(F.rootElement),r.destroy(),v&&v.destroy(),F.runHooks("afterDestroy"),X.default.getSingleton().destroy(F),(0,U.objectEach)(F,function(t,e,n){(0,R.isFunction)(t)?n[e]=function(t){return function(){throw new Error('The "'+t+'" method cannot be called because this Handsontable instance has been destroyed')}}(e):"guid"!==e&&(n[e]=null)}),F.isDestroyed=!0,m&&m.destroy(),g=F=v=b=y=V=m=null},this.getActiveEditor=function(){return v.getActiveEditor()},this.getPlugin=function(t){return(0,x.getPlugin)(this,t)},this.getInstance=function(){return F},this.addHook=function(t,e){X.default.getSingleton().add(t,e,F)},this.hasHook=function(t){return X.default.getSingleton().has(t,F)},this.addHookOnce=function(t,e){X.default.getSingleton().once(t,e,F)},this.removeHook=function(t,e){X.default.getSingleton().remove(t,e,F)},this.runHooks=function(t,e,n,r,i,o,a){return X.default.getSingleton().run(F,t,e,n,r,i,o,a)},this.getTranslatedPhrase=function(t,e){return(0,Z.getTranslatedPhrase)(V.settings.language,t,e)},this.timeouts=[],this._registerTimeout=function(t){var e=t;"function"==typeof e&&(e=setTimeout(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(e)},this._clearTimeouts=function(){(0,A.arrayEach)(this.timeouts,function(t){clearTimeout(t)})},this.immediates=[],this._registerImmediate=function(t){this.immediates.push(setImmediate(t))},this._clearImmediates=function(){(0,A.arrayEach)(this.immediates,function(t){clearImmediate(t)})},this._refreshBorders=function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];v.destroyEditor(t),F.view.render(),e&&b.isSelected()&&v.prepareEditor()},X.default.getSingleton().run(F,"construct")};var T=n(2),N=n(158),R=n(34),_=n(22),W=n(10),s=n(42),l=o(n(299)),u=o(n(302)),M=o(n(8)),U=n(1),A=n(0),k=n(25),x=n(5),I=n(15),D=n(44),L=n(31),P=n(4),H=o(n(303)),B=o(n(304)),z=n(84),G=n(55),Y=n(213),$=n(9),X=o(n(17)),K=o(n(214)),q=n(156),Z=n(215),Q=n(85),J=n(216),tt=n(86),et=n(217);function o(t){return t&&t.__esModule?t:{default:t}}function nt(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var rt=null},function(t,e,n){"use strict";e.__esModule=!0,e.columnFactory=function(t,e){function n(){}(0,o.inherit)(n,t);for(var r=0,i=e.length;r<i;r++)n.prototype[e[r]]=void 0;return n};var o=n(1)},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=n(2),c=n(0);var o=(r(a,[{key:"addRow",value:function(t,e){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:t};this.rows.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(t){var e=this.hot.getColHeader(0);if(null!=e){var n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tHead.appendChild(this.createColumnHeadersRow()),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}},{key:"addColumn",value:function(t,e){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:t};this.columns.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(e){this.injected||this.injectTable(),(0,c.arrayEach)(this.rows,function(t){e(t.row,(0,h.outerHeight)(t.table)-1)})}},{key:"getWidths",value:function(e){this.injected||this.injectTable(),(0,c.arrayEach)(this.columns,function(t){e(t.col,(0,h.outerWidth)(t.table))})}},{key:"setSettings",value:function(t){this.settings=t}},{key:"setSetting",value:function(t,e){this.settings||(this.settings={}),this.settings[t]=e}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(t){return this.settings?this.settings[t]:null}},{key:"createColGroupsCol",value:function(){var e=this,n=document.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(t){(0,c.arrayEach)(t.strings,function(t){n.appendChild(e.createColElement(t.col))})}),n}},{key:"createRow",value:function(o){var a=this,s=document,l=s.createDocumentFragment(),t=s.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(o,t),l.appendChild(t)),this.samples.forEach(function(t){(0,c.arrayEach)(t.strings,function(t){var e=t.col,n=a.hot.getCellMeta(o,e);n.col=e,n.row=o;var r=a.hot.getCellRenderer(n),i=s.createElement("td");r(a.hot,i,o,e,a.hot.colToProp(e),t.value,n),l.appendChild(i)})}),l}},{key:"createColumnHeadersRow",value:function(){var r=this,i=document,o=i.createDocumentFragment();if(this.hot.hasRowHeaders()){var t=i.createElement("th");this.hot.view.appendColHeader(-1,t),o.appendChild(t)}return this.samples.forEach(function(t){(0,c.arrayEach)(t.strings,function(t){var e=t.col,n=i.createElement("th");r.hot.view.appendColHeader(e,n),o.appendChild(n)})}),o}},{key:"createCol",value:function(a){var s=this,l=document,u=l.createDocumentFragment();return this.samples.forEach(function(t){(0,c.arrayEach)(t.strings,function(t){var e=t.row,n=s.hot.getCellMeta(e,a);n.col=a,n.row=e;var r=s.hot.getCellRenderer(n),i=l.createElement("td"),o=l.createElement("tr");i.setAttribute("ghost-table",1),r(s.hot,i,e,a,s.hot.colToProp(a),t.value,n),o.appendChild(i),u.appendChild(o)})}),u}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(t){var e=0<arguments.length&&void 0!==t?t:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(t){var e=document.createElement("col");return e.style.width=this.hot.view.wt.wtTable.getStretchedColumnWidth(t)+"px",e}},{key:"createTable",value:function(t){var e=0<arguments.length&&void 0!==t?t:"",n=document,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),a=n.createElement("tbody"),s=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(s),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&a.appendChild(l),i.appendChild(a),(0,h.addClass)(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:a,colGroup:s,tr:l,th:u}}},{key:"createContainer",value:function(t){var e=0<arguments.length&&void 0!==t?t:"",n=document,r=n.createDocumentFragment(),i=n.createElement("div"),o="htGhostTable htAutoSize "+e.trim();return(0,h.addClass)(i,o),r.appendChild(i),{fragment:r,container:i}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}]),a);function a(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}e.default=o},function(t,e,n){"use strict";e.__esModule=!0,e.HEADER_SPAN_CLASS=e.DESC_SORT_STATE=e.ASC_SORT_STATE=void 0,e.areValidSortStates=function(t){if(!1===Array.isArray(t)||!1===t.every(function(t){return(0,i.isObject)(t)}))return!1;var e=t.map(function(t){return t.column});return new Set(e).size===e.length&&t.every(u)},e.getNextSortOrder=function(t){{if(t===s)return;if(t===a)return s}return a},e.getHeaderSpanElement=function(t){return t.querySelector("."+l)},e.isFirstLevelColumnHeader=function(t,e){if(t<0||!e.parentNode)return!1;var n=e.parentNode.parentNode.childNodes;return-1==Array.from(n).indexOf(e.parentNode)-n.length},e.wasHeaderClickedProperly=function(t,e,n){return-1===t&&0<=e&&!1===(0,o.isRightClick)(n)};var r=n(10),i=n(1),o=n(12),a=e.ASC_SORT_STATE="asc",s=e.DESC_SORT_STATE="desc",l=e.HEADER_SPAN_CLASS="colHeader";function u(t){if((0,r.isUndefined)(t))return!1;var e=t.column,n=t.sortOrder;return Number.isInteger(e)&&[a,s].includes(n)}},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(){return{name:r}};var r=e.KEY="---------"},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=y(n(157)),p=n(2),s=n(0),a=y(n(352)),l=y(n(8)),g=n(1),u=n(10),h=n(34),c=n(23),d=n(18),f=y(n(20)),v=n(45),m=n(12);function y(t){return t&&t.__esModule?t:{default:t}}var w=(r(b,[{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(document.documentElement,"mousedown",function(t){return e.onDocumentMouseDown(t)})}},{key:"setMenuItems",value:function(t){this.menuItems=t}},{key:"setOffset",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:0;this.offset[t]=n}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var a=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=(0,h.debounce)(function(t){return a.openSubMenu(t)},300),e=this.options.minWidth||215,r=(0,s.arrayFilter)(this.menuItems,function(t){return(0,c.isItemHidden)(t,a.hot)}),t={data:r=(0,c.filterSeparators)(r,v.SEPARATOR),colHeaders:!1,autoColumnSize:!0,modifyColWidth:function(t){return(0,u.isDefined)(t)&&t<e?e:t},autoRowSize:!1,readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:function(t,e,n,r,i,o){return a.menuItemRenderer(t,e,n,r,i,o)}}],renderAllRows:!0,fragmentSelection:"cell",disableVisualSelection:"area",beforeKeyDown:function(t){return a.onBeforeKeyDown(t)},afterOnCellMouseOver:function(t,e){a.isAllSubMenusClosed()?n(e.row):a.openSubMenu(e.row)},rowHeights:function(t){return r[t].name===v.SEPARATOR?1:23}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new o.default(this.container,t),this.hotMenu.addHook("afterInit",function(){return a.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return a.onAfterSelection.apply(a,arguments)}),this.hotMenu.init(),this.hotMenu.listen(),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(t){var e=0<arguments.length&&void 0!==t&&t;this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(t){if(!this.hotMenu)return!1;var e=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!e||!(0,c.hasSubMenu)(e))return!1;var n=this.hotMenu.getSourceDataAtRow(t),r=new b(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0});return r.setMenuItems(n.submenu.items),r.open(),r.setPosition(e.getBoundingClientRect()),this.hotSubMenus[n.key]=r}},{key:"closeSubMenu",value:function(t){var e=this.hotMenu.getSourceDataAtRow(t),n=this.hotSubMenus[e.key];n&&(n.destroy(),delete this.hotSubMenus[e.key])}},{key:"closeAllSubMenus",value:function(){var n=this;(0,s.arrayEach)(this.hotMenu.getData(),function(t,e){return n.closeSubMenu(e)})}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy()}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(t){if(this.isOpened()&&this.hotMenu.getSelectedLast()){var e=this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]);if(this.runLocalHooks("select",e,t),!1!==e.isCommand&&e.name!==v.SEPARATOR){var n=this.hot.getSelectedRange(),r=n?(0,c.normalizeSelection)(n):[],i=!0;(!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(this.hot)||e.submenu)&&(i=!1),this.runLocalHooks("executeCommand",e.key,r,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,r,t),i&&this.close(!0)}}}},{key:"setPosition",value:function(t){var e=new a.default(t);this.options.keepInViewport?(e.fitsBelow(this.container)?this.setPositionBelowCursor(e):e.fitsAbove(this.container)?this.setPositionAboveCursor(e):this.setPositionBelowCursor(e),e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)):(this.setPositionBelowCursor(e),this.setPositionOnRightOfCursor(e))}},{key:"setPositionAboveCursor",value:function(t){var e=this.offset.above+t.top-this.container.offsetHeight;this.isSubMenu()&&(e=t.top+t.cellHeight-this.container.offsetHeight+3),this.container.style.top=e+"px"}},{key:"setPositionBelowCursor",value:function(t){var e=this.offset.below+t.top;this.isSubMenu()&&(e=t.top-1),this.container.style.top=e+"px"}},{key:"setPositionOnRightOfCursor",value:function(t){var e=void 0;e=this.isSubMenu()?1+t.left+t.cellWidth:this.offset.right+1+t.left,this.container.style.left=e+"px"}},{key:"setPositionOnLeftOfCursor",value:function(t){var e=this.offset.left+t.left-this.container.offsetWidth+(0,p.getScrollbarWidth)()+4;this.container.style.left=e+"px"}},{key:"selectFirstCell",value:function(){var t=this.hotMenu.getCell(0,0);(0,c.isSeparator)(t)||(0,c.isDisabled)(t)||(0,c.isSelectionDisabled)(t)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var t=this.hotMenu.countRows()-1,e=this.hotMenu.getCell(t,0);(0,c.isSeparator)(e)||(0,c.isDisabled)(e)||(0,c.isSelectionDisabled)(e)?this.selectPrevCell(t,0):this.hotMenu.selectCell(t,0)}},{key:"selectNextCell",value:function(t,e){var n=t+1,r=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,e):null;r&&((0,c.isSeparator)(r)||(0,c.isDisabled)(r)||(0,c.isSelectionDisabled)(r)?this.selectNextCell(n,e):this.hotMenu.selectCell(n,e))}},{key:"selectPrevCell",value:function(t,e){var n=t-1,r=0<=n?this.hotMenu.getCell(n,e):null;r&&((0,c.isSeparator)(r)||(0,c.isDisabled)(r)||(0,c.isSelectionDisabled)(r)?this.selectPrevCell(n,e):this.hotMenu.selectCell(n,e))}},{key:"menuItemRenderer",value:function(t,e,n,r,i,o){function a(t){return t.disableSelection}var s,l,u,h=this,c=t.getSourceDataAtRow(n),d=document.createElement("div"),f=o;"function"==typeof f&&(f=f.call(this.hot)),(0,p.empty)(e),(0,p.addClass)(d,"htItemWrapper"),e.appendChild(d),s=c,new RegExp(v.SEPARATOR,"i").test(s.name)?(0,p.addClass)(e,"htSeparator"):"function"==typeof c.renderer?((0,p.addClass)(e,"htCustomMenuRenderer"),e.appendChild(c.renderer(t,d,n,r,i,f))):(0,p.fastInnerHTML)(d,f),!0===(u=c).disabled||"function"==typeof u.disabled&&!0===u.disabled.call(h.hot)?((0,p.addClass)(e,"htDisabled"),this.eventManager.addEventListener(e,"mouseenter",function(){return t.deselectCell()})):a(c)?((0,p.addClass)(e,"htSelectionDisabled"),this.eventManager.addEventListener(e,"mouseenter",function(){return t.deselectCell()})):(l=c,(0,g.hasOwnProperty)(l,"submenu")?(0,p.addClass)(e,"htSubmenu"):((0,p.removeClass)(e,"htSubmenu"),(0,p.removeClass)(e,"htDisabled")),a(c)?this.eventManager.addEventListener(e,"mouseenter",function(){return t.deselectCell()}):this.eventManager.addEventListener(e,"mouseenter",function(){return t.selectCell(n,r,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(t){var e=0<arguments.length&&void 0!==t?t:null,n=void 0;return(n=e?((0,h.isFunction)(e)&&(e=null===(e=e.call(this.hot))||(0,u.isUndefined)(e)?"":e.toString()),e=e.replace(/[^A-z0-9]/g,"_"),e=this.options.className+"Sub_"+e,document.querySelector("."+this.options.className+"."+e)):document.querySelector("."+this.options.className))||(n=document.createElement("div"),(0,p.addClass)(n,"htMenu "+this.options.className),e&&(0,p.addClass)(n,e),document.getElementsByTagName("body")[0].appendChild(n)),n}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onBeforeKeyDown",value:function(t){var e=this.hotMenu.getSelectedLast(),n=!1;switch(this.keyEvent=!0,t.keyCode){case d.KEY_CODES.ESCAPE:this.close(),n=!0;break;case d.KEY_CODES.ENTER:e&&(this.hotMenu.getSourceDataAtRow(e[0]).submenu?n=!0:(this.executeCommand(t),this.close(!0)));break;case d.KEY_CODES.ARROW_DOWN:e?this.selectNextCell(e[0],e[1]):this.selectFirstCell(),n=!0;break;case d.KEY_CODES.ARROW_UP:e?this.selectPrevCell(e[0],e[1]):this.selectLastCell(),n=!0;break;case d.KEY_CODES.ARROW_RIGHT:if(e){var r=this.openSubMenu(e[0]);r&&r.selectFirstCell()}n=!0;break;case d.KEY_CODES.ARROW_LEFT:e&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),n=!0)}n&&(t.preventDefault(),(0,m.stopImmediatePropagation)(t)),this.keyEvent=!1}},{key:"onAfterInit",value:function(){var t=this.hotMenu.getSettings().data,e=this.hotMenu.view.wt.wtTable.hider.style,n=this.hotMenu.view.wt.wtTable.holder.style,r=parseInt(e.width,10),i=(0,s.arrayReduce)(t,function(t,e){return t+(e.name===v.SEPARATOR?1:26)},0);n.width=r+22+"px",n.height=i+4+"px",e.height=n.height}},{key:"onAfterSelection",value:function(t,e,n,r,i){!1===this.keyEvent&&(i.value=!0)}},{key:"onDocumentMouseDown",value:function(t){this.isOpened()&&(this.container&&(0,p.isChildOf)(t.target,this.container)&&this.executeCommand(t),this.options.standalone&&this.hotMenu&&!(0,p.isChildOf)(t.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!(0,p.isChildOf)(t.target,".htMenu")&&(0,p.isChildOf)(t.target,document)&&this.close(!0))}}]),b);function b(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b),this.hot=t,this.options=e||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215},this.eventManager=new l.default(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}(0,g.mixin)(w,f.default),e.default=w},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=c(["The merged cell declared with {row: ",", col: ",", rowspan: \n    ",", colspan: ","} contains negative values, which is not supported. It \n    will not be added to the collection."],["The merged cell declared with {row: ",", col: ",", rowspan: \n    ",", colspan: ","} contains negative values, which is not supported. It \n    will not be added to the collection."]),a=c(["The merged cell declared at [",", ","] is positioned (or positioned partially) \n       outside of the table range. It was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] is positioned (or positioned partially) \n       outside of the table range. It was not added to the table, please fix your setup."]),s=c(["The merged cell declared at [",", ",'] has both "rowspan" \n     and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has both "rowspan" \n     and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.']),l=c(["The merged cell declared at [",", ",'] has "rowspan" or "colspan" declared as \n      "0", which is not supported. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has "rowspan" or "colspan" declared as \n      "0", which is not supported. It cannot be added to the collection.']),u=n(9),h=n(25);function c(t,e){return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var d=(r(f,[{key:"normalize",value:function(t){var e=t.countRows(),n=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}},{key:"includes",value:function(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}},{key:"includesHorizontally",value:function(t){return this.col<=t&&this.col+this.colspan-1>=t}},{key:"includesVertically",value:function(t){return this.row<=t&&this.row+this.rowspan-1>=t}},{key:"shift",value:function(t,e){var n=t[0]||t[1],r=e+Math.abs(t[0]||t[1])-1,i=t[0]?"colspan":"rowspan",o=t[0]?"col":"row",a=Math.min(e,r),s=Math.max(e,r),l=this[o],u=this[o]+this[i]-1;if(e<=l&&(this[o]+=n),0<n)e<=u&&l<e&&(this[i]+=n);else if(n<0){if(a<=l&&u<=s)return!(this.removed=!0);if(a<=l&&l<=s){var h=s-l+1,c=Math.abs(n)-h;this[o]-=c+n,this[i]-=h}else if(l<=a&&s<=u)this[i]+=n;else if(l<=a&&a<=u&&u<s){var d=u-a+1;this[i]-=d}}return!0}},{key:"isFarther",value:function(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return new u.CellRange(new u.CellCoords(this.row,this.col),new u.CellCoords(this.row,this.col),new u.CellCoords(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(t){return(0,h.toSingleLine)(o,t.row,t.col,t.rowspan,t.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(t){return(0,h.toSingleLine)(a,t.row,t.col)}},{key:"IS_SINGLE_CELL",value:function(t){return(0,h.toSingleLine)(s,t.row,t.col)}},{key:"ZERO_SPAN_WARNING",value:function(t){return(0,h.toSingleLine)(l,t.row,t.col)}},{key:"containsNegativeValues",value:function(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}},{key:"isSingleCell",value:function(t){return 1===t.colspan&&1===t.rowspan}},{key:"containsZeroSpan",value:function(t){return 0===t.colspan||0===t.rowspan}},{key:"isOutOfBounds",value:function(t,e,n){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=n||t.col+t.colspan-1>=n}}]),f);function f(t,e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),this.row=t,this.col=e,this.rowspan=n,this.colspan=r,this.removed=!1}e.default=d},function(t,e,n){"use strict";var r;e.__esModule=!0,e.TYPES=e.TYPE_DATE=e.TYPE_TEXT=e.TYPE_NUMERIC=e.OPERATION_OR_THEN_VARIABLE=e.OPERATION_OR=e.OPERATION_AND=e.CONDITION_FALSE=e.CONDITION_TRUE=e.CONDITION_BY_VALUE=e.CONDITION_YESTERDAY=e.CONDITION_TODAY=e.CONDITION_TOMORROW=e.CONDITION_DATE_AFTER=e.CONDITION_DATE_BEFORE=e.CONDITION_NOT_CONTAINS=e.CONDITION_CONTAINS=e.CONDITION_ENDS_WITH=e.CONDITION_BEGINS_WITH=e.CONDITION_NOT_BETWEEN=e.CONDITION_BETWEEN=e.CONDITION_LESS_THAN_OR_EQUAL=e.CONDITION_LESS_THAN=e.CONDITION_GREATER_THAN_OR_EQUAL=e.CONDITION_GREATER_THAN=e.CONDITION_NOT_EQUAL=e.CONDITION_EQUAL=e.CONDITION_NOT_EMPTY=e.CONDITION_EMPTY=e.CONDITION_NONE=void 0,e.default=function(t){var n=[],e=t;B[e]||(e=P);return(0,o.arrayEach)(B[e],function(t){var e=void 0;e=t===a.SEPARATOR?{name:a.SEPARATOR}:(0,i.clone)((0,s.getConditionDescriptor)(t)),n.push(e)}),n};var i=n(1),o=n(0),a=n(45),s=n(11),l=n(424),u=n(227),h=n(425),c=n(228),d=n(426),f=n(427),p=n(428),g=n(429),v=n(430),m=n(229),y=n(431),w=n(432),b=n(433),C=n(232),E=n(434),S=n(231),O=n(230),T=n(435),N=n(436),R=n(437),_=n(438),M=n(439),A=n(440),k=n(165),x=n(233),I=n(234);function D(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}e.CONDITION_NONE=l.CONDITION_NAME,e.CONDITION_EMPTY=u.CONDITION_NAME,e.CONDITION_NOT_EMPTY=h.CONDITION_NAME,e.CONDITION_EQUAL=c.CONDITION_NAME,e.CONDITION_NOT_EQUAL=d.CONDITION_NAME,e.CONDITION_GREATER_THAN=f.CONDITION_NAME,e.CONDITION_GREATER_THAN_OR_EQUAL=p.CONDITION_NAME,e.CONDITION_LESS_THAN=g.CONDITION_NAME,e.CONDITION_LESS_THAN_OR_EQUAL=v.CONDITION_NAME,e.CONDITION_BETWEEN=m.CONDITION_NAME,e.CONDITION_NOT_BETWEEN=y.CONDITION_NAME,e.CONDITION_BEGINS_WITH=w.CONDITION_NAME,e.CONDITION_ENDS_WITH=b.CONDITION_NAME,e.CONDITION_CONTAINS=C.CONDITION_NAME,e.CONDITION_NOT_CONTAINS=E.CONDITION_NAME,e.CONDITION_DATE_BEFORE=S.CONDITION_NAME,e.CONDITION_DATE_AFTER=O.CONDITION_NAME,e.CONDITION_TOMORROW=T.CONDITION_NAME,e.CONDITION_TODAY=N.CONDITION_NAME,e.CONDITION_YESTERDAY=R.CONDITION_NAME,e.CONDITION_BY_VALUE=_.CONDITION_NAME,e.CONDITION_TRUE=M.CONDITION_NAME,e.CONDITION_FALSE=A.CONDITION_NAME,e.OPERATION_AND=k.OPERATION_ID,e.OPERATION_OR=x.OPERATION_ID,e.OPERATION_OR_THEN_VARIABLE=I.OPERATION_ID;var L=e.TYPE_NUMERIC="numeric",P=e.TYPE_TEXT="text",H=e.TYPE_DATE="date",B=e.TYPES=(D(r={},L,[l.CONDITION_NAME,a.SEPARATOR,u.CONDITION_NAME,h.CONDITION_NAME,a.SEPARATOR,c.CONDITION_NAME,d.CONDITION_NAME,a.SEPARATOR,f.CONDITION_NAME,p.CONDITION_NAME,g.CONDITION_NAME,v.CONDITION_NAME,m.CONDITION_NAME,y.CONDITION_NAME]),D(r,P,[l.CONDITION_NAME,a.SEPARATOR,u.CONDITION_NAME,h.CONDITION_NAME,a.SEPARATOR,c.CONDITION_NAME,d.CONDITION_NAME,a.SEPARATOR,w.CONDITION_NAME,b.CONDITION_NAME,a.SEPARATOR,C.CONDITION_NAME,E.CONDITION_NAME]),D(r,H,[l.CONDITION_NAME,a.SEPARATOR,u.CONDITION_NAME,h.CONDITION_NAME,a.SEPARATOR,c.CONDITION_NAME,d.CONDITION_NAME,a.SEPARATOR,S.CONDITION_NAME,O.CONDITION_NAME,m.CONDITION_NAME,a.SEPARATOR,T.CONDITION_NAME,N.CONDITION_NAME,R.CONDITION_NAME]),r)},function(t,e,n){"use strict";e.__esModule=!0,e.SHORT_NAME_FOR_COMPONENT=e.OPERATION_ID=void 0,e.operationResult=s;var r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),i=n(68);var o=e.OPERATION_ID="conjunction",a=e.SHORT_NAME_FOR_COMPONENT=r.FILTERS_LABELS_CONJUNCTION;function s(t,e){return t.every(function(t){return t.func(e)})}(0,i.registerOperation)(o,a,s)},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(2),s=n(1),l=n(69),u=(o=l)&&o.__esModule?o:{default:o};var h=new WeakMap,c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(d,u.default),r(d,null,[{key:"DEFAULTS",get:function(){return(0,s.clone)({placeholder:"",type:"text",tagName:"input"})}}]),r(d,[{key:"registerHooks",value:function(){var e=this;this.addLocalHook("click",function(){return e.onClick()}),this.addLocalHook("keyup",function(t){return e.onKeyup(t)})}},{key:"build",value:function(){(function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"build",this).call(this);var t=h.get(this),e=document.createElement("div");t.input=this._element.firstChild,(0,a.addClass)(this._element,"htUIInput"),(0,a.addClass)(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var t=h.get(this).input;t.type=this.options.type,t.placeholder=this.translateIfPossible(this.options.placeholder),t.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&h.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(t){this.options.value=t.target.value}}]),d);function d(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,t,(0,s.extend)(d.DEFAULTS,e)));return h.set(n,{}),n.registerHooks(),n}e.default=c},function(t,e,n){"use strict";e.__esModule=!0,e.getMixedMonthObject=function(t,e){return{name:t,days:r,daysBeforeFullWeeks:0,daysAfterFullWeeks:0,fullWeeks:1,index:e}},e.getMixedMonthName=function(t,e){var n=null,r=s(e[t].name),i=0<t?s(e[t-1].name):null,o=s(e[0].name),a=s(e[e.length-1].name);n=0<t?i+"/"+r:t===e.length-1?r+"/"+o:a+"/"+r;return n},e.getShorthand=s,e.getStartDate=function(t){return i(Array.isArray(t)?t[1]:t.startDate)},e.getEndDate=function(t){return i(Array.isArray(t)?t[2]:t.endDate)},e.getAdditionalData=function(t){return Array.isArray(t)?t[3]:t.additionalData},e.setStartDate=function(t,e){Array.isArray(t)?t[1]=e:t.startDate=e},e.setEndDate=function(t,e){Array.isArray(t)?t[2]=e:t.endDate=e},e.parseDate=i,e.getDateYear=function(t){var e=i(t);return e?e.getFullYear():null};e.DEC_LENGTH=31;var r=e.WEEK_LENGTH=7;function s(t){return t.substring(0,3)}function i(t){var e=t;return null===e?null:e instanceof Date||"Invalid Date"!==(e=new Date(e)).toString()?e:null}},function(t,e,n){"use strict";e.__esModule=!0;e.default=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=n,this.plugin=e}},function(t,e,n){"use strict";function a(t,e){var n,r=p(e);if("F"!==r)return t._i[r];for(n=t._f;n;n=n.n)if(n.k==e)return n}var s=n(24).f,l=n(92),u=n(74),h=n(38),c=n(76),d=n(77),r=n(178),i=n(180),o=n(181),f=n(26),p=n(40).fastKey,g=n(53),v=f?"_s":"size";t.exports={getConstructor:function(t,o,n,r){var i=t(function(t,e){c(t,i,o,"_i"),t._t=o,t._i=l(null),t._f=void 0,t._l=void 0,t[v]=0,null!=e&&d(e,n,t[r],t)});return u(i.prototype,{clear:function(){for(var t=g(this,o),e=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete e[n.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var e=g(this,o),n=a(e,t);if(n){var r=n.n,i=n.p;delete e._i[n.i],n.r=!0,i&&(i.n=r),r&&(r.p=i),e._f==n&&(e._f=r),e._l==n&&(e._l=i),e[v]--}return!!n},forEach:function(t,e){g(this,o);for(var n,r=h(t,1<arguments.length?e:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!a(g(this,o),t)}}),f&&s(i.prototype,"size",{get:function(){return g(this,o)[v]}}),i},def:function(t,e,n){var r,i,o=a(t,e);return o?o.v=n:(t._l=o={i:i=p(e,!0),k:e,v:n,p:r=t._l,n:void 0,r:!1},t._f||(t._f=o),r&&(r.n=o),t[v]++,"F"!==i&&(t._i[i]=o)),t},getEntry:a,setStrong:function(t,n,e){r(t,n,function(t,e){this._t=g(t,n),this._k=e,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?i(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,i(1))},e?"entries":"values",!e,!0),o(n)}}},function(t,e,n){t.exports=!n(26)&&!n(27)(function(){return 7!=Object.defineProperty(n(90)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var a=n(35),s=n(28),l=n(172)(!1),u=n(94)("IE_PROTO");t.exports=function(t,e){var n,r=s(t),i=0,o=[];for(n in r)n!=u&&a(r,n)&&o.push(n);for(;e.length>i;)a(r,n=e[i++])&&(~l(o,n)||o.push(n));return o}},function(t,e,n){var l=n(28),u=n(29),h=n(73);t.exports=function(s){return function(t,e,n){var r,i=l(t),o=u(i.length),a=h(n,o);if(s&&e!=e){for(;a<o;)if((r=i[a++])!=r)return!0}else for(;a<o;a++)if((s||a in i)&&i[a]===e)return s||a||0;return!s&&-1}}},function(t,e,n){var r=n(16).document;t.exports=r&&r.documentElement},function(t,e,n){var o=n(21);t.exports=function(e,t,n,r){try{return r?t(o(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&o(i.call(e)),t}}},function(t,e,n){var r=n(61),i=n(14)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},function(t,e,n){var r=n(177),i=n(14)("iterator"),o=n(61);t.exports=n(50).getIteratorMethod=function(t){if(null!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){var i=n(52),o=n(14)("toStringTag"),a="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?n:a?i(e):"Object"==(r=i(e))&&"function"==typeof e.callee?"Arguments":r}},function(t,e,n){"use strict";function w(){return this}var b=n(58),C=n(6),E=n(36),S=n(37),O=n(61),T=n(241),N=n(62),R=n(179),_=n(14)("iterator"),M=!([].keys&&"next"in[].keys()),A="values";t.exports=function(t,e,n,r,i,o,a){T(n,e,r);function s(t){if(!M&&t in p)return p[t];switch(t){case"keys":case A:return function(){return new n(this,t)}}return function(){return new n(this,t)}}var l,u,h,c=e+" Iterator",d=i==A,f=!1,p=t.prototype,g=p[_]||p["@@iterator"]||i&&p[i],v=g||s(i),m=i?d?s("entries"):v:void 0,y="Array"==e&&p.entries||g;if(y&&(h=R(y.call(new t)))!==Object.prototype&&h.next&&(N(h,c,!0),b||"function"==typeof h[_]||S(h,_,w)),d&&g&&g.name!==A&&(f=!0,v=function(){return g.call(this)}),b&&!a||!M&&!f&&p[_]||S(p,_,v),O[e]=v,O[c]=w,i)if(l={values:d?v:s(A),keys:o?v:s("keys"),entries:m},a)for(u in l)u in p||E(p,u,l[u]);else C(C.P+C.F*(M||f),e,l);return l}},function(t,e,n){var r=n(35),i=n(39),o=n(94)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var r=n(16),i=n(24),o=n(26),a=n(14)("species");t.exports=function(t){var e=r[t];o&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,i){function o(t,e){if(r(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")}var n=i(13),r=i(21);t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,r){try{(r=i(38)(Function.call,i(79).f(Object.prototype,"__proto__").set,2))(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,e){return o(t,e),n?t.__proto__=e:r(t,e),t}}({},!1):void 0),check:o}},function(t,e,n){var r=n(52);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){"use strict";var d=n(48),f=n(81),p=n(63),g=n(39),v=n(93),i=Object.assign;t.exports=!i||n(27)(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=i({},t)[n]||Object.keys(i({},e)).join("")!=r})?function(t,e){for(var n=g(t),r=arguments.length,i=1,o=f.f,a=p.f;i<r;)for(var s,l=v(arguments[i++]),u=o?d(l).concat(o(l)):d(l),h=u.length,c=0;c<h;)a.call(l,s=u[c++])&&(n[s]=l[s]);return n}:i},function(t,e,n){"use strict";function a(t){return t._l||(t._l=new m)}function r(t,e){return p(t.a,function(t){return t[0]===e})}var s=n(74),l=n(40).getWeak,i=n(21),u=n(13),h=n(76),c=n(77),o=n(80),d=n(35),f=n(53),p=o(5),g=o(6),v=0,m=function(){this.a=[]};m.prototype={get:function(t){var e=r(this,t);if(e)return e[1]},has:function(t){return!!r(this,t)},set:function(t,e){var n=r(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(e){var t=g(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},t.exports={getConstructor:function(t,n,r,i){var o=t(function(t,e){h(t,o,n,"_i"),t._t=n,t._i=v++,t._l=void 0,null!=e&&c(e,r,t[i],t)});return s(o.prototype,{delete:function(t){if(!u(t))return!1;var e=l(t);return!0===e?a(f(this,n)).delete(t):e&&d(e,this._i)&&delete e[this._i]},has:function(t){if(!u(t))return!1;var e=l(t);return!0===e?a(f(this,n)).has(t):e&&d(e,this._i)}}),o},def:function(t,e,n){var r=l(i(e),!0);return!0===r?a(t).set(e,n):r[t._i]=n,t},ufstore:a}},function(t,e,n){"use strict";var i=n(75);function r(t){var n,r;this.promise=new t(function(t,e){if(void 0!==n||void 0!==r)throw TypeError("Bad Promise constructor");n=t,r=e}),this.resolve=i(n),this.reject=i(r)}t.exports.f=function(t){return new r(t)}},function(t,e,n){e.f=n(14)},function(t,e,n){var r=n(28),i=n(105).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?function(t){try{return i(t)}catch(t){return a.slice()}}(t):i(r(t))}},function(t,e,n){"use strict";var i=n(72),o=n(49);t.exports=function(t){var e=String(o(this)),n="",r=i(t);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;0<r;(r>>>=1)&&(e+=e))1&r&&(n+=e);return n}},function(t,e,n){var r=n(13),i=n(52),o=n(14)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},function(t,e,n){var r=n(13),i=Math.floor;t.exports=function(t){return!r(t)&&isFinite(t)&&i(t)===t}},function(t,e,n){var l=n(48),u=n(28),h=n(63).f;t.exports=function(s){return function(t){for(var e,n=u(t),r=l(n),i=r.length,o=0,a=[];o<i;)h.call(n,e=r[o++])&&a.push(s?[e,n[e]]:n[e]);return a}}},function(t,e,n){var h=n(29),c=n(189),d=n(49);t.exports=function(t,e,n,r){var i=String(d(t)),o=i.length,a=void 0===n?" ":String(n),s=h(e);if(s<=o||""==a)return i;var l=s-o,u=c.call(a,Math.ceil(l/a.length));return u.length>l&&(u=u.slice(0,l)),r?u+i:i+u}},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var d=new WeakMap,o=(r(l,null,[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),r(l,[{key:"calculate",value:function(){for(var t=0,e=!0,n=[],r=void 0,i=d.get(this),o=i.onlyFullyVisible,a=i.overrideFn,s=i.scrollOffset,l=i.totalColumns,u=i.viewportWidth,h=0;h<l;h++)if(r=this._getColumnWidth(h),t<=s&&!o&&(this.startColumn=h),s<=t&&t+r<=s+(0<s?u+1:u)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=h),this.endColumn=h),n.push(t),t+=r,o||(this.endColumn=h),s+u<=t){e=!1;break}if(this.endColumn===l-1&&e)for(this.startColumn=this.endColumn;0<this.startColumn;){var c=n[this.endColumn]+r-n[this.startColumn-1];if((c<=u||!o)&&(this.startColumn-=1),u<c)break}null!==this.startColumn&&a&&a(this),this.startPosition=n[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(t){if("none"!==this.stretch){var e=t;this.totalTargetWidth=e;for(var n=d.get(this),r=n.totalColumns,i=0,o=0;o<r;o++){var a=this._getColumnWidth(o),s=n.stretchingColumnWidthFn(void 0,o);"number"==typeof s?e-=s:i+=a}var l=e-i;if("all"===this.stretch&&0<l)this.stretchAllRatio=e/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&e!==1/0){var u=this._getColumnWidth(r-1),h=l+u;this.stretchLastWidth=0<=h?h:u}}}},{key:"getStretchedColumnWidth",value:function(t,e){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(t,e):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(t)),n}},{key:"_getStretchedAllColumnWidth",value:function(t,e){var n=0,r=d.get(this),i=r.totalColumns;if(!this.stretchAllColumnsWidth[t]){var o=Math.round(e*this.stretchAllRatio),a=r.stretchingColumnWidthFn(o,t);this.stretchAllColumnsWidth[t]=void 0===a?o:isNaN(a)?this._getColumnWidth(t):a}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var s=0;s<this.stretchAllColumnsWidth.length;s++)n+=this.stretchAllColumnsWidth[s];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[t]}},{key:"_getStretchedLastColumnWidth",value:function(t){return t===d.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var e=d.get(this).columnWidthFn(t);return isNaN(e)&&(e=l.DEFAULT_WIDTH),e}}]),l);function l(t,e,n,r,i,o,a){var s=7<arguments.length&&void 0!==arguments[7]?arguments[7]:function(t){return t};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),d.set(this,{viewportWidth:t,scrollOffset:e,totalColumns:n,columnWidthFn:r,overrideFn:i,onlyFullyVisible:o,stretchingColumnWidthFn:s}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=a,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}e.default=o},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var p=new WeakMap,o=(r(g,null,[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),r(g,[{key:"calculate",value:function(){for(var t=0,e=!0,n=[],r=p.get(this),i=r.onlyFullyVisible,o=r.overrideFn,a=r.rowHeightFn,s=r.scrollOffset,l=r.totalRows,u=r.viewportHeight,h=r.horizontalScrollbarHeight||0,c=void 0,d=0;d<l;d++)if(c=a(d),isNaN(c)&&(c=g.DEFAULT_HEIGHT),t<=s&&!i&&(this.startRow=d),s<=t&&t+c<=s+u-h&&(null===this.startRow&&(this.startRow=d),this.endRow=d),n.push(t),t+=c,i||(this.endRow=d),s+u-h<=t){e=!1;break}if(this.endRow===l-1&&e)for(this.startRow=this.endRow;0<this.startRow;){var f=n[this.endRow]+c-n[this.startRow-1];if((f<=u-h||!i)&&(this.startRow-=1),u-h<=f)break}null!==this.startRow&&o&&o(this),this.startPosition=n[this.startRow],void 0===this.startPosition&&(this.startPosition=null),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}]),g);function g(t,e,n,r,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),p.set(this,{viewportHeight:t,scrollOffset:e,totalRows:n,rowHeightFn:r,overrideFn:i,onlyFullyVisible:o,horizontalScrollbarHeight:a}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}e.default=o},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(65),d=(o=a)&&o.__esModule?o:{default:o};var s=(r(l,[{key:"setHighlight",value:function(t){return this.highlight=t,this}},{key:"setFrom",value:function(t){return this.from=t,this}},{key:"setTo",value:function(t){return this.to=t,this}},{key:"isValid",value:function(t){return this.from.isValid(t)&&this.to.isValid(t)}},{key:"isSingle",value:function(){return this.from.row===this.to.row&&this.from.col===this.to.col}},{key:"getHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"includes",value:function(t){var e=t.row,n=t.col,r=this.getTopLeftCorner(),i=this.getBottomRightCorner();return r.row<=e&&i.row>=e&&r.col<=n&&i.col>=n}},{key:"includesRange",value:function(t){return this.includes(t.getTopLeftCorner())&&this.includes(t.getBottomRightCorner())}},{key:"isEqual",value:function(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}},{key:"overlaps",value:function(t){return t.isSouthEastOf(this.getTopLeftCorner())&&t.isNorthWestOf(this.getBottomRightCorner())}},{key:"isSouthEastOf",value:function(t){return this.getTopLeftCorner().isSouthEastOf(t)||this.getBottomRightCorner().isSouthEastOf(t)}},{key:"isNorthWestOf",value:function(t){return this.getTopLeftCorner().isNorthWestOf(t)||this.getBottomRightCorner().isNorthWestOf(t)}},{key:"isOverlappingHorizontally",value:function(t){return this.getTopRightCorner().col>=t.getTopLeftCorner().col&&this.getTopRightCorner().col<=t.getTopRightCorner().col||this.getTopLeftCorner().col<=t.getTopRightCorner().col&&this.getTopLeftCorner().col>=t.getTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(t){return this.getBottomRightCorner().row>=t.getTopRightCorner().row&&this.getBottomRightCorner().row<=t.getBottomRightCorner().row||this.getTopRightCorner().row<=t.getBottomRightCorner().row&&this.getTopRightCorner().row>=t.getTopRightCorner().row}},{key:"expand",value:function(t){var e=this.getTopLeftCorner(),n=this.getBottomRightCorner();return(t.row<e.row||t.col<e.col||t.row>n.row||t.col>n.col)&&(this.from=new d.default(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=new d.default(Math.max(n.row,t.row),Math.max(n.col,t.col)),!0)}},{key:"expandByRange",value:function(t){if(this.includesRange(t)||!this.overlaps(t))return!1;var e=this.getTopLeftCorner(),n=this.getBottomRightCorner(),r=this.getDirection(),i=t.getTopLeftCorner(),o=t.getBottomRightCorner(),a=Math.min(e.row,i.row),s=Math.min(e.col,i.col),l=Math.max(n.row,o.row),u=Math.max(n.col,o.col),h=new d.default(a,s),c=new d.default(l,u);return this.from=h,this.to=c,this.setDirection(r),this.highlight.row===this.getBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(t){switch(t){case"NW-SE":var e=[this.getTopLeftCorner(),this.getBottomRightCorner()];this.from=e[0],this.to=e[1];break;case"NE-SW":var n=[this.getTopRightCorner(),this.getBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var r=[this.getBottomRightCorner(),this.getTopLeftCorner()];this.from=r[0],this.to=r[1];break;case"SW-NE":var i=[this.getBottomLeftCorner(),this.getTopRightCorner()];this.from=i[0],this.to=i[1]}}},{key:"getVerticalDirection",value:function(){return-1<["NE-SW","NW-SE"].indexOf(this.getDirection())?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return-1<["NW-SE","SW-NE"].indexOf(this.getDirection())?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getTopLeftCorner",value:function(){return new d.default(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getBottomRightCorner",value:function(){return new d.default(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getTopRightCorner",value:function(){return new d.default(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getBottomLeftCorner",value:function(){return new d.default(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(t,e){return!!(e&&e.includes(t)&&(this.getTopLeftCorner().isEqual(new d.default(e.from.row,e.from.col))||this.getTopRightCorner().isEqual(new d.default(e.from.row,e.to.col))||this.getBottomLeftCorner().isEqual(new d.default(e.to.row,e.from.col))||this.getBottomRightCorner().isEqual(new d.default(e.to.row,e.to.col))))||t.isEqual(this.getTopLeftCorner())||t.isEqual(this.getTopRightCorner())||t.isEqual(this.getBottomLeftCorner())||t.isEqual(this.getBottomRightCorner())}},{key:"getOppositeCorner",value:function(t,e){if(!(t instanceof d.default))return!1;if(e&&e.includes(t)){if(this.getTopLeftCorner().isEqual(new d.default(e.from.row,e.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new d.default(e.from.row,e.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new d.default(e.to.row,e.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new d.default(e.to.row,e.to.col)))return this.getTopLeftCorner()}return t.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():t.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():t.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():t.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0}},{key:"getBordersSharedWith",value:function(t){if(!this.includesRange(t))return[];var e=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),r=Math.min(this.from.col,this.to.col),i=Math.max(this.from.col,this.to.col),o=Math.min(t.from.row,t.to.row),a=Math.max(t.from.row,t.to.row),s=Math.min(t.from.col,t.to.col),l=Math.max(t.from.col,t.to.col),u=[];return e===o&&u.push("top"),i===l&&u.push("right"),n===a&&u.push("bottom"),r===s&&u.push("left"),u}},{key:"getInner",value:function(){for(var t=this.getTopLeftCorner(),e=this.getBottomRightCorner(),n=[],r=t.row;r<=e.row;r++)for(var i=t.col;i<=e.col;i++)this.from.row===r&&this.from.col===i||this.to.row===r&&this.to.col===i||n.push(new d.default(r,i));return n}},{key:"getAll",value:function(){for(var t=this.getTopLeftCorner(),e=this.getBottomRightCorner(),n=[],r=t.row;r<=e.row;r++)for(var i=t.col;i<=e.col;i++)t.row===r&&t.col===i?n.push(t):e.row===r&&e.col===i?n.push(e):n.push(new d.default(r,i));return n}},{key:"forAll",value:function(t){for(var e=this.getTopLeftCorner(),n=this.getBottomRightCorner(),r=e.row;r<=n.row;r++)for(var i=e.col;i<=n.col;i++)if(!1===t(r,i))return}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}}]),l);function l(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:t,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),this.highlight=t,this.from=e,this.to=n}e.default=s},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.__esModule=!0;var i=(function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}(o,[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]),o);function o(t,e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.offset=t,this.total=e,this.countTH=n}e.default=i},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.__esModule=!0;var i=(function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}(o,[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceRowToVisibleColHeadedRow",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]),o);function o(t,e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.offset=t,this.total=e,this.countTH=n}e.default=i},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(2),a=n(1),s=n(31),l=p(n(200)),u=p(n(201)),h=p(n(202)),c=p(n(203)),d=p(n(204)),f=p(n(206));function p(t){return t&&t.__esModule?t:{default:t}}var g=(r(v,[{key:"draw",value:function(t){var e=0<arguments.length&&void 0!==t&&t;return this.drawInterrupted=!1,e||(0,o.isVisible)(this.wtTable.TABLE)?this.wtTable.draw(e):this.drawInterrupted=!0,this}},{key:"getCell",value:function(t,e){if(!(1<arguments.length&&void 0!==e&&e))return this.wtTable.getCell(t);var n=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsLeft");if(t.row<r&&t.col<o)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(t);if(t.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<o&&t.row>=n-i){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<o)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(t);if(t.row<n&&t.row>n-i&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}},{key:"update",value:function(t,e){return this.wtSettings.update(t,e)}},{key:"scrollViewport",value:function(t,e,n,r,i){return this.wtScroll.scrollViewport(t,e,n,r,i)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return this.wtScroll.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return this.wtScroll.scrollViewportVertically(t,e,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"getOverlayName",value:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"}},{key:"isOverlayName",value:function(t){return!!this.cloneOverlay&&this.cloneOverlay.type===t}},{key:"exportSettingsAsClassNames",value:function(){var n=this,r=[],i=[];(0,a.objectEach)({rowHeaders:["array"],columnHeaders:["array"]},function(t,e){-1<t.indexOf("array")&&n.getSetting(e).length&&i.push("ht"+(0,s.toUpperCaseFirst)(e)),r.push("ht"+(0,s.toUpperCaseFirst)(e))}),(0,o.removeClass)(this.wtTable.wtRootElement.parentNode,r),(0,o.addClass)(this.wtTable.wtRootElement.parentNode,i)}},{key:"getSetting",value:function(t,e,n,r,i){return this.wtSettings.getSetting(t,e,n,r,i)}},{key:"hasSetting",value:function(t){return this.wtSettings.has(t)}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}}]),v);function v(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v);var n=[];if(this.guid="wt_"+(0,s.randomString)(),t.cloneSource?(this.cloneSource=t.cloneSource,this.cloneOverlay=t.cloneOverlay,this.wtSettings=t.cloneSource.wtSettings,this.wtTable=new d.default(this,t.table,t.wtRootElement),this.wtScroll=new h.default(this),this.wtViewport=t.cloneSource.wtViewport,this.wtEvent=new l.default(this),this.selections=this.cloneSource.selections):(this.wtSettings=new c.default(this,t),this.wtTable=new d.default(this,t.table),this.wtScroll=new h.default(this),this.wtViewport=new f.default(this),this.wtEvent=new l.default(this),this.selections=this.getSetting("selections"),this.wtOverlays=new u.default(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var e=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;e<r;e++)n.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(t,e){(0,o.fastInnerText)(e,n[t])}])}this.drawn=!1,this.drawInterrupted=!1}e.default=g},function(t,e,n){"use strict";e.__esModule=!0;var r,c=n(2),d=n(34),f=n(42),i=n(8),p=(r=i)&&r.__esModule?r:{default:r};function o(e){var a=this,n=new p.default(e),s=void 0;this.instance=e;var o=[null,null];this.dblClickTimeout=[null,null];function r(t){var e=document.activeElement,n=(0,d.partial)(c.getParent,t.realTarget),r=t.realTarget;if(r!==e&&n(0)!==e&&n(1)!==e){var i=a.parentCell(r);(0,c.hasClass)(r,"corner")?a.instance.getSetting("onCellCornerMouseDown",t,r):i.TD&&a.instance.hasSetting("onCellMouseDown")&&a.instance.getSetting("onCellMouseDown",t,i.coords,i.TD,a.instance),2!==t.button&&i.TD&&(o[0]=i.TD,clearTimeout(a.dblClickTimeout[0]),a.dblClickTimeout[0]=setTimeout(function(){o[0]=null},1e3))}}function i(){a.instance.touchMoving=!0}function l(t){if(2!==t.button){var e=a.parentCell(t.realTarget);e.TD&&a.instance.hasSetting("onCellMouseUp")&&a.instance.getSetting("onCellMouseUp",t,e.coords,e.TD,a.instance),e.TD===o[0]&&e.TD===o[1]?((0,c.hasClass)(t.realTarget,"corner")?a.instance.getSetting("onCellCornerDblClick",t,e.coords,e.TD,a.instance):a.instance.getSetting("onCellDblClick",t,e.coords,e.TD,a.instance),o[0]=null,o[1]=null):e.TD===o[0]&&(o[1]=e.TD,clearTimeout(a.dblClickTimeout[1]),a.dblClickTimeout[1]=setTimeout(function(){o[1]=null},500))}}function u(t){var e=t.target;!1!==function(t){var e=a.parentCell(t).coords;if(s&&e){var n=[e.row,s.from.row],r=n[0],i=n[1],o=[e.col,s.from.col];return r===i&&o[0]===o[1]}return!1}(e)&&!1!==["A","BUTTON","INPUT"].includes(e.tagName)||(t.preventDefault(),l(t))}if(n.addEventListener(this.instance.wtTable.holder,"mousedown",r),n.addEventListener(this.instance.wtTable.holder,"contextmenu",function(t){if(a.instance.hasSetting("onCellContextMenu")){var e=a.parentCell(t.realTarget);e.TD&&a.instance.getSetting("onCellContextMenu",t,e.coords,e.TD,a.instance)}}),n.addEventListener(this.instance.wtTable.TABLE,"mouseover",function(t){var e=void 0,n=void 0,r=void 0;a.instance.hasSetting("onCellMouseOver")&&(e=a.instance.wtTable.TABLE,n=(0,c.closestDown)(t.realTarget,["TD","TH"],e),r=a.instance.cloneSource||a.instance,n&&n!==r.lastMouseOver&&(0,c.isChildOf)(n,e)&&(r.lastMouseOver=n,a.instance.getSetting("onCellMouseOver",t,a.instance.wtTable.getCoords(n),n,a.instance)))}),n.addEventListener(this.instance.wtTable.TABLE,"mouseout",function(t){var e=void 0,n=void 0,r=void 0;a.instance.hasSetting("onCellMouseOut")&&(e=a.instance.wtTable.TABLE,n=(0,c.closestDown)(t.realTarget,["TD","TH"],e),r=(0,c.closestDown)(t.relatedTarget,["TD","TH"],e),n&&n!==r&&(0,c.isChildOf)(n,e)&&a.instance.getSetting("onCellMouseOut",t,a.instance.wtTable.getCoords(n),n,a.instance))}),n.addEventListener(this.instance.wtTable.holder,"mouseup",l),this.instance.wtTable.holder.parentNode.parentNode&&(0,f.isMobileBrowser)()&&!a.instance.wtTable.isWorkingOnClone()){var h="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");n.addEventListener(this.instance.wtTable.holder,"touchstart",function(t){s=e.selections.getCell().cellRange,a.instance.touchApplied=!0,(0,c.isChildOf)(t.target,h)&&function(t){n.addEventListener(this,"touchmove",i),a.checkIfTouchMove=setTimeout(function(){!0===a.instance.touchMoving&&(a.instance.touchMoving=void 0,n.removeEventListener("touchmove",i,!1)),r(t)},30)}.call(t.target,t)}),n.addEventListener(this.instance.wtTable.holder,"touchend",function(t){a.instance.touchApplied=!1,(0,c.isChildOf)(t.target,h)&&u.call(t.target,t)}),a.instance.momentumScrolling||(a.instance.momentumScrolling={}),n.addEventListener(this.instance.wtTable.holder,"scroll",function(){clearTimeout(a.instance.momentumScrolling._timeout),a.instance.momentumScrolling.ongoing||a.instance.getSetting("onBeforeTouchScroll"),a.instance.momentumScrolling.ongoing=!0,a.instance.momentumScrolling._timeout=setTimeout(function(){a.instance.touchApplied||(a.instance.momentumScrolling.ongoing=!1,a.instance.getSetting("onAfterMomentumScroll"))},200)})}n.addEventListener(window,"resize",function(){"none"!==a.instance.getSetting("stretchH")&&a.instance.draw()}),this.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1]),n.destroy()}}o.prototype.parentCell=function(t){var e={},n=this.instance.wtTable.TABLE,r=(0,c.closestDown)(t,["TD","TH"],n);return r?(e.coords=this.instance.wtTable.getCoords(r),e.TD=r):(0,c.hasClass)(t,"wtBorder")&&(0,c.hasClass)(t,"current")?(e.coords=this.instance.selections.getCell().cellRange.highlight,e.TD=this.instance.wtTable.getCell(e.coords)):(0,c.hasClass)(t,"wtBorder")&&(0,c.hasClass)(t,"area")&&this.instance.selections.createOrGetArea().cellRange&&(e.coords=this.instance.selections.createOrGetArea().cellRange.to,e.TD=this.instance.wtTable.getCell(e.coords)),e},e.default=o},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(2),a=n(0),s=n(18),l=n(42),u=c(n(8)),h=c(n(33));function c(t){return t&&t.__esModule?t:{default:t}}var d=(r(f,[{key:"prepareOverlays",value:function(){var t=!1;return this.topOverlay?t=this.topOverlay.updateStateOfRendering()||t:this.topOverlay=h.default.createOverlay(h.default.CLONE_TOP,this.wot),h.default.hasOverlay(h.default.CLONE_BOTTOM)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),h.default.hasOverlay(h.default.CLONE_BOTTOM_LEFT_CORNER)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?t=this.bottomOverlay.updateStateOfRendering()||t:this.bottomOverlay=h.default.createOverlay(h.default.CLONE_BOTTOM,this.wot),this.leftOverlay?t=this.leftOverlay.updateStateOfRendering()||t:this.leftOverlay=h.default.createOverlay(h.default.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?t=this.topLeftCornerOverlay.updateStateOfRendering()||t:this.topLeftCornerOverlay=h.default.createOverlay(h.default.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?t=this.bottomLeftCornerOverlay.updateStateOfRendering()||t:this.bottomLeftCornerOverlay=h.default.createOverlay(h.default.CLONE_BOTTOM_LEFT_CORNER,this.wot)),this.wot.getSetting("debug")&&!this.debug&&(this.debug=h.default.createOverlay(h.default.CLONE_DEBUG,this.wot)),t}},{key:"refreshAll",value:function(){this.wot.drawn&&(this.wot.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var i=this,t=this.topOverlay.mainTableScrollableElement,e=this.leftOverlay.mainTableScrollableElement,n=[];for(n.push([document.documentElement,"keydown",function(t){return i.onKeyDown(t)}]),n.push([document.documentElement,"keyup",function(){return i.onKeyUp()}]),n.push([document,"visibilitychange",function(){return i.onKeyUp()}]),n.push([t,"scroll",function(t){return i.onTableScroll(t)}]),t!==e&&n.push([e,"scroll",function(t){return i.onTableScroll(t)}]),window.devicePixelRatio&&1<window.devicePixelRatio||!(0,l.isChrome)()?n.push([this.instance.wtTable.wtRootElement.parentNode,"wheel",function(t){return i.onCloneWheel(t)}]):(this.topOverlay.needFullRender&&n.push([this.topOverlay.clone.wtTable.holder,"wheel",function(t){return i.onCloneWheel(t)}]),this.bottomOverlay.needFullRender&&n.push([this.bottomOverlay.clone.wtTable.holder,"wheel",function(t){return i.onCloneWheel(t)}]),this.leftOverlay.needFullRender&&n.push([this.leftOverlay.clone.wtTable.holder,"wheel",function(t){return i.onCloneWheel(t)}]),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.needFullRender&&n.push([this.topLeftCornerOverlay.clone.wtTable.holder,"wheel",function(t){return i.onCloneWheel(t)}]),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.needFullRender&&n.push([this.bottomLeftCornerOverlay.clone.wtTable.holder,"wheel",function(t){return i.onCloneWheel(t)}])),this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&n.push([window,"wheel",function(t){var e=void 0,n=t.wheelDeltaY||t.deltaY,r=t.wheelDeltaX||t.deltaX;i.topOverlay.clone.wtTable.holder.contains(t.realTarget)?e="top":i.bottomOverlay.clone&&i.bottomOverlay.clone.wtTable.holder.contains(t.realTarget)?e="bottom":i.leftOverlay.clone.wtTable.holder.contains(t.realTarget)?e="left":i.topLeftCornerOverlay&&i.topLeftCornerOverlay.clone&&i.topLeftCornerOverlay.clone.wtTable.holder.contains(t.realTarget)?e="topLeft":i.bottomLeftCornerOverlay&&i.bottomLeftCornerOverlay.clone&&i.bottomLeftCornerOverlay.clone.wtTable.holder.contains(t.realTarget)&&(e="bottomLeft"),!("top"===e&&0!==n||"left"===e&&0!==r||"bottom"===e&&0!==n)&&("topLeft"!==e&&"bottomLeft"!==e||0===n&&0===r)||t.preventDefault()}]);n.length;){var r=n.pop();this.eventManager.addEventListener(r[0],r[1],r[2]),this.registeredListeners.push(r)}}},{key:"deregisterListeners",value:function(){for(;this.registeredListeners.length;){var t=this.registeredListeners.pop();this.eventManager.removeEventListener(t[0],t[1],t[2])}}},{key:"onTableScroll",value:function(t){var e=this.leftOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,r=t.target;this.keyPressed&&(n!==window&&r!==window&&!t.target.contains(n)||e!==window&&r!==window&&!t.target.contains(e))||this.syncScrollPositions(t)}},{key:"onCloneWheel",value:function(t){this.scrollableElement!==window&&t.preventDefault();var e=this.leftOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,r=t.target,i=n!==window&&r!==window&&!t.target.contains(n),o=e!==window&&r!==window&&!t.target.contains(e);this.keyPressed&&(i||o)||this.translateMouseWheelToScroll(t)}},{key:"onKeyDown",value:function(t){this.keyPressed=(0,s.isKey)(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(t){var e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,n=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;return 1===t.deltaMode&&(n+=n*this.browserLineHeight,e+=e*this.browserLineHeight),this.scrollVertically(e),this.scrollHorizontally(n),!1}},{key:"scrollVertically",value:function(t){if(0===t)return 0;this.scrollableElement.scrollTop+=t}},{key:"scrollHorizontally",value:function(t){if(0===t)return 0;this.scrollableElement.scrollLeft+=t}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var t=this.topOverlay.clone.wtTable.holder,e=this.leftOverlay.clone.wtTable.holder,n=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],r=n[0],i=n[1];if(this.horizontalScrolling=t.scrollLeft!==r,this.verticalScrolling=e.scrollTop!==i,this.horizontalScrolling){t.scrollLeft=r;var o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(e.scrollTop=i),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var t=this.topOverlay.mainTableScrollableElement,e=t.scrollLeft,n=t.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement(),this.scrollableElement=(0,o.getScrollableElement)(this.wot.wtTable.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.debug&&this.debug.destroy(),this.destroyed=!0}},{key:"refresh",value:function(t){var e=0<arguments.length&&void 0!==t&&t;if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var n=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,r=n.clientWidth,i=n.clientHeight;r===this.spreaderLastSize.width&&i===this.spreaderLastSize.height||(this.spreaderLastSize.width=r,this.spreaderLastSize.height=i,this.adjustElementsSize())}this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.leftOverlay.refresh(e),this.topOverlay.refresh(e),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(e),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(e),this.debug&&this.debug.refresh(e)}},{key:"adjustElementsSize",value:function(t){var e=0<arguments.length&&void 0!==t&&t,n=this.wot.getSetting("totalColumns"),r=this.wot.getSetting("totalRows"),i=this.wot.wtViewport.getRowHeaderWidth(),o=this.wot.wtViewport.getColumnHeaderHeight(),a=this.wot.wtTable.hider.style;a.width=i+this.leftOverlay.sumCellSizes(0,n)+"px",a.height=o+this.topOverlay.sumCellSizes(0,r)+1+"px",this.topOverlay.adjustElementsSize(e),this.leftOverlay.adjustElementsSize(e),this.bottomOverlay.clone&&this.bottomOverlay.adjustElementsSize(e)}},{key:"applyToDOM",value:function(){this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted||this.adjustElementsSize(),this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.leftOverlay.applyToDOM()}},{key:"getParentOverlay",value:function(e){if(!e)return null;var t=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],n=null;return(0,a.arrayEach)(t,function(t){t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(n=t.clone)}),n}}]),f);function f(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);var e=parseInt(getComputedStyle(document.body).lineHeight,10),n=1.2*parseInt(getComputedStyle(document.body).fontSize,10);this.wot=t,this.instance=this.wot,this.eventManager=new u.default(this.wot),this.wot.update("scrollbarWidth",(0,o.getScrollbarWidth)()),this.wot.update("scrollbarHeight",(0,o.getScrollbarWidth)()),this.scrollableElement=(0,o.getScrollableElement)(this.wot.wtTable.TABLE),this.prepareOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},bottom:{top:null,left:0},left:{top:0,left:null}},this.pendingScrollCallbacks={master:{top:0,left:0},top:{left:0},bottom:{left:0},left:{top:0}},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.delegatedScrollCallback=!1,this.registeredListeners=[],this.browserLineHeight=e||n,this.registerListeners()}e.default=d},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var d=n(2),f=n(4);var o=(r(a,[{key:"scrollViewport",value:function(t,e,n,r,i){var o=this.scrollViewportHorizontally(t.col,n,i),a=this.scrollViewportVertically(t.row,e,r);return o||a}},{key:"scrollViewportHorizontally",value:function(t,e,n){if(!this.wot.drawn)return!1;var r=this._getVariables(),i=r.fixedColumnsLeft,o=r.leftOverlay,a=r.totalColumns,s=!1;return 0<=t&&t<=Math.max(a-1,0)&&(i<=t&&(t<this.getFirstVisibleColumn()||n)?s=o.scrollTo(t):(t>this.getLastVisibleColumn()||e)&&(s=o.scrollTo(t,!0))),s}},{key:"scrollViewportVertically",value:function(t,e,n){if(!this.wot.drawn)return!1;var r=this._getVariables(),i=r.fixedRowsBottom,o=r.fixedRowsTop,a=r.topOverlay,s=r.totalRows,l=!1;return 0<=t&&t<=Math.max(s-1,0)&&(o<=t&&(t<this.getFirstVisibleRow()||e)?l=a.scrollTo(t):(t>this.getLastVisibleRow()&&t<s-i||n)&&(l=a.scrollTo(t,!0))),l}},{key:"getFirstVisibleRow",value:function(){var t=this._getVariables(),e=t.topOverlay,n=t.wtTable,r=t.wtViewport,i=t.totalRows,o=t.fixedRowsTop,a=n.getFirstVisibleRow();if(e.mainTableScrollableElement===window){var s=(0,d.offset)(n.wtRootElement),l=(0,d.innerHeight)(n.hider),u=(0,d.innerHeight)(window),h=(0,d.getScrollTop)(window);if(s.top+l-u<=h){var c=r.getColumnHeaderHeight();c+=e.sumCellSizes(0,o),(0,f.rangeEachReverse)(i,1,function(t){if(c+=e.sumCellSizes(t-1,t),s.top+l-c<=h)return a=t,!1})}}return a}},{key:"getLastVisibleRow",value:function(){var t=this._getVariables(),e=t.topOverlay,n=t.wtTable,r=t.wtViewport,i=t.totalRows,o=n.getLastVisibleRow();if(e.mainTableScrollableElement===window){var a=(0,d.offset)(n.wtRootElement),s=(0,d.innerHeight)(window),l=(0,d.getScrollTop)(window);if(a.top>l){var u=r.getColumnHeaderHeight();(0,f.rangeEach)(1,i,function(t){if(u+=e.sumCellSizes(t-1,t),a.top+u-l>=s)return o=t-2,!1})}}return o}},{key:"getFirstVisibleColumn",value:function(){var t=this._getVariables(),e=t.leftOverlay,n=t.wtTable,r=t.wtViewport,i=t.totalColumns,o=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===window){var a=(0,d.offset)(n.wtRootElement),s=(0,d.innerWidth)(n.hider),l=(0,d.innerWidth)(window),u=(0,d.getScrollLeft)(window);if(a.left+s-l<=u){var h=r.getRowHeaderWidth();(0,f.rangeEachReverse)(i,1,function(t){if(h+=e.sumCellSizes(t-1,t),a.left+s-h<=u)return o=t,!1})}}return o}},{key:"getLastVisibleColumn",value:function(){var t=this._getVariables(),e=t.leftOverlay,n=t.wtTable,r=t.wtViewport,i=t.totalColumns,o=n.getLastVisibleColumn();if(e.mainTableScrollableElement===window){var a=(0,d.offset)(n.wtRootElement),s=(0,d.innerWidth)(window),l=(0,d.getScrollLeft)(window);if(a.left>l){var u=r.getRowHeaderWidth();(0,f.rangeEach)(1,i,function(t){if(u+=e.sumCellSizes(t-1,t),a.left+u-l>=s)return o=t-2,!1})}}return o}},{key:"_getVariables",value:function(){var t=this.wot;return{topOverlay:t.wtOverlays.topOverlay,leftOverlay:t.wtOverlays.leftOverlay,wtTable:t.wtTable,wtViewport:t.wtViewport,totalRows:t.getSetting("totalRows"),totalColumns:t.getSetting("totalColumns"),fixedRowsTop:t.getSetting("fixedRowsTop"),fixedRowsBottom:t.getSetting("fixedRowsBottom"),fixedColumnsLeft:t.getSetting("fixedColumnsLeft")}}}]),a);function a(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),this.wot=t,this.instance=t}e.default=o},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(2),a=n(1);var s=(r(l,[{key:"update",value:function(t,e){var n=this;return void 0===e?(0,a.objectEach)(t,function(t,e){n.settings[e]=t}):this.settings[t]=e,this.wot}},{key:"getSetting",value:function(t,e,n,r,i){return"function"==typeof this.settings[t]?this.settings[t](e,n,r,i):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}},{key:"has",value:function(t){return!!this.settings[t]}}]),l);function l(t,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),this.wot=t,this.instance=t,this.defaults={table:void 0,debug:!1,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(t,e,n){var r=i.getSetting("data",t,e);(0,o.fastInnerText)(n,null==r?"":r)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(t){return t},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={},(0,a.objectEach)(this.defaults,function(t,e){if(void 0!==n[e])i.settings[e]=n[e];else{if(void 0===t)throw new Error('A required setting "'+e+'" was not provided');i.settings[e]=t}})}e.default=s},function(t,e,n){"use strict";e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t};function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var f=n(2),s=n(34),l=h(n(65)),p=h(n(197)),g=h(n(198)),u=h(n(205)),v=h(n(33));function h(t){return t&&t.__esModule?t:{default:t}}var c=(i(d,[{key:"fixTableDomTree",value:function(){this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=document.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=document.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=document.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(document.createElement("TR"))}},{key:"createSpreader",value:function(t){var e=t.parentNode,n=void 0;return e&&1===e.nodeType&&(0,f.hasClass)(e,"wtHolder")||((n=document.createElement("div")).className="wtSpreader",e&&e.insertBefore(n,t),n.appendChild(t)),n.style.position="relative",n}},{key:"createHider",value:function(t){var e=t.parentNode,n=void 0;return e&&1===e.nodeType&&(0,f.hasClass)(e,"wtHolder")||((n=document.createElement("div")).className="wtHider",e&&e.insertBefore(n,t),n.appendChild(t)),n}},{key:"createHolder",value:function(t){var e=t.parentNode,n=void 0;return e&&1===e.nodeType&&(0,f.hasClass)(e,"wtHolder")||((n=document.createElement("div")).style.position="relative",n.className="wtHolder",e&&e.insertBefore(n,t),this.isWorkingOnClone()||(n.parentNode.className+="ht_master handsontable"),n.appendChild(t)),n}},{key:"alignOverlaysWithTrimmingContainer",value:function(){var t=(0,f.getTrimmingContainer)(this.wtRootElement);this.isWorkingOnClone()||(this.holder.parentNode.style.position="relative",t===window?this.wot.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible"):(this.holder.style.width=(0,f.getStyle)(t,"width"),this.holder.style.height=(0,f.getStyle)(t,"height"),this.holder.style.overflow=""))}},{key:"isWorkingOnClone",value:function(){return!!this.wot.cloneSource}},{key:"draw",value:function(t){var e=this.wot,n=e.wtOverlays,r=e.wtViewport,i=this.instance.getSetting("totalRows"),o=this.wot.getSetting("rowHeaders").length,a=this.wot.getSetting("columnHeaders").length,s=!1,l=t;if(!this.isWorkingOnClone()&&(this.holderOffset=(0,f.offset)(this.holder),l=r.createRenderCalculators(l),o&&!this.wot.getSetting("fixedColumnsLeft"))){var u=n.leftOverlay.getScrollPosition(),h=this.correctHeaderWidth;this.correctHeaderWidth=0<u,h!==this.correctHeaderWidth&&(l=!1)}if(this.isWorkingOnClone()||(s=n.prepareOverlays()),l)this.isWorkingOnClone()||r.createVisibleCalculators(),n&&n.refresh(!0);else{this.isWorkingOnClone()?this.tableOffset=this.wot.cloneSource.wtTable.tableOffset:this.tableOffset=(0,f.offset)(this.TABLE);var c=void 0;c=v.default.isOverlayTypeOf(this.wot.cloneOverlay,v.default.CLONE_DEBUG)||v.default.isOverlayTypeOf(this.wot.cloneOverlay,v.default.CLONE_TOP)||v.default.isOverlayTypeOf(this.wot.cloneOverlay,v.default.CLONE_TOP_LEFT_CORNER)?0:v.default.isOverlayTypeOf(this.instance.cloneOverlay,v.default.CLONE_BOTTOM)||v.default.isOverlayTypeOf(this.instance.cloneOverlay,v.default.CLONE_BOTTOM_LEFT_CORNER)?Math.max(i-this.wot.getSetting("fixedRowsBottom"),0):r.rowsRenderCalculator.startRow;var d=void 0;d=v.default.isOverlayTypeOf(this.wot.cloneOverlay,v.default.CLONE_DEBUG)||v.default.isOverlayTypeOf(this.wot.cloneOverlay,v.default.CLONE_LEFT)||v.default.isOverlayTypeOf(this.wot.cloneOverlay,v.default.CLONE_TOP_LEFT_CORNER)||v.default.isOverlayTypeOf(this.wot.cloneOverlay,v.default.CLONE_BOTTOM_LEFT_CORNER)?0:r.columnsRenderCalculator.startColumn,this.rowFilter=new g.default(c,i,a),this.columnFilter=new p.default(d,this.wot.getSetting("totalColumns"),o),this.alignOverlaysWithTrimmingContainer(),this._doDraw()}return this.refreshSelections(l),this.isWorkingOnClone()||(n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&n.bottomOverlay.resetFixedPosition(),n.leftOverlay.resetFixedPosition(),n.topLeftCornerOverlay&&n.topLeftCornerOverlay.resetFixedPosition(),n.bottomLeftCornerOverlay&&n.bottomLeftCornerOverlay.clone&&n.bottomLeftCornerOverlay.resetFixedPosition()),s&&n.syncScrollWithMaster(),this.wot.drawn=!0,this}},{key:"_doDraw",value:function(){new u.default(this).render()}},{key:"removeClassFromCells",value:function(t){for(var e=this.TABLE.querySelectorAll("."+t),n=0,r=e.length;n<r;n++)(0,f.removeClass)(e[n],t)}},{key:"refreshSelections",value:function(t){if(this.wot.selections){var e=Array.from(this.wot.selections),n=e.length;if(t){for(var r=[],i=0;i<n;i++){for(var o=e[i].settings,a=o.highlightHeaderClassName,s=o.highlightRowClassName,l=o.highlightColumnClassName,u=e[i].classNames,h=u.length,c=0;c<h;c++)r.includes(u[c])||r.push(u[c]);a&&!r.includes(a)&&r.push(a),s&&!r.includes(s)&&r.push(s),l&&!r.includes(l)&&r.push(l)}var d=this.wot.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(d))for(var f=0;f<d.length;f++)r.push(d[f]);for(var p=r.length,g=0;g<p;g++)this.removeClassFromCells(r[g])}for(var v=0;v<n;v++)e[v].draw(this.wot,t)}}},{key:"getCell",value:function(t){var e=t.row,n=t.col,r=this.wot.getSetting("onModifyGetCellCoords",e,n);if(r&&Array.isArray(r)){var i=a(r,2);e=i[0],n=i[1]}if(this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return o?o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)]:void 0}},{key:"getColumnHeader",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:0,r=this.THEAD.childNodes[n];if(r)return r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}},{key:"getRowHeader",value:function(t){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var e=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)];return e?e.childNodes[0]:void 0}},{key:"getCoords",value:function(t){var e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=(0,f.closest)(e,["TD","TH"])),null===e)return null;var n=e.parentNode,r=n.parentNode,i=(0,f.index)(n),o=e.cellIndex;return(0,f.overlayContainsElement)(v.default.CLONE_TOP_LEFT_CORNER,e)||(0,f.overlayContainsElement)(v.default.CLONE_TOP,e)?"THEAD"===r.nodeName&&(i-=r.childNodes.length):i=r===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter.renderedToSource(i),o=(0,f.overlayContainsElement)(v.default.CLONE_TOP_LEFT_CORNER,e)||(0,f.overlayContainsElement)(v.default.CLONE_LEFT,e)?this.columnFilter.offsettedTH(o):this.columnFilter.visibleRowHeadedColumnToSourceColumn(o),new l.default(i,o)}},{key:"getTrForRow",value:function(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}},{key:"getFirstRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.startRow}},{key:"getFirstVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.startRow}},{key:"getFirstRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.startColumn}},{key:"getFirstVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.startColumn}},{key:"getLastRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.endRow}},{key:"getLastVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.endRow}},{key:"getLastRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.endColumn}},{key:"getLastVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.endColumn}},{key:"isRowBeforeRenderedRows",value:function(t){return this.rowFilter&&this.rowFilter.sourceToRendered(t)<0&&0<=t}},{key:"isRowAfterViewport",value:function(t){return this.rowFilter&&this.rowFilter.sourceToRendered(t)>this.getLastVisibleRow()}},{key:"isRowAfterRenderedRows",value:function(t){return this.rowFilter&&this.rowFilter.sourceToRendered(t)>this.getLastRenderedRow()}},{key:"isColumnBeforeViewport",value:function(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&0<=t}},{key:"isColumnAfterViewport",value:function(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)>this.getLastVisibleColumn()}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"getRenderedColumnsCount",value:function(){var t=this.wot.wtViewport.columnsRenderCalculator.count,e=this.wot.getSetting("totalColumns");if(this.wot.isOverlayName(v.default.CLONE_DEBUG))t=e;else if(this.wot.isOverlayName(v.default.CLONE_LEFT)||this.wot.isOverlayName(v.default.CLONE_TOP_LEFT_CORNER)||this.wot.isOverlayName(v.default.CLONE_BOTTOM_LEFT_CORNER))return Math.min(this.wot.getSetting("fixedColumnsLeft"),e);return t}},{key:"getRenderedRowsCount",value:function(){var t=this.wot.wtViewport.rowsRenderCalculator.count,e=this.wot.getSetting("totalRows");return this.wot.isOverlayName(v.default.CLONE_DEBUG)?t=e:this.wot.isOverlayName(v.default.CLONE_TOP)||this.wot.isOverlayName(v.default.CLONE_TOP_LEFT_CORNER)?t=Math.min(this.wot.getSetting("fixedRowsTop"),e):(this.wot.isOverlayName(v.default.CLONE_BOTTOM)||this.wot.isOverlayName(v.default.CLONE_BOTTOM_LEFT_CORNER))&&(t=Math.min(this.wot.getSetting("fixedRowsBottom"),e)),t}},{key:"getVisibleRowsCount",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"getRowHeight",value:function(t){var e=this.wot.wtSettings.settings.rowHeight(t),n=this.wot.wtViewport.oversizedRows[t];return void 0!==n&&(e=void 0===e?n:Math.max(e,n)),e}},{key:"getColumnHeaderHeight",value:function(t){var e=this.wot.wtSettings.settings.defaultRowHeight,n=this.wot.wtViewport.oversizedColumnHeaders[t];return void 0!==n&&(e=e?Math.max(e,n):n),e}},{key:"getVisibleColumnsCount",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getColumnWidth",value:function(t){var e=this.wot.wtSettings.settings.columnWidth;return"function"==typeof e?e=e(t):"object"===(void 0===e?"undefined":r(e))&&(e=e[t]),e||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(t){var e=this.getColumnWidth(t),n=null==e?this.instance.wtSettings.settings.defaultColumnWidth:e,r=this.wot.wtViewport.columnsRenderCalculator;if(r){var i=r.getStretchedColumnWidth(t,n);i&&(n=i)}return n}},{key:"_modifyRowHeaderWidth",value:function(t){var e=(0,s.isFunction)(t)?t():null;return Array.isArray(e)?(e=[].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(e)))[e.length-1]=this._correctRowHeaderWidth(e[e.length-1]):e=this._correctRowHeaderWidth(e),e}},{key:"_correctRowHeaderWidth",value:function(t){var e=t;return"number"!=typeof t&&(e=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}]),d);function d(t,e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),this.wot=t,this.instance=this.wot,this.TABLE=e,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.tableOffset=0,(this.holderOffset=0,f.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var r=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return n._modifyRowHeaderWidth(r)}}e.default=c},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a,s,l=(o=['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number \n          of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],a=['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number \n          of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(a)}}))),y=n(2),u=n(22),h=n(25),c=n(33),w=(s=c)&&s.__esModule?s:{default:s};var d=!1,f=(r(p,[{key:"render",value:function(){if(!this.wtTable.isWorkingOnClone()){var t={};if(this.wot.getSetting("beforeDraw",!0,t),!0===t.skipRender)return}this.rowHeaders=this.wot.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.wot.getSetting("fixedRowsTop"),this.fixedRowsBottom=this.wot.getSetting("fixedRowsBottom"),this.columnHeaders=this.wot.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var e=this.wtTable.getRenderedColumnsCount(),n=this.wtTable.getRenderedRowsCount(),r=this.wot.getSetting("totalColumns"),i=this.wot.getSetting("totalRows"),o=void 0,a=!1;if((w.default.isOverlayTypeOf(this.wot.cloneOverlay,w.default.CLONE_BOTTOM)||w.default.isOverlayTypeOf(this.wot.cloneOverlay,w.default.CLONE_BOTTOM_LEFT_CORNER))&&(this.columnHeaders=[],this.columnHeaderCount=0),0<=r&&(this.adjustAvailableNodes(),a=!0,this.renderColumnHeaders(),this.renderRows(i,n,e),this.wtTable.isWorkingOnClone()||(o=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnWidths(e),this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights()),a||this.adjustAvailableNodes(),this.removeRedundantRows(n),this.wtTable.isWorkingOnClone()&&!this.wot.isOverlayName(w.default.CLONE_BOTTOM)||this.markOversizedRows(),this.wtTable.isWorkingOnClone())this.wot.isOverlayName(w.default.CLONE_BOTTOM)&&this.wot.cloneSource.wtOverlays.adjustElementsSize();else{this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM();var s=(0,y.outerWidth)(this.wtTable.hider),l=(0,y.outerWidth)(this.wtTable.TABLE);if(0!==s&&l!==s&&this.adjustColumnWidths(e),o!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;var u=this.wtTable.getFirstRenderedColumn(),h=this.wtTable.getLastRenderedColumn(),c=this.wot.getSetting("defaultColumnWidth"),d=this.wot.getSetting("rowHeaderWidth");if(null!=(d=this.instance.getSetting("onModifyRowHeaderWidth",d)))for(var f=0;f<this.rowHeaderCount;f++){var p=Array.isArray(d)?d[f]:d;p=null==p?c:p,this.COLGROUP.childNodes[f].style.width=p+"px"}for(var g=u;g<h;g++){var v=this.wtTable.getStretchedColumnWidth(g),m=this.columnFilter.sourceToRendered(g);this.COLGROUP.childNodes[m+this.rowHeaderCount].style.width=v+"px"}}this.wot.getSetting("onDraw",!0)}}},{key:"removeRedundantRows",value:function(t){for(;this.wtTable.tbodyChildrenLength>t;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength-=1}},{key:"renderRows",value:function(t,e,n){for(var r=void 0,i=0,o=this.rowFilter.renderedToSource(i),a=this.wtTable.isWorkingOnClone();o<t&&0<=o&&(!d&&1e3<i&&(d=!0,(0,u.warn)((0,h.toSingleLine)(l))),void 0===e||i!==e);){if(r=this.getOrCreateTrForRow(i,r),this.renderRowHeaders(o,r),this.adjustColumns(r,n+this.rowHeaderCount),this.renderCells(o,r,n),a&&!this.wot.isOverlayName(w.default.CLONE_BOTTOM)||this.resetOversizedRow(o),r.firstChild){var s=this.wot.wtTable.getRowHeight(o);s?(s-=1,r.firstChild.style.height=s+"px"):r.firstChild.style.height=""}i+=1,o=this.rowFilter.renderedToSource(i)}}},{key:"resetOversizedRow",value:function(t){this.wot.getSetting("externalRowCalculator")||this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[t]&&(this.wot.wtViewport.oversizedRows[t]=void 0)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var t=this.instance.wtTable.TBODY.childNodes.length,e=void 0,n=void 0,r=void 0,i=void 0,o=void 0;if(t*this.instance.wtSettings.settings.defaultRowHeight!=(0,y.innerHeight)(this.instance.wtTable.TBODY)-1||this.instance.getSetting("fixedRowsBottom"))for(;t;)t-=1,r=this.instance.wtTable.rowFilter.renderedToSource(t),e=this.instance.wtTable.getRowHeight(r),n=(o=(i=this.instance.wtTable.getTrForRow(r)).querySelector("th"))?(0,y.innerHeight)(o):(0,y.innerHeight)(i)-1,(!e&&this.instance.wtSettings.settings.defaultRowHeight<n||e<n)&&(n+=1,this.instance.wtViewport.oversizedRows[r]=n)}}},{key:"markOversizedColumnHeaders",value:function(){var t=this.wot.getOverlayName();if(this.columnHeaderCount&&!this.wot.wtViewport.hasOversizedColumnHeadersMarked[t]&&!this.wtTable.isWorkingOnClone()){for(var e=this.wtTable.getRenderedColumnsCount(),n=0;n<this.columnHeaderCount;n++)for(var r=-1*this.rowHeaderCount;r<e;r++)this.markIfOversizedColumnHeader(r);this.wot.wtViewport.hasOversizedColumnHeadersMarked[t]=!0}}},{key:"adjustColumnHeaderHeights",value:function(){for(var t=this.wot.getSetting("columnHeaders"),e=this.wot.wtTable.THEAD.childNodes,n=this.wot.wtViewport.oversizedColumnHeaders,r=0,i=t.length;r<i;r++)if(n[r]){if(!e[r]||0===e[r].childNodes.length)return;e[r].childNodes[0].style.height=n[r]+"px"}}},{key:"markIfOversizedColumnHeader",value:function(t){for(var e=this.wot.wtTable.columnFilter.renderedToSource(t),n=this.columnHeaderCount,r=this.wot.wtSettings.settings.defaultRowHeight,i=void 0,o=void 0,a=void 0,s=this.wot.getSetting("columnHeaderHeight")||[];n;)n-=1,i=this.wot.wtTable.getColumnHeaderHeight(n),(o=this.wot.wtTable.getColumnHeader(e,n))&&(a=(0,y.innerHeight)(o),(!i&&r<a||i<a)&&(this.wot.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(s)?null!=s[n]&&(this.wot.wtViewport.oversizedColumnHeaders[n]=s[n]):isNaN(s)||(this.wot.wtViewport.oversizedColumnHeaders[n]=s),this.wot.wtViewport.oversizedColumnHeaders[n]<(s[n]||s)&&(this.wot.wtViewport.oversizedColumnHeaders[n]=s[n]||s))}},{key:"renderCells",value:function(t,e,n){for(var r=void 0,i=void 0,o=0;o<n;o++)i=this.columnFilter.renderedToSource(o),"TH"===(r=0===o?e.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)]:r.nextSibling).nodeName&&(r=v(r,e)),(0,y.hasClass)(r,"hide")||(r.className=""),r.removeAttribute("style"),this.wot.wtSettings.settings.cellRenderer(t,i,r);return r}},{key:"adjustColumnWidths",value:function(t){var e=0,n=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,r=this.wot.getSetting("defaultColumnWidth"),i=this.wot.getSetting("rowHeaderWidth");if(n.offsetHeight<n.scrollHeight&&(e=(0,y.getScrollbarWidth)()),this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-e),null!=(i=this.instance.getSetting("onModifyRowHeaderWidth",i)))for(var o=0;o<this.rowHeaderCount;o++){var a=Array.isArray(i)?i[o]:i;a=null==a?r:a,this.COLGROUP.childNodes[o].style.width=a+"px"}for(var s=0;s<t;s++){var l=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(s));this.COLGROUP.childNodes[s+this.rowHeaderCount].style.width=l+"px"}}},{key:"appendToTbody",value:function(t){this.TBODY.appendChild(t),this.wtTable.tbodyChildrenLength+=1}},{key:"getOrCreateTrForRow",value:function(t,e){var n=void 0;return t>=this.wtTable.tbodyChildrenLength?(n=this.createRow(),this.appendToTbody(n)):n=0===t?this.TBODY.firstChild:e.nextSibling,n.className&&n.removeAttribute("class"),n}},{key:"createRow",value:function(){for(var t=document.createElement("TR"),e=0;e<this.rowHeaderCount;e++)t.appendChild(document.createElement("TH"));return t}},{key:"renderRowHeader",value:function(t,e,n){n.className="",n.removeAttribute("style"),this.rowHeaders[e](t,n,e)}},{key:"renderRowHeaders",value:function(t,e){for(var n=e.firstChild,r=0;r<this.rowHeaderCount;r++)n?"TD"===n.nodeName&&(n=g(n,e)):(n=document.createElement("TH"),e.appendChild(n)),this.renderRowHeader(t,r,n),n=n.nextSibling}},{key:"adjustAvailableNodes",value:function(){this.adjustColGroups(),this.adjustThead()}},{key:"renderColumnHeaders",value:function(){if(this.columnHeaderCount)for(var t=this.wtTable.getRenderedColumnsCount(),e=0;e<this.columnHeaderCount;e++)for(var n=this.getTrForColumnHeaders(e),r=-1*this.rowHeaderCount;r<t;r++){var i=this.columnFilter.renderedToSource(r);this.renderColumnHeader(e,i,n.childNodes[r+this.rowHeaderCount])}}},{key:"adjustColGroups",value:function(){for(var t=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<t+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength+=1;for(;this.wtTable.colgroupChildrenLength>t+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength-=1;this.rowHeaderCount&&(0,y.addClass)(this.COLGROUP.childNodes[0],"rowHeader")}},{key:"adjustThead",value:function(){var t=this.wtTable.getRenderedColumnsCount(),e=this.THEAD.firstChild;if(this.columnHeaders.length){for(var n=0,r=this.columnHeaders.length;n<r;n++){for((e=this.THEAD.childNodes[n])||(e=document.createElement("TR"),this.THEAD.appendChild(e)),this.theadChildrenLength=e.childNodes.length;this.theadChildrenLength<t+this.rowHeaderCount;)e.appendChild(document.createElement("TH")),this.theadChildrenLength+=1;for(;this.theadChildrenLength>t+this.rowHeaderCount;)e.removeChild(e.lastChild),this.theadChildrenLength-=1}var i=this.THEAD.childNodes.length;if(i>this.columnHeaders.length)for(var o=this.columnHeaders.length;o<i;o++)this.THEAD.removeChild(this.THEAD.lastChild)}else e&&(0,y.empty)(e)}},{key:"getTrForColumnHeaders",value:function(t){return this.THEAD.childNodes[t]}},{key:"renderColumnHeader",value:function(t,e,n){return n.className="",n.removeAttribute("style"),this.columnHeaders[t](e,n,t)}},{key:"adjustColumns",value:function(t,e){for(var n=t.childNodes.length;n<e;){var r=document.createElement("TD");t.appendChild(r),n+=1}for(;e<n;)t.removeChild(t.lastChild),n-=1}},{key:"removeRedundantColumns",value:function(t){for(;this.wtTable.tbodyChildrenLength>t;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength-=1}}]),p);function p(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),this.wtTable=t,this.wot=t.instance,this.instance=t.instance,this.rowFilter=t.rowFilter,this.columnFilter=t.columnFilter,this.TABLE=t.TABLE,this.THEAD=t.THEAD,this.TBODY=t.TBODY,this.COLGROUP=t.COLGROUP,this.rowHeaders=[],this.rowHeaderCount=0,this.columnHeaders=[],this.columnHeaderCount=0,this.fixedRowsTop=0,this.fixedRowsBottom=0}function g(t,e){var n=document.createElement("TH");return e.insertBefore(n,t),e.removeChild(t),n}function v(t,e){var n=document.createElement("TD");return e.insertBefore(n,t),e.removeChild(t),n}e.default=f},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=n(2),o=n(1),a=l(n(8)),s=l(n(194)),c=l(n(195));function l(t){return t&&t.__esModule?t:{default:t}}var u=(r(d,[{key:"getWorkspaceHeight",value:function(){var t=this.instance.wtOverlays.topOverlay.trimmingContainer;return t===window?document.documentElement.clientHeight:0<(0,h.outerHeight)(t)&&0<t.clientHeight?t.clientHeight:1/0}},{key:"getWorkspaceWidth",value:function(){var t=void 0,e=this.wot.getSetting("totalColumns"),n=this.instance.wtOverlays.leftOverlay.trimmingContainer,r=void 0,i=this.wot.getSetting("stretchH"),o=document.documentElement.offsetWidth;return this.wot.getSetting("preventOverflow")?(0,h.outerWidth)(this.instance.wtTable.wtRootElement):(t=this.wot.getSetting("freezeOverlays")?Math.min(o-this.getWorkspaceOffset().left,o):Math.min(this.getContainerFillWidth(),o-this.getWorkspaceOffset().left,o),n===window&&0<e&&this.sumColumnWidths(0,e-1)>t?document.documentElement.clientWidth:n===window||"scroll"!==(r=(0,h.getStyle)(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"))&&"hidden"!==r&&"auto"!==r?"none"!==i&&i?t:Math.max(t,(0,h.outerWidth)(this.instance.wtTable.TABLE)):Math.max(t,n.clientWidth))}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(t,e){for(var n=this.wot.wtTable,r=0,i=t;i<e;)r+=n.getColumnWidth(i),i+=1;return r}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var t=this.instance.wtTable.holder,e=document.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);var n=e.offsetWidth;return this.containerWidth=n,t.removeChild(e),n}},{key:"getWorkspaceOffset",value:function(){return(0,h.offset)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return(0,h.outerHeight)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){return(0,h.outerWidth)(this.wot.wtTable.TABLE)||(0,h.outerWidth)(this.wot.wtTable.TBODY)||(0,h.outerWidth)(this.wot.wtTable.THEAD)}},{key:"getColumnHeaderHeight",value:function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,h.outerHeight)(this.wot.wtTable.THEAD)),this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var t=this.getWorkspaceHeight();if(t===1/0)return t;var e=this.getColumnHeaderHeight();return 0<e&&(t-=e),t}},{key:"getRowHeaderWidth",value:function(){var t=this.instance.getSetting("rowHeaderWidth"),e=this.instance.getSetting("rowHeaders");if(t)for(var n=this.rowHeaderWidth=0,r=e.length;n<r;n++)this.rowHeaderWidth+=t[n]||t;if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(e.length)for(var i=this.instance.wtTable.TABLE.querySelector("TH"),o=this.rowHeaderWidth=0,a=e.length;o<a;o++)i?(this.rowHeaderWidth+=(0,h.outerWidth)(i),i=i.nextSibling):this.rowHeaderWidth+=50;else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var t=this.getWorkspaceWidth();if(t===1/0)return t;var e=this.getRowHeaderWidth();return 0<e?t-e:t}},{key:"createRowsCalculator",value:function(t){var e=this,n=0<arguments.length&&void 0!==t&&t,r=void 0,i=void 0,o=void 0;this.rowHeaderWidth=NaN,r=this.wot.wtSettings.settings.renderAllRows&&!n?1/0:this.getViewportHeight();var a=this.wot.wtOverlays.topOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset();a<0&&(a=0);var s=this.wot.getSetting("fixedRowsTop"),l=this.wot.getSetting("fixedRowsBottom"),u=this.wot.getSetting("totalRows");return s&&(a+=o=this.wot.wtOverlays.topOverlay.sumCellSizes(0,s),r-=o),l&&this.wot.wtOverlays.bottomOverlay.clone&&(r-=o=this.wot.wtOverlays.bottomOverlay.sumCellSizes(u-l,u)),i=this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight?0:(0,h.getScrollbarWidth)(),new c.default(r,a,this.wot.getSetting("totalRows"),function(t){return e.wot.wtTable.getRowHeight(t)},n?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,n,i)}},{key:"createColumnsCalculator",value:function(t){var n=this,e=0<arguments.length&&void 0!==t&&t,r=this.getViewportWidth(),i=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.leftOverlay.getTableParentOffset();this.columnHeaderHeight=NaN,i<0&&(i=0);var o=this.wot.getSetting("fixedColumnsLeft");if(o){var a=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,o);i+=a,r-=a}return this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(r-=(0,h.getScrollbarWidth)()),new s.default(r,i,this.wot.getSetting("totalColumns"),function(t){return n.wot.wtTable.getColumnWidth(t)},e?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,e,this.wot.getSetting("stretchH"),function(t,e){return n.wot.getSetting("onBeforeStretchingColumnWidth",t,e)})}},{key:"createRenderCalculators",value:function(t){var e=0<arguments.length&&void 0!==t&&t;if(e){var n=this.createRowsCalculator(!0),r=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(r)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0),this.columnsVisibleCalculator=this.createColumnsCalculator(!0)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(t){return!(!this.rowsVisibleCalculator||t.startRow<this.rowsRenderCalculator.startRow||t.startRow===this.rowsRenderCalculator.startRow&&0<t.startRow||t.endRow>this.rowsRenderCalculator.endRow||t.endRow===this.rowsRenderCalculator.endRow&&t.endRow<this.wot.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(t){return!(!this.columnsVisibleCalculator||t.startColumn<this.columnsRenderCalculator.startColumn||t.startColumn===this.columnsRenderCalculator.startColumn&&0<t.startColumn||t.endColumn>this.columnsRenderCalculator.endColumn||t.endColumn===this.columnsRenderCalculator.endColumn&&t.endColumn<this.wot.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){(0,o.objectEach)(this.hasOversizedColumnHeadersMarked,function(t,e,n){n[e]=void 0})}}]),d);function d(t){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),this.wot=t,this.instance=this.wot,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new a.default(this.wot),this.eventManager.addEventListener(window,"resize",function(){e.clientHeight=e.getWorkspaceHeight()})}e.default=u},function(t,e,n){"use strict";e.__esModule=!0;var W=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var U=n(2),o=n(12),a=n(1),z=n(42),s=l(n(8)),G=l(n(65));function l(t){return t&&t.__esModule?t:{default:t}}var u=(r(h,[{key:"registerListeners",value:function(){var n=this;this.eventManager.addEventListener(document.body,"mousedown",function(){return n.onMouseDown()}),this.eventManager.addEventListener(document.body,"mouseup",function(){return n.onMouseUp()});for(var t=function(e){n.eventManager.addEventListener(n.main.childNodes[e],"mouseenter",function(t){return n.onMouseEnter(t,n.main.childNodes[e])})},e=0,r=this.main.childNodes.length;e<r;e++)t(e)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(t,n){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){t.preventDefault(),(0,o.stopImmediatePropagation)(t);var r=this,i=n.getBoundingClientRect();n.style.display="none",this.eventManager.addEventListener(document.body,"mousemove",function t(e){!function(t){return t.clientY<Math.floor(i.top)||t.clientY>Math.ceil(i.top+i.height)||t.clientX<Math.floor(i.left)||t.clientX>Math.ceil(i.left+i.width)}(e)||(r.eventManager.removeEventListener(document.body,"mousemove",t),n.style.display="block")})}}},{key:"createBorders",value:function(t){this.main=document.createElement("div");var e=["top","left","bottom","right","corner"],n=this.main.style;n.position="absolute",n.top=0;for(var r=n.left=0;r<5;r++){var i=e[r],o=document.createElement("div");o.className="wtBorder "+(this.settings.className||""),this.settings[i]&&this.settings[i].hide&&(o.className+=" hidden"),(n=o.style).backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:t.border.color,n.height=this.settings[i]&&this.settings[i].width?this.settings[i].width+"px":t.border.width+"px",n.width=this.settings[i]&&this.settings[i].width?this.settings[i].width+"px":t.border.width+"px",this.main.appendChild(o)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,z.isMobileBrowser)()&&this.createMultipleSelectorHandles(),this.disappear();var a=this.wot.wtTable.bordersHolder;a||((a=document.createElement("div")).className="htBorders",this.wot.wtTable.bordersHolder=a,this.wot.wtTable.spreader.appendChild(a)),a.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var n=this;this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")},this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var t={position:"absolute",height:"40px",width:"40px","border-radius":parseInt(40/1.5,10)+"px"};(0,a.objectEach)(t,function(t,e){n.selectionHandles.styles.bottomRightHitArea[e]=t,n.selectionHandles.styles.topLeftHitArea[e]=t});var e={position:"absolute",height:"10px",width:"10px","border-radius":parseInt(10/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};(0,a.objectEach)(e,function(t,e){n.selectionHandles.styles.bottomRight[e]=t,n.selectionHandles.styles.topLeft[e]=t}),this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(t,e){var n=this.wot.selections.createOrGetArea();return!(!n.cellRange||t===n.cellRange.to.row&&e===n.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(t,e,n,r,i,o){var a=parseInt(this.selectionHandles.styles.topLeft.width,10),s=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(n-a,10)+"px",this.selectionHandles.styles.topLeft.left=parseInt(r-a,10)+"px",this.selectionHandles.styles.topLeftHitArea.top=parseInt(n-s/4*3,10)+"px",this.selectionHandles.styles.topLeftHitArea.left=parseInt(r-s/4*3,10)+"px",this.selectionHandles.styles.bottomRight.top=parseInt(n+o,10)+"px",this.selectionHandles.styles.bottomRight.left=parseInt(r+i,10)+"px",this.selectionHandles.styles.bottomRightHitArea.top=parseInt(n+o-s/4,10)+"px",this.selectionHandles.styles.bottomRightHitArea.left=parseInt(r+i-s/4,10)+"px",this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(t,e)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(t){if(!this.disabled){for(var e=void 0,n=void 0,r=void 0,i=void 0,o=this.wot.wtTable.getRenderedRowsCount(),a=0;a<o;a+=1){var s=this.wot.wtTable.rowFilter.renderedToSource(a);if(s>=t[0]&&s<=t[2]){e=s;break}}for(var l=o-1;0<=l;l-=1){var u=this.wot.wtTable.rowFilter.renderedToSource(l);if(u>=t[0]&&u<=t[2]){n=u;break}}for(var h=this.wot.wtTable.getRenderedColumnsCount(),c=0;c<h;c+=1){var d=this.wot.wtTable.columnFilter.renderedToSource(c);if(d>=t[1]&&d<=t[3]){r=d;break}}for(var f=h-1;0<=f;f-=1){var p=this.wot.wtTable.columnFilter.renderedToSource(f);if(p>=t[1]&&p<=t[3]){i=p;break}}if(void 0!==e&&void 0!==r){var g=this.wot.wtTable.getCell(new G.default(e,r)),v=e!==n||r!==i,m=v?this.wot.wtTable.getCell(new G.default(n,i)):g,y=(0,U.offset)(g),w=v?(0,U.offset)(m):y,b=(0,U.offset)(this.wot.wtTable.TABLE),C=y.top,E=y.left,S=E-b.left-1,O=w.left+(0,U.outerWidth)(m)-E;if(this.isEntireColumnSelected(e,n)){var T=this.getDimensionsFromHeader("columns",r,i,b),N=null;if(T){var R=W(T,3);N=R[0],S=R[1],O=R[2]}N&&(g=N)}var _=C-b.top-1,M=w.top+(0,U.outerHeight)(m)-C;if(this.isEntireRowSelected(r,i)){var A=this.getDimensionsFromHeader("rows",e,n,b),k=null;if(A){var x=W(A,3);k=x[0],_=x[1],M=x[2]}k&&(g=k)}var I=(0,U.getComputedStyle)(g);0<parseInt(I.borderTopWidth,10)&&(_+=1,M=0<M?M-1:0),0<parseInt(I.borderLeftWidth,10)&&(S+=1,O=0<O?O-1:0),this.topStyle.top=_+"px",this.topStyle.left=S+"px",this.topStyle.width=O+"px",this.topStyle.display="block",this.leftStyle.top=_+"px",this.leftStyle.left=S+"px",this.leftStyle.height=M+"px",this.leftStyle.display="block";var D=Math.floor(this.settings.border.width/2);this.bottomStyle.top=_+M-D+"px",this.bottomStyle.left=S+"px",this.bottomStyle.width=O+"px",this.bottomStyle.display="block",this.rightStyle.top=_+"px",this.rightStyle.left=S+O-D+"px",this.rightStyle.height=M+1+"px",this.rightStyle.display="block";var L=this.settings.border.cornerVisible;L="function"==typeof L?L(this.settings.layerLevel):L;var P=this.wot.getSetting("onModifyGetCellCoords",n,i),H=n,B=i;if(P&&Array.isArray(P)){var F=W(P,4);H=F[2],B=F[3]}if((0,z.isMobileBrowser)()||!L||this.isPartRange(H,B))this.cornerStyle.display="none";else{this.cornerStyle.top=_+M-4+"px",this.cornerStyle.left=S+O-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var V=(0,U.getTrimmingContainer)(this.wot.wtTable.TABLE),j=V===window;j&&(V=document.documentElement),i!==this.wot.getSetting("totalColumns")-1||(j?m.getBoundingClientRect().left:m.offsetLeft)+(0,U.outerWidth)(m)+parseInt(this.cornerDefaultStyle.width,10)/2>=(0,U.innerWidth)(V)&&(this.cornerStyle.left=Math.floor(S+O-3-parseInt(this.cornerDefaultStyle.width,10)/2)+"px",this.cornerStyle.borderRightWidth=0),n===this.wot.getSetting("totalRows")-1&&(j?m.getBoundingClientRect().top:m.offsetTop)+(0,U.outerHeight)(m)+parseInt(this.cornerDefaultStyle.height,10)/2>=(0,U.innerHeight)(V)&&(this.cornerStyle.top=Math.floor(_+M-3-parseInt(this.cornerDefaultStyle.height,10)/2)+"px",this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}(0,z.isMobileBrowser)()&&this.updateMultipleSelectionHandlesPosition(n,i,_,S,O,M)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(t,e,n,r){var i=this,o=this.wot.wtTable.wtRootElement.parentNode,a=null,s=null,l=null,u=null,h=null,c=null,d=null,f=null;switch(t){case"rows":a=function(){var t;return(t=i.wot.wtTable).getRowHeader.apply(t,arguments)},s=function(){return U.outerHeight.apply(void 0,arguments)},l="ht__selection--rows",c="top";break;case"columns":a=function(){var t;return(t=i.wot.wtTable).getColumnHeader.apply(t,arguments)},s=function(){return U.outerWidth.apply(void 0,arguments)},l="ht__selection--columns",c="left"}if(o.className.includes(l)){var p=this.wot.getSetting("columnHeaders").length;if(d=a(e,p-1),f=a(n,p-1),!d||!f)return!1;var g=(0,U.offset)(d),v=(0,U.offset)(f);return d&&f&&(u=g[c]-r[c]-1,h=v[c]+s(f)-g[c]),[d,u,h]}return!1}},{key:"changeBorderStyle",value:function(t,e){var n=this[t].style,r=e[t];!r||r.hide?(0,U.addClass)(this[t],"hidden"):((0,U.hasClass)(this[t],"hidden")&&(0,U.removeClass)(this[t],"hidden"),n.backgroundColor=r.color,"top"!==t&&"bottom"!==t||(n.height=r.width+"px"),"right"!==t&&"left"!==t||(n.width=r.width+"px"))}},{key:"changeBorderToDefaultStyle",value:function(t){var e=1,n="#000",r=this[t].style;r.backgroundColor=n,r.width=e+"px",r.height=e+"px"}},{key:"toggleHiddenClass",value:function(t,e){this.changeBorderToDefaultStyle(t),e?(0,U.addClass)(this[t],"hidden"):(0,U.removeClass)(this[t],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",(0,z.isMobileBrowser)()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}}]),h);function h(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),e&&(this.eventManager=new s.default(t),this.instance=t,this.wot=t,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners())}e.default=u},function(t,e,n){"use strict";e.__esModule=!0;var r,i=n(18),d=n(10),c=n(31),f=n(0),p=n(2),o=n(209),a=(r=o)&&r.__esModule?r:{default:r};var g=a.default.prototype.extend();g.prototype.init=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];a.default.prototype.init.apply(this,e),this.query=null,this.strippedChoices=[],this.rawChoices=[]},g.prototype.getValue=function(){var e=this,t=this.rawChoices.find(function(t){return e.stripValueIfNeeded(t)===e.TEXTAREA.value});return(0,d.isDefined)(t)?t:this.TEXTAREA.value};g.prototype.createElements=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];a.default.prototype.createElements.apply(this,e),(0,p.addClass)(this.htContainer,"autocompleteEditor"),(0,p.addClass)(this.htContainer,-1===window.navigator.platform.indexOf("Mac")?"":"htMacScroll")};function s(t){!1;var e=this.getActiveEditor();if((0,i.isPrintableChar)(t.keyCode)||t.keyCode===i.KEY_CODES.BACKSPACE||t.keyCode===i.KEY_CODES.DELETE||t.keyCode===i.KEY_CODES.INSERT){var n=0;if(t.keyCode===i.KEY_CODES.C&&(t.ctrlKey||t.metaKey))return;e.isOpened()||(n+=10),e.htEditor&&e.instance._registerTimeout(function(){e.queryChoices(e.TEXTAREA.value),!0},n)}}g.prototype.prepare=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];a.default.prototype.prepare.apply(this,e)},g.prototype.open=function(){this.instance.addHook("beforeKeyDown",s),this.TEXTAREA_PARENT.style.overflow="auto";for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];a.default.prototype.open.apply(this,e),this.TEXTAREA_PARENT.style.overflow="";var r=this.htEditor.getInstance(),c=this,i=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus(),r.updateSettings({colWidths:i?[(0,p.outerWidth)(this.TEXTAREA)-2]:void 0,width:i?(0,p.outerWidth)(this.TEXTAREA)+(0,p.getScrollbarWidth)()+2:void 0,afterRenderer:function(t,e,n,r,i){var o=c.cellProperties,a=o.filteringCaseSensitive,s=o.allowHtml,l=(0,d.stringify)(i),u=void 0,h=void 0;l&&!s&&-1!==(u=!0===a?l.indexOf(this.query):l.toLowerCase().indexOf(c.query.toLowerCase()))&&(h=l.substr(u,c.query.length),l=l.replace(h,"<strong>"+h+"</strong>")),t.innerHTML=l},autoColumnSize:!0,modifyColWidth:function(t,e){var n=this.getPlugin("autoColumnSize").widths,r=t;return n[e]&&(r=n[e]),i?r:r+15}}),this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=(0,p.getScrollbarWidth)()+2+"px",!1,c.instance._registerTimeout(function(){c.queryChoices(c.TEXTAREA.value)})},g.prototype.queryChoices=function(t){var e=this;this.query=t;var n=this.cellProperties.source;"function"==typeof n?n.call(this.cellProperties,t,function(t){e.rawChoices=t,e.updateChoicesList(e.stripValuesIfNeeded(t))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])},g.prototype.updateChoicesList=function(t){var e=(0,p.getCaretPosition)(this.TEXTAREA),n=(0,p.getSelectionEndPosition)(this.TEXTAREA),r=this.cellProperties.sortByRelevance,i=this.cellProperties.filter,o=null,a=null,s=t;r&&(o=g.sortByRelevance(this.stripValueIfNeeded(this.getValue()),s,this.cellProperties.filteringCaseSensitive));var l=Array.isArray(o)?o.length:0;if(!1===i)l&&(a=o[0]);else{for(var u=[],h=0,c=s.length;h<c&&!(r&&l<=h);h++)l?u.push(s[o[h]]):u.push(s[h]);a=0,s=u}this.strippedChoices=s,this.htEditor.loadData((0,f.pivot)([s])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(a),this.instance.listen(!1),(0,p.setCaretPosition)(this.TEXTAREA,e,e===n?void 0:n)},g.prototype.flipDropdownIfNeeded=function(){var t=(0,p.offset)(this.TEXTAREA),e=(0,p.outerHeight)(this.TEXTAREA),n=this.getDropdownHeight(),r=(0,p.getTrimmingContainer)(this.instance.view.wt.wtTable.TABLE),i=r.scrollTop,o=(0,p.outerHeight)(this.instance.view.wt.wtTable.THEAD),a={row:0,col:0};r!==window&&(a=(0,p.offset)(r));var s=t.top-a.top-o+i,l=r.scrollHeight-s-o-e,u=l<n&&l<s;return u?this.flipDropdown(n):this.unflipDropdown(),this.limitDropdownIfNeeded(u?s:l,n),u},g.prototype.limitDropdownIfNeeded=function(t,e){if(t<e){for(var n,r=0,i=0,o=0;r+=o=this.htEditor.getRowHeight(i)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,i+=1,r<t;);n=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+e-n+"px"),this.setDropdownHeight(r-o)}},g.prototype.flipDropdown=function(t){var e=this.htEditor.rootElement.style;e.position="absolute",e.top=-t+"px",this.htEditor.flipped=!0},g.prototype.unflipDropdown=function(){var t=this.htEditor.rootElement.style;"absolute"===t.position&&(t.position="",t.top=""),this.htEditor.flipped=void 0},g.prototype.updateDropdownHeight=function(){var t=this.htEditor.getColWidth(0)+(0,p.getScrollbarWidth)()+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()},g.prototype.setDropdownHeight=function(t){this.htEditor.updateSettings({height:t})},g.prototype.finishEditing=function(t){for(var e=arguments.length,n=Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];a.default.prototype.finishEditing.apply(this,[t].concat(n))},g.prototype.highlightBestMatchingChoice=function(t){"number"==typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()},g.sortByRelevance=function(t,e,n){var r=[],i=void 0,o=t.length,a=void 0,s=void 0,l=[],u=void 0,h=e.length;if(0===o){for(u=0;u<h;u++)l.push(u);return l}for(u=0;u<h;u++)i=(0,c.stripTags)((0,d.stringify)(e[u])),-1!==(a=n?i.indexOf(t):i.toLowerCase().indexOf(t.toLowerCase()))&&(s=i.length-a-o,r.push({baseIndex:u,index:a,charsLeft:s,value:i}));for(r.sort(function(t,e){if(-1===e.index)return-1;if(-1===t.index)return 1;if(t.index<e.index)return-1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0}),u=0,h=r.length;u<h;u++)l.push(r[u].baseIndex);return l},g.prototype.getDropdownHeight=function(){var t=this.htEditor.getInstance().getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8},g.prototype.stripValueIfNeeded=function(t){return this.stripValuesIfNeeded([t])[0]},g.prototype.stripValuesIfNeeded=function(t){var e=this.cellProperties.allowHtml,n=(0,f.arrayMap)(t,function(t){return(0,d.stringify)(t)});return(0,f.arrayMap)(n,function(t){return e?t:(0,c.stripTags)(t)})},g.prototype.allowKeyEventPropagation=function(t){var e=this.htEditor.getSelectedRangeLast(),n=e?e.from.row:-1,r=!1;return t===i.KEY_CODES.ARROW_DOWN&&0<n&&n<this.htEditor.countRows()-1&&(r=!0),t===i.KEY_CODES.ARROW_UP&&-1<n&&(r=!0),r},g.prototype.close=function(){this.instance.removeHook("beforeKeyDown",s);for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];a.default.prototype.close.apply(this,e)},g.prototype.discardEditor=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];a.default.prototype.discardEditor.apply(this,e),this.instance.view.render()},e.default=g},function(t,e,n){"use strict";e.__esModule=!0;var r,a=n(18),c=n(1),i=n(2),s=n(12),o=n(66),d=(r=o)&&r.__esModule?r:{default:r};var l=d.default.prototype.extend();l.prototype.createElements=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];d.default.prototype.createElements.apply(this,e);var r=document.createElement("DIV");r.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(r),this.htContainer=r,this.assignHooks()},l.prototype.prepare=function(t,e,n,r,i,o){for(var a=arguments.length,s=Array(6<a?a-6:0),l=6;l<a;l++)s[l-6]=arguments[l];d.default.prototype.prepare.apply(this,[t,e,n,r,i,o].concat(s));var u=this,h={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(t,e){var n=this.getSourceData(e.row,e.col);void 0!==n&&u.setValue(n),u.instance.destroyEditor()}};this.cellProperties.handsontable&&(0,c.extend)(h,o.handsontable),this.htOptions=h};function u(t){if(!(0,s.isImmediatePropagationStopped)(t)){var e=this.getActiveEditor(),n=e.htEditor.getInstance(),r=void 0,i=void 0;if(t.keyCode===a.KEY_CODES.ARROW_DOWN)if(n.getSelectedLast()||n.flipped){if(n.getSelectedLast())if(n.flipped)r=n.getSelectedLast()[0]+1;else if(!n.flipped){var o=n.countRows()-1;i=n.getSelectedLast()[0],r=Math.min(o,i+1)}}else r=0;else t.keyCode===a.KEY_CODES.ARROW_UP&&(!n.getSelectedLast()&&n.flipped?r=n.countRows()-1:n.getSelectedLast()&&(r=n.flipped?(i=n.getSelectedLast()[0],Math.max(0,i-1)):(i=n.getSelectedLast()[0])-1));void 0!==r&&(r<0||n.flipped&&r>n.countRows()-1?n.deselectCell():n.selectCell(r,0),n.getData().length&&(t.preventDefault(),(0,s.stopImmediatePropagation)(t),e.instance.listen(),e.TEXTAREA.focus()))}}l.prototype.open=function(){this.instance.addHook("beforeKeyDown",u);for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];d.default.prototype.open.apply(this,e),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.instance.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),(0,i.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length)},l.prototype.close=function(){this.htEditor.rootElement.style.display="none",this.instance.removeHook("beforeKeyDown",u);for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];d.default.prototype.close.apply(this,e)},l.prototype.focus=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];d.default.prototype.focus.apply(this,e)},l.prototype.beginEditing=function(){var t=this.instance.getSettings().onBeginEditing;if(!t||!1!==t()){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];d.default.prototype.beginEditing.apply(this,n)}},l.prototype.finishEditing=function(){if(this.htEditor&&this.htEditor.isListening()&&this.instance.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var t=this.htEditor.getInstance().getValue();void 0!==t&&this.setValue(t)}for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return d.default.prototype.finishEditing.apply(this,n)},l.prototype.assignHooks=function(){var t=this;this.instance.addHook("afterDestroy",function(){t.htEditor&&t.htEditor.destroy()})},e.default=l},function(t,e,n){"use strict";e.__esModule=!0,e.getNormalizedDate=function(t){var e=new Date(t);return isNaN(new Date(t+"T00:00").getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}},function(t,e,n){"use strict";function h(t){return t.split('"').length-1}var r;window,r={parse:function(t){var e,n,r,i,o,a,s,l=[],u=0;for(1<(r=t.split("\n")).length&&""===r[r.length-1]&&r.pop(),e=0,n=r.length;e<n;e+=1){for(r[e]=r[e].split("\t"),i=0,o=r[e].length;i<o;i+=1)l[u]||(l[u]=[]),a&&0===i?(s=l[u].length-1,l[u][s]=l[u][s]+"\n"+r[e][0],a&&1&h(r[e][0])&&(a=!1,l[u][s]=l[u][s].substring(0,l[u][s].length-1).replace(/""/g,'"'))):a=i===o-1&&0===r[e][i].indexOf('"')&&1&h(r[e][i])?(l[u].push(r[e][i].substring(1).replace(/""/g,'"')),!0):(l[u].push(r[e][i].replace(/""/g,'"')),!1);a||(u+=1)}return l},stringify:function(t){var e,n,r,i,o,a="";for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)0<r&&(a+="\t"),"string"==typeof(o=t[e][r])?-1<o.indexOf("\n")?a+='"'+o.replace(/"/g,'""')+'"':a+=o:a+=null==o?"":o;e!==n-1&&(a+="\n")}return a}},e.parse=r.parse,e.stringify=r.stringify},function(t,e,n){"use strict";e.__esModule=!0,e.mouseDown=r,e.mouseOver=i,e.handleMouseEvent=function(t,e){var n=e.coords,r=e.selection,i=e.controller;a.get(t.type)({coords:n,selection:r,controller:i,isShiftKey:t.shiftKey,isLeftClick:(0,o.isLeftClick)(t)||"touchstart"===t.type,isRightClick:(0,o.isRightClick)(t)})};var o=n(12),f=n(9);function r(t){var e=t.isShiftKey,n=t.isLeftClick,r=t.isRightClick,i=t.coords,o=t.selection,a=t.controller,s=o.isSelected()?o.getSelectedRange().current():null,l=o.isSelectedByCorner(),u=o.isSelectedByRowHeader();if(e&&s)0<=i.row&&0<=i.col&&!a.cells?o.setRangeEnd(i):(l||u)&&0<=i.row&&0<=i.col&&!a.cells?o.setRangeEnd(new f.CellCoords(i.row,i.col)):l&&i.row<0&&!a.column?o.setRangeEnd(new f.CellCoords(s.to.row,i.col)):u&&i.col<0&&!a.row?o.setRangeEnd(new f.CellCoords(i.row,s.to.col)):(!l&&!u&&i.col<0||l&&i.col<0)&&!a.row?o.selectRows(s.from.row,i.row):(!l&&!u&&i.row<0||u&&i.row<0)&&!a.column&&o.selectColumns(s.from.col,i.col);else{var h=new f.CellCoords(i.row,i.col);h.row<0&&(h.row=0),h.col<0&&(h.col=0);var c=!o.inInSelection(h),d=n||r&&c;i.row<0&&0<=i.col&&!a.column?d&&o.selectColumns(i.col):i.col<0&&0<=i.row&&!a.row?d&&o.selectRows(i.row):0<=i.col&&0<=i.row&&!a.cells?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.setRangeStart(i)}}function i(t){var e=t.isLeftClick,n=t.coords,r=t.selection,i=t.controller;if(e){var o=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),s=r.tableProps.countCols(),l=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(new f.CellCoords(l-1,n.col)):o&&!i.row?r.setRangeEnd(new f.CellCoords(n.row,s-1)):i.cell||r.setRangeEnd(n)}}var a=new Map([["mousedown",r],["mouseover",i],["touchstart",r]])},function(t,e,n){"use strict";e.__esModule=!0,e.registerAsRootInstance=function(t){r.set(t,!0)},e.hasValidParameter=function(t){return t===i},e.isRootInstance=function(t){return r.has(t)};var r=e.holder=new WeakMap,i=e.rootInstanceSymbol=Symbol("rootInstance")},function(t,e,n){"use strict";e.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=n(10),s=n(1);function r(){}r.prototype={licenseKey:"trial",data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,selectionMode:"multiple",fillHandle:{autoInsertRow:!1},fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!0,autoWrapCol:!0,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",activeHeaderClassName:"ht__active_highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(t){var e,n=void 0,r=void 0,i=void 0;for(n=0,e=this.countCols();n<e;n++)if(""!==(r=this.getDataAtCell(t,n))&&null!==r&&(0,a.isDefined)(r))return"object"===(void 0===r?"undefined":o(r))&&(i=this.getCellMeta(t,n),(0,s.isObjectEqual)(this.getSchema()[i.prop],r));return!0},isEmptyCol:function(t){var e,n=void 0,r=void 0;for(n=0,e=this.countRows();n<e;n++)if(""!==(r=this.getDataAtCell(n,t))&&null!==r&&(0,a.isDefined)(r))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:void 0,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,visibleRows:10,trimDropdown:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,multiColumnSorting:void 0,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,manualColumnFreeze:void 0,trimWhitespace:!0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:"en-US",selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:"DD/MM/YYYY",correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1,dragToScroll:!0,nestedRows:void 0},e.default=r},function(t,e,n){"use strict";e.__esModule=!0,e.getTranslatedPhrase=function(t,e,n){var r=(0,s.getLanguageDictionary)(t);if(null===r)return null;var i=r[e];if((0,u.isUndefined)(i))return null;var o=function(e,n){var r=e;return(0,a.arrayEach)((0,l.getPhraseFormatters)(),function(t){r=t(e,n)}),r}(i,n);if(Array.isArray(o))return o[0];return o};var a=n(0),s=n(85),l=n(306),u=n(10)},function(t,e,n){"use strict";e.__esModule=!0;var r,i,o=(r=['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],i=['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(i)}})));e.extendNotExistingKeys=function(n,t){return(0,s.objectEach)(t,function(t,e){(0,a.isUndefined)(n[e])&&(n[e]=t)}),n},e.createCellHeadersRange=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:t,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:e,i=n,o=r;if(e<t){var a=[o,i];i=a[0],o=a[1]}return i+"-"+o},e.normalizeLanguageCode=c,e.applyLanguageSetting=function(t,e){var n=c(e);(0,h.hasLanguageDictionary)(n)?t.language=n:(t.language=h.DEFAULT_LANGUAGE_CODE,d(e))},e.warnUserAboutLanguageRegistration=d;var a=n(10),s=n(1),l=n(22),u=n(25),h=n(85);function c(t){var e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return e?e[1].toLowerCase()+"-"+e[2].toUpperCase():t}function d(t){(0,a.isDefined)(t)&&(0,l.error)((0,u.toSingleLine)(o,t))}},function(t,e,n){"use strict";e.__esModule=!0,e.normalizeSelectionFactory=e.detectSelectionType=e.Selection=e.Highlight=e.handleMouseEvent=void 0;var r=s(n(218)),i=s(n(315)),o=n(212),a=n(87);function s(t){return t&&t.__esModule?t:{default:t}}e.handleMouseEvent=o.handleMouseEvent,e.Highlight=r.default,e.Selection=i.default,e.detectSelectionType=a.detectSelectionType,e.normalizeSelectionFactory=a.normalizeSelectionFactory},function(t,e,n){"use strict";e.__esModule=!0,e.CUSTOM_SELECTION=e.HEADER_TYPE=e.FILL_TYPE=e.CELL_TYPE=e.AREA_TYPE=e.ACTIVE_HEADER_TYPE=void 0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(308),a=n(0);function s(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var l=e.ACTIVE_HEADER_TYPE="active-header",u=e.AREA_TYPE="area",h=e.CELL_TYPE="cell",c=e.FILL_TYPE="fill",d=e.HEADER_TYPE="header",f=e.CUSTOM_SELECTION="custom-selection",p=(r(g,[{key:"isEnabledFor",value:function(t){var e="current"===t?h:t,n=this.options.disableHighlight;return"string"==typeof n&&(n=[n]),!1===n||Array.isArray(n)&&!n.includes(e)}},{key:"useLayerLevel",value:function(t){var e=0<arguments.length&&void 0!==t?t:0;return this.layerLevel=e,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var t=this.layerLevel,e=void 0;return this.areas.has(t)?e=this.areas.get(t):(e=(0,o.createHighlight)(u,Object.assign({layerLevel:t},this.options)),this.areas.set(t,e)),e}},{key:"getAreas",value:function(){return[].concat(s(this.areas.values()))}},{key:"createOrGetHeader",value:function(){var t=this.layerLevel,e=void 0;return this.headers.has(t)?e=this.headers.get(t):(e=(0,o.createHighlight)(d,Object.assign({},this.options)),this.headers.set(t,e)),e}},{key:"getHeaders",value:function(){return[].concat(s(this.headers.values()))}},{key:"createOrGetActiveHeader",value:function(){var t=this.layerLevel,e=void 0;return this.activeHeaders.has(t)?e=this.activeHeaders.get(t):(e=(0,o.createHighlight)(l,Object.assign({},this.options)),this.activeHeaders.set(t,e)),e}},{key:"getActiveHeaders",value:function(){return[].concat(s(this.activeHeaders.values()))}},{key:"getCustomSelections",value:function(){return[].concat(s(this.customSelections.values()))}},{key:"addCustomSelection",value:function(t){this.customSelections.push((0,o.createHighlight)(f,Object.assign({},t)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),(0,a.arrayEach)(this.areas.values(),function(t){t.clear()}),(0,a.arrayEach)(this.headers.values(),function(t){t.clear()}),(0,a.arrayEach)(this.activeHeaders.values(),function(t){t.clear()})}},{key:Symbol.iterator,value:function(){return[this.cell,this.fill].concat(s(this.areas.values()),s(this.headers.values()),s(this.activeHeaders.values()),s(this.customSelections))[Symbol.iterator]()}}]),g);function g(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),this.options=t,this.layerLevel=0,this.cell=(0,o.createHighlight)(h,t),this.fill=(0,o.createHighlight)(c,t),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}e.default=p},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var f=n(1),p=n(4),g=n(10);var o=(r(a,null,[{key:"SAMPLE_COUNT",get:function(){return 3}}]),r(a,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:a.SAMPLE_COUNT}},{key:"setSampleCount",value:function(t){this.customSampleCount=t}},{key:"setAllowDuplicates",value:function(t){this.allowDuplicates=t}},{key:"generateRowSamples",value:function(t,e){return this.generateSamples("row",e,t)}},{key:"generateColumnSamples",value:function(t,e){return this.generateSamples("col",e,t)}},{key:"generateSamples",value:function(n,r,t){var i=this,o=new Map,e="number"==typeof t?{from:t,to:t}:t,a=e.from,s=e.to;return(0,p.rangeEach)(a,s,function(t){var e=i.generateSample(n,r,t);o.set(t,e)}),o}},{key:"generateSample",value:function(s,t,l){var u=this;if("row"!==s&&"col"!==s)throw new Error("Unsupported sample type");var h=new Map,c="row"===s?"col":"row",d=[];return(0,p.rangeEach)(t.from,t.to,function(t){var e="row"===s?u.dataFactory(l,t):u.dataFactory(t,l),n=e.value,r=e.bundleCountSeed,i=0<r,o=void 0;o=(0,f.isObject)(n)?Object.keys(n).length:Array.isArray(n)?n.length:(0,g.stringify)(n).length,i&&(o+=r),h.has(o)||h.set(o,{needed:u.getSampleCount(),strings:[]});var a=h.get(o);a.needed&&(-1<d.indexOf(n)&&!u.allowDuplicates&&!i||(a.strings.push(function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({value:n},c,t)),d.push(n),a.needed-=1))}),h}}]),a);function a(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}e.default=o},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=n(2),l=n(10),s=n(1),u=n(0),h=n(4),c=C(n(7)),d=n(5),f=C(n(17)),p=n(86),g=n(326),v=n(160),m=n(327),y=C(n(328)),w=n(329),b=n(51);function C(t){return t&&t.__esModule?t:{default:t}}function E(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function S(t,e){var n={};for(var r in t)0<=e.indexOf(r)||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}var O="columnSorting";(0,b.registerRootComparator)(O,w.rootComparator),f.default.getSingleton().register("beforeColumnSort"),f.default.getSingleton().register("afterColumnSort");var T=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(N,c.default),r(N,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||((0,l.isUndefined)(this.hot.getSettings().observeChanges)&&this.enableObserveChangesPlugin(),this.addHook("afterTrimRow",function(){return i.sortByPresetSortStates()}),this.addHook("afterUntrimRow",function(){return i.sortByPresetSortStates()}),this.addHook("modifyRow",function(t,e){return i.onModifyRow(t,e)}),this.addHook("unmodifyRow",function(t,e){return i.onUnmodifyRow(t,e)}),this.addHook("afterGetColHeader",function(t,e){return i.onAfterGetColHeader(t,e)}),this.addHook("beforeOnCellMouseDown",function(t,e,n,r){return i.onBeforeOnCellMouseDown(t,e,n,r)}),this.addHook("afterOnCellMouseDown",function(t,e){return i.onAfterOnCellMouseDown(t,e)}),this.addHook("afterCreateRow",function(t,e){return i.onAfterCreateRow(t,e)}),this.addHook("afterRemoveRow",function(t,e){return i.onAfterRemoveRow(t,e)}),this.addHook("afterInit",function(){return i.loadOrSortBySettings()}),this.addHook("afterLoadData",function(t){return i.onAfterLoadData(t)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol()}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol()}),this.hot.view&&this.loadOrSortBySettings(),a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){function t(t,e){var n=(0,v.getHeaderSpanElement)(e);!1!==(0,v.isFirstLevelColumnHeader)(t,e)&&null!==n&&r.updateHeaderClasses(n)}var r=this;this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterRender",function(){r.hot.removeHook("afterGetColHeader",t)}),this.rowsMapper.clearMap(),a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(t){var r=this,e=this.getSortConfig(),n=this.getNormalizedSortConfigs(t),i=this.areValidSortConfigs(n);if(!1!==this.hot.runHooks("beforeColumnSort",e,n,i)){if(i){var o=(0,u.arrayMap)(n,function(t){return function(t){var e=t.column,n=S(t,["column"]);return Object.assign({column:r.hot.toPhysicalColumn(e)},n)}(t)});this.columnStatesManager.setSortStates(o),this.sortByPresetSortStates(),this.saveAllSortSettings(),this.hot.render(),this.hot.view.wt.draw(!0)}this.hot.runHooks("afterColumnSort",e,this.getSortConfig(),i)}}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(t){function e(t){var e=t.column,n=S(t,["column"]);return Object.assign({column:r.hot.toVisualColumn(e)},n)}var r=this;if((0,l.isDefined)(t)){var n=this.hot.toPhysicalColumn(t),i=this.columnStatesManager.getColumnSortState(n);return(0,l.isDefined)(i)?e(i):void 0}var o=this.columnStatesManager.getSortStates();return(0,u.arrayMap)(o,function(t){return e(t)})}},{key:"setSortConfig",value:function(t){var r=this,e=this.getNormalizedSortConfigs(t);if(this.areValidSortConfigs(e)){var n=(0,u.arrayMap)(e,function(t){return function(t){var e=t.column,n=S(t,["column"]);return Object.assign({column:r.hot.toPhysicalColumn(e)},n)}(t)});this.columnStatesManager.setSortStates(n)}}},{key:"getNormalizedSortConfigs",value:function(t){var e=0<arguments.length&&void 0!==t?t:[];return Array.isArray(e)?e.slice(0,1):[e].slice(0,1)}},{key:"areValidSortConfigs",value:function(t){if(!1===Array.isArray(t))return!1;var e=t.map(function(t){return t.column}),n=this.hot.countCols(),r=e.every(function(t){return t<=n&&0<=t});return(0,v.areValidSortStates)(t)&&r}},{key:"saveAllSortSettings",value:function(){var t=this.columnStatesManager.getAllColumnsProperties();t.initialConfig=this.columnStatesManager.getSortStates(),this.hot.runHooks("persistentStateSave","columnSorting",t)}},{key:"getAllSavedSortSettings",value:function(){var r=this,t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);var e=t.value;return(0,l.isDefined)(e)&&Array.isArray(e.initialConfig)&&(e.initialConfig=(0,u.arrayMap)(e.initialConfig,function(t){var e=t.column,n=S(t,["column"]);return Object.assign({column:r.hot.toVisualColumn(e)},n)})),e}},{key:"getColumnNextConfig",value:function(t){var e=this.hot.toPhysicalColumn(t);if(this.columnStatesManager.isColumnSorted(e)){var n=this.getSortConfig(t),r=(0,v.getNextSortOrder)(n.sortOrder);return(0,l.isDefined)(r)?(n.sortOrder=r,n):void 0}var i=this.hot.countCols();if(Number.isInteger(t)&&0<=t&&t<i)return{column:t,sortOrder:(0,v.getNextSortOrder)()}}},{key:"getNextSortConfig",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:"append",r=this.hot.toPhysicalColumn(t),i=this.columnStatesManager.getIndexOfColumnInSortQueue(r),o=this.columnStatesManager.isColumnSorted(r),a=this.getSortConfig(),s=this.getColumnNextConfig(t);if(o){if((0,l.isUndefined)(s))return[].concat(E(a.slice(0,i)),E(a.slice(i+1)));if("append"===n)return[].concat(E(a.slice(0,i)),E(a.slice(i+1)),[s]);if("replace"===n)return[].concat(E(a.slice(0,i)),[s],E(a.slice(i+1)))}return(0,l.isDefined)(s)?a.concat(s):a}},{key:"setMergedPluginSettings",value:function(t){var e=this.hot.toPhysicalColumn(t),n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,t),o=Object.getPrototypeOf(i),a=Object.hasOwnProperty.call(o,this.pluginKey)?o[this.pluginKey]:{};this.columnMetaCache.set(e,Object.assign(r,n,a))}},{key:"getFirstCellSettings",value:function(t){var e=this,n=this.blockPluginTranslation;if(this.blockPluginTranslation=!0,0===this.columnMetaCache.size){var r=this.hot.countCols();(0,h.rangeEach)(r,function(t){return e.setMergedPluginSettings(t)})}var i=this.hot.getCellMeta(0,t);this.blockPluginTranslation=n;var o=Object.create(i);return o[this.pluginKey]=this.columnMetaCache.get(this.hot.toPhysicalColumn(t)),o}},{key:"getNumberOfRowsToSort",value:function(t){var e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}},{key:"sortByPresetSortStates",value:function(){var n=this;if(this.columnStatesManager.isListOfSortedColumnsEmpty())this.rowsMapper.clearMap();else{var t=[],r=this.columnStatesManager.getSortedColumns(),e=this.hot.countRows();this.blockPluginTranslation=!0;for(var i=function(e){return(0,u.arrayMap)(r,function(t){return n.hot.getDataAtCell(e,n.hot.toVisualColumn(t))})},o=0;o<this.getNumberOfRowsToSort(e);o+=1)t.push([o].concat(i(o)));(0,b.sort)(t,this.pluginKey,(0,u.arrayMap)(r,function(t){return n.columnStatesManager.getSortOrderOfColumn(t)}),(0,u.arrayMap)(r,function(t){return n.getFirstCellSettings(n.hot.toVisualColumn(t))}));for(var a=t.length;a<e;a+=1)t.push([a].concat(i(a)));this.blockPluginTranslation=!1,this.rowsMapper._arrayMap=(0,u.arrayMap)(t,function(t){return t[0]})}}},{key:"loadOrSortBySettings",value:function(){this.columnMetaCache.clear();var t=this.getAllSavedSortSettings();if((0,s.isObject)(t))this.sortBySettings(t);else{var e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}},{key:"sortBySettings",value:function(t){if((0,s.isObject)(t)){this.columnStatesManager.updateAllColumnsProperties(t);var e=t.initialConfig;(Array.isArray(e)||(0,s.isObject)(e))&&this.sort(e)}else this.hot.render()}},{key:"enableObserveChangesPlugin",value:function(){var t=this;this.hot._registerTimeout(setTimeout(function(){t.hot.updateSettings({observeChanges:!0})},0))}},{key:"onModifyRow",value:function(t,e){if(!1===this.blockPluginTranslation&&e!==this.pluginName&&this.isSorted()){var n=this.rowsMapper.getValueByIndex(t);t=null===n?t:n}return t}},{key:"onUnmodifyRow",value:function(t,e){return!1===this.blockPluginTranslation&&e!==this.pluginName&&this.isSorted()&&(t=this.rowsMapper.getIndexByValue(t)),t}},{key:"onAfterGetColHeader",value:function(t,e){var n=(0,v.getHeaderSpanElement)(e);if(!1!==(0,v.isFirstLevelColumnHeader)(t,e)&&null!==n){var r=this.hot.toPhysicalColumn(t),i=this.getFirstCellSettings(t)[this.pluginKey],o=i.indicator,a=i.headerAction;this.updateHeaderClasses(n,this.columnStatesManager,r,o,a)}}},{key:"updateHeaderClasses",value:function(t){if((0,o.removeClass)(t,(0,m.getClassedToRemove)(t)),!1!==this.enabled){for(var e=arguments.length,n=Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];(0,o.addClass)(t,m.getClassesToAdd.apply(void 0,n))}}},{key:"onUpdateSettings",value:function(t){a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache.clear(),(0,l.isDefined)(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}},{key:"onAfterLoadData",value:function(t){this.rowsMapper.clearMap(),!0===t&&this.hot.view&&this.loadOrSortBySettings()}},{key:"onAfterCreateRow",value:function(t,e){this.rowsMapper.shiftItems(t,e)}},{key:"onAfterRemoveRow",value:function(t,e){this.rowsMapper.unshiftItems(t,e)}},{key:"onAfterCreateCol",value:function(){this.columnMetaCache.clear()}},{key:"onAfterRemoveCol",value:function(){this.columnMetaCache.clear()}},{key:"wasClickableHeaderClicked",value:function(t,e){return this.getFirstCellSettings(e)[this.pluginKey].headerAction&&"SPAN"===t.realTarget.nodeName}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){!1!==(0,v.wasHeaderClickedProperly)(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(0,p.isPressedCtrlKey)()&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(t,e){!1!==(0,v.wasHeaderClickedProperly)(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&((0,p.isPressedCtrlKey)()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col)),this.sort(this.getColumnNextConfig(e.col)))}},{key:"destroy",value:function(){this.rowsMapper.destroy(),this.columnStatesManager.destroy(),a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"destroy",this).call(this)}}]),N);function N(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,N);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,t));return e.columnStatesManager=new g.ColumnStatesManager,e.rowsMapper=new y.default(e),e.blockPluginTranslation=!0,e.columnMetaCache=new Map,e.pluginKey=O,e}(0,d.registerPlugin)(O,T),e.default=T},function(t,e,n){"use strict";e.__esModule=!0,e.getRootComparator=e.registerRootComparator=void 0,e.getCompareFunctionFactory=function(t){if(d(t))return c(t);return c(i.COLUMN_DATA_TYPE)};var r,i=n(330),o=n(331),a=n(332),s=n(41),l=(r=s)&&r.__esModule?r:{default:r};var u=(0,l.default)("sorting.compareFunctionFactory"),h=u.register,c=u.getItem,d=u.hasItem,f=(0,l.default)("sorting.mainSortComparator"),p=f.register,g=f.getItem;h(o.COLUMN_DATA_TYPE,o.compareFunctionFactory),h(a.COLUMN_DATA_TYPE,a.compareFunctionFactory),h(i.COLUMN_DATA_TYPE,i.compareFunctionFactory),e.registerRootComparator=p,e.getRootComparator=g},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=n(0),c=n(1);var o=(r(a,[{key:"registerCommand",value:function(t,e){this.commands[t]=e}},{key:"setCommonCallback",value:function(t){this.commonCallback=t}},{key:"execute",value:function(t){for(var e=this,n=arguments.length,r=Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o=t.split(":"),a=o[0],s=2===o.length?o[1]:null,l=this.commands[a];if(!l)throw new Error("Menu command '"+a+"' not exists.");if(s&&l.submenu&&(l=function(n,t){var r=void 0;return(0,h.arrayEach)(t,function(t){var e=t.key?t.key.split(":"):null;if(Array.isArray(e)&&e[1]===n)return r=t,!1}),r}(s,l.submenu.items)),!0!==l.disabled&&("function"!=typeof l.disabled||!0!==l.disabled.call(this.hot))&&!(0,c.hasOwnProperty)(l,"submenu")){var u=[];"function"==typeof l.callback&&u.push(l.callback),"function"==typeof this.commonCallback&&u.push(this.commonCallback),r.unshift(o.join(":")),(0,h.arrayEach)(u,function(t){return t.apply(e.hot,r)})}}}]),a);function a(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),this.hot=t,this.commands={},this.commonCallback=null}e.default=o},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(1),a=n(0),s=n(45);var l=(r(u,[{key:"setPredefinedItems",value:function(t){var r=this,i={};(this.defaultOrderPattern.length=0,o.objectEach)(t,function(t,e){var n="";n=t.name===s.SEPARATOR?(i[s.SEPARATOR]=t,s.SEPARATOR):isNaN(parseInt(e,10))?(t.key=void 0===t.key?e:t.key,(i[e]=t).key):(i[t.key]=t).key,r.defaultOrderPattern.push(n)}),this.predefinedItems=i}},{key:"getItems",value:function(t){return function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=[],n=t;return n&&n.items?n=n.items:Array.isArray(n)||(n=e),(0,o.isObject)(n)?(0,o.objectEach)(n,function(t,e){var n=r["string"==typeof t?t:e];n=n||t,(0,o.isObject)(t)?(0,o.extend)(n,t):"string"==typeof n&&(n={name:n}),void 0===n.key&&(n.key=e),i.push(n)}):(0,a.arrayEach)(n,function(t,e){var n=r[t];!n&&0<=s.ITEMS.indexOf(t)||(n=n||{name:t,key:""+e},(0,o.isObject)(t)&&(0,o.extend)(n,t),void 0===n.key&&(n.key=e),i.push(n))}),i}(0<arguments.length&&void 0!==t?t:null,this.defaultOrderPattern,this.predefinedItems)}}]),u);function u(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),this.hot=t,this.predefinedItems=(0,s.predefinedItems)(),this.defaultOrderPattern=e}e.default=l},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(4);var a=(r(s,[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=2}},{key:"build",value:function(){this._element=document.createElement("div"),this.state=1}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return 1<=this.state}},{key:"setPosition",value:function(t,e){(0,o.isNumeric)(t)&&(this._element.style.top=t+"px"),(0,o.isNumeric)(e)&&(this._element.style.left=e+"px")}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(t,e){(0,o.isNumeric)(t)&&(this._element.style.width=t+"px"),(0,o.isNumeric)(e)&&(this._element.style.height=e+"px")}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,e){(0,o.isNumeric)(t)&&(this._element.style.marginTop=t+"px"),(0,o.isNumeric)(e)&&(this._element.style.marginLeft=e+"px")}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),s);function s(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),this.hot=t,this._element=null,this.state=0}e.default=a},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.__esModule=!0;var i=(function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}(o,[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=2}},{key:"build",value:function(){this._element=document.createElement("div"),this.state=1}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return 1<=this.state}},{key:"setPosition",value:function(t,e){void 0!==t&&(this._element.style.top=t+"px"),void 0!==e&&(this._element.style.left=e+"px")}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(t,e){t&&(this._element.style.width=t+"px"),e&&(this._element.style.height=e+"px")}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,e){t&&(this._element.style.marginTop=t+"px"),e&&(this._element.style.marginLeft=e+"px")}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),o);function o(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.hot=t,this._element=null,this.state=0}e.default=i},function(t,e,n){"use strict";e.__esModule=!0,e.applySpanProperties=function(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0,e.condition=a;var r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),i=n(11);var o=e.CONDITION_NAME="empty";function a(t){return""===t.value||null===t.value||void 0===t.value}(0,i.registerCondition)(o,a,{name:r.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0;var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.condition=l;var i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),o=n(10),a=n(11);var s=e.CONDITION_NAME="eq";function l(t,e){var n=r(e,1)[0];return(0,o.stringify)(t.value).toLowerCase()===(0,o.stringify)(n)}(0,a.registerCondition)(s,l,{name:i.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0;var u=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.condition=o;var r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),h=n(11),c=n(230),d=n(231);var i=e.CONDITION_NAME="between";function o(t,e){var n=u(e,2),r=n[0],i=n[1];if("numeric"===t.meta.type){var o=parseFloat(r,10),a=parseFloat(i,10);r=Math.min(o,a),i=Math.max(o,a)}else if("date"===t.meta.type){var s=(0,h.getCondition)(d.CONDITION_NAME,[i]),l=(0,h.getCondition)(c.CONDITION_NAME,[r]);return s(t)&&l(t)}return t.value>=r&&t.value<=i}(0,h.registerCondition)(i,o,{name:r.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0;var o=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.condition=h;var r,i=n(32),a=(r=i)&&r.__esModule?r:{default:r},s=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),l=n(11);var u=e.CONDITION_NAME="date_after";function h(t,e){var n=o(e,1)[0],r=(0,a.default)(t.value,t.meta.dateFormat),i=(0,a.default)(n,t.meta.dateFormat);return!(!r.isValid()||!i.isValid())&&0<=r.diff(i)}(0,l.registerCondition)(u,h,{name:s.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0;var o=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.condition=h;var r,i=n(32),a=(r=i)&&r.__esModule?r:{default:r},s=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),l=n(11);var u=e.CONDITION_NAME="date_before";function h(t,e){var n=o(e,1)[0],r=(0,a.default)(t.value,t.meta.dateFormat),i=(0,a.default)(n,t.meta.dateFormat);return!(!r.isValid()||!i.isValid())&&r.diff(i)<=0}(0,l.registerCondition)(u,h,{name:s.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0;var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.condition=l;var i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),o=n(10),a=n(11);var s=e.CONDITION_NAME="contains";function l(t,e){var n=r(e,1)[0];return 0<=(0,o.stringify)(t.value).toLowerCase().indexOf((0,o.stringify)(n))}(0,a.registerCondition)(s,l,{name:i.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";e.__esModule=!0,e.SHORT_NAME_FOR_COMPONENT=e.OPERATION_ID=void 0,e.operationResult=s;var r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),i=n(68);var o=e.OPERATION_ID="disjunction",a=e.SHORT_NAME_FOR_COMPONENT=r.FILTERS_LABELS_DISJUNCTION;function s(t,e){return t.some(function(t){return t.func(e)})}(0,i.registerOperation)(o,a,s)},function(t,e,n){"use strict";e.__esModule=!0,e.SHORT_NAME_FOR_COMPONENT=e.OPERATION_ID=void 0,e.operationResult=s;var r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),i=n(68);var o=e.OPERATION_ID="disjunctionWithExtraCondition",a=e.SHORT_NAME_FOR_COMPONENT=r.FILTERS_LABELS_DISJUNCTION;function s(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(function(t){return t.func(e)})&&t[t.length-1].func(e)}(0,i.registerOperation)(o,a,s)},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a,s,l=(o=["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],a=["The column of index "," has been already applied with a \\`","\\` \n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`, \n        use it consequently for a particular column)."],Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(a)}}))),u=n(0),h=n(1),c=n(25),d=n(20),f=(s=d)&&s.__esModule?s:{default:s},p=n(11),g=n(165),v=n(68);var m=(r(y,[{key:"isEmpty",value:function(){return!this.orderStack.length}},{key:"isMatch",value:function(n,t){var r=this,i=!0;if(void 0===t)(0,h.objectEach)(this.columnTypes,function(t,e){return i=r.isMatchInConditions(r.conditions[t][e],n,t)});else{var e=this.columnTypes[t];i=this.isMatchInConditions(this.getConditions(t),n,e)}return i}},{key:"isMatchInConditions",value:function(t,e,n){var r=2<arguments.length&&void 0!==n?n:g.OPERATION_ID;return!t.length||(0,v.getOperationFunc)(r)(t,e)}},{key:"addCondition",value:function(t,e,n){var r=2<arguments.length&&void 0!==n?n:g.OPERATION_ID,i=(0,u.arrayMap)(e.args,function(t){return"string"==typeof t?t.toLowerCase():t}),o=e.name||e.command.key;this.runLocalHooks("beforeAdd",t),-1===this.orderStack.indexOf(t)&&this.orderStack.push(t);var a=this.columnTypes[t];if(a){if(a!==r)throw Error((0,c.toSingleLine)(l,t,a))}else{if(!this.conditions[r])throw new Error("Unexpected operation named `"+r+"`. Possible ones are `disjunction` and `conjunction`.");this.columnTypes[t]=r}this.getConditions(t).push({name:o,args:i,func:(0,p.getCondition)(o,i)}),this.runLocalHooks("afterAdd",t)}},{key:"getConditions",value:function(t){var e=this.columnTypes[t];return e?(this.conditions[e][t]||(this.conditions[e][t]=[]),this.conditions[e][t]):[]}},{key:"exportAllConditions",value:function(){var r=this,i=[];return(0,u.arrayEach)(this.orderStack,function(t){var e=(0,u.arrayMap)(r.getConditions(t),function(t){return{name:t.name,args:t.args}}),n=r.columnTypes[t];i.push({column:t,operation:n,conditions:e})}),i}},{key:"importAllConditions",value:function(t){var n=this;this.clean(),(0,u.arrayEach)(t,function(e){n.orderStack.push(e.column),(0,u.arrayEach)(e.conditions,function(t){return n.addCondition(e.column,t)})})}},{key:"removeConditions",value:function(t){this.runLocalHooks("beforeRemove",t),0<=this.orderStack.indexOf(t)&&this.orderStack.splice(this.orderStack.indexOf(t),1),this.clearConditions(t),this.runLocalHooks("afterRemove",t)}},{key:"clearConditions",value:function(t){this.runLocalHooks("beforeClear",t),this.getConditions(t).length=0,delete this.columnTypes[t],this.runLocalHooks("afterClear",t)}},{key:"hasConditions",value:function(t,e){if(!this.columnTypes[t])return!1;var n=this.getConditions(t);return e?0<(0,u.arrayFilter)(n,function(t){return t.name===e}).length:0<n.length}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.columnTypes=Object.create(null),this.orderStack.length=0,this.conditions=this.initConditionsCollection(),this.runLocalHooks("afterClean")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.conditions=null,this.orderStack=null,this.columnTypes=null}},{key:"initConditionsCollection",value:function(){var n=Object.create(null);return(0,h.objectEach)(v.operations,function(t,e){n[e]=Object.create(null)}),n}}]),y);function y(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),this.conditions=this.initConditionsCollection(),this.columnTypes={},this.orderStack=[]}(0,h.mixin)(m,f.default),e.default=m},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(0);var a=(r(s,[{key:"filter",value:function(){var r=this,i=[];return this.conditionCollection.isEmpty()||(0,o.arrayEach)(this.conditionCollection.orderStack,function(t,e){var n=r.columnDataFactory(t);e&&(n=r._getIntersectData(n,i)),i=r.filterByColumn(t,n)}),i}},{key:"filterByColumn",value:function(e,t){var n=this,r=1<arguments.length&&void 0!==t?t:[],i=[];return(0,o.arrayEach)(r,function(t){void 0!==t&&n.conditionCollection.isMatch(t,e)&&i.push(t)}),i}},{key:"_getIntersectData",value:function(n,t){var r=[];return(0,o.arrayEach)(t,function(t){var e=t.meta.visualRow;void 0!==n[e]&&(r[e]=n[e])}),r}}]),s);function s(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){return[]};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),this.conditionCollection=t,this.columnDataFactory=e}e.default=a},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(1),a=n(70);var s=(r(l,[{key:"translateTo",value:function(t,e){this.row=this.row+t,this.column=this.column+e}},{key:"isEqual",value:function(t){return t.row===this.row&&t.column===this.column}},{key:"toString",value:function(){return(0,a.toLabel)({index:this.row,isAbsolute:this.rowAbsolute},{index:this.column,isAbsolute:this.columnAbsolute})}}]),l);function l(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);var n=(0,o.isObject)(t),r=(0,o.isObject)(e);this._row=n?t.index:t,this.rowAbsolute=!n||t.isAbsolute,this._column=r?e.index:e,this.columnAbsolute=!r||e.isAbsolute,this.rowOffset=0,this.columnOffset=0,Object.defineProperty(this,"row",{get:function(){return this.rowOffset+this._row},set:function(t){this._row=t},enumerable:!0,configurable:!0}),Object.defineProperty(this,"column",{get:function(){return this.columnOffset+this._column},set:function(t){this._column=t},enumerable:!0,configurable:!0})}e.default=s},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,h=n(0),c=n(4),d=n(2),a=n(168);var s=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(f,((o=a)&&o.__esModule?o:{default:o}).default),r(f,null,[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r(f,[{key:"appendLevelIndicators",value:function(t,e){var n=this.trimRowsPlugin.rowsMapper.getValueByIndex(t),r=this.dataManager.getRowLevel(n),i=this.dataManager.getDataObject(n),o=e.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),s=o.querySelectorAll('[class^="ht_nesting"]');if((0,h.arrayEach)(s,function(t){t&&o.removeChild(t)}),(0,d.addClass)(e,f.CSS_CLASSES.indicatorContainer),r){var l=a.cloneNode(!0);o.innerHTML="",(0,c.rangeEach)(0,r-1,function(){var t=document.createElement("SPAN");(0,d.addClass)(t,f.CSS_CLASSES.emptyIndicator),o.appendChild(t)}),o.appendChild(l)}if(this.dataManager.hasChildren(i)){var u=document.createElement("DIV");(0,d.addClass)(e,f.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(0,d.addClass)(u,f.CSS_CLASSES.button+" "+f.CSS_CLASSES.expandButton):(0,d.addClass)(u,f.CSS_CLASSES.button+" "+f.CSS_CLASSES.collapseButton),o.appendChild(u)}}},{key:"updateRowHeaderWidth",value:function(t){var e=t;e=e||this.dataManager.cache.levelCount,this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}]),f);function f(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,t,e));return n.dataManager=n.plugin.dataManager,n.collapsingUI=n.plugin.collapsingUI,n.rowHeaderWidthCache=null,n.trimRowsPlugin=t.trimRowsPlugin,n}e.default=s},function(t,e,n){"use strict";e.__esModule=!0,n(89),n(98),n(99),n(100),n(101),n(104),n(106),n(107),n(108),n(109),n(110),n(111),n(112),n(113),n(114),n(115),n(116),n(117),n(118),n(119),n(120),n(121),n(122),n(123),n(124),n(127),n(128),n(129),n(130),n(131),n(132),n(133),n(134),n(136),n(137),n(138),n(139),n(140),n(83),n(141),n(142),n(143),n(144),n(145),n(146),n(147),n(148),n(149),n(150),n(151),n(152),n(153),n(154),n(155);var r,i=n(258),o=(r=i)&&r.__esModule?r:{default:r};!function(t){{if(t&&t.__esModule)return;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}}(n(400));o.default.baseVersion="6.2.0",e.default=o.default},function(t,e,n){var a=n(24),s=n(21),l=n(48);t.exports=n(26)?Object.defineProperties:function(t,e){s(t);for(var n,r=l(e),i=r.length,o=0;o<i;)a.f(t,n=r[o++],e[n]);return t}},function(t,e,n){"use strict";var r=n(92),i=n(60),o=n(62),a={};n(37)(a,n(14)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(a,{next:i(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var o=n(13),a=n(182).set;t.exports=function(t,e,n){var r,i=e.constructor;return i!==n&&"function"==typeof i&&(r=i.prototype)!==n.prototype&&o(r)&&a&&a(t,r),t}},function(t,e,n){var r=n(244);t.exports=function(t,e){return new(r(t))(e)}},function(t,e,n){var r=n(13),i=n(183),o=n(14)("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),r(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){var i=n(21),o=n(75),a=n(14)("species");t.exports=function(t,e){var n,r=i(t).constructor;return void 0===r||null==(n=i(r)[a])?e:o(n)}},function(t,e){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var s=n(16),l=n(102).set,u=s.MutationObserver||s.WebKitMutationObserver,h=s.process,c=s.Promise,d="process"==n(52)(h);t.exports=function(){function t(){var t,e;for(d&&(t=h.domain)&&t.exit();n;){e=n.fn,n=n.next;try{e()}catch(t){throw n?i():r=void 0,t}}r=void 0,t&&t.enter()}var n,r,i;if(d)i=function(){h.nextTick(t)};else if(!u||s.navigator&&s.navigator.standalone)if(c&&c.resolve){var e=c.resolve(void 0);i=function(){e.then(t)}}else i=function(){l.call(s,t)};else{var o=!0,a=document.createTextNode("");new u(t).observe(a,{characterData:!0}),i=function(){a.data=o=!o}}return function(t){var e={fn:t,next:void 0};r&&(r.next=e),n||(n=e,i()),r=e}}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var r=n(21),i=n(13),o=n(186);t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){var r=n(16),i=n(50),o=n(58),a=n(187),s=n(24).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,n){var s=n(48),l=n(81),u=n(63);t.exports=function(t){var e=s(t),n=l.f;if(n)for(var r,i=n(t),o=u.f,a=0;i.length>a;)o.call(t,r=i[a++])&&e.push(r);return e}},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){var l=n(72),u=n(49);t.exports=function(s){return function(t,e){var n,r,i=String(u(t)),o=l(e),a=i.length;return o<0||a<=o?s?"":void 0:(n=i.charCodeAt(o))<55296||56319<n||o+1===a||(r=i.charCodeAt(o+1))<56320||57343<r?s?i.charAt(o):n:s?i.slice(o,o+2):r-56320+(n-55296<<10)+65536}}},function(t,e,n){"use strict";var r=n(21);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";var h=n(39),c=n(73),d=n(29);t.exports=[].copyWithin||function(t,e,n){var r=h(this),i=d(r.length),o=c(t,i),a=c(e,i),s=2<arguments.length?n:void 0,l=Math.min((void 0===s?i:c(s,i))-a,i-o),u=1;for(a<o&&o<a+l&&(u=-1,a+=l-1,o+=l-1);0<l--;)a in r?r[o]=r[a]:delete r[o],o+=u,a+=u;return r}},function(t,e,n){"use strict";var u=n(39),h=n(73),c=n(29);t.exports=function(t,e,n){for(var r=u(this),i=c(r.length),o=arguments.length,a=h(1<o?e:void 0,i),s=2<o?n:void 0,l=void 0===s?i:h(s,i);a<l;)r[a++]=t;return r}},function(t,e,n){var r=n(105),i=n(81),o=n(21),a=n(16).Reflect;t.exports=a&&a.ownKeys||function(t){var e=r.f(o(t)),n=i.f;return n?e.concat(n(t)):e}},function(t,e,n){"use strict";e.__esModule=!0,n(89),n(98),n(99),n(100),n(101),n(104),n(106),n(107),n(108),n(109),n(110),n(111),n(112),n(113),n(114),n(115),n(116),n(117),n(118),n(119),n(120),n(121),n(122),n(123),n(124),n(127),n(128),n(129),n(130),n(131),n(132),n(133),n(134),n(136),n(137),n(138),n(139),n(140),n(83),n(141),n(142),n(143),n(144),n(145),n(146),n(147),n(148),n(149),n(150),n(151),n(152),n(153),n(154),n(155),n(259),n(260),n(261);var r=n(19),i=n(15),o=n(44),a=n(156),s=L(n(157)),l=L(n(318)),u=n(8),h=L(u),c=L(n(17)),d=L(n(159)),f=D(n(0)),p=D(n(42)),g=D(n(84)),v=D(n(210)),m=D(n(43)),y=D(n(34)),w=D(n(10)),b=D(n(4)),C=D(n(1)),E=D(n(158)),S=D(n(31)),O=D(n(18)),T=D(n(2)),N=D(n(12)),R=D(n(319)),_=n(5),M=L(n(214)),A=n(213),k=n(215),x=D(n(3)),I=n(85);function D(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function L(t){return t&&t.__esModule?t:{default:t}}function P(t,e){var n=new s.default(t,e||{},A.rootInstanceSymbol);return n.init(),n}(0,l.default)(P),P.Core=s.default,P.DefaultSettings=M.default,P.EventManager=h.default,P._getListenersCounter=u.getListenersCounter,P.buildDate="14/11/2018 12:28:46",P.packageName="handsontable-pro";P.version="6.2.0";P.baseVersion="6.2.0",P.hooks=c.default.getSingleton(),P.__GhostTable=d.default;var H=[f,p,g,v,m,y,w,b,C,E,S,O],B=[T,N];P.helper={},P.dom={},f.arrayEach(H,function(e){f.arrayEach(Object.getOwnPropertyNames(e),function(t){"_"!==t.charAt(0)&&(P.helper[t]=e[t])})}),f.arrayEach(B,function(e){f.arrayEach(Object.getOwnPropertyNames(e),function(t){"_"!==t.charAt(0)&&(P.dom[t]=e[t])})}),P.cellTypes={},f.arrayEach((0,a.getRegisteredCellTypeNames)(),function(t){P.cellTypes[t]=(0,a.getCellType)(t)}),P.cellTypes.registerCellType=a.registerCellType,P.cellTypes.getCellType=a.getCellType,P.editors={},f.arrayEach((0,r.getRegisteredEditorNames)(),function(t){P.editors[S.toUpperCaseFirst(t)+"Editor"]=(0,r.getEditor)(t)}),P.editors.registerEditor=r.registerEditor,P.editors.getEditor=r.getEditor,P.renderers={},f.arrayEach((0,i.getRegisteredRendererNames)(),function(t){var e=(0,i.getRenderer)(t);"base"===t&&(P.renderers.cellDecorator=e),P.renderers[S.toUpperCaseFirst(t)+"Renderer"]=e}),P.renderers.registerRenderer=i.registerRenderer,P.renderers.getRenderer=i.getRenderer,P.validators={},f.arrayEach((0,o.getRegisteredValidatorNames)(),function(t){P.validators[S.toUpperCaseFirst(t)+"Validator"]=(0,o.getValidator)(t)}),P.validators.registerValidator=o.registerValidator,P.validators.getValidator=o.getValidator,P.plugins={},f.arrayEach(Object.getOwnPropertyNames(R),function(t){var e=R[t];"Base"===t?P.plugins[t+"Plugin"]=e:P.plugins[t]=e}),P.plugins.registerPlugin=_.registerPlugin,(P.languages={}).dictionaryKeys=x,P.languages.getLanguageDictionary=I.getLanguageDictionary,P.languages.getLanguagesDictionaries=I.getLanguagesDictionaries,P.languages.registerLanguageDictionary=I.registerLanguageDictionary,P.languages.getTranslatedPhrase=function(){return k.getTranslatedPhrase.apply(void 0,arguments)},e.default=P},function(t,e){},function(t,e){},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var r,i=n(2),o=n(33),a=(r=o)&&r.__esModule?r:{default:r};var s=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(l,a.default),l);function l(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,t));return e.clone=e.makeClone(a.default.CLONE_DEBUG),e.clone.wtTable.holder.style.opacity=.4,e.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",(0,i.addClass)(e.clone.wtTable.holder.parentNode,"wtDebugVisible"),e}a.default.registerOverlay(a.default.CLONE_DEBUG,s),e.default=s},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,l=n(2),a=n(33),s=(o=a)&&o.__esModule?o:{default:o};var u=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(h,s.default),r(h,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||n&&"horizontal"===n)e=this.getScrollPosition(),(0,l.resetCssTransform)(t);else{var r=this.wot.wtTable.hider.getBoundingClientRect(),i=Math.ceil(r.left),o=Math.ceil(r.right),a=void 0,s=void 0;s=""===(s=this.wot.wtTable.hider.style.top)?0:s,e=a=i<0&&0<o-t.offsetWidth?-i:0,a+="px",(0,l.setOverlayPosition)(t,a,s)}this.adjustHeaderBordersPosition(e),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(t){var e=!1;return this.mainTableScrollableElement===window&&window.scrollX!==t?(window.scrollTo(t,(0,l.getWindowScrollTop)()),e=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,e=!0),e}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(t,e){for(var n=this.wot.wtSettings.defaultColumnWidth,r=t,i=0;r<e;)i+=this.wot.wtTable.getStretchedColumnWidth(r)||n,r+=1;return i}},{key:"adjustElementsSize",value:function(t){var e=0<arguments.length&&void 0!==t&&t;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),e||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable.holder,e=t.clientHeight===t.offsetHeight?0:(0,l.getScrollbarWidth)(),n=this.clone.wtTable.holder.parentNode.style,r=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||"vertical"===r){var i=this.wot.wtViewport.getWorkspaceHeight()-e;i=Math.min(i,(0,l.innerHeight)(this.wot.wtTable.wtRootElement)),n.height=i+"px"}else n.height="";this.clone.wtTable.holder.style.height=n.height;var o=(0,l.outerWidth)(this.clone.wtTable.TABLE);n.width=(0===o?o:o+4)+"px"}},{key:"adjustRootChildrenSize",value:function(){var t=(0,l.getScrollbarWidth)();this.clone.wtTable.hider.style.height=this.hider.style.height,this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height,0===t&&(t=30),this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+t+"px"}},{key:"applyToDOM",value:function(){var t=this.wot.getSetting("totalColumns");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.left="0"}this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,i=0;return e&&r.offsetWidth!==r.clientWidth&&(i=(0,l.getScrollbarWidth)()),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),t),n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var t=0;return this.wot.getSetting("preventOverflow")||this.trimmingContainer!==window||(t=this.wot.wtTable.holderOffset.left),t}},{key:"getScrollPosition",value:function(){return(0,l.getScrollLeft)(this.mainTableScrollableElement)}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wot.wtTable.holder.parentNode,n=this.wot.getSetting("rowHeaders"),r=this.wot.getSetting("fixedColumnsLeft");if(this.wot.getSetting("totalRows")?(0,l.removeClass)(e,"emptyRows"):(0,l.addClass)(e,"emptyRows"),r&&!n.length)(0,l.addClass)(e,"innerBorderLeft");else if(!r&&n.length){var i=(0,l.hasClass)(e,"innerBorderLeft");t?(0,l.addClass)(e,"innerBorderLeft"):(0,l.removeClass)(e,"innerBorderLeft"),(!i&&t||i&&!t)&&this.wot.wtOverlays.adjustElementsSize()}}}]),h);function h(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,t));return e.clone=e.makeClone(s.default.CLONE_LEFT),e}s.default.registerOverlay(s.default.CLONE_LEFT,u),e.default=u},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,l=n(2),a=n(0),s=n(33),u=(o=s)&&o.__esModule?o:{default:o};var h=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(c,u.default),r(c,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||n&&"vertical"===n)e=this.getScrollPosition(),(0,l.resetCssTransform)(t);else{var r=this.wot.wtTable.hider.getBoundingClientRect(),i=Math.ceil(r.top),o=Math.ceil(r.bottom),a=void 0,s=void 0;a=""===(a=this.wot.wtTable.hider.style.left)?0:a,e=s=i<0&&0<o-t.offsetHeight?-i:0,s+="px",(0,l.setOverlayPosition)(t,a,s)}this.adjustHeaderBordersPosition(e),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(t){var e=!1;return this.mainTableScrollableElement===window&&window.scrollY!==t?(window.scrollTo((0,l.getWindowScrollLeft)(),t),e=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,e=!0),e}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(t,e){for(var n=this.wot.wtSettings.settings.defaultRowHeight,r=t,i=0;r<e;){var o=this.wot.wtTable.getRowHeight(r);i+=void 0===o?n:o,r+=1}return i}},{key:"adjustElementsSize",value:function(t){var e=0<arguments.length&&void 0!==t&&t;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),e||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable.holder,e=t.clientWidth===t.offsetWidth?0:(0,l.getScrollbarWidth)(),n=this.clone.wtTable.holder.parentNode.style,r=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||"horizontal"===r){var i=this.wot.wtViewport.getWorkspaceWidth()-e;i=Math.min(i,(0,l.innerWidth)(this.wot.wtTable.wtRootElement)),n.width=i+"px"}else n.width="";this.clone.wtTable.holder.style.width=n.width;var o=(0,l.outerHeight)(this.clone.wtTable.TABLE);n.height=(0===o?o:o+4)+"px"}},{key:"adjustRootChildrenSize",value:function(){var t=(0,l.getScrollbarWidth)();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===t&&(t=30),this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+t+"px"}},{key:"applyToDOM",value:function(){var t=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,i=0;if(e&&r.offsetHeight!==r.clientHeight&&(i=(0,l.getScrollbarWidth)()),e){var o=this.wot.getSetting("fixedRowsBottom"),a=this.wot.getSetting("totalRows");n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportHeight()-this.sumCellSizes(a-o,a),n+=1}else n+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),t);return n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return(0,l.getScrollTop)(this.mainTableScrollableElement)}},{key:"redrawSelectionBorders",value:function(t){if(t&&t.cellRange){var e=t.getBorder(this.wot),n=t.getCorners();e.disappear(),e.appear(n)}}},{key:"redrawAllSelectionsBorders",value:function(){var e=this,t=this.wot.selections;this.redrawSelectionBorders(t.getCell()),(0,a.arrayEach)(t.getAreas(),function(t){e.redrawSelectionBorders(t)}),this.redrawSelectionBorders(t.getFill()),this.wot.wtTable.wot.wtOverlays.leftOverlay.refresh()}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wot.wtTable.holder.parentNode;if(this.wot.getSetting("totalColumns")?(0,l.removeClass)(e,"emptyColumns"):(0,l.addClass)(e,"emptyColumns"),0===this.wot.getSetting("fixedRowsTop")&&0<this.wot.getSetting("columnHeaders").length){var n=(0,l.hasClass)(e,"innerBorderTop");t||0===this.wot.getSetting("totalRows")?(0,l.addClass)(e,"innerBorderTop"):(0,l.removeClass)(e,"innerBorderTop"),(!n&&t||n&&!t)&&(this.wot.wtOverlays.adjustElementsSize(),this.redrawAllSelectionsBorders())}if(0===this.wot.getSetting("rowHeaders").length){var r=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(r)for(var i=0;i<r.length;i++)r[i].style["border-left-width"]=0}}}]),c);function c(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,t));return e.clone=e.makeClone(u.default.CLONE_TOP),e}u.default.registerOverlay(u.default.CLONE_TOP,h),e.default=h},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,c=n(2),a=n(33),s=(o=a)&&o.__esModule?o:{default:o};var l=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(u,s.default),r(u,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length||!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=(0,c.outerHeight)(this.clone.wtTable.TABLE),n=(0,c.outerWidth)(this.clone.wtTable.TABLE),r=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window){var i=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(i.top),a=Math.ceil(i.left),s=Math.ceil(i.bottom),l=Math.ceil(i.right),u="0",h="0";r&&"vertical"!==r||a<0&&0<l-t.offsetWidth&&(u=-a+"px"),r&&"horizontal"!==r||o<0&&0<s-t.offsetHeight&&(h=-o+"px"),(0,c.setOverlayPosition)(t,u,h)}else(0,c.resetCssTransform)(t);t.style.height=(0===e?e:e+4)+"px",t.style.width=(0===n?n:n+4)+"px"}}}]),u);function u(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,t));return e.clone=e.makeClone(s.default.CLONE_TOP_LEFT_CORNER),e}s.default.registerOverlay(s.default.CLONE_TOP_LEFT_CORNER,l),e.default=l},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,s=n(2),a=n(33),l=(o=a)&&o.__esModule?o:{default:o};var u=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(h,l.default),r(h,[{key:"repositionOverlay",value:function(){var t=(0,s.getScrollbarWidth)(),e=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(t=0),e.style.top="",e.style.bottom=t+"px"}},{key:"shouldBeRendered",value:function(){return!!this.wot.getSetting("fixedRowsBottom")}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=0;if(t.style.top="",this.wot.wtOverlays.leftOverlay.trimmingContainer===window){var n=this.wot.wtTable.hider.getBoundingClientRect(),r=Math.ceil(n.bottom),i=void 0,o=void 0,a=document.body.offsetHeight;i=""===(i=this.wot.wtTable.hider.style.left)?0:i,e=o=a<r?r-a:0,o+="px",t.style.top="",t.style.left=i,t.style.bottom=o}else e=this.getScrollPosition(),(0,s.resetCssTransform)(t),this.repositionOverlay();this.adjustHeaderBordersPosition(e)}}},{key:"setScrollPosition",value:function(t){this.mainTableScrollableElement===window?window.scrollTo((0,s.getWindowScrollLeft)(),t):this.mainTableScrollableElement.scrollTop=t}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(t,e){for(var n=t,r=0,i=this.wot.wtSettings.settings.defaultRowHeight;n<e;){var o=this.wot.wtTable.getRowHeight(n);r+=void 0===o?i:o,n+=1}return r}},{key:"adjustElementsSize",value:function(t){var e=0<arguments.length&&void 0!==t&&t;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),e||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable.holder,e=t.clientWidth===t.offsetWidth?0:(0,s.getScrollbarWidth)(),n=this.clone.wtTable.holder.parentNode.style;this.trimmingContainer===window?n.width="":n.width=this.wot.wtViewport.getWorkspaceWidth()-e+"px",this.clone.wtTable.holder.style.width=n.width;var r=(0,s.outerHeight)(this.clone.wtTable.TABLE);n.height=r+"px"}},{key:"adjustRootChildrenSize",value:function(){var t=(0,s.getScrollbarWidth)();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===t&&(t=30),this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+t+"px"}},{key:"applyToDOM",value:function(){var t=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,i=0;e&&r.offsetHeight!==r.clientHeight&&(i=(0,s.getScrollbarWidth)()),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),t),n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return(0,s.getScrollTop)(this.mainTableScrollableElement)}},{key:"adjustHeaderBordersPosition",value:function(t){if(0===this.wot.getSetting("fixedRowsBottom")&&0<this.wot.getSetting("columnHeaders").length){var e=this.wot.wtTable.holder.parentNode,n=(0,s.hasClass)(e,"innerBorderTop");t?(0,s.addClass)(e,"innerBorderTop"):(0,s.removeClass)(e,"innerBorderTop"),(!n&&t||n&&!t)&&this.wot.wtOverlays.adjustElementsSize()}if(0===this.wot.getSetting("rowHeaders").length){var r=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)");r&&(r.style["border-left-width"]=0)}}}]),h);function h(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,t));return e.clone=e.makeClone(l.default.CLONE_BOTTOM),e}l.default.registerOverlay(l.default.CLONE_BOTTOM,u),e.default=u},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,u=n(2),a=n(33),s=(o=a)&&o.__esModule?o:{default:o};var l=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(h,s.default),r(h,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedRowsBottom")||!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)}},{key:"repositionOverlay",value:function(){var t=(0,u.getScrollbarWidth)(),e=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(t=0),e.style.top="",e.style.bottom=t+"px"}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=(0,u.outerHeight)(this.clone.wtTable.TABLE),n=(0,u.outerWidth)(this.clone.wtTable.TABLE);if(t.style.top="",this.trimmingContainer===window){var r=this.wot.wtTable.hider.getBoundingClientRect(),i=Math.ceil(r.bottom),o=Math.ceil(r.left),a=void 0,s=void 0,l=document.body.offsetHeight;a=o<0?-o:0,s=l<i?i-l:0,s+="px",a+="px",t.style.top="",t.style.left=a,t.style.bottom=s}else(0,u.resetCssTransform)(t),this.repositionOverlay();t.style.height=e+"px",t.style.width=n+"px"}}}]),h);function h(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,t));return e.clone=e.makeClone(s.default.CLONE_BOTTOM_LEFT_CORNER),e}s.default.registerOverlay(s.default.CLONE_BOTTOM_LEFT_CORNER,l),e.default=l},function(t,e,n){"use strict";e.__esModule=!0;var b=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var C=n(2),o=s(n(207)),u=s(n(65)),a=s(n(196));function s(t){return t&&t.__esModule?t:{default:t}}var h=(r(c,[{key:"getBorder",value:function(t){return this.instanceBorders[t.guid]||(this.instanceBorders[t.guid]=new o.default(t,this.settings)),this.instanceBorders[t.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(t){return this.isEmpty()?this.cellRange=new a.default(t):this.cellRange.expand(t),this}},{key:"replace",value:function(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var t=this.cellRange.getTopLeftCorner(),e=this.cellRange.getBottomRightCorner();return[t.row,t.col,e.row,e.col]}},{key:"addClassAtCoords",value:function(t,e,n,r,i){var o=4<arguments.length&&void 0!==i&&i,a=t.wtTable.getCell(new u.default(e,n));if("object"===(void 0===a?"undefined":l(a))){var s=r;o&&(s=this.classNameGenerator(a),this.classNames.includes(s)||this.classNames.push(s)),(0,C.addClass)(a,s)}return this}},{key:"linearClassNameGenerator",value:function(a,s){return function t(e,n){var r=1<arguments.length&&void 0!==n?n:-1;if(0===s||0===r)return a;var i=0<=r?r:s,o=0==--i?a:a+"-"+i;return(0,C.hasClass)(e,o)?a+"-"+(1+i):t(e,i)}}},{key:"draw",value:function(t){if(this.isEmpty())this.settings.border&&this.getBorder(t).disappear();else{for(var e=t.wtTable.getRenderedRowsCount(),n=t.wtTable.getRenderedColumnsCount(),r=this.getCorners(),i=b(r,4),o=i[0],a=i[1],s=i[2],l=i[3],u=0;u<n;u+=1){var h=t.wtTable.columnFilter.renderedToSource(u);if(a<=h&&h<=l){var c=t.wtTable.getColumnHeader(h);if(c){var d=[];this.settings.highlightHeaderClassName&&d.push(this.settings.highlightHeaderClassName),this.settings.highlightColumnClassName&&d.push(this.settings.highlightColumnClassName),(0,C.addClass)(c,d)}}}for(var f=0;f<e;f+=1){var p=t.wtTable.rowFilter.renderedToSource(f);if(o<=p&&p<=s){var g=t.wtTable.getRowHeader(p);if(g){var v=[];this.settings.highlightHeaderClassName&&v.push(this.settings.highlightHeaderClassName),this.settings.highlightRowClassName&&v.push(this.settings.highlightRowClassName),(0,C.addClass)(g,v)}}for(var m=0;m<n;m+=1){var y=t.wtTable.columnFilter.renderedToSource(m);o<=p&&p<=s&&a<=y&&y<=l?this.settings.className&&this.addClassAtCoords(t,p,y,this.settings.className,this.settings.markIntersections):o<=p&&p<=s?this.settings.highlightRowClassName&&this.addClassAtCoords(t,p,y,this.settings.highlightRowClassName):a<=y&&y<=l&&this.settings.highlightColumnClassName&&this.addClassAtCoords(t,p,y,this.settings.highlightColumnClassName);var w=t.getSetting("onAfterDrawSelection",p,y,r,this.settings.layerLevel);"string"==typeof w&&this.addClassAtCoords(t,p,y,w)}}t.getSetting("onBeforeDrawBorders",r,this.settings.className),this.settings.border&&this.getBorder(t).appear(r)}}}]),c);function c(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),this.settings=t,this.cellRange=e||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}e.default=h},function(t,e,n){"use strict";t.exports=function(){function r(t,e,n){t.addEventListener(e,n,!1)}function t(t,e,n){t.removeEventListener(e,n,!1)}function i(t){var e,n;t?/^[a-zA-Z \.,\\\/\|0-9]$/.test(t)||(t="."):t="",void 0!==h.textContent?h.textContent=s.value+t:h.data=s.value+t,c.style.fontSize=d(s).fontSize,c.style.fontFamily=d(s).fontFamily,c.style.whiteSpace="pre",u.appendChild(c),e=c.clientWidth+2,u.removeChild(c),s.style.height=l.minHeight+"px",l.minWidth>e?s.style.width=l.minWidth+"px":e>l.maxWidth?s.style.width=l.maxWidth+"px":s.style.width=e+"px",n=s.scrollHeight?s.scrollHeight-1:0,l.minHeight>n?s.style.height=l.minHeight+"px":l.maxHeight<n?(s.style.height=l.maxHeight+"px",s.style.overflowY="visible"):s.style.height=n+"px"}function o(){window.setTimeout(i,0)}function a(t,e,n){s=t,function(t){if(t&&t.minHeight)if("inherit"==t.minHeight)l.minHeight=s.clientHeight;else{var e=parseInt(t.minHeight);isNaN(e)||(l.minHeight=e)}if(t&&t.maxHeight)if("inherit"==t.maxHeight)l.maxHeight=s.clientHeight;else{var n=parseInt(t.maxHeight);isNaN(n)||(l.maxHeight=n)}if(t&&t.minWidth)if("inherit"==t.minWidth)l.minWidth=s.clientWidth;else{var r=parseInt(t.minWidth);isNaN(r)||(l.minWidth=r)}if(t&&t.maxWidth)if("inherit"==t.maxWidth)l.maxWidth=s.clientWidth;else{var i=parseInt(t.maxWidth);isNaN(i)||(l.maxWidth=i)}c.firstChild||(c.className="autoResize",c.style.display="inline-block",c.appendChild(h))}(e),"TEXTAREA"==s.nodeName&&(s.style.resize="none",s.style.overflowY="",s.style.height=l.minHeight+"px",s.style.minWidth=l.minWidth+"px",s.style.maxWidth=l.maxWidth+"px",s.style.overflowY="hidden"),n&&(r(s,"change",i),r(s,"cut",o),r(s,"paste",o),r(s,"drop",o),r(s,"keydown",o),r(s,"focus",i),r(s,"compositionstart",o),r(s,"compositionupdate",o),r(s,"compositionend",o)),i()}var s,l={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},u=document.body,h=document.createTextNode(""),c=document.createElement("SPAN");function d(t){return t.currentStyle||document.defaultView.getComputedStyle(t)}return{init:function(t,e,n){a(t,e,n)},unObserve:function(){t(s,"change",i),t(s,"cut",o),t(s,"paste",o),t(s,"drop",o),t(s,"keydown",o),t(s,"focus",i),t(s,"compositionstart",o),t(s,"compositionupdate",o),t(s,"compositionend",o)},resize:i}}},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(64),s=(o=a)&&o.__esModule?o:{default:o},l=n(2);var u=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(h,s.default),r(h,[{key:"beginEditing",value:function(t,e){if(e&&"mouseup"===e.type){var n=this.TD.querySelector('input[type="checkbox"]');(0,l.hasClass)(n,"htBadValue")||n.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}]),h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(h.__proto__||Object.getPrototypeOf(h)).apply(this,arguments))}e.default=u},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var s=f(n(32)),o=f(n(272));n(273);var l=n(2),u=n(1),h=f(n(8)),c=n(18),d=n(12);function f(t){return t&&t.__esModule?t:{default:t}}var p=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(g,f(n(66)).default),r(g,[{key:"init",value:function(){var t=this;if("function"!=typeof s.default)throw new Error("You need to include moment.js to your project.");if("function"!=typeof o.default)throw new Error("You need to include Pikaday to your project.");a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){t.parentDestroyed=!0,t.destroyElements()})}},{key:"createElements",value:function(){a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"createElements",this).call(this),this.datePicker=document.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,(0,l.addClass)(this.datePicker,"htDatepickerHolder"),document.body.appendChild(this.datePicker),this.$datePicker=new o.default(this.getDatePickerConfig()),new h.default(this).addEventListener(this.datePicker,"mousedown",function(t){return(0,d.stopPropagation)(t)}),this.hideDatepicker()}},{key:"destroyElements",value:function(){this.$datePicker.destroy()}},{key:"prepare",value:function(t,e,n,r,i,o){a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"prepare",this).call(this,t,e,n,r,i,o)}},{key:"open",value:function(t){var e=0<arguments.length&&void 0!==t?t:null;a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"open",this).call(this),this.showDatepicker(e)}},{key:"close",value:function(){var t=this;this._opened=!1,this.instance._registerTimeout(function(){t.instance._refreshBorders()}),a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(t,e){var n=0<arguments.length&&void 0!==t&&t,r=1<arguments.length&&void 0!==e&&e;if(n){var i=this.originalValue;void 0!==i&&this.setValue(i)}this.hideDatepicker(),a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"finishEditing",this).call(this,n,r)}},{key:"showDatepicker",value:function(t){this.$datePicker.config(this.getDatePickerConfig());var e=this.TD.getBoundingClientRect(),n=this.cellProperties.dateFormat||this.defaultDateFormat,r=this.$datePicker.config(),i=void 0,o=this.instance.view.isMouseDown(),a=!!t&&(0,c.isMetaKey)(t.keyCode);this.datePickerStyle.top=window.pageYOffset+e.top+(0,l.outerHeight)(this.TD)+"px",this.datePickerStyle.left=window.pageXOffset+e.left+"px",this.$datePicker._onInputFocus=function(){},r.format=n,this.originalValue?(i=this.originalValue,(0,s.default)(i,n,!0).isValid()&&this.$datePicker.setMoment((0,s.default)(i,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),a||o||this.setValue("")):this.cellProperties.defaultDate?(i=this.cellProperties.defaultDate,r.defaultDate=i,(0,s.default)(i,n,!0).isValid()&&this.$datePicker.setMoment((0,s.default)(i,n),!0),a||o||this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block",this.$datePicker.show()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var n=this,t=this.TEXTAREA,e={};this.cellProperties&&this.cellProperties.datePickerConfig&&(0,u.deepExtend)(e,this.cellProperties.datePickerConfig);var r=e.onSelect,i=e.onClose;return e.field=t,e.trigger=t,e.container=this.datePicker,e.bound=!1,e.format=e.format||this.defaultDateFormat,e.reposition=e.reposition||!1,e.onSelect=function(t){var e=t;isNaN(e.getTime())||(e=(0,s.default)(e).format(n.cellProperties.dateFormat||n.defaultDateFormat)),n.setValue(e),n.hideDatepicker(),r&&r()},e.onClose=function(){n.parentDestroyed||n.finishEditing(!1),i&&i()},e}}]),g);function g(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,t));return e.defaultDateFormat="DD/MM/YYYY",e.isCellEdited=!1,e.parentDestroyed=!1,e}e.default=p},function(t,e){t.exports=r},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=s(n(208)),a=s(n(17));function s(t){return t&&t.__esModule?t:{default:t}}var l=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(u,o.default),r(u,[{key:"prepare",value:function(t,e,n,r,i,o){(function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(u.prototype.__proto__||Object.getPrototypeOf(u.prototype),"prepare",this).call(this,t,e,n,r,i,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}]),u);function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments))}a.default.getSingleton().add("beforeValidate",function(t,e,n){var r=this.getCellMeta(e,this.propToCol(n));r.editor===l&&void 0===r.strict&&(r.filter=!1,r.strict=!0)}),e.default=l},function(t,e,n){"use strict";e.__esModule=!0;var r,i=n(66);var o=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(a,((r=i)&&r.__esModule?r:{default:r}).default),a);function a(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}e.default=o},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(2),s=n(66);var l=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(u,((o=s)&&o.__esModule?o:{default:o}).default),r(u,[{key:"createElements",value:function(){(function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(u.prototype.__proto__||Object.getPrototypeOf(u.prototype),"createElements",this).call(this),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,(this.textareaStyle.height=0,a.empty)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}]),u);function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments))}e.default=l},function(t,e,n){"use strict";e.__esModule=!0;var r,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c=n(2),o=n(12),a=n(18),d=n(64),s=(r=d)&&r.__esModule?r:{default:r},l=n(1);var u=s.default.prototype.extend();u.prototype.init=function(){this.select=document.createElement("SELECT"),(0,c.addClass)(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement.appendChild(this.select),this.registerHooks()},u.prototype.registerHooks=function(){var t=this;this.instance.addHook("afterScrollHorizontally",function(){return t.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){return t.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){return t.refreshDimensions()}),this.instance.addHook("afterRowResize",function(){return t.refreshDimensions()})},u.prototype.prepare=function(){for(var r=this,t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];s.default.prototype.prepare.apply(this,e);var i=this.cellProperties.selectOptions,o=void 0;o="function"==typeof i?this.prepareOptions(i(this.row,this.col,this.prop)):this.prepareOptions(i),(0,c.empty)(this.select),(0,l.objectEach)(o,function(t,e){var n=document.createElement("OPTION");n.value=e,(0,c.fastInnerHTML)(n,t),r.select.appendChild(n)})},u.prototype.prepareOptions=function(t){var e={};if(Array.isArray(t))for(var n=0,r=t.length;n<r;n++)e[t[n]]=t[n];else"object"===(void 0===t?"undefined":i(t))&&(e=t);return e},u.prototype.getValue=function(){return this.select.value},u.prototype.setValue=function(t){this.select.value=t};function h(t){var e=this.getActiveEditor(),n=e.select.selectedIndex-1,r=e.select.selectedIndex+1;switch(t.keyCode){case a.KEY_CODES.ARROW_UP:0<=n&&(e.select[n].selected=!0),(0,o.stopImmediatePropagation)(t),t.preventDefault();break;case a.KEY_CODES.ARROW_DOWN:r<=e.select.length-1&&(e.select[r].selected=!0),(0,o.stopImmediatePropagation)(t),t.preventDefault()}}u.prototype.open=function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.instance.addHook("beforeKeyDown",h)},u.prototype.close=function(){this._opened=!1,this.select.style.display="none",this.instance.removeHook("beforeKeyDown",h)},u.prototype.focus=function(){this.select.focus()},u.prototype.refreshValue=function(){var t=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()},u.prototype.refreshDimensions=function(){if(this.state===d.EditorState.EDITING)if(this.TD=this.getEditedCell(),this.TD){var t=(0,c.offset)(this.TD),e=(0,c.offset)(this.instance.rootElement),n=(0,c.getScrollableElement)(this.TD),r=this.checkEditorSection(),i=(0,c.outerWidth)(this.TD)+1,o=(0,c.outerHeight)(this.TD)+1,a=t.top-e.top-1-(n.scrollTop||0),s=t.left-e.left-1-(n.scrollLeft||0),l=void 0;switch(r){case"top":l=(0,c.getCssTransform)(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":l=(0,c.getCssTransform)(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":l=(0,c.getCssTransform)(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":l=(0,c.getCssTransform)(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":l=(0,c.getCssTransform)(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}0===this.instance.getSelectedLast()[0]&&(a+=1),0===this.instance.getSelectedLast()[1]&&(s+=1);var u=this.select.style;l&&-1!==l?u[l[0]]=l[1]:(0,c.resetCssTransform)(this.select);var h=(0,c.getComputedStyle)(this.TD);0<parseInt(h.borderTopWidth,10)&&(o-=1),0<parseInt(h.borderLeftWidth,10)&&(i-=1),u.height=o+"px",u.minWidth=i+"px",u.top=a+"px",u.left=s+"px",u.margin="0px"}else this.close()},u.prototype.getEditedCell=function(){var t=void 0;switch(this.checkEditorSection()){case"top":t=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=101;break;case"corner":t=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=103;break;case"left":t=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=102;break;default:t=this.instance.getCell(this.row,this.col),this.select.style.zIndex=""}return-1!==t&&-2!==t?t:void 0},e.default=u},function(t,e,n){"use strict";e.__esModule=!0;var u=n(2);e.default=function(t,e,n,r,i,o,a){var s=[],l=[];a.className&&(e.className?e.className=e.className+" "+a.className:e.className=a.className),a.readOnly&&s.push(a.readOnlyCellClassName),!1===a.valid&&a.invalidCellClassName?s.push(a.invalidCellClassName):l.push(a.invalidCellClassName),!1===a.wordWrap&&a.noWordWrapClassName&&s.push(a.noWordWrapClassName),!o&&a.placeholder&&s.push(a.placeholderCellClassName),(0,u.removeClass)(e,l),(0,u.addClass)(e,s)}},function(t,e,n){"use strict";e.__esModule=!0;var r,f=n(2),i=n(8),p=(r=i)&&r.__esModule?r:{default:r},g=n(9),v=n(15);document.createElement("DIV").className="htAutocompleteWrapper";var m=document.createElement("DIV");m.className="htAutocompleteArrow",m.appendChild(document.createTextNode(String.fromCharCode(9660))),e.default=function(e,n,r,i,t,o,a){for(var s=a.allowHtml?"html":"text",l=m.cloneNode(!0),u=arguments.length,h=Array(7<u?u-7:0),c=7;c<u;c++)h[c-7]=arguments[c];if((0,v.getRenderer)(s).apply(this,[e,n,r,i,t,o,a].concat(h)),n.firstChild||n.appendChild(document.createTextNode(String.fromCharCode(160))),n.insertBefore(l,n.firstChild),(0,f.addClass)(n,"htAutocomplete"),!e.acArrowListener){var d=new p.default(e);e.acArrowListener=function(t){(0,f.hasClass)(t.target,"htAutocompleteArrow")&&e.view.wt.getSetting("onCellDblClick",null,new g.CellCoords(r,i),n)},d.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){d.destroy()})}}},function(t,e,n){"use strict";e.__esModule=!0;var r,v=n(2),m=n(31),i=n(8),y=(r=i)&&r.__esModule?r:{default:r},w=n(18),b=n(34),C=n(12),E=n(15);var S=new WeakMap,O=new WeakMap;function T(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}e.default=function(p,t,e,n,r,i,o){for(var a=arguments.length,s=Array(7<a?a-7:0),l=7;l<a;l++)s[l-7]=arguments[l];(0,E.getRenderer)("base").apply(this,[p,t,e,n,r,i,o].concat(s)),function(e){var t=O.get(e);t||((t=new y.default(e)).addEventListener(e.rootElement,"click",function(t){return function(t,e){if(!T(t.target))return!1;var n=parseInt(t.target.getAttribute("data-row"),10),r=parseInt(t.target.getAttribute("data-col"),10);e.getCellMeta(n,r).readOnly&&t.preventDefault()}(t,e)}),t.addEventListener(e.rootElement,"mouseup",function(t){return function(t,e){if(!T(t.target))return;setTimeout(e.listen,10)}(t,e)}),t.addEventListener(e.rootElement,"change",function(t){return function(t,e){if(!T(t.target))return!1;var n=parseInt(t.target.getAttribute("data-row"),10),r=parseInt(t.target.getAttribute("data-col"),10),i=e.getCellMeta(n,r);if(!i.readOnly){var o=null;o=t.target.checked?void 0===i.uncheckedTemplate||i.checkedTemplate:void 0!==i.uncheckedTemplate&&i.uncheckedTemplate,e.setDataAtCell(n,r,o)}}(t,e)}),O.set(e,t))}(p);var u=function(){var t=document.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}(),h=o.label,c=!1;if(void 0===o.checkedTemplate&&(o.checkedTemplate=!0),void 0===o.uncheckedTemplate&&(o.uncheckedTemplate=!1),(0,v.empty)(t),i===o.checkedTemplate||(0,m.equalsIgnoreCase)(i,o.checkedTemplate)?u.checked=!0:i===o.uncheckedTemplate||(0,m.equalsIgnoreCase)(i,o.uncheckedTemplate)?u.checked=!1:null===i?(0,v.addClass)(u,"noValue"):(u.style.display="none",(0,v.addClass)(u,"htBadValue"),c=!0),u.setAttribute("data-row",e),u.setAttribute("data-col",n),!c&&h){var d="";h.value?d="function"==typeof h.value?h.value.call(this,e,n,r,i):h.value:h.property&&(d=p.getDataAtRowProp(e,h.property));var f=function(t){var e=document.createElement("label");return e.className="htCheckboxRendererLabel",e.appendChild(document.createTextNode(t)),e.cloneNode(!0)}(d);"before"===h.position?f.appendChild(u):f.insertBefore(u,f.firstChild),u=f}function g(t){var e=0<arguments.length&&void 0!==t&&t,n=p.getSelectedRangeLast();if(n){for(var r=n.getTopLeftCorner(),i=r.row,o=r.col,a=n.getBottomRightCorner(),s=a.row,l=a.col,u=[],h=i;h<=s;h+=1)for(var c=o;c<=l;c+=1){var d=p.getCellMeta(h,c);if("checkbox"!==d.type)return;if(!0!==d.readOnly){void 0===d.checkedTemplate&&(d.checkedTemplate=!0),void 0===d.uncheckedTemplate&&(d.uncheckedTemplate=!1);var f=p.getDataAtCell(h,c);!1===e?[d.checkedTemplate,d.checkedTemplate.toString()].includes(f)?u.push([h,c,d.uncheckedTemplate]):[d.uncheckedTemplate,d.uncheckedTemplate.toString(),null,void 0].includes(f)&&u.push([h,c,d.checkedTemplate]):u.push([h,c,d.uncheckedTemplate])}}0<u.length&&p.setDataAtCell(u)}}t.appendChild(u),c&&t.appendChild(document.createTextNode("#bad-value#")),S.has(p)||(S.set(p,!0),p.addHook("beforeKeyDown",function(t){var e="SPACE|ENTER",n="DELETE|BACKSPACE",r=(0,b.partial)(w.isKey,t.keyCode);r(e+"|"+n)&&!(0,C.isImmediatePropagationStopped)(t)&&function(t){var e=p.getSelectedRangeLast();if(!e)return;for(var n=e.getTopLeftCorner(),r=e.getBottomRightCorner(),i=n.row;i<=r.row;i++)for(var o=n.col;o<=r.col;o++){var a=p.getCellMeta(i,o);if("checkbox"!==a.type)return;var s=p.getCell(i,o);if(null==s)t(i,o,a);else{var l=s.querySelectorAll("input[type=checkbox]");0<l.length&&!a.readOnly&&t(l)}}}(function(){(0,C.stopImmediatePropagation)(t),t.preventDefault()});r(e)&&g();r(n)&&g(!0)}))}},function(t,e,n){"use strict";e.__esModule=!0;var u=n(2),h=n(15);e.default=function(t,e,n,r,i,o){for(var a=arguments.length,s=Array(6<a?a-6:0),l=6;l<a;l++)s[l-6]=arguments[l];(0,h.getRenderer)("base").apply(this,[t,e,n,r,i,o].concat(s)),(0,u.fastInnerHTML)(e,null==o?"":o)}},function(t,e,n){"use strict";e.__esModule=!0;var r,i=n(283),g=(r=i)&&r.__esModule?r:{default:r},v=n(15),m=n(4);e.default=function(t,e,n,r,i,o,a){var s=o;if((0,m.isNumeric)(s)){var l=a.numericFormat,u=l&&l.culture||"-",h=l&&l.pattern,c=a.className||"",d=c.length?c.split(" "):[];if(void 0!==u&&!g.default.languages()[u]){var f=u.replace("-",""),p=g.default.allLanguages?g.default.allLanguages[u]:g.default[f];p&&g.default.registerLanguage(p)}g.default.setLanguage(u),s=(0,g.default)(s).format(h||"0"),d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),a.className=d.join(" ")}(0,v.getRenderer)("text")(t,e,n,r,i,s,a)}},function(t,e){t.exports=i},function(t,e,n){"use strict";e.__esModule=!0;var f=n(2),p=n(15),g=n(4);e.default=function(t,e,n,r,i,o,a){for(var s=arguments.length,l=Array(7<s?s-7:0),u=7;u<s;u++)l[u-7]=arguments[u];(0,p.getRenderer)("text").apply(this,[t,e,n,r,i,o,a].concat(l));var h=a.hashLength||e.innerHTML.length,c=a.hashSymbol||"*",d="";(0,g.rangeEach)(h-1,function(){d+=c}),(0,f.fastInnerHTML)(e,d)}},function(t,e,n){"use strict";e.__esModule=!0;var d=n(2),f=n(10),p=n(15);e.default=function(t,e,n,r,i,o,a){for(var s=arguments.length,l=Array(7<s?s-7:0),u=7;u<s;u++)l[u-7]=arguments[u];(0,p.getRenderer)("base").apply(this,[t,e,n,r,i,o,a].concat(l));var h=o;if(!h&&a.placeholder&&(h=a.placeholder),h=(0,f.stringify)(h),t.getSettings().trimWhitespace||(h=h.replace(/ /g,String.fromCharCode(160))),a.rendererTemplate){(0,d.empty)(e);var c=document.createElement("TEMPLATE");c.setAttribute("bind","{{}}"),c.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=t.getSourceDataAtRow(n),e.appendChild(c)}else(0,d.fastInnerText)(e,h)}},function(t,e,n){"use strict";function r(t,i){var o=t;return function(t){for(var e=!1,n=0,r=t.length;n<r;n++)if(o===t[n]){e=!0;break}i(e)}}e.__esModule=!0,e.default=function(t,e){var n=t;null==n&&(n="");if(this.allowEmpty&&""===n)return void e(!0);this.strict&&this.source?"function"==typeof this.source?this.source(n,r(n,e)):r(n,e)(this.source):e(!0)}},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){var n=(0,c.getEditorInstance)("date",this.instance),r=t,i=!0;null==r&&(r="");var o=(0,h.default)(new Date(r)).isValid()||(0,h.default)(r,n.defaultDateFormat).isValid(),a=(0,h.default)(r,this.dateFormat||n.defaultDateFormat,!0).isValid();this.allowEmpty&&""===r&&(a=o=!0);o||(i=!1);!o&&a&&(i=!0);if(o&&!a)if(!0===this.correctFormat){var s=d(r,this.dateFormat),l=this.instance.runHooks("unmodifyRow",this.row),u=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(l,u,s,"dateValidator"),i=!0}else i=!1;e(i)},e.correctFormat=d;var r,i=n(32),h=(r=i)&&r.__esModule?r:{default:r},o=n(210),c=n(19);function d(t,e){var n=(0,h.default)((0,o.getNormalizedDate)(t)),r=(0,h.default)(t,e),i=-1<t.search(/[A-z]/g);return(n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?n:r).format(e)}},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){var n=t;null==n&&(n="");this.allowEmpty&&""===n?e(!0):e(""!==n&&/^-?\d*(\.|,)?\d*$/.test(n))}},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){var n=this.timeFormat||"h:mm:ss a",r=!0,i=t;null===i&&(i="");i=/^\d{3,}$/.test(i)?parseInt(i,10):i;var o=/^\d{1,2}$/.test(i);o&&(i+=":00");var a=(0,d.default)(i,f,!0).isValid()?(0,d.default)(i):(0,d.default)(i,n),s=a.isValid(),l=(0,d.default)(i,n,!0).isValid()&&!o;this.allowEmpty&&""===i&&(l=s=!0);s||(r=!1);!s&&l&&(r=!0);if(s&&!l)if(!0===this.correctFormat){var u=a.format(n),h=this.instance.runHooks("unmodifyRow",this.row),c=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(h,c,u,"timeValidator"),r=!0}else r=!1;e(r)};var r,i=n(32),d=(r=i)&&r.__esModule?r:{default:r};var f=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"]},function(t,e,n){"use strict";e.__esModule=!0;var r=n(19),i=n(15),o=n(44),a="autocomplete";e.default={editor:(0,r.getEditor)(a),renderer:(0,i.getRenderer)(a),validator:(0,o.getValidator)(a)}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(19),i=n(15);e.default={editor:(0,r.getEditor)("checkbox"),renderer:(0,i.getRenderer)("checkbox")}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(19),i=n(15),o=n(44);e.default={editor:(0,r.getEditor)("date"),renderer:(0,i.getRenderer)("autocomplete"),validator:(0,o.getValidator)("date")}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(19),i=n(15),o=n(44);e.default={editor:(0,r.getEditor)("dropdown"),renderer:(0,i.getRenderer)("autocomplete"),validator:(0,o.getValidator)("autocomplete")}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(19),i=n(15);e.default={editor:(0,r.getEditor)("handsontable"),renderer:(0,i.getRenderer)("autocomplete")}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(19),i=n(15),o=n(44),a="numeric";e.default={editor:(0,r.getEditor)(a),renderer:(0,i.getRenderer)(a),validator:(0,o.getValidator)(a),dataType:"number"}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(19),i=n(15);e.default={editor:(0,r.getEditor)("password"),renderer:(0,i.getRenderer)("password"),copyable:!1}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(19),i=n(15);e.default={editor:(0,r.getEditor)("text"),renderer:(0,i.getRenderer)("text")}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(19),i=n(15),o=n(44);e.default={editor:(0,r.getEditor)("text"),renderer:(0,i.getRenderer)("text"),validator:(0,o.getValidator)("time")}},function(t,e,n){"use strict";e.__esModule=!0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=a(n(211)),i=n(84),f=n(158),p=n(1),h=n(0),o=a(n(300)),u=n(4),c=a(n(301));function a(t){return t&&t.__esModule?t:{default:t}}function l(t,e,n){var r=this;this.instance=t,this.priv=e,this.GridSettings=n,this.dataSource=this.instance.getSettings().data,this.cachedLength=null,this.skipCache=!1,this.latestSourceRowsCount=0,this.dataSource&&this.dataSource[0]?this.duckSchema=this.recursiveDuckSchema(this.dataSource[0]):this.duckSchema={},this.createMap(),this.interval=o.default.create(function(){return r.clearLengthCache()},"15fps"),this.instance.addHook("skipLengthCache",function(t){return r.onSkipLengthCache(t)}),this.onSkipLengthCache(500)}l.prototype.DESTINATION_RENDERER=1,l.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,l.prototype.recursiveDuckSchema=function(t){return(0,p.duckSchema)(t)},l.prototype.recursiveDuckColumns=function(t,e,n){var r=this,i=e,o=n,a=void 0;return void 0===i&&(i=0,o=""),"object"!==(void 0===t?"undefined":s(t))||Array.isArray(t)||(0,p.objectEach)(t,function(t,e){null===t?(a=o+e,r.colToPropCache.push(a),r.propToColCache.set(a,i),i+=1):i=r.recursiveDuckColumns(t,i,e+".")}),i},l.prototype.createMap=function(){var t=void 0,e=this.getSchema();if(void 0===e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");this.colToPropCache=[],this.propToColCache=new c.default;var n=this.instance.getSettings().columns;if(n){var r=this.instance.getSettings().maxCols,i=Math.min(r,n.length),o=0,a=!1,s=(0,p.deepObjectSize)(e);for("function"==typeof n&&(i=0<s?s:this.instance.countSourceCols(),a=!0),t=0;t<i;t++){var l=a?n(t):n[t];if((0,p.isObject)(l)){if(void 0!==l.data){var u=a?o:t;this.colToPropCache[u]=l.data,this.propToColCache.set(l.data,u)}o+=1}}}else this.recursiveDuckColumns(e)},l.prototype.colToProp=function(t){var e=this.instance.runHooks("modifyCol",t);return!isNaN(e)&&this.colToPropCache&&void 0!==this.colToPropCache[e]?this.colToPropCache[e]:e},l.prototype.propToCol=function(t){var e=void 0;return e=void 0===this.propToColCache.get(t)?t:this.propToColCache.get(t),e=this.instance.runHooks("unmodifyCol",e)},l.prototype.getSchema=function(){var t=this.instance.getSettings().dataSchema;return t?"function"==typeof t?t():t:this.duckSchema},l.prototype.createRow=function(t){var e=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=arguments[2],i=0,o=t;if(("number"!=typeof o||o>=this.instance.countSourceRows())&&(o=this.instance.countSourceRows()),!1===this.instance.runHooks("beforeCreateRow",o,n,r))return 0;for(var a=this.instance.getSettings().maxRows,s=this.instance.countCols(),l=function(){var t=null;"array"===e.instance.dataType?e.instance.getSettings().dataSchema?t=(0,p.deepClone)(e.getSchema()):(t=[],(0,u.rangeEach)(s-1,function(){return t.push(null)})):"function"===e.instance.dataType?t=e.instance.getSettings().dataSchema(o):(t={},(0,p.deepExtend)(t,e.getSchema())),o===e.instance.countSourceRows()?e.dataSource.push(t):e.spliceData(o,0,t),i+=1};i<n&&this.instance.countSourceRows()<a;)l();return this.instance.runHooks("afterCreateRow",o,i,r),this.instance.forceFullRender=!0,i},l.prototype.createCol=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=arguments[2];if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var r=this.instance.countSourceRows(),i=this.dataSource,o=this.instance.countCols(),a="number"!=typeof t||o<=t?o:t,s=void 0,l=0,u=void 0;this.instance.runHooks("beforeCreateCol",a,e,n),u=a;for(var h=this.instance.getSettings().maxCols;l<e&&this.instance.countCols()<h;){if(s=(0,f.columnFactory)(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof a||a>=this.instance.countCols()){if(0<r)for(var c=0;c<r;c++)void 0===i[c]&&(i[c]=[]),i[c].push(null);else i.push([null]);this.priv.columnSettings.push(s)}else{for(var d=0;d<r;d++)i[d].splice(u,0,null);this.priv.columnSettings.splice(u,0,s)}l+=1,u+=1}return this.instance.runHooks("afterCreateCol",a,l,n),this.instance.forceFullRender=!0,l},l.prototype.removeRow=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=arguments[2],r="number"!=typeof t?-e:t,i=this.instance.runHooks("modifyRemovedAmount",e,r);r=(this.instance.countSourceRows()+r)%this.instance.countSourceRows();var o=this.visualRowsToPhysical(r,i);if(!1!==this.instance.runHooks("beforeRemoveRow",r,i,o,n)){var a=this.dataSource,s=this.filterData(r,i);s&&(a.length=0,Array.prototype.push.apply(a,s)),this.instance.runHooks("afterRemoveRow",r,i,o,n),this.instance.forceFullRender=!0}},l.prototype.removeCol=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=arguments[2];if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");var r="number"!=typeof t?-e:t;r=(this.instance.countCols()+r)%this.instance.countCols();var i=this.visualColumnsToPhysical(r,e),o=i.slice(0).sort(function(t,e){return e-t});if(!1!==this.instance.runHooks("beforeRemoveCol",r,e,i,n)){for(var a=!0,s=o.length,l=this.dataSource,u=0;u<s;u++)a&&i[0]!==i[u]-u&&(a=!1);if(a)for(var h=0,c=this.instance.countSourceRows();h<c;h++)l[h].splice(i[0],e);else{for(var d=0,f=this.instance.countSourceRows();d<f;d++)for(var p=0;p<s;p++)l[d].splice(o[p],1);for(var g=0;g<s;g++)this.priv.columnSettings.splice(i[g],1)}this.instance.runHooks("afterRemoveCol",r,e,i,n),this.instance.forceFullRender=!0}},l.prototype.spliceCol=function(t,e,n){for(var r=this.instance.getDataAtCol(t),i=r.slice(e,e+n),o=r.slice(e+n),a=arguments.length,s=Array(3<a?a-3:0),l=3;l<a;l++)s[l-3]=arguments[l];(0,h.extendArray)(s,o);for(var u=0;u<n;)s.push(null),u+=1;return(0,h.to2dArray)(s),this.instance.populateFromArray(e,t,s,null,null,"spliceCol"),i},l.prototype.spliceRow=function(t,e,n){for(var r=this.instance.getSourceDataAtRow(t),i=r.slice(e,e+n),o=r.slice(e+n),a=arguments.length,s=Array(3<a?a-3:0),l=3;l<a;l++)s[l-3]=arguments[l];(0,h.extendArray)(s,o);for(var u=0;u<n;)s.push(null),u+=1;return this.instance.populateFromArray(t,e,[s],null,null,"spliceRow"),i},l.prototype.spliceData=function(t,e,n){!1!==this.instance.runHooks("beforeDataSplice",t,e,n)&&this.dataSource.splice(t,e,n)},l.prototype.filterData=function(t,e){var n=this.visualRowsToPhysical(t,e);if(!1!==this.instance.runHooks("beforeDataFilter",t,e,n))return this.dataSource.filter(function(t,e){return-1===n.indexOf(e)})},l.prototype.get=function(t,e){var n=this.instance.runHooks("modifyRow",t),r=this.dataSource[n],i=this.instance.runHooks("modifyRowData",n),o=null;if((r=isNaN(i)?i:r)&&r.hasOwnProperty&&(0,p.hasOwnProperty)(r,e))o=r[e];else if("string"==typeof e&&-1<e.indexOf(".")){var a=e.split("."),s=r;if(!s)return null;for(var l=0,u=a.length;l<u;l++)if(void 0===(s=s[a[l]]))return null;o=s}else"function"==typeof e&&(o=e(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var h=(0,p.createObjectPropListener)(o);this.instance.runHooks("modifyData",n,this.propToCol(e),h,"get"),h.isTouched()&&(o=h.value)}return o};var d=(0,i.cellMethodLookupFactory)("copyable",!1);l.prototype.getCopyable=function(t,e){return d.call(this.instance,t,this.propToCol(e))?this.get(t,e):""},l.prototype.set=function(t,e,n,r){var i=this.instance.runHooks("modifyRow",t,r||"datamapGet"),o=n,a=this.dataSource[i],s=this.instance.runHooks("modifyRowData",i);if(a=isNaN(s)?s:a,this.instance.hasHook("modifyData")){var l=(0,p.createObjectPropListener)(o);this.instance.runHooks("modifyData",i,this.propToCol(e),l,"set"),l.isTouched()&&(o=l.value)}if(a&&a.hasOwnProperty&&(0,p.hasOwnProperty)(a,e))a[e]=o;else if("string"==typeof e&&-1<e.indexOf(".")){var u,h=e.split("."),c=a,d=0;for(d=0,u=h.length-1;d<u;d++)void 0===c[h[d]]&&(c[h[d]]={}),c=c[h[d]];c[h[d]]=o}else"function"==typeof e?e(this.dataSource.slice(i,i+1)[0],o):a[e]=o},l.prototype.visualRowsToPhysical=function(t,e){for(var n=this.instance.countSourceRows(),r=[],i=(n+t)%n,o=e,a=void 0;i<n&&o;)a=this.instance.runHooks("modifyRow",i),r.push(a),o-=1,i+=1;return r},l.prototype.visualColumnsToPhysical=function(t,e){for(var n=this.instance.countCols(),r=(n+t)%n,i=[],o=e;r<n&&o;){var a=this.instance.runHooks("modifyCol",r);i.push(a),o-=1,r+=1}return i},l.prototype.clear=function(){for(var t=0;t<this.instance.countSourceRows();t++)for(var e=0;e<this.instance.countCols();e++)this.set(t,this.colToProp(e),"")},l.prototype.clearLengthCache=function(){this.cachedLength=null},l.prototype.getLength=function(){var e=this,t=this.instance.getSettings().maxRows,n=void 0;n=t<0||0===t?0:t||1/0;var r=this.instance.countSourceRows();if(this.instance.hasHook("modifyRow")){var i=this.skipCache;this.interval.start(),r!==this.latestSourceRowsCount&&(i=!0),this.latestSourceRowsCount=r,null===this.cachedLength||i?((0,u.rangeEach)(r-1,function(t){null===e.instance.runHooks("modifyRow",t)&&(r-=1)}),this.cachedLength=r):r=this.cachedLength}else this.interval.stop();return Math.min(r,n)},l.prototype.getAll=function(){var t={row:0,col:0},e={row:Math.max(this.instance.countSourceRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return t.row-e.row!=0||this.instance.countSourceRows()?this.getRange(t,e,l.prototype.DESTINATION_RENDERER):[]},l.prototype.getRange=function(t,e,n){var r=[],i=void 0,o=void 0,a=void 0,s=this.instance.getSettings().maxRows,l=this.instance.getSettings().maxCols;if(0===s||0===l)return[];var u=n===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(s-1,0),Math.max(t.row,e.row)),c=Math.min(Math.max(l-1,0),Math.max(t.col,e.col));for(i=Math.min(t.row,e.row);i<=h;i++){a=[];var d=this.instance.runHooks("modifyRow",i);for(o=Math.min(t.col,e.col);o<=c&&null!==d;o++)a.push(u.call(this,i,this.colToProp(o)));null!==d&&r.push(a)}return r},l.prototype.getText=function(t,e){return r.default.stringify(this.getRange(t,e,this.DESTINATION_RENDERER))},l.prototype.getCopyableText=function(t,e){return r.default.stringify(this.getRange(t,e,this.DESTINATION_CLIPBOARD_GENERATOR))},l.prototype.onSkipLengthCache=function(t){var e=this;this.skipCache=!0,setTimeout(function(){e.skipCache=!1},t)},l.prototype.destroy=function(){this.interval.stop(),this.interval=null,this.instance=null,this.priv=null,this.GridSettings=null,this.dataSource=null,this.cachedLength=null,this.duckSchema=null},e.default=l},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.parseDelay=l;var o=n(43);var a=(r(s,null,[{key:"create",value:function(t,e){return new s(t,e)}}]),r(s,[{key:"start",value:function(){return this.stopped&&(this._then=Date.now(),this.stopped=!1,this.timer=(0,o.requestAnimationFrame)(this._callback)),this}},{key:"stop",value:function(){return this.stopped||(this.stopped=!0,(0,o.cancelAnimationFrame)(this.timer),this.timer=null),this}},{key:"__callback",value:function(){if(this.timer=(0,o.requestAnimationFrame)(this._callback),this.delay){var t=Date.now(),e=t-this._then;e>this.delay&&(this._then=t-e%this.delay,this.func())}else this.func()}}]),s);function s(t,e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),this.timer=null,this.func=t,this.delay=l(e),this.stopped=!0,this._then=null,this._callback=function(){return n.__callback()}}function l(t){var e=t;return"string"==typeof e&&/fps$/.test(e)&&(e=1e3/parseInt(e.replace("fps","")||0,10)),e}e.default=a},function(t,e,n){"use strict";e.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.default=function(){var n={arrayMap:[],weakMap:new WeakMap};return{get:function(t){return r(t)?n.arrayMap[t]:i(t)?n.weakMap.get(t):void 0},set:function(t,e){if(r(t))n.arrayMap[t]=e;else{if(!i(t))throw new Error("Invalid key type");n.weakMap.set(t,e)}},delete:function(t){r(t)?delete n.arrayMap[t]:i(t)&&n.weakMap.delete(t)}};function r(t){return null!==t&&!function(t){return t!=t}(t)&&("string"==typeof t||"number"==typeof t)}function i(t){return null!==t&&("object"===(void 0===t?"undefined":o(t))||"function"==typeof t)}}},function(t,e,n){"use strict";e.__esModule=!0;var r,d=n(9),f=n(18),p=n(12),g=n(19),i=n(8),v=(r=i)&&r.__esModule?r:{default:r},m=n(64);function o(s,i,o){var l=this,t=new v.default(s),a=!1,u=!1,h=void 0;function c(t){var e="function"==typeof i.settings.enterMoves?i.settings.enterMoves(event):i.settings.enterMoves;t?o.transformStart(-e.row,-e.col):o.transformStart(e.row,e.col,!0)}function e(t){if(s.isListening()&&(s.runHooks("beforeKeyDown",t),!a&&229!==t.keyCode&&!(0,p.isImmediatePropagationStopped)(t)&&(i.lastKeyCode=t.keyCode,o.isSelected()))){var e=(t.ctrlKey||t.metaKey)&&!t.altKey;if(!h||h.isWaiting()||(0,f.isMetaKey)(t.keyCode)||(0,f.isCtrlMetaKey)(t.keyCode)||e||l.isEditorOpened()){var n=t.shiftKey?o.setRangeEnd:o.setRangeStart,r=void 0;switch(t.keyCode){case f.KEY_CODES.A:!l.isEditorOpened()&&e&&(s.selectAll(),t.preventDefault(),(0,p.stopPropagation)(t));break;case f.KEY_CODES.ARROW_UP:l.isEditorOpened()&&!h.isWaiting()&&l.closeEditorAndSaveChanges(e),function(t){t?o.transformEnd(-1,0):o.transformStart(-1,0)}(t.shiftKey),t.preventDefault(),(0,p.stopPropagation)(t);break;case f.KEY_CODES.ARROW_DOWN:l.isEditorOpened()&&!h.isWaiting()&&l.closeEditorAndSaveChanges(e),function(t){t?o.transformEnd(1,0):o.transformStart(1,0)}(t.shiftKey),t.preventDefault(),(0,p.stopPropagation)(t);break;case f.KEY_CODES.ARROW_RIGHT:l.isEditorOpened()&&!h.isWaiting()&&l.closeEditorAndSaveChanges(e),function(t){t?o.transformEnd(0,1):o.transformStart(0,1)}(t.shiftKey),t.preventDefault(),(0,p.stopPropagation)(t);break;case f.KEY_CODES.ARROW_LEFT:l.isEditorOpened()&&!h.isWaiting()&&l.closeEditorAndSaveChanges(e),function(t){t?o.transformEnd(0,-1):o.transformStart(0,-1)}(t.shiftKey),t.preventDefault(),(0,p.stopPropagation)(t);break;case f.KEY_CODES.TAB:r="function"==typeof i.settings.tabMoves?i.settings.tabMoves(t):i.settings.tabMoves,t.shiftKey?o.transformStart(-r.row,-r.col):o.transformStart(r.row,r.col,!0),t.preventDefault(),(0,p.stopPropagation)(t);break;case f.KEY_CODES.BACKSPACE:case f.KEY_CODES.DELETE:s.emptySelectedCells(),l.prepareEditor(),t.preventDefault();break;case f.KEY_CODES.F2:h&&h.enableFullEditMode(),l.openEditor(null,t),t.preventDefault();break;case f.KEY_CODES.ENTER:l.isEditorOpened()?(h&&h.state!==m.EditorState.WAITING&&l.closeEditorAndSaveChanges(e),c(t.shiftKey)):s.getSettings().enterBeginsEditing?(h&&h.enableFullEditMode(),l.openEditor(null,t)):c(t.shiftKey),t.preventDefault(),(0,p.stopImmediatePropagation)(t);break;case f.KEY_CODES.ESCAPE:l.isEditorOpened()&&(l.closeEditorAndRestoreOriginalValue(e),h.focus()),t.preventDefault();break;case f.KEY_CODES.HOME:t.ctrlKey||t.metaKey?n.call(o,new d.CellCoords(0,o.selectedRange.current().from.col)):n.call(o,new d.CellCoords(o.selectedRange.current().from.row,0)),t.preventDefault(),(0,p.stopPropagation)(t);break;case f.KEY_CODES.END:t.ctrlKey||t.metaKey?n.call(o,new d.CellCoords(s.countRows()-1,o.selectedRange.current().from.col)):n.call(o,new d.CellCoords(o.selectedRange.current().from.row,s.countCols()-1)),t.preventDefault(),(0,p.stopPropagation)(t);break;case f.KEY_CODES.PAGE_UP:o.transformStart(-s.countVisibleRows(),0),t.preventDefault(),(0,p.stopPropagation)(t);break;case f.KEY_CODES.PAGE_DOWN:o.transformStart(s.countVisibleRows(),0),t.preventDefault(),(0,p.stopPropagation)(t)}}else l.openEditor("",t)}}this.lockEditor=function(){u=!0},this.unlockEditor=function(){u=!1},this.destroyEditor=function(t){u||this.closeEditor(t)},this.getActiveEditor=function(){return h},this.prepareEditor=function(){if(!u)if(h&&h.isWaiting())this.closeEditor(!1,!1,function(t){t&&l.prepareEditor()});else{var t=s.selection.selectedRange.current().highlight.row,e=s.selection.selectedRange.current().highlight.col,n=s.colToProp(e),r=s.getCell(t,e),i=s.getSourceDataAtCell(s.runHooks("modifyRow",t),e),o=s.getCellMeta(t,e),a=s.getCellEditor(o);a?(h=(0,g.getEditorInstance)(a,s)).prepare(t,e,n,r,i,o):h=void 0}},this.isEditorOpened=function(){return h&&h.isOpened()},this.openEditor=function(t,e){h&&(h.cellProperties.readOnly?e&&e.keyCode===f.KEY_CODES.ENTER&&c():h.beginEditing(t,e))},this.closeEditor=function(t,e,n){h?h.finishEditing(t,e,n):n&&n(!1)},this.closeEditorAndSaveChanges=function(t){return this.closeEditor(!1,t)},this.closeEditorAndRestoreOriginalValue=function(t){return this.closeEditor(!0,t)},this.destroy=function(){a=!0},s.addHook("afterDocumentKeyDown",e),t.addEventListener(document.documentElement,"keydown",function(t){a||s.runHooks("afterDocumentKeyDown",t)}),t.addEventListener(document.documentElement,"compositionstart",function(t){!a&&h&&!h.isOpened()&&s.isListening()&&l.openEditor("",t)}),s.view.wt.update("onCellDblClick",function(t,e,n){"TD"===n.nodeName&&(h&&h.enableFullEditMode(),l.openEditor(null,t))})}var a=new WeakMap;o.getInstance=function(t,e,n,r){var i=a.get(t);return i||(i=new o(t,e,n,r),a.set(t,i)),i},e.default=o},function(t,e,n){"use strict";e.__esModule=!0;var a=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},u=n(2),i=r(n(8)),o=n(12),h=r(n(9)),c=n(212);function r(t){return t&&t.__esModule?t:{default:t}}function d(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}function s(a){var e=this,s=this;this.eventManager=new i.default(a),this.instance=a,this.settings=a.getSettings(),this.selectionMouseDown=!1;var t=a.rootElement.getAttribute("style");t&&a.rootElement.setAttribute("data-originalstyle",t),(0,u.addClass)(a.rootElement,"handsontable");var n=document.createElement("TABLE");(0,u.addClass)(n,"htCore"),a.getSettings().tableClassName&&(0,u.addClass)(n,a.getSettings().tableClassName),this.THEAD=document.createElement("THEAD"),n.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),n.appendChild(this.TBODY),a.table=n,a.container.insertBefore(n,a.container.firstChild),this.eventManager.addEventListener(a.rootElement,"mousedown",function(t){e.selectionMouseDown=!0,s.isTextSelectionAllowed(t.target)||(d(),t.preventDefault(),window.focus())}),this.eventManager.addEventListener(a.rootElement,"mouseup",function(){e.selectionMouseDown=!1}),this.eventManager.addEventListener(a.rootElement,"mousemove",function(t){e.selectionMouseDown&&!s.isTextSelectionAllowed(t.target)&&(e.settings.fragmentSelection&&d(),t.preventDefault())}),this.eventManager.addEventListener(document.documentElement,"keyup",function(t){a.selection.isInProgress()&&!t.shiftKey&&a.selection.finish()});var l=void 0;this.isMouseDown=function(){return l},this.eventManager.addEventListener(document.documentElement,"mouseup",function(t){a.selection.isInProgress()&&(0,o.isLeftClick)(t)&&a.selection.finish(),l=!1,!(0,u.isOutsideInput)(document.activeElement)&&(a.selection.isSelected()||(0,o.isRightClick)(t))||a.unlisten()}),this.eventManager.addEventListener(document.documentElement,"contextmenu",function(t){a.selection.isInProgress()&&(0,o.isRightClick)(t)&&(a.selection.finish(),l=!1)}),this.eventManager.addEventListener(document.documentElement,"touchend",function(){a.selection.isInProgress()&&a.selection.finish()}),this.eventManager.addEventListener(document.documentElement,"mousedown",function(t){var e=t.target,n=t.x||t.clientX,r=t.y||t.clientY,i=t.target;if(!l&&a.rootElement){if(i===a.view.wt.wtTable.holder){var o=(0,u.getScrollbarWidth)();if(document.elementFromPoint(n+o,r)!==a.view.wt.wtTable.holder||document.elementFromPoint(n,r+o)!==a.view.wt.wtTable.holder)return}else for(;i!==document.documentElement;){if(null===i){if(t.isTargetWebComponent)break;return}if(i===a.rootElement)return;i=i.parentNode}("function"==typeof s.settings.outsideClickDeselects?s.settings.outsideClickDeselects(e):s.settings.outsideClickDeselects)?a.deselectCell():a.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n,"selectstart",function(t){s.settings.fragmentSelection||(0,u.isInput)(t.target)||t.preventDefault()});var r={debug:function(){return s.settings.debug},externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n,preventOverflow:function(){return e.settings.preventOverflow},stretchH:function(){return s.settings.stretchH},data:a.getDataAtCell,totalRows:function(){return a.countRows()},totalColumns:function(){return a.countCols()},fixedColumnsLeft:function(){return s.settings.fixedColumnsLeft},fixedRowsTop:function(){return s.settings.fixedRowsTop},fixedRowsBottom:function(){return s.settings.fixedRowsBottom},minSpareRows:function(){return s.settings.minSpareRows},renderAllRows:s.settings.renderAllRows,rowHeaders:function(){var t=[];return a.hasRowHeaders()&&t.push(function(t,e){return s.appendRowHeader(t,e)}),a.runHooks("afterGetRowHeaderRenderers",t),t},columnHeaders:function(){var t=[];return a.hasColHeaders()&&t.push(function(t,e){s.appendColHeader(t,e)}),a.runHooks("afterGetColumnHeaderRenderers",t),t},columnWidth:a.getColWidth,rowHeight:a.getRowHeight,cellRenderer:function(t,e,n){var r=s.instance.getCellMeta(t,e),i=s.instance.colToProp(e),o=s.instance.getDataAtRowProp(t,i);s.instance.hasHook("beforeValueRender")&&(o=s.instance.runHooks("beforeValueRender",o,r)),s.instance.runHooks("beforeRenderer",n,t,e,i,o,r),s.instance.getCellRenderer(r)(s.instance,n,t,e,i,o,r),s.instance.runHooks("afterRenderer",n,t,e,i,o,r)},selections:s.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return s.settings.fragmentSelection},onCellMouseDown:function(t,e,n,r){var i={row:!1,column:!1,cell:!1};a.listen(),s.activeWt=r,l=!0,a.runHooks("beforeOnCellMouseDown",t,e,n,i),(0,o.isImmediatePropagationStopped)(t)||((0,c.handleMouseEvent)(t,{coords:e,selection:a.selection,controller:i}),a.runHooks("afterOnCellMouseDown",t,e,n),s.activeWt=s.wt)},onCellContextMenu:function(t,e,n,r){s.activeWt=r,l=!1,a.selection.isInProgress()&&a.selection.finish(),a.runHooks("beforeOnCellContextMenu",t,e,n),(0,o.isImmediatePropagationStopped)(t)||(a.runHooks("afterOnCellContextMenu",t,e,n),s.activeWt=s.wt)},onCellMouseOut:function(t,e,n,r){s.activeWt=r,a.runHooks("beforeOnCellMouseOut",t,e,n),(0,o.isImmediatePropagationStopped)(t)||(a.runHooks("afterOnCellMouseOut",t,e,n),s.activeWt=s.wt)},onCellMouseOver:function(t,e,n,r){var i={row:!1,column:!1,cell:!1};s.activeWt=r,a.runHooks("beforeOnCellMouseOver",t,e,n,i),(0,o.isImmediatePropagationStopped)(t)||(l&&(0,c.handleMouseEvent)(t,{coords:e,selection:a.selection,controller:i}),a.runHooks("afterOnCellMouseOver",t,e,n),s.activeWt=s.wt)},onCellMouseUp:function(t,e,n,r){s.activeWt=r,a.runHooks("beforeOnCellMouseUp",t,e,n),a.runHooks("afterOnCellMouseUp",t,e,n),s.activeWt=s.wt},onCellCornerMouseDown:function(t){t.preventDefault(),a.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(t){t.preventDefault(),a.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:function(t,e){s.beforeRender(t,e)},onDraw:function(t){s.onDraw(t)},onScrollVertically:function(){a.runHooks("afterScrollVertically")},onScrollHorizontally:function(){a.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return a.runHooks("beforeRemoveCellClassNames")},onAfterDrawSelection:function(t,e,n,r){return a.runHooks("afterDrawSelection",t,e,n,r)},onBeforeDrawBorders:function(t,e){a.runHooks("beforeDrawBorders",t,e)},onBeforeTouchScroll:function(){a.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){a.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(t,e){return a.runHooks("beforeStretchingColumnWidth",t,e)},onModifyRowHeaderWidth:function(t){return a.runHooks("modifyRowHeaderWidth",t)},onModifyGetCellCoords:function(t,e,n){return a.runHooks("modifyGetCellCoords",t,e,n)},viewportRowCalculatorOverride:function(t){var e=a.countRows(),n=s.settings.viewportRowRenderingOffset;if("auto"===n&&s.settings.fixedRowsTop&&(n=10),"number"==typeof n&&(t.startRow=Math.max(t.startRow-n,0),t.endRow=Math.min(t.endRow+n,e-1)),"auto"===n){var r=t.startRow+t.endRow-t.startRow,i=Math.ceil(r/e*12);t.startRow=Math.max(t.startRow-i,0),t.endRow=Math.min(t.endRow+i,e-1)}a.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:function(t){var e=a.countCols(),n=s.settings.viewportColumnRenderingOffset;if("auto"===n&&s.settings.fixedColumnsLeft&&(n=10),"number"==typeof n&&(t.startColumn=Math.max(t.startColumn-n,0),t.endColumn=Math.min(t.endColumn+n,e-1)),"auto"===n){var r=t.startColumn+t.endColumn-t.startColumn,i=Math.ceil(r/e*12);t.startRow=Math.max(t.startColumn-i,0),t.endColumn=Math.min(t.endColumn+i,e-1)}a.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:function(){return s.settings.rowHeaderWidth},columnHeaderHeight:function(){var t=a.runHooks("modifyColumnHeaderHeight");return s.settings.columnHeaderHeight||t}};a.runHooks("beforeInitWalkontable",r),this.wt=new h.default(r),this.activeWt=this.wt,this.eventManager.addEventListener(s.wt.wtTable.spreader,"mousedown",function(t){t.target===s.wt.wtTable.spreader&&3===t.which&&(0,o.stopPropagation)(t)}),this.eventManager.addEventListener(s.wt.wtTable.spreader,"contextmenu",function(t){t.target===s.wt.wtTable.spreader&&3===t.which&&(0,o.stopPropagation)(t)}),this.eventManager.addEventListener(document.documentElement,"click",function(){s.settings.observeDOMVisibility&&s.wt.drawInterrupted&&(s.instance.forceFullRender=!0,s.render())})}s.prototype.isTextSelectionAllowed=function(t){if((0,u.isInput)(t))return!0;var e=(0,u.isChildOf)(t,this.instance.view.wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))},s.prototype.isSelectedOnlyCell=function(){var t=this.instance.getSelectedLast()||[],e=a(t,4),n=e[0],r=e[1],i=e[2],o=e[3];return void 0!==n&&n===i&&r===o},s.prototype.isCellEdited=function(){var t=this.instance.getActiveEditor();return t&&t.isOpened()},s.prototype.beforeRender=function(t,e){t&&this.instance.runHooks("beforeRender",this.instance.forceFullRender,e)},s.prototype.onDraw=function(t){t&&this.instance.runHooks("afterRender",this.instance.forceFullRender)},s.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1},s.prototype.getCellAtCoords=function(t,e){var n=this.wt.getCell(t,e);return n<0?null:n},s.prototype.scrollViewport=function(t,e,n,r,i){return this.wt.scrollViewport(t,e,n,r,i)},s.prototype.scrollViewportHorizontally=function(t,e,n){return this.wt.scrollViewportHorizontally(t,e,n)},s.prototype.scrollViewportVertically=function(t,e,n){return this.wt.scrollViewportVertically(t,e,n)},s.prototype.appendRowHeader=function(t,e){if(e.firstChild){var n=e.firstChild;if(!(0,u.hasClass)(n,"relative"))return(0,u.empty)(e),void this.appendRowHeader(t,e);this.updateCellHeader(n.querySelector(".rowHeader"),t,this.instance.getRowHeader)}else{var r=document.createElement("div"),i=document.createElement("span");r.className="relative",i.className="rowHeader",this.updateCellHeader(i,t,this.instance.getRowHeader),r.appendChild(i),e.appendChild(r)}this.instance.runHooks("afterGetRowHeader",t,e)},s.prototype.appendColHeader=function(t,e){if(e.firstChild){var n=e.firstChild;(0,u.hasClass)(n,"relative")?this.updateCellHeader(n.querySelector(".colHeader"),t,this.instance.getColHeader):((0,u.empty)(e),this.appendColHeader(t,e))}else{var r=document.createElement("div"),i=document.createElement("span");r.className="relative",i.className="colHeader",this.updateCellHeader(i,t,this.instance.getColHeader),r.appendChild(i),e.appendChild(r)}this.instance.runHooks("afterGetColHeader",t,e)},s.prototype.updateCellHeader=function(t,e,n){var r=e,i=this.wt.wtOverlays.getParentOverlay(t)||this.wt;t.parentNode&&((0,u.hasClass)(t,"colHeader")?r=i.wtTable.columnFilter.sourceToRendered(e):(0,u.hasClass)(t,"rowHeader")&&(r=i.wtTable.rowFilter.sourceToRendered(e))),-1<r?(0,u.fastInnerHTML)(t,n(e)):((0,u.fastInnerText)(t,String.fromCharCode(160)),(0,u.addClass)(t,"cornerHeader"))},s.prototype.maximumVisibleElementWidth=function(t){var e=this.wt.wtViewport.getWorkspaceWidth()-t;return 0<e?e:0},s.prototype.maximumVisibleElementHeight=function(t){var e=this.wt.wtViewport.getWorkspaceHeight()-t;return 0<e?e:0},s.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},s.prototype.destroy=function(){this.wt.destroy(),this.eventManager.destroy()},e.default=s},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=n(1),s=n(0),h=n(4);var o=(r(l,[{key:"getData",value:function(t){var e=0<arguments.length&&void 0!==t&&t,n=this.data;return e&&(n=this.getByRange({row:0,col:0},{row:Math.max(this.countRows()-1,0),col:Math.max(this.countColumns()-1,0)},!0)),n}},{key:"setData",value:function(t){this.data=t}},{key:"getAtColumn",value:function(r){var i=this,o=[];return(0,s.arrayEach)(this.data,function(t){var e=i.colToProp(r),n=void 0;n="string"==typeof e?(0,a.getProperty)(t,e):"function"==typeof e?e(t):t[e],o.push(n)}),o}},{key:"getAtRow",value:function(t){return this.data[t]}},{key:"getAtCell",value:function(t,e){var n=null,r=this.hot.runHooks("modifyRowData",t),i=isNaN(r)?r:this.data[t];if(i){var o=this.colToProp(e);n="string"==typeof o?(0,a.getProperty)(i,o):"function"==typeof o?o(this.data.slice(t,t+1)[0]):i[o]}return n}},{key:"getByRange",value:function(t,e,n){var i=this,o=2<arguments.length&&void 0!==n&&n,r=Math.min(t.row,e.row),a=Math.min(t.col,e.col),s=Math.max(t.row,e.row),l=Math.max(t.col,e.col),u=[];return(0,h.rangeEach)(r,s,function(t){var n=i.getAtRow(t),r=void 0;"array"===i.dataType?r=n.slice(a,l+1):"object"===i.dataType&&(r=o?[]:{},(0,h.rangeEach)(a,l,function(t){var e=i.colToProp(t);o?r.push(n[e]):r[e]=n[e]})),u.push(r)}),u}},{key:"countRows",value:function(){return Array.isArray(this.data)?this.data.length:0}},{key:"countColumns",value:function(){var t=0;return Array.isArray(this.data)&&("array"===this.dataType?t=this.data[0].length:"object"===this.dataType&&(t=Object.keys(this.data[0]).length)),t}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),l);function l(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),this.hot=t,this.data=e,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}e.default=o},function(t,e,n){"use strict";var r;e.__esModule=!0;var i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3));function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a=(o(r={languageCode:"en-US"},i.CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),o(r,i.CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),o(r,i.CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),o(r,i.CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),o(r,i.CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),o(r,i.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),o(r,i.CONTEXTMENU_ITEMS_UNDO,"Undo"),o(r,i.CONTEXTMENU_ITEMS_REDO,"Redo"),o(r,i.CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),o(r,i.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),o(r,i.CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),o(r,i.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),o(r,i.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),o(r,i.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),o(r,i.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),o(r,i.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),o(r,i.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),o(r,i.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),o(r,i.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),o(r,i.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),o(r,i.CONTEXTMENU_ITEMS_BORDERS,"Borders"),o(r,i.CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),o(r,i.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),o(r,i.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),o(r,i.CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),o(r,i.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),o(r,i.CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),o(r,i.CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),o(r,i.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),o(r,i.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),o(r,i.CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),o(r,i.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),o(r,i.CONTEXTMENU_ITEMS_COPY,"Copy"),o(r,i.CONTEXTMENU_ITEMS_CUT,"Cut"),o(r,i.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),o(r,i.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),o(r,i.CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),o(r,i.CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),o(r,i.CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),o(r,i.CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),o(r,i.FILTERS_CONDITIONS_NONE,"None"),o(r,i.FILTERS_CONDITIONS_EMPTY,"Is empty"),o(r,i.FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),o(r,i.FILTERS_CONDITIONS_EQUAL,"Is equal to"),o(r,i.FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),o(r,i.FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),o(r,i.FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),o(r,i.FILTERS_CONDITIONS_CONTAINS,"Contains"),o(r,i.FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),o(r,i.FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),o(r,i.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),o(r,i.FILTERS_CONDITIONS_LESS_THAN,"Less than"),o(r,i.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),o(r,i.FILTERS_CONDITIONS_BETWEEN,"Is between"),o(r,i.FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),o(r,i.FILTERS_CONDITIONS_AFTER,"After"),o(r,i.FILTERS_CONDITIONS_BEFORE,"Before"),o(r,i.FILTERS_CONDITIONS_TODAY,"Today"),o(r,i.FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),o(r,i.FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),o(r,i.FILTERS_VALUES_BLANK_CELLS,"Blank cells"),o(r,i.FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),o(r,i.FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),o(r,i.FILTERS_LABELS_CONJUNCTION,"And"),o(r,i.FILTERS_LABELS_DISJUNCTION,"Or"),o(r,i.FILTERS_BUTTONS_SELECT_ALL,"Select all"),o(r,i.FILTERS_BUTTONS_CLEAR,"Clear"),o(r,i.FILTERS_BUTTONS_OK,"OK"),o(r,i.FILTERS_BUTTONS_CANCEL,"Cancel"),o(r,i.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),o(r,i.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),o(r,i.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),r);e.default=a},function(t,e,n){"use strict";e.__esModule=!0,e.getPhraseFormatters=e.registerPhraseFormatter=void 0,e.register=u,e.getAll=h;var r=o(n(41)),i=o(n(307));function o(t){return t&&t.__esModule?t:{default:t}}var a=(0,r.default)("phraseFormatters"),s=a.register,l=a.getValues;function u(t,e){s(t,e)}function h(){return l()}e.registerPhraseFormatter=u,e.getPhraseFormatters=h,u("pluralize",i.default)},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){if(Array.isArray(t)&&Number.isInteger(e))return t[e];return t}},function(t,e,n){"use strict";e.__esModule=!0,e.createHighlight=void 0;var r=h(n(41)),i=h(n(309)),o=h(n(310)),a=h(n(311)),s=h(n(312)),l=h(n(313)),u=h(n(314));function h(t){return t&&t.__esModule?t:{default:t}}var c=(0,r.default)("highlight/types"),d=c.register,f=c.getItem;d("active-header",i.default),d("area",o.default),d("cell",a.default),d("custom-selection",s.default),d("fill",l.default),d("header",u.default),e.createHighlight=function(t,e){return f(t)(e)}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(9);e.default=function(t){var e=t.activeHeaderClassName;return new r.Selection({highlightHeaderClassName:e})}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(9);e.default=function(t){var e=t.layerLevel,n=t.areaCornerVisible;return new r.Selection({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:n}})}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(9);e.default=function(t){var e=t.cellCornerVisible;return new r.Selection({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e}})}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(9);e.default=function(t){var e=t.border,n=t.cellRange;return new r.Selection(e,n)}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(9);e.default=function(){return new r.Selection({className:"fill",border:{width:1,color:"#ff0000"}})}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(9);e.default=function(t){var e=t.headerClassName,n=t.rowClassName,r=t.columnClassName;return new i.Selection({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:n,highlightColumnClassName:r})}},function(t,e,n){"use strict";e.__esModule=!0;var c=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a,d=(o=["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]]) \n        or as an array of CellRange objects."],a=["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]]) \n        or as an array of CellRange objects."],Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(a)}}))),s=n(218),l=C(s),u=C(n(316)),f=n(9),h=n(86),p=n(1),g=n(10),v=n(0),m=C(n(20)),y=C(n(317)),w=n(87),b=n(25);function C(t){return t&&t.__esModule?t:{default:t}}var E=(r(S,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(t,e,n){var r=2<arguments.length&&void 0!==n&&n,i="multiple"===this.settings.selectionMode,o=(0,g.isUndefined)(e)?(0,h.isPressedCtrlKey)():e,a=t.row<0,s=t.col<0,l=a&&s;a&&(t.row=0),s&&(t.col=0),this.selectedByCorner=l,this.runLocalHooks("beforeSetRangeStart"+(r?"Only":""),t),(!i||i&&!o&&(0,g.isUndefined)(e))&&this.selectedRange.clear(),this.selectedRange.add(t),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!l&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!l&&a&&this.selectedByColumnHeader.add(this.getLayerLevel()),r||this.setRangeEnd(t)}},{key:"setRangeStartOnly",value:function(t,e){this.setRangeStart(t,e,!0)}},{key:"setRangeEnd",value:function(t){if(!this.selectedRange.isEmpty()){this.runLocalHooks("beforeSetRangeEnd",t),this.begin();var e=this.selectedRange.current();"single"!==this.settings.selectionMode&&e.setTo(new f.CellCoords(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(s.CELL_TYPE)&&this.highlight.getCell().add(this.selectedRange.current().highlight);var n=this.getLayerLevel();n<this.highlight.layerLevel&&((0,v.arrayEach)(this.highlight.getAreas(),function(t){t.clear()}),(0,v.arrayEach)(this.highlight.getHeaders(),function(t){t.clear()}),(0,v.arrayEach)(this.highlight.getActiveHeaders(),function(t){t.clear()})),this.highlight.useLayerLevel(n);var r=this.highlight.createOrGetArea(),i=this.highlight.createOrGetHeader(),o=this.highlight.createOrGetActiveHeader();r.clear(),i.clear(),o.clear(),this.highlight.isEnabledFor(s.AREA_TYPE)&&(this.isMultiple()||1<=n)&&(r.add(e.from).add(e.to),1===n&&(this.highlight.useLayerLevel(n-1).createOrGetArea().add(this.selectedRange.previous().from),this.highlight.useLayerLevel(n))),this.highlight.isEnabledFor(s.HEADER_TYPE)&&("single"===this.settings.selectionMode?i.add(e.highlight):i.add(e.from).add(e.to)),!this.isSelectedByRowHeader()||this.tableProps.countCols()===e.getWidth()&&o.add(new f.CellCoords(e.from.row,-1)).add(new f.CellCoords(e.to.row,-1)),this.isSelectedByColumnHeader()&&this.tableProps.countRows()===e.getHeight()&&o.add(new f.CellCoords(-1,e.from.col)).add(new f.CellCoords(-1,e.to.col)),this.runLocalHooks("afterSetRangeEnd",t)}}},{key:"isMultiple",value:function(){var t=(0,p.createObjectPropListener)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}},{key:"transformStart",value:function(t,e,n){this.setRangeStart(this.transformation.transformStart(t,e,n))}},{key:"transformEnd",value:function(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(t){var e=0<arguments.length&&void 0!==t?t:this.getLayerLevel();return-1===e?0<this.selectedByRowHeader.size:this.selectedByRowHeader.has(e)}},{key:"isSelectedByColumnHeader",value:function(t){var e=0<arguments.length&&void 0!==t?t:this.getLayerLevel();return-1===e?0<this.selectedByColumnHeader.size:this.selectedByColumnHeader.has(e)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(t){return this.selectedRange.includes(t)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){this.clear(),this.setRangeStart(new f.CellCoords(-1,-1)),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(new f.CellCoords(this.tableProps.countRows()-1,this.tableProps.countCols()-1))}},{key:"selectCells",value:function(t){var s=this,e=(0,w.detectSelectionType)(t);if(e===w.SELECTION_TYPE_EMPTY)return!1;if(e===w.SELECTION_TYPE_UNRECOGNIZED)throw new Error((0,b.toSingleLine)(d));var l=(0,w.normalizeSelectionFactory)(e,{propToCol:function(t){return s.tableProps.propToCol(t)},keepDirection:!0}),u=this.tableProps.countRows(),h=this.tableProps.countCols(),n=!t.some(function(t){var e=l(t),n=c(e,4),r=n[0],i=n[1],o=n[2],a=n[3];return!((0,w.isValidCoord)(r,u)&&(0,w.isValidCoord)(i,h)&&(0,w.isValidCoord)(o,u)&&(0,w.isValidCoord)(a,h))});return n&&(this.clear(),(0,v.arrayEach)(t,function(t){var e=l(t),n=c(e,4),r=n[0],i=n[1],o=n[2],a=n[3];s.setRangeStartOnly(new f.CellCoords(r,i),!1),s.setRangeEnd(new f.CellCoords(o,a)),s.finish()})),n}},{key:"selectColumns",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:t,r="string"==typeof t?this.tableProps.propToCol(t):t,i="string"==typeof n?this.tableProps.propToCol(n):n,o=this.tableProps.countCols(),a=(0,w.isValidCoord)(r,o)&&(0,w.isValidCoord)(i,o);return a&&(this.setRangeStartOnly(new f.CellCoords(-1,r)),this.setRangeEnd(new f.CellCoords(this.tableProps.countRows()-1,i)),this.finish()),a}},{key:"selectRows",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:t,r=this.tableProps.countRows(),i=(0,w.isValidCoord)(t,r)&&(0,w.isValidCoord)(n,r);return i&&(this.setRangeStartOnly(new f.CellCoords(t,-1)),this.setRangeEnd(new f.CellCoords(n,this.tableProps.countCols()-1)),this.finish()),i}}]),S);function S(t,e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,S),this.settings=t,this.tableProps=e,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new u.default,this.highlight=new l.default({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disableHighlight:this.settings.disableVisualSelection,cellCornerVisible:function(){return r.isCellCornerVisible.apply(r,arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible.apply(r,arguments)}}),this.transformation=new y.default(this.selectedRange,{countRows:function(){return r.tableProps.countRows()},countCols:function(){return r.tableProps.countCols()},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformStart"].concat(e))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformStart"].concat(e))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformEnd"].concat(e))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformEnd"].concat(e))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["insertRowRequire"].concat(e))}),this.transformation.addLocalHook("insertColRequire",function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["insertColRequire"].concat(e))})}(0,p.mixin)(E,m.default),e.default=E},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(9);var a=(r(s,[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(t){return this.clear(),this.ranges.push(new o.CellRange(t)),this}},{key:"add",value:function(t){return this.ranges.push(new o.CellRange(t)),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(e){return this.ranges.some(function(t){return t.includes(e)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(t){var e=0<arguments.length&&void 0!==t?t:0,n=this.size()+e-1,r=void 0;return 0<=n&&(r=this.ranges[n]),r}},{key:Symbol.iterator,value:function(){return this.ranges[Symbol.iterator]()}}]),s);function s(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),this.ranges=[]}e.default=a},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,g=n(9),a=n(1),s=n(20),l=(o=s)&&o.__esModule?o:{default:o};var u=(r(h,[{key:"transformStart",value:function(t,e,n){var r=new g.CellCoords(t,e);this.runLocalHooks("beforeTransformStart",r);var i=this.options.countRows(),o=this.options.countCols(),a=this.options.fixedRowsBottom(),s=this.options.minSpareRows(),l=this.options.minSpareCols(),u=this.options.autoWrapRow(),h=this.options.autoWrapCol(),c=this.range.current().highlight;c.row+t>i-1?n&&0<s&&!(a&&c.row>=i-a-1)?(this.runLocalHooks("insertRowRequire",i),i=this.options.countRows()):h&&(r.row=1-i,r.col=c.col+r.col===o-1?1-o:1):h&&c.row+r.row<0&&0<=c.col+r.col&&(r.row=i-1,r.col=c.col+r.col===0?o-1:-1),c.col+r.col>o-1?n&&0<l?(this.runLocalHooks("insertColRequire",o),o=this.options.countCols()):u&&(r.row=c.row+r.row===i-1?1-i:1,r.col=1-o):u&&c.col+r.col<0&&0<=c.row+r.row&&(r.row=c.row+r.row===0?i-1:-1,r.col=o-1);var d=new g.CellCoords(c.row+r.row,c.col+r.col),f=0,p=0;return d.row<0?(f=-1,d.row=0):0<d.row&&d.row>=i&&(f=1,d.row=i-1),d.col<0?(p=-1,d.col=0):0<d.col&&d.col>=o&&(p=1,d.col=o-1),this.runLocalHooks("afterTransformStart",d,f,p),d}},{key:"transformEnd",value:function(t,e){var n=new g.CellCoords(t,e);this.runLocalHooks("beforeTransformEnd",n);var r=this.options.countRows(),i=this.options.countCols(),o=this.range.current(),a=new g.CellCoords(o.to.row+n.row,o.to.col+n.col),s=0,l=0;return a.row<0?(s=-1,a.row=0):0<a.row&&a.row>=r&&(s=1,a.row=r-1),a.col<0?(l=-1,a.col=0):0<a.col&&a.col>=i&&(l=1,a.col=i-1),this.runLocalHooks("afterTransformEnd",a,s,l),a}}]),h);function h(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),this.range=t,this.options=e}(0,a.mixin)(u,l.default),e.default=u},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(u){var t="undefined"!=typeof window&&window.jQuery;if(!t)return;t.fn.handsontable=function(t){var e=this.first(),n=e.data("handsontable");if("string"!=typeof t){var r=t||{};return n?n.updateSettings(r):(n=new u.Core(e[0],r),e.data("handsontable",n),n.init()),e}var i=void 0;if(n){if(void 0===n[t])throw new Error("Handsontable do not provide action: "+t);for(var o,a=arguments.length,s=Array(1<a?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];i=(o=n[t]).call.apply(o,[n].concat(s)),"destroy"===t&&e.removeData()}return i}}},function(t,e,n){"use strict";e.__esModule=!0,e.Base=e.UndoRedo=e.TouchScroll=e.Search=e.PersistentState=e.ObserveChanges=e.MultipleSelectionHandles=e.MergeCells=e.ManualRowResize=e.ManualRowMove=e.ManualColumnResize=e.ManualColumnMove=e.ManualColumnFreeze=e.DragToScroll=e.CustomBorders=e.CopyPaste=e.ContextMenu=e.Comments=e.ColumnSorting=e.AutoRowSize=e.AutoFill=e.AutoColumnSize=void 0;var r=T(n(320)),i=T(n(322)),o=T(n(323)),a=T(n(325)),s=T(n(220)),l=T(n(336)),u=T(n(340)),h=T(n(354)),c=T(n(362)),d=T(n(369)),f=T(n(370)),p=T(n(374)),g=T(n(379)),v=T(n(380)),m=T(n(385)),y=T(n(386)),w=T(n(392)),b=T(n(393)),C=T(n(397)),E=T(n(398)),S=T(n(399)),O=T(n(7));function T(t){return t&&t.__esModule?t:{default:t}}e.AutoColumnSize=i.default,e.AutoFill=o.default,e.AutoRowSize=a.default,e.ColumnSorting=s.default,e.Comments=l.default,e.ContextMenu=u.default,e.CopyPaste=h.default,e.CustomBorders=c.default,e.DragToScroll=d.default,e.ManualColumnFreeze=f.default,e.ManualColumnMove=p.default,e.ManualColumnResize=g.default,e.ManualRowMove=v.default,e.ManualRowResize=m.default,e.MergeCells=y.default,e.MultipleSelectionHandles=w.default,e.ObserveChanges=b.default,e.PersistentState=r.default,e.Search=C.default,e.TouchScroll=E.default,e.UndoRedo=S.default,e.Base=O.default},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=h(n(7)),s=n(5),l=h(n(321)),u=h(n(17));function h(t){return t&&t.__esModule?t:{default:t}}u.default.getSingleton().register("persistentStateSave"),u.default.getSingleton().register("persistentStateLoad"),u.default.getSingleton().register("persistentStateReset");var c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(d,o.default),r(d,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().persistentState}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.storage||(this.storage=new l.default(this.hot.rootElement.id)),this.addHook("persistentStateSave",function(t,e){return n.saveValue(t,e)}),this.addHook("persistentStateLoad",function(t,e){return n.loadValue(t,e)}),this.addHook("persistentStateReset",function(){return n.resetValue()}),a(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,a(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),a(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(t,e){e.value=this.storage.loadValue(t)}},{key:"saveValue",value:function(t,e){this.storage.saveValue(t,e)}},{key:"resetValue",value:function(t){void 0===t?this.storage.resetAll():this.storage.reset(t)}},{key:"destroy",value:function(){a(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"destroy",this).call(this)}}]),d);function d(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,t));return e.storage=void 0,e}(0,s.registerPlugin)("persistentState",c),e.default=c},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(0);var a=(r(s,[{key:"saveValue",value:function(t,e){window.localStorage.setItem(this.prefix+"_"+t,JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}},{key:"loadValue",value:function(t,e){var n=void 0===t?e:t,r=window.localStorage.getItem(this.prefix+"_"+n);return null===r?void 0:JSON.parse(r)}},{key:"reset",value:function(t){window.localStorage.removeItem(this.prefix+"_"+t)}},{key:"resetAll",value:function(){var n=this;(0,o.arrayEach)(this.savedKeys,function(t,e){window.localStorage.removeItem(n.prefix+"_"+n.savedKeys[e])}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var t=window.localStorage.getItem(this.prefix+"__persistentStateKeys"),e="string"==typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}},{key:"saveSavedKeys",value:function(){window.localStorage.setItem(this.prefix+"__persistentStateKeys",JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),s);function s(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}e.default=a},function(t,e,n){"use strict";e.__esModule=!0;function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var u=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=y(n(7)),h=n(0),s=n(43),l=n(2),c=y(n(159)),d=n(1),f=n(4),p=n(5),g=y(n(219)),v=n(31),m=n(9);function y(t){return t&&t.__esModule?t:{default:t}}var w=new WeakMap,b=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(C,o.default),r(C,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r(C,[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings().autoColumnSize&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var t=this.hot.getSettings().autoColumnSize;t&&null!==t.useHeaders&&void 0!==t.useHeaders&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("beforeChange",function(t){return n.onBeforeChange(t)}),this.addHook("beforeRender",function(t){return n.onBeforeRender(t)}),this.addHook("modifyColWidth",function(t,e){return n.getColumnWidth(e,t)}),this.addHook("afterInit",function(){return n.onAfterInit()}),a(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.findColumnsWhereHeaderWasChanged();t.length&&this.clearCache(t),a(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){a(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"disablePlugin",this).call(this)}},{key:"calculateColumnsWidth",value:function(t,e,n){var r=0<arguments.length&&void 0!==t?t:{from:0,to:this.hot.countCols()-1},i=this,o=1<arguments.length&&void 0!==e?e:{from:0,to:this.hot.countRows()-1},a=2<arguments.length&&void 0!==n&&n,s="number"==typeof r?{from:r,to:r}:r,l="number"==typeof o?{from:o,to:o}:o;(0,f.rangeEach)(s.from,s.to,function(t){if(a||void 0===i.widths[t]&&!i.hot._getColWidthFromSettings(t)){var e=i.samplesGenerator.generateColumnSamples(t,l);(0,h.arrayEach)(e,function(t){var e=u(t,2),n=e[0],r=e[1];return i.ghostTable.addColumn(n,r)})}}),this.ghostTable.columns.length&&(this.ghostTable.getWidths(function(t,e){i.widths[t]=e}),this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(t){var e=this,n=0<arguments.length&&void 0!==t?t:{from:0,to:this.hot.countRows()-1},r=0,i=this.hot.countCols()-1,o=null;this.inProgress=!0;var a=this.getSyncCalculationLimit();this.firstCalculation&&0<=a&&(this.calculateColumnsWidth({from:0,to:a},n),this.firstCalculation=!1,r=a+1),r<i?function t(){if(!e.hot)return(0,s.cancelAnimationFrame)(o),void(e.inProgress=!1);e.calculateColumnsWidth({from:r,to:Math.min(r+C.CALCULATION_STEP,i)},n),(r=r+C.CALCULATION_STEP+1)<i?o=(0,s.requestAnimationFrame)(t):((0,s.cancelAnimationFrame)(o),e.inProgress=!1,e.hot.view.wt.wtOverlays.adjustElementsSize(!0),e.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&e.hot.view.wt.wtOverlays.leftOverlay.clone.draw())}():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings().autoColumnSize,e=t&&(0,d.hasOwnProperty)(t,"samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0,n=t&&(0,d.hasOwnProperty)(t,"allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&(0,l.isVisible)(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var t=C.SYNC_CALCULATION_LIMIT,e=this.hot.countCols()-1;return(0,d.isObject)(this.hot.getSettings().autoColumnSize)&&(t=this.hot.getSettings().autoColumnSize.syncLimit,(0,v.isPercentValue)(t)?t=(0,f.valueAccordingPercent)(e,t):t>>=0),Math.min(t,e)}},{key:"getColumnWidth",value:function(t,e,n){var r=!(2<arguments.length&&void 0!==n)||n,i=1<arguments.length&&void 0!==e?e:void 0;return void 0===i&&(i=this.widths[t],r&&"number"==typeof i&&(i=Math.max(i,m.ViewportColumnsCalculator.DEFAULT_WIDTH))),i}},{key:"getFirstVisibleColumn",value:function(){var t=this.hot.view.wt;return t.wtViewport.columnsVisibleCalculator?t.wtTable.getFirstVisibleColumn():t.wtViewport.columnsRenderCalculator?t.wtTable.getFirstRenderedColumn():-1}},{key:"getLastVisibleColumn",value:function(){var t=this.hot.view.wt;return t.wtViewport.columnsVisibleCalculator?t.wtTable.getLastVisibleColumn():t.wtViewport.columnsRenderCalculator?t.wtTable.getLastRenderedColumn():-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var t=this.hot.getColHeader(),i=w.get(this).cachedColumnHeaders;return(0,h.arrayReduce)(t,function(t,e,n){var r=i.length;return(r-1<n||i[n]!==e)&&t.push(n),r-1<n?i.push(e):i[n]=e,t},[])}},{key:"clearCache",value:function(t){var e=this,n=0<arguments.length&&void 0!==t?t:[];n.length?(0,h.arrayEach)(n,function(t){e.widths[t]=void 0}):this.widths.length=0}},{key:"isNeedRecalculate",value:function(){return!!(0,h.arrayFilter)(this.widths,function(t){return void 0===t}).length}},{key:"onBeforeRender",value:function(){var t=this.hot.renderCall;this.hot.countRows()&&(this.calculateColumnsWidth({from:this.getFirstVisibleColumn(),to:this.getLastVisibleColumn()},void 0,t),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth())}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){t.hot&&t.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(t){var n=this,e=(0,h.arrayMap)(t,function(t){var e=u(t,2)[1];return n.hot.propToCol(e)});this.clearCache(e)}},{key:"onBeforeColumnResize",value:function(t,e,n){var r=e;return n&&(this.calculateColumnsWidth(t,void 0,!0),r=this.getColumnWidth(t,void 0,!1)),r}},{key:"onAfterInit",value:function(){w.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"destroy",value:function(){this.ghostTable.clean(),a(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"destroy",this).call(this)}}]),C);function C(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,C);var u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,t));return w.set(u,{cachedColumnHeaders:[]}),u.widths=[],u.ghostTable=new c.default(u.hot),u.samplesGenerator=new g.default(function(t,e){var n=u.hot.getCellMeta(t,e),r="";n.spanned||(r=u.hot.getDataAtCell(t,e));var i=0;if(n.label){var o=n.label,a=o.value,s=o.property,l="";a?l="function"==typeof a?a(t,e,u.hot.colToProp(e),r):a:s&&(l=u.hot.getDataAtRowProp(t,s)),i=l.length}return{value:r,bundleCountSeed:i}}),u.firstCalculation=!0,u.inProgress=!1,u.addHook("beforeColumnResize",function(t,e,n){return u.onBeforeColumnResize(t,e,n)}),u}(0,p.registerPlugin)("autoColumnSize",b),e.default=b},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=d(n(7)),s=d(n(17)),l=n(2),u=d(n(8)),h=n(5),c=n(9),p=n(324);function d(t){return t&&t.__esModule?t:{default:t}}s.default.getSingleton().register("modifyAutofillRange"),s.default.getSingleton().register("beforeAutofill");var f=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(g,o.default),r(g,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(t){return n.onAfterCellCornerMouseDown(t)}),this.addHook("afterOnCellCornerDblClick",function(t){return n.onCellCornerDblClick(t)}),this.addHook("beforeOnCellMouseOver",function(t,e){return n.onBeforeCellMouseOver(e)}),a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var t={from:this.hot.getSelectedRangeLast().from,to:this.hot.getSelectedRangeLast().to};return this.hot.getData(t.from.row,t.from.col,t.to.row,t.to.col)}},{key:"fillIn",value:function(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;var t=this.hot.selection.highlight.getFill().getCorners();this.resetSelectionOfDraggedArea();var e=this.getCornersOfSelectedCells();t=this.hot.runHooks("modifyAutofillRange",t,e);var n=(0,p.getDragDirectionAndRange)(e,t),r=n.directionOfDrag,i=n.startOfDragCoords,o=n.endOfDragCoords;if(i&&-1<i.row&&-1<i.col){var a=this.getSelectionData();this.hot.runHooks("beforeAutofill",i,o,a);var s=(0,p.getDeltas)(i,o,a,r),l=a;if(-1<["up","left"].indexOf(r)){l=[];var u=null,h=null;if("up"===r){h=(u=o.row-i.row+1)%a.length;for(var c=0;c<u;c++)l.push(a[(c+(a.length-h))%a.length])}else{h=(u=o.col-i.col+1)%a[0].length;for(var d=0;d<a.length;d++){l.push([]);for(var f=0;f<u;f++)l[d].push(a[d][(f+(a[d].length-h))%a[d].length])}}}this.hot.populateFromArray(i.row,i.col,l,o.row,o.col,this.pluginName+".fill",null,r,s),this.setSelection(t)}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}},{key:"getCoordsOfDragAndDropBorders",value:function(t){var e=this.hot.getSelectedRangeLast().getTopLeftCorner(),n=this.hot.getSelectedRangeLast().getBottomRightCorner(),r=void 0;if(this.directions.includes(p.DIRECTIONS.vertical)&&(n.row<t.row||e.row>t.row))r=new c.CellCoords(t.row,n.col);else{if(!this.directions.includes(p.DIRECTIONS.horizontal))return;r=new c.CellCoords(n.row,t.col)}return this.reduceSelectionAreaIfNeeded(r)}},{key:"showBorder",value:function(t){var e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}},{key:"addRow",value:function(){var t=this;this.hot._registerTimeout(setTimeout(function(){t.hot.alter("insert_row",void 0,1,t.pluginName+".fill"),t.addingStarted=!1},200))}},{key:"addNewRowIfNeeded",value:function(){if(this.hot.selection.highlight.getFill().cellRange&&!1===this.addingStarted&&this.autoInsertRow){var t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getCorners(),n=this.hot.countRows();t[2]<n-1&&e[2]===n-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getCornersOfSelectedCells",value:function(){return this.hot.selection.isMultiple()?this.hot.selection.highlight.createOrGetArea().getCorners():this.hot.selection.highlight.getCell().getCorners()}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(t){for(var e=this.hot.getData(),n=this.hot.countRows(),r=void 0,i=t[2]+1;i<n;i++){for(var o=t[1];o<=t[3];o++)if(e[i][o])return-1;var a=e[i][t[1]-1],s=e[i][t[3]+1];(a||s)&&(r=i)}return r}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(t,e){this.hot.selection.highlight.getFill().clear().add(new c.CellCoords(t[0],t[1])).add(new c.CellCoords(e,t[3]))}},{key:"setSelection",value:function(t){var e;(e=this.hot).selectCell.apply(e,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(t).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var t=this.getCornersOfSelectedCells(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(t){var e=(0,l.offset)(this.hot.table).top-(window.pageYOffset||document.documentElement.scrollTop)+(0,l.outerHeight)(this.hot.table),n=(0,l.offset)(this.hot.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+(0,l.outerWidth)(this.hot.table);return t.clientY>e&&t.clientX<=n}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return e.onMouseUp()}),this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return e.onMouseMove(t)})}},{key:"onCellCornerDblClick",value:function(){this.selectAdjacent()&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(1<this.handleDraggedCells&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(t){var e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&0<this.handleDraggedCells&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var t=(0,p.getMappedFillHandleSetting)(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}},{key:"destroy",value:function(){a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"destroy",this).call(this)}}]),g);function g(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,t));return e.eventManager=new u.default(e),e.addingStarted=!1,e.mouseDownOnCellCorner=!1,e.mouseDragOutside=!1,e.handleDraggedCells=0,e.directions=[],e.autoInsertRow=!1,e}(0,h.registerPlugin)("autofill",f),e.default=f},function(t,e,n){"use strict";e.__esModule=!0,e.DIRECTIONS=void 0,e.getDeltas=function(t,e,n,r){var i=n.length,o=n?n[0].length:0,a=[],s=e.row-t.row,l=e.col-t.col;if(-1!==["down","up"].indexOf(r)){for(var u=[],h=0;h<=l;h++){var c=parseInt(n[0][h],10),d=parseInt(n[i-1][h],10),f=("down"===r?d-c:c-d)/(i-1)||0;u.push(f)}a.push(u)}if(-1!==["right","left"].indexOf(r))for(var p=0;p<=s;p++){var g=parseInt(n[p][0],10),v=parseInt(n[p][o-1],10),m=("right"===r?v-g:g-v)/(o-1)||0;a.push([m])}return a},e.getDragDirectionAndRange=function(t,e){var n=void 0,r=void 0,i=void 0;e[0]===t[0]&&e[1]<t[1]?(i="left",n=new o.CellCoords(e[0],e[1]),r=new o.CellCoords(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(i="right",n=new o.CellCoords(e[0],t[3]+1),r=new o.CellCoords(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(i="up",n=new o.CellCoords(e[0],e[1]),r=new o.CellCoords(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(i="down",n=new o.CellCoords(t[2]+1,e[1]),r=new o.CellCoords(e[2],e[3]));return{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:r}},e.getMappedFillHandleSetting=function(t){var e={};!0===t?(e.directions=Object.keys(a),e.autoInsertRow=!0):(0,r.isObject)(t)?((0,i.isDefined)(t.autoInsertRow)?t.direction===a.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,(0,i.isDefined)(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(a)):"string"==typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1);return e};var r=n(1),i=n(10),o=n(9),a=e.DIRECTIONS={horizontal:"horizontal",vertical:"vertical"}},function(t,e,n){"use strict";e.__esModule=!0;function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var h=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=m(n(7)),c=n(0),s=n(43),l=n(2),u=m(n(159)),d=n(1),f=n(4),p=n(5),g=m(n(219)),v=n(31);function m(t){return t&&t.__esModule?t:{default:t}}var y=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(w,o.default),r(w,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r(w,[{key:"isEnabled",value:function(){return!0===this.hot.getSettings().autoRowSize||(0,d.isObject)(this.hot.getSettings().autoRowSize)}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("beforeChange",function(t){return n.onBeforeChange(t)}),this.addHook("beforeColumnMove",function(){return n.recalculateAllRowsHeight()}),this.addHook("beforeColumnResize",function(){return n.recalculateAllRowsHeight()}),this.addHook("beforeColumnSort",function(){return n.clearCache()}),this.addHook("beforeRender",function(t){return n.onBeforeRender(t)}),this.addHook("beforeRowMove",function(t,e){return n.onBeforeRowMove(t,e)}),this.addHook("modifyRowHeight",function(t,e){return n.getRowHeight(e,t)}),this.addHook("modifyColumnHeaderHeight",function(){return n.getColumnHeaderHeight()}),a(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){a(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"disablePlugin",this).call(this)}},{key:"calculateRowsHeight",value:function(t,e,n){var r=0<arguments.length&&void 0!==t?t:{from:0,to:this.hot.countRows()-1},i=this,o=1<arguments.length&&void 0!==e?e:{from:0,to:this.hot.countCols()-1},a=2<arguments.length&&void 0!==n&&n,s="number"==typeof r?{from:r,to:r}:r,l="number"==typeof o?{from:o,to:o}:o;if(null!==this.hot.getColHeader(0)){var u=this.samplesGenerator.generateRowSamples(-1,l);this.ghostTable.addColumnHeadersRow(u.get(-1))}(0,f.rangeEach)(s.from,s.to,function(t){if(a||void 0===i.heights[t]){var e=i.samplesGenerator.generateRowSamples(t,l);(0,c.arrayEach)(e,function(t){var e=h(t,2),n=e[0],r=e[1];return i.ghostTable.addRow(n,r)})}}),this.ghostTable.rows.length&&(this.ghostTable.getHeights(function(t,e){i.heights[t]=e}),this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(t){var e=this,n=0<arguments.length&&void 0!==t?t:{from:0,to:this.hot.countCols()-1},r=0,i=this.hot.countRows()-1,o=null;this.inProgress=!0;var a=this.getSyncCalculationLimit();this.firstCalculation&&0<=a&&(this.calculateRowsHeight({from:0,to:a},n),this.firstCalculation=!1,r=a+1),r<i?function t(){if(!e.hot)return(0,s.cancelAnimationFrame)(o),void(e.inProgress=!1);e.calculateRowsHeight({from:r,to:Math.min(r+w.CALCULATION_STEP,i)},n),(r=r+w.CALCULATION_STEP+1)<i?o=(0,s.requestAnimationFrame)(t):((0,s.cancelAnimationFrame)(o),e.inProgress=!1,e.hot.view.wt.wtOverlays.adjustElementsSize(!0),e.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&e.hot.view.wt.wtOverlays.leftOverlay.clone.draw())}():(this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings().autoRowSize,e=t&&(0,d.hasOwnProperty)(t,"samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0,n=t&&(0,d.hasOwnProperty)(t,"allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllRowsHeight",value:function(){(0,l.isVisible)(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var t=w.SYNC_CALCULATION_LIMIT,e=this.hot.countRows()-1;return(0,d.isObject)(this.hot.getSettings().autoRowSize)&&(t=this.hot.getSettings().autoRowSize.syncLimit,(0,v.isPercentValue)(t)?t=(0,f.valueAccordingPercent)(e,t):t>>=0),Math.min(t,e)}},{key:"getRowHeight",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:void 0,r=n;return void 0!==this.heights[t]&&this.heights[t]>(n||0)&&(r=this.heights[t]),r}},{key:"getColumnHeaderHeight",value:function(){return this.heights[-1]}},{key:"getFirstVisibleRow",value:function(){var t=this.hot.view.wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var t=this.hot.view.wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.heights.length=0,this.heights[-1]=void 0}},{key:"clearCacheByRange",value:function(t){var e=this,n="number"==typeof t?{from:t,to:t}:t,r=n.from,i=n.to;(0,f.rangeEach)(Math.min(r,i),Math.max(r,i),function(t){e.heights[t]=void 0})}},{key:"isNeedRecalculate",value:function(){return!!(0,c.arrayFilter)(this.heights,function(t){return void 0===t}).length}},{key:"onBeforeRender",value:function(){var t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom;if(this.calculateRowsHeight({from:this.getFirstVisibleRow(),to:this.getLastVisibleRow()},void 0,t),e){var n=this.hot.countRows()-1;this.calculateRowsHeight({from:n-e,to:n})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}},{key:"onBeforeRowMove",value:function(t,e){this.clearCacheByRange({from:t,to:e}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(t,e,n){var r=e;return n&&(this.calculateRowsHeight(t,void 0,!0),r=this.getRowHeight(t)),r}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){t.hot&&t.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(t){var e=null;1===t.length?e=t[0][0]:1<t.length&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}},{key:"destroy",value:function(){this.ghostTable.clean(),a(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"destroy",this).call(this)}}]),w);function w(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,w);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,t));return r.heights=[],r.ghostTable=new u.default(r.hot),r.samplesGenerator=new g.default(function(t,e){var n=void 0;return 0<=t?n=r.hot.getDataAtCell(t,e):-1===t&&(n=r.hot.getColHeader(e)),{value:n}}),r.firstCalculation=!0,r.inProgress=!1,r.addHook("beforeRowResize",function(t,e,n){return r.onBeforeRowResize(t,e,n)}),r}(0,p.registerPlugin)("autoRowSize",y),e.default=y},function(t,e,n){"use strict";e.__esModule=!0,e.ColumnStatesManager=void 0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(1),a=n(0);var s=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];e.ColumnStatesManager=(r(l,[{key:"updateAllColumnsProperties",value:function(t){var n=this;(0,o.isObject)(t)&&(0,o.objectEach)(t,function(t,e){s.includes(e)&&(n[e]=t)})}},{key:"getAllColumnsProperties",value:function(){var t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}},{key:"getFirstSortedColumn",value:function(){var t=void 0;return 0<this.getNumberOfSortedColumns()&&(t=this.sortedColumnsStates[0].column),t}},{key:"getSortOrderOfColumn",value:function(n){var t=this.sortedColumnsStates.find(function(t){var e=t.column;return n===e}),e=void 0;return(0,o.isObject)(t)&&(e=t.sortOrder),e}},{key:"getSortedColumns",value:function(){return(0,a.arrayMap)(this.sortedColumnsStates,function(t){return t.column})}},{key:"getIndexOfColumnInSortQueue",value:function(t){return this.getSortedColumns().indexOf(t)}},{key:"getNumberOfSortedColumns",value:function(){return this.sortedColumnsStates.length}},{key:"isListOfSortedColumnsEmpty",value:function(){return 0===this.getNumberOfSortedColumns()}},{key:"isColumnSorted",value:function(t){return this.getSortedColumns().includes(t)}},{key:"getSortStates",value:function(){return(0,o.deepClone)(this.sortedColumnsStates)}},{key:"getColumnSortState",value:function(t){if(this.isColumnSorted(t))return(0,o.deepClone)(this.sortedColumnsStates[this.getIndexOfColumnInSortQueue(t)])}},{key:"setSortStates",value:function(t){this.sortedColumnsStates=t}},{key:"destroy",value:function(){this.sortedColumnsStates.length=0,this.sortedColumnsStates=null}}]),l);function l(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),this.sortedColumnsStates=[],this.sortEmptyCells=!1,this.indicator=!0,this.headerAction=!0,this.compareFunctionFactory=void 0}},function(t,e,n){"use strict";e.__esModule=!0,e.getClassesToAdd=function(t,e,n,r){var i=[s];r&&i.push(l);if(!1===n)i.push(a);else if(t.isColumnSorted(e)){var o=t.getSortOrderOfColumn(e);i.push(u.get(o))}return i},e.getClassedToRemove=function(){return Array.from(u.values()).concat(l,a,s)};var r=n(160),a="indicatorDisabled",s="columnSorting",l="sortAction",u=new Map([[r.ASC_SORT_STATE,"ascending"],[r.DESC_SORT_STATE,"descending"]])},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(56),s=(o=a)&&o.__esModule?o:{default:o},l=n(1),u=n(4);var h=(r(c,[{key:"createMap",value:function(t){var e=this,n=void 0===t?this._arrayMap.length:t;(this._arrayMap.length=0,u.rangeEach)(n-1,function(t){e._arrayMap[t]=t})}},{key:"destroy",value:function(){this._arrayMap=null}}]),c);function c(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c)}(0,l.mixin)(h,s.default),e.default=h},function(t,e,n){"use strict";e.__esModule=!0,e.rootComparator=function(h,c){return function(t,e){var n,r,i,o,a,s,l=f(t).slice(1),u=f(e).slice(1);return r=h[n=0],i=c[n],o=l[n],a=u[n],((s=i.columnSorting).compareFunctionFactory?s.compareFunctionFactory:(0,d.getCompareFunctionFactory)(i.type))(r,i,s)(o,a)}};var d=n(51);function f(t){return Array.isArray(t)?t:Array.from(t)}},function(t,e,n){"use strict";e.__esModule=!0,e.COLUMN_DATA_TYPE=void 0,e.compareFunctionFactory=function(r,t,i){return function(t,e){var n=i.sortEmptyCells;return"string"==typeof t&&(t=t.toLowerCase()),"string"==typeof e&&(e=e.toLowerCase()),t===e?a.DO_NOT_SWAP:(0,o.isEmpty)(t)?(0,o.isEmpty)(e)?a.DO_NOT_SWAP:n&&"asc"===r?a.FIRST_BEFORE_SECOND:a.FIRST_AFTER_SECOND:(0,o.isEmpty)(e)?n&&"asc"===r?a.FIRST_AFTER_SECOND:a.FIRST_BEFORE_SECOND:isNaN(t)&&!isNaN(e)?"asc"===r?a.FIRST_AFTER_SECOND:a.FIRST_BEFORE_SECOND:!isNaN(t)&&isNaN(e)?"asc"===r?a.FIRST_BEFORE_SECOND:a.FIRST_AFTER_SECOND:(isNaN(t)||isNaN(e)||(t=parseFloat(t),e=parseFloat(e)),t<e?"asc"===r?a.FIRST_BEFORE_SECOND:a.FIRST_AFTER_SECOND:e<t?"asc"===r?a.FIRST_AFTER_SECOND:a.FIRST_BEFORE_SECOND:a.DO_NOT_SWAP)}};var o=n(10),a=n(51);e.COLUMN_DATA_TYPE="default"},function(t,e,n){"use strict";e.__esModule=!0,e.COLUMN_DATA_TYPE=void 0,e.compareFunctionFactory=function(o,t,a){return function(t,e){var n=parseFloat(t),r=parseFloat(e),i=a.sortEmptyCells;if(n===r||isNaN(n)&&isNaN(r))return l.DO_NOT_SWAP;if(i){if((0,s.isEmpty)(t))return"asc"===o?l.FIRST_BEFORE_SECOND:l.FIRST_AFTER_SECOND;if((0,s.isEmpty)(e))return"asc"===o?l.FIRST_AFTER_SECOND:l.FIRST_BEFORE_SECOND}return isNaN(n)?l.FIRST_AFTER_SECOND:isNaN(r)?l.FIRST_BEFORE_SECOND:n<r?"asc"===o?l.FIRST_BEFORE_SECOND:l.FIRST_AFTER_SECOND:r<n?"asc"===o?l.FIRST_AFTER_SECOND:l.FIRST_BEFORE_SECOND:l.DO_NOT_SWAP}};var s=n(10),l=n(51);e.COLUMN_DATA_TYPE="numeric"},function(t,e,n){"use strict";e.__esModule=!0,e.COLUMN_DATA_TYPE=void 0,e.compareFunctionFactory=function(a,s,l){return function(t,e){var n=l.sortEmptyCells;if(t===e)return c.DO_NOT_SWAP;if((0,h.isEmpty)(t))return(0,h.isEmpty)(e)?c.DO_NOT_SWAP:n&&"asc"===a?c.FIRST_BEFORE_SECOND:c.FIRST_AFTER_SECOND;if((0,h.isEmpty)(e))return n&&"asc"===a?c.FIRST_AFTER_SECOND:c.FIRST_BEFORE_SECOND;var r=s.dateFormat,i=(0,u.default)(t,r),o=(0,u.default)(e,r);return i.isValid()?o.isValid()?o.isAfter(i)?"asc"===a?c.FIRST_BEFORE_SECOND:c.FIRST_AFTER_SECOND:o.isBefore(i)?"asc"===a?c.FIRST_AFTER_SECOND:c.FIRST_BEFORE_SECOND:c.DO_NOT_SWAP:c.FIRST_BEFORE_SECOND:c.FIRST_AFTER_SECOND}};var r,i=n(32),u=(r=i)&&r.__esModule?r:{default:r},h=n(10),c=n(51);e.COLUMN_DATA_TYPE="date"},function(t,e,n){"use strict";e.__esModule=!0,e.FIRST_AFTER_SECOND=e.FIRST_BEFORE_SECOND=e.DO_NOT_SWAP=void 0,e.sort=function(t,e){for(var n=(0,s.getRootComparator)(e),r=arguments.length,i=Array(2<r?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];(0,a.default)(t,n.apply(void 0,i))};var r,i=n(334),a=(r=i)&&r.__esModule?r:{default:r},s=n(221);e.DO_NOT_SWAP=0,e.FIRST_BEFORE_SECOND=-1,e.FIRST_AFTER_SECOND=1},function(t,e,n){"use strict";e.__esModule=!0,e.default=function t(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:a;var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:e.length;if(Math.abs(i-r)<=1)return[];var o=Math.ceil((r+i)/2);t(e,n,r,o);t(e,n,o,i);return s(e,n,r,o,i)};var r,i=n(335),f=(r=i)&&r.__esModule?r:{default:r};var a=function(t,e){var n=t.toString(),r=e.toString();return n===r?0:n<r?-1:1};function s(t,e,n,r,i){for(var o=new f.default,a=new f.default,s=r-n,l=i-r,u=Math.max(s,l),h=i-n,c=0;c<u;c+=1)c<s&&o.push(t[n+c]),c<l&&a.push(t[r+c]);for(var d=0;d<h;)o.first&&a.first?0<e(o.first.data,a.first.data)?t[n+d]=a.shift().data:t[n+d]=o.shift().data:o.first?t[n+d]=o.shift().data:t[n+d]=a.shift().data,d+=1;return t}},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;function o(t){i(this,o),this.data=t,this.next=null,this.prev=null}var a=(function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}(s,[{key:"push",value:function(t){var e=new o(t);if(null===this.first)this.first=e,this.last=e;else{var n=this.last;((this.last=e).prev=n).next=e}}},{key:"unshift",value:function(t){var e=new o(t);if(null===this.first)this.first=e,this.last=e;else{var n=this.first;((this.first=e).next=n).prev=e}}},{key:"inorder",value:function(t){for(var e=this.first;e;)t(e),e=e.next}},{key:"remove",value:function(t){if(null===this.first)return!1;for(var e=this.first,n=void 0,r=void 0;e;){if(e.data===t)return n=e.next,r=e.prev,n&&(n.prev=r),r&&(r.next=n),e===this.first&&(this.first=n),e===this.last&&(this.last=r),!0;e=e.next}return!1}},{key:"hasCycle",value:function(){for(var t=this.first,e=this.first;;){if(null===t)return!1;if(null===(t=t.next))return!1;if((t=t.next)===(e=e.next))return!0}}},{key:"pop",value:function(){if(null===this.last)return null;var t=this.last;return this.last=this.last.prev,t}},{key:"shift",value:function(){if(null===this.first)return null;var t=this.first;return this.first=this.first.next,t}},{key:"recursiveReverse",value:function(){if(this.first){!function t(e,n){n&&(t(n,n.next),n.next=e)}(this.first,this.first.next),this.first.next=null;var t=this.first;this.first=this.last,this.last=t}}},{key:"reverse",value:function(){if(this.first&&this.first.next){for(var t=this.first.next,e=this.first,n=void 0;t;)n=t.next,e=(t.next=e).prev=t,t=n;this.first.next=null,this.last.prev=null,n=this.first,this.first=e,this.last=n}}}]),s);function s(){i(this,s),this.first=null,this.last=null}e.NodeStructure=o,e.default=a},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:s(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var f=n(2),o=n(1),l=v(n(8)),a=n(9),u=n(5),h=v(n(7)),c=v(n(337)),d=n(23),p=v(n(338)),g=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3));function v(t){return t&&t.__esModule?t:{default:t}}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n(339);var y=new WeakMap,w="comment",b="value",C="readOnly",E=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(S,h.default),r(S,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().comments}},{key:"enablePlugin",value:function(){var a=this;this.enabled||(this.editor||(this.editor=new c.default),this.eventManager||(this.eventManager=new l.default(this)),this.displaySwitch||(this.displaySwitch=new p.default(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(t){return a.addToContextMenu(t)}),this.addHook("afterRenderer",function(t,e,n,r,i,o){return a.onAfterRenderer(t,o)}),this.addHook("afterScrollHorizontally",function(){return a.hide()}),this.addHook("afterScrollVertically",function(){return a.hide()}),this.addHook("afterBeginEditing",function(){return a.onAfterBeginEditing()}),this.displaySwitch.addLocalHook("hide",function(){return a.hide()}),this.displaySwitch.addLocalHook("show",function(t,e){return a.showAtCell(t,e)}),this.registerListeners(),s(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),s(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){s(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var e=this;this.eventManager.addEventListener(document,"mouseover",function(t){return e.onMouseOver(t)}),this.eventManager.addEventListener(document,"mousedown",function(t){return e.onMouseDown(t)}),this.eventManager.addEventListener(document,"mouseup",function(){return e.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return e.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(t){return e.onEditorMouseDown(t)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(t){return e.onEditorMouseUp(t)})}},{key:"setRange",value:function(t){this.range=t}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(t){var e=(0,f.closest)(t.target,"TD","TBODY");return!!(e&&(0,f.hasClass)(e,"htCommentCell")&&(0,f.closest)(e,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(t){return this.editor.getInputElement()===t.target}},{key:"setComment",value:function(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.editor.getValue(),n="";null!=t?n=t:null!=e&&(n=e);var r=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(r,i,m({},b,n)),this.hot.render()}},{key:"setCommentAtCell",value:function(t,e,n){this.setRange({from:new a.CellCoords(t,e)}),this.setComment(n)}},{key:"removeComment",value:function(t){var e=!(0<arguments.length&&void 0!==t)||t;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,w,void 0),e&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(t,e,n){var r=!(2<arguments.length&&void 0!==n)||n;this.setRange({from:new a.CellCoords(t,e)}),this.removeComment(r)}},{key:"getComment",value:function(){var t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,b)}},{key:"getCommentAtCell",value:function(t,e){return this.getCommentMeta(t,e,b)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(t[w]?t[w][b]:""),this.editor.hidden&&this.editor.show(),!0}},{key:"showAtCell",value:function(t,e){return this.setRange({from:new a.CellCoords(t,e)}),this.show()}},{key:"hide",value:function(){this.editor.hidden||this.editor.hide()}},{key:"refreshEditor",value:function(t){if(0<arguments.length&&void 0!==t&&t||this.range.from&&this.editor.isVisible()){var e=(0,f.getScrollableElement)(this.hot.view.wt.wtTable.TABLE),n=this.hot.view.wt.wtTable.getCell(this.range.from),r=this.range.from.row,i=this.range.from.col,o=(0,f.offset)(n),a=this.hot.view.wt.wtTable.getStretchedColumnWidth(i),s=o.top<0?0:o.top,l=o.left;this.hot.view.wt.wtViewport.hasVerticalScroll()&&e!==window&&(s-=this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition()),this.hot.view.wt.wtViewport.hasHorizontalScroll()&&e!==window&&(l-=this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition());var u=l+a,h=s,c=this.getCommentMeta(r,i,"style"),d=this.getCommentMeta(r,i,C);c?this.editor.setSize(c.width,c.height):this.editor.resetSize(),this.editor.setReadOnlyState(d),this.editor.setPosition(u,h)}}},{key:"checkSelectionCommentsConsistency",value:function(){var t=this.hot.getSelectedRangeLast();if(!t)return!1;var e=!1,n=t.from;return this.getCommentMeta(n.row,n.col,b)&&(e=!0),e}},{key:"updateCommentMeta",value:function(t,e,n){var r=this.hot.getCellMeta(t,e)[w],i=void 0;r?(i=(0,o.deepClone)(r),(0,o.deepExtend)(i,n)):i=n,this.hot.setCellMeta(t,e,w,i)}},{key:"getCommentMeta",value:function(t,e,n){var r=this.hot.getCellMeta(t,e);if(r[w])return r[w][n]}},{key:"onMouseDown",value:function(t){if(this.mouseDown=!0,this.hot.view&&this.hot.view.wt){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(t)){var e=(0,f.closest)(t.target,"TD","TBODY"),n=null;e&&(n=this.hot.view.wt.wtTable.getCoords(e)),e&&(!this.range.from||!n||this.range.from.row===n.row&&this.range.from.col===n.col)||this.hide()}this.contextMenuEvent=!1}}},{key:"onMouseOver",value:function(t){var e=y.get(this);if(e.cellBelowCursor=document.elementFromPoint(t.clientX,t.clientY),!(this.mouseDown||this.editor.isFocused()||(0,f.hasClass)(t.target,"wtBorder")||e.cellBelowCursor!==t.target)&&this.editor)if(this.targetIsCellWithComment(t)){var n=this.hot.view.wt.wtTable.getCoords(t.target),r={from:new a.CellCoords(n.row,n.col)};this.displaySwitch.show(r)}else(0,f.isChildOf)(t.target,document)&&!this.targetIsCommentTextArea(t)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onAfterRenderer",value:function(t,e){e[w]&&e[w][b]&&(0,f.addClass)(t,e.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(t){y.get(this).tempEditorDimensions={width:(0,f.outerWidth)(t.target),height:(0,f.outerHeight)(t.target)}}},{key:"onEditorMouseUp",value:function(t){var e=y.get(this),n=(0,f.outerWidth)(t.target),r=(0,f.outerHeight)(t.target);n===e.tempEditorDimensions.width+1&&r===e.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,m({},"style",{width:n,height:r}))}},{key:"onContextMenuAddComment",value:function(){var t=this;this.displaySwitch.cancelHiding();var e=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,this.setRange({from:e.from}),this.show(),setTimeout(function(){t.hot&&(t.hot.deselectCell(),t.editor.focus())},10)}},{key:"onContextMenuRemoveComment",value:function(){var t=this.hot.getSelectedRangeLast(),e=t.from,n=t.to;this.contextMenuEvent=!0;for(var r=e.row;r<=n.row;r++)for(var i=e.col;i<=n.col;i++)this.removeCommentAtCell(r,i,!1);this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var t=this.hot.getSelectedRangeLast(),e=t.from,n=t.to;this.contextMenuEvent=!0;for(var r=e.row;r<=n.row;r++)for(var i=e.col;i<=n.col;i++){var o=!!this.getCommentMeta(r,i,C);this.updateCommentMeta(r,i,m({},C,!o))}}},{key:"addToContextMenu",value:function(t){var e=this;t.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return e.checkSelectionCommentsConsistency()?e.hot.getTranslatedPhrase(g.CONTEXTMENU_ITEMS_EDIT_COMMENT):e.hot.getTranslatedPhrase(g.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback:function(){return e.onContextMenuAddComment()},disabled:function(){return!(this.getSelectedLast()&&!this.selection.isSelectedByCorner())}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(g.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback:function(){return e.onContextMenuRemoveComment()},disabled:function(){return e.hot.selection.isSelectedByCorner()}},{key:"commentsReadOnly",name:function(){var r=this,t=this.getTranslatedPhrase(g.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return(0,d.checkSelectionConsistency)(this.getSelectedRangeLast(),function(t,e){var n=r.getCellMeta(t,e)[w];if(n=n&&n[C])return!0})&&(t=(0,d.markLabelAsSelected)(t)),t},callback:function(){return e.onContextMenuMakeReadOnly()},disabled:function(){return e.hot.selection.isSelectedByCorner()||!e.checkSelectionCommentsConsistency()}})}},{key:"getDisplayDelaySetting",value:function(){var t=this.hot.getSettings().comments;if((0,o.isObject)(t))return t.displayDelay}},{key:"onAfterBeginEditing",value:function(){this.hide()}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),s(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"destroy",this).call(this)}}]),S);function S(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,S);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,t));return e.editor=null,e.displaySwitch=null,e.eventManager=null,e.range={},e.mouseDown=!1,e.contextMenuEvent=!1,e.timer=null,y.set(e,{tempEditorDimensions:{},cellBelowCursor:null}),e}(0,u.registerPlugin)("comments",E),e.default=E},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(2);var a=(r(s,null,[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),r(s,[{key:"setPosition",value:function(t,e){this.editorStyle.left=t+"px",this.editorStyle.top=e+"px"}},{key:"setSize",value:function(t,e){if(t&&e){var n=this.getInputElement();n.style.width=t+"px",n.style.height=e+"px"}}},{key:"resetSize",value:function(){var t=this.getInputElement();t.style.width="",t.style.height=""}},{key:"setReadOnlyState",value:function(t){this.getInputElement().readOnly=t}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.editorStyle.display="none",this.hidden=!0}},{key:"isVisible",value:function(){return"block"===this.editorStyle.display}},{key:"setValue",value:function(t){var e=(0<arguments.length&&void 0!==t?t:"")||"";this.getInputElement().value=e}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return document.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var t=document.createElement("div"),e=document.createElement("textarea"),n=document.querySelector("."+s.CLASS_EDITOR_CONTAINER);return n||(n=document.createElement("div"),(0,o.addClass)(n,s.CLASS_EDITOR_CONTAINER),document.body.appendChild(n)),(0,o.addClass)(t,s.CLASS_EDITOR),(0,o.addClass)(e,s.CLASS_INPUT),t.appendChild(e),n.appendChild(t),t}},{key:"getInputElement",value:function(){return this.editor.querySelector("."+s.CLASS_INPUT)}},{key:"destroy",value:function(){this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null}}]),s);function s(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}e.default=a},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(34),s=n(1),l=n(20),u=(o=l)&&o.__esModule?o:{default:o};var h=(r(c,[{key:"hide",value:function(){var t=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){!1===t.wasLastActionShow&&t.runLocalHooks("hide")},250)}},{key:"show",value:function(t){this.wasLastActionShow=!0,this.showDebounced(t)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(t){var e=this,n=0<arguments.length&&void 0!==t?t:250;this.showDebounced=(0,a.debounce)(function(t){e.wasLastActionShow&&e.runLocalHooks("show",t.from.row,t.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),c);function c(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}(0,s.mixin)(h,u.default),e.default=h},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=m(n(7)),s=m(n(17)),l=n(0),u=m(n(222)),h=m(n(8)),c=m(n(223)),d=m(n(162)),f=n(5),p=n(12),g=n(2),v=n(45);function m(t){return t&&t.__esModule?t:{default:t}}n(353),s.default.getSingleton().register("afterContextMenuDefaultOptions"),s.default.getSingleton().register("beforeContextMenuShow"),s.default.getSingleton().register("afterContextMenuShow"),s.default.getSingleton().register("afterContextMenuHide"),s.default.getSingleton().register("afterContextMenuExecute");var y=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(w,o.default),r(w,null,[{key:"DEFAULT_ITEMS",get:function(){return[v.ROW_ABOVE,v.ROW_BELOW,v.SEPARATOR,v.COLUMN_LEFT,v.COLUMN_RIGHT,v.SEPARATOR,v.REMOVE_ROW,v.REMOVE_COLUMN,v.SEPARATOR,v.UNDO,v.REDO,v.SEPARATOR,v.READ_ONLY,v.SEPARATOR,v.ALIGNMENT]}}]),r(w,[{key:"isEnabled",value:function(){return this.hot.getSettings().contextMenu}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.itemsFactory=new c.default(this.hot,w.DEFAULT_ITEMS);var e=this.hot.getSettings().contextMenu,n={items:this.itemsFactory.getItems(e)};"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),a(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"enablePlugin",this).call(this);var t=function(){if(i.hot){i.hot.runHooks("afterContextMenuDefaultOptions",n),i.itemsFactory.setPredefinedItems(n.items);var t=i.itemsFactory.getItems(e);i.menu=new d.default(i.hot,{className:"htContextMenu",keepInViewport:!0}),i.hot.runHooks("beforeContextMenuSetItems",t),i.menu.setMenuItems(t),i.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),i.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),i.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),i.menu.addLocalHook("executeCommand",function(){for(var t,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=i.executeCommand).call.apply(t,[i].concat(n))}),i.addHook("afterOnCellContextMenu",function(t){return i.onAfterOnCellContextMenu(t)}),(0,l.arrayEach)(t,function(t){return i.commandExecutor.registerCommand(t.key,t)})}};this.callOnPluginsReady(function(){i.isPluginsReady?setTimeout(t,0):t()})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),a(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),a(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(t){this.menu&&(this.menu.open(),this.menu.setPosition({top:parseInt((0,p.pageY)(t),10)-(0,g.getWindowScrollTop)(),left:parseInt((0,p.pageX)(t),10)-(0,g.getWindowScrollLeft)()}),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv)}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(t){for(var e,n=arguments.length,r=Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=this.commandExecutor).execute.apply(e,[t].concat(r))}},{key:"onAfterOnCellContextMenu",value:function(t){var e,n=this.hot.getSettings(),r=n.rowHeaders,i=n.colHeaders,o=t.realTarget;this.close(),(0,g.hasClass)(o,"handsontableInput")||(t.preventDefault(),(0,p.stopPropagation)(t),(r||i||"TD"===(e=o).nodeName||"TD"===e.parentNode.nodeName||(0,g.hasClass)(o,"current")&&(0,g.hasClass)(o,"wtBorder"))&&this.open(t))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),a(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"destroy",this).call(this)}}]),w);function w(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,w);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,t));return e.eventManager=new h.default(e),e.commandExecutor=new u.default(e.hot),e.itemsFactory=null,e.menu=null,e}y.SEPARATOR={name:v.SEPARATOR},(0,f.registerPlugin)("contextMenu",y),e.default=y},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0,e.default=function(){return{key:a,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled:function(){return!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:a+":left",name:function(){var r=this,t=this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);return(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(t,e){var n=r.getCellMeta(t,e).className;if(n&&-1!==n.indexOf("htLeft"))return!0})&&(t=(0,o.markLabelAsSelected)(t)),t},callback:function(){var i=this,t=this.getSelectedRange(),e=(0,o.getAlignmentClasses)(t,function(t,e){return i.getCellMeta(t,e).className}),n="horizontal";this.runHooks("beforeCellAlignment",e,t,n,"htLeft"),(0,o.align)(t,n,"htLeft",function(t,e){return i.getCellMeta(t,e)},function(t,e,n,r){return i.setCellMeta(t,e,n,r)}),this.render()},disabled:!1},{key:a+":center",name:function(){var r=this,t=this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);return(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(t,e){var n=r.getCellMeta(t,e).className;if(n&&-1!==n.indexOf("htCenter"))return!0})&&(t=(0,o.markLabelAsSelected)(t)),t},callback:function(){var i=this,t=this.getSelectedRange(),e=(0,o.getAlignmentClasses)(t,function(t,e){return i.getCellMeta(t,e).className}),n="horizontal";this.runHooks("beforeCellAlignment",e,t,n,"htCenter"),(0,o.align)(t,n,"htCenter",function(t,e){return i.getCellMeta(t,e)},function(t,e,n,r){return i.setCellMeta(t,e,n,r)}),this.render()},disabled:!1},{key:a+":right",name:function(){var r=this,t=this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);return(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(t,e){var n=r.getCellMeta(t,e).className;if(n&&-1!==n.indexOf("htRight"))return!0})&&(t=(0,o.markLabelAsSelected)(t)),t},callback:function(){var i=this,t=this.getSelectedRange(),e=(0,o.getAlignmentClasses)(t,function(t,e){return i.getCellMeta(t,e).className}),n="horizontal";this.runHooks("beforeCellAlignment",e,t,n,"htRight"),(0,o.align)(t,n,"htRight",function(t,e){return i.getCellMeta(t,e)},function(t,e,n,r){return i.setCellMeta(t,e,n,r)}),this.render()},disabled:!1},{key:a+":justify",name:function(){var r=this,t=this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);return(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(t,e){var n=r.getCellMeta(t,e).className;if(n&&-1!==n.indexOf("htJustify"))return!0})&&(t=(0,o.markLabelAsSelected)(t)),t},callback:function(){var i=this,t=this.getSelectedRange(),e=(0,o.getAlignmentClasses)(t,function(t,e){return i.getCellMeta(t,e).className}),n="horizontal";this.runHooks("beforeCellAlignment",e,t,n,"htJustify"),(0,o.align)(t,n,"htJustify",function(t,e){return i.getCellMeta(t,e)},function(t,e,n,r){return i.setCellMeta(t,e,n,r)}),this.render()},disabled:!1},{name:r.KEY},{key:a+":top",name:function(){var r=this,t=this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_ALIGNMENT_TOP);return(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(t,e){var n=r.getCellMeta(t,e).className;if(n&&-1!==n.indexOf("htTop"))return!0})&&(t=(0,o.markLabelAsSelected)(t)),t},callback:function(){var i=this,t=this.getSelectedRange(),e=(0,o.getAlignmentClasses)(t,function(t,e){return i.getCellMeta(t,e).className});this.runHooks("beforeCellAlignment",e,t,"vertical","htTop"),(0,o.align)(t,"vertical","htTop",function(t,e){return i.getCellMeta(t,e)},function(t,e,n,r){return i.setCellMeta(t,e,n,r)}),this.render()},disabled:!1},{key:a+":middle",name:function(){var r=this,t=this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);return(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(t,e){var n=r.getCellMeta(t,e).className;if(n&&-1!==n.indexOf("htMiddle"))return!0})&&(t=(0,o.markLabelAsSelected)(t)),t},callback:function(){var i=this,t=this.getSelectedRange(),e=(0,o.getAlignmentClasses)(t,function(t,e){return i.getCellMeta(t,e).className});this.runHooks("beforeCellAlignment",e,t,"vertical","htMiddle"),(0,o.align)(t,"vertical","htMiddle",function(t,e){return i.getCellMeta(t,e)},function(t,e,n,r){return i.setCellMeta(t,e,n,r)}),this.render()},disabled:!1},{key:a+":bottom",name:function(){var r=this,t=this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);return(0,o.checkSelectionConsistency)(this.getSelectedRange(),function(t,e){var n=r.getCellMeta(t,e).className;if(n&&-1!==n.indexOf("htBottom"))return!0})&&(t=(0,o.markLabelAsSelected)(t)),t},callback:function(){var i=this,t=this.getSelectedRange(),e=(0,o.getAlignmentClasses)(t,function(t,e){return i.getCellMeta(t,e).className});this.runHooks("beforeCellAlignment",e,t,"vertical","htBottom"),(0,o.align)(t,"vertical","htBottom",function(t,e){return i.getCellMeta(t,e)},function(t,e,n,r){return i.setCellMeta(t,e,n,r)}),this.render()},disabled:!1}]}}};var o=n(23),r=n(161),i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3));var a=e.KEY="alignment"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0;var o=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.default=function(){return{key:i,name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback:function(t,e){var n=e[0].start.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled:function(){var t=(0,a.getValidSelection)(this);if(!t)return!0;var e=o(t[0],3),n=e[0],r=e[1],i=[n,0,e[2],this.countCols()-1].join(",")===t.join(",");return r<0||this.countCols()>=this.getSettings().maxCols||i}}};var a=n(23),r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3));var i=e.KEY="clear_column"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0;var a=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.default=function(){return{key:i,name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback:function(t,e){var n=e[Math.max(e.length-1,0)];this.alter("insert_col",n.start.col,1,"ContextMenu.columnLeft")},disabled:function(){var t=(0,s.getValidSelection)(this);if(!t)return!0;if(!this.isColumnModificationAllowed())return!0;var e=a(t[0],3),n=e[0],r=e[1],i=[n,0,e[2],this.countCols()-1].join(",")===t.join(","),o=1===this.countCols();return r<0||this.countCols()>=this.getSettings().maxCols||!o&&i},hidden:function(){return!this.getSettings().allowInsertColumn}}};var s=n(23),r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3));var i=e.KEY="col_left"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0;var a=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.default=function(){return{key:i,name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback:function(t,e){var n=e[Math.max(e.length-1,0)];this.alter("insert_col",n.end.col+1,1,"ContextMenu.columnRight")},disabled:function(){var t=(0,s.getValidSelection)(this);if(!t)return!0;if(!this.isColumnModificationAllowed())return!0;var e=a(t[0],3),n=e[0],r=e[1],i=[n,0,e[2],this.countCols()-1].join(",")===t.join(","),o=1===this.countCols();return r<0||this.countCols()>=this.getSettings().maxCols||!o&&i},hidden:function(){return!this.getSettings().allowInsertColumn}}};var s=n(23),r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3));var i=e.KEY="col_right"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0,e.default=function(){return{key:a,name:function(){var n=this,t=this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_READ_ONLY);return(0,i.checkSelectionConsistency)(this.getSelectedRange(),function(t,e){return n.getCellMeta(t,e).readOnly})&&(t=(0,i.markLabelAsSelected)(t)),t},callback:function(){var n=this,t=this.getSelectedRange(),r=(0,i.checkSelectionConsistency)(t,function(t,e){return n.getCellMeta(t,e).readOnly});(0,o.arrayEach)(t,function(t){t.forAll(function(t,e){n.setCellMeta(t,e,"readOnly",!r)})}),this.render()},disabled:function(){return!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())}}};var i=n(23),o=n(0),r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3));var a=e.KEY="make_read_only"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0,e.default=function(){return{key:i,name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_REDO)},callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}};var r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3));var i=e.KEY="redo"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0;var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.default=function(){return{key:s,name:function(){var t=this.getSelected(),e=0;if(t)if(1<t.length)e=1;else{var n=r(t[0],4);n[1]-n[3]!=0&&(e=1)}return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_REMOVE_COLUMN,e)},callback:function(){this.alter("remove_col",(0,o.transformSelectionToColumnDistance)(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){var t=(0,i.getValidSelection)(this),e=this.countCols();return!t||(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner()||!this.isColumnModificationAllowed()||!e)},hidden:function(){return!this.getSettings().allowRemoveColumn}}};var i=n(23),o=n(87),a=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3));var s=e.KEY="remove_col"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0;var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.default=function(){return{key:s,name:function(){var t=this.getSelected(),e=0;if(t)if(1<t.length)e=1;else{var n=r(t[0],3);n[0]-n[2]!=0&&(e=1)}return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_REMOVE_ROW,e)},callback:function(){this.alter("remove_row",(0,o.transformSelectionToRowDistance)(this.getSelected()),null,"ContextMenu.removeRow")},disabled:function(){var t=(0,i.getValidSelection)(this),e=this.countRows();return!t||(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner()||!e)},hidden:function(){return!this.getSettings().allowRemoveRow}}};var i=n(23),o=n(87),a=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3));var s=e.KEY="remove_row"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0,e.default=function(){return{key:o,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback:function(t,e){var n=e[Math.max(e.length-1,0)];this.alter("insert_row",n.start.row,1,"ContextMenu.rowAbove")},disabled:function(){return!(0,r.getValidSelection)(this)||(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}};var r=n(23),i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3));var o=e.KEY="row_above"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0,e.default=function(){return{key:o,name:function(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_ROW_BELOW)},callback:function(t,e){var n=e[Math.max(e.length-1,0)];this.alter("insert_row",n.end.row+1,1,"ContextMenu.rowBelow")},disabled:function(){return!(0,r.getValidSelection)(this)||(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}};var r=n(23),i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3));var o=e.KEY="row_below"},function(t,e,n){"use strict";e.__esModule=!0,e.KEY=void 0,e.default=function(){return{key:i,name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_UNDO)},callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}}};var r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3));var i=e.KEY="undo"},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=n(2),h=n(12);var o=(r(c,[{key:"getSourceType",value:function(t){var e="literal";return t instanceof Event&&(e="event"),e}},{key:"fitsAbove",value:function(t){return this.topRelative>=t.offsetHeight}},{key:"fitsBelow",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:window.innerHeight;return this.topRelative+t.offsetHeight<=n}},{key:"fitsOnRight",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:window.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=n}},{key:"fitsOnLeft",value:function(t){return this.leftRelative>=t.offsetWidth}}]),c);function c(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var e=(0,u.getWindowScrollTop)(),n=(0,u.getWindowScrollLeft)(),r=void 0,i=void 0,o=void 0,a=void 0,s=void 0,l=void 0;this.type=this.getSourceType(t),"literal"===this.type?(r=parseInt(t.top,10),o=parseInt(t.left,10),s=t.height||0,l=t.width||0,i=r,a=o,r+=e,o+=n):"event"===this.type&&(r=parseInt((0,h.pageY)(t),10),o=parseInt((0,h.pageX)(t),10),s=t.target.clientHeight,l=t.target.clientWidth,i=r-e,a=o-n),this.top=r,this.topRelative=i,this.left=o,this.leftRelative=a,this.scrollTop=e,this.scrollLeft=n,this.cellHeight=s,this.cellWidth=l}e.default=o},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var h=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t};function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var s=b(n(7)),l=b(n(17)),c=b(n(211)),u=n(0),d=n(4),f=n(2),p=n(5),g=b(n(355)),v=b(n(356)),m=b(n(357)),y=n(359),w=n(360);function b(t){return t&&t.__esModule?t:{default:t}}n(361),l.default.getSingleton().register("afterCopyLimit"),l.default.getSingleton().register("modifyCopyableRange"),l.default.getSingleton().register("beforeCut"),l.default.getSingleton().register("afterCut"),l.default.getSingleton().register("beforePaste"),l.default.getSingleton().register("afterPaste"),l.default.getSingleton().register("beforeCopy"),l.default.getSingleton().register("afterCopy");var C=new WeakMap,E=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(S,s.default),i(S,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().copyPaste}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings();C.get(this).isFragmentSelectionEnabled=t.fragmentSelection,"object"===r(t.copyPaste)&&(this.pasteMode=t.copyPaste.pasteMode||this.pasteMode,this.rowsLimit=t.copyPaste.rowsLimit||this.rowsLimit,this.columnsLimit=t.copyPaste.columnsLimit||this.columnsLimit),this.addHook("afterContextMenuDefaultOptions",function(t){return e.onAfterContextMenuDefaultOptions(t)}),this.addHook("afterOnCellMouseUp",function(){return e.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return e.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return e.onBeforeKeyDown()}),this.focusableElement=(0,y.createElement)(),this.focusableElement.addLocalHook("copy",function(t){return e.onCopy(t)}).addLocalHook("cut",function(t){return e.onCut(t)}).addLocalHook("paste",function(t){return e.onPaste(t)}),a(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),a(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&(0,y.destroyElement)(this.focusableElement),a(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){C.get(this).isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),document.execCommand("copy")}},{key:"cut",value:function(){C.get(this).isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),document.execCommand("cut")}},{key:"getRangedCopyableData",value:function(t){var r=this,i=[],e=[],o=[];return(0,u.arrayEach)(t,function(t){(0,d.rangeEach)(t.startRow,t.endRow,function(t){-1===e.indexOf(t)&&e.push(t)}),(0,d.rangeEach)(t.startCol,t.endCol,function(t){-1===o.indexOf(t)&&o.push(t)})}),(0,u.arrayEach)(e,function(e){var n=[];(0,u.arrayEach)(o,function(t){n.push(r.hot.getCopyableData(e,t))}),i.push(n)}),c.default.stringify(i)}},{key:"getRangedData",value:function(t){var r=this,i=[],e=[],o=[];return(0,u.arrayEach)(t,function(t){(0,d.rangeEach)(t.startRow,t.endRow,function(t){-1===e.indexOf(t)&&e.push(t)}),(0,d.rangeEach)(t.startCol,t.endCol,function(t){-1===o.indexOf(t)&&o.push(t)})}),(0,u.arrayEach)(e,function(e){var n=[];(0,u.arrayEach)(o,function(t){n.push(r.hot.getCopyableData(e,t))}),i.push(n)}),i}},{key:"paste",value:function(t,e){var n=0<arguments.length&&void 0!==t?t:"",r=1<arguments.length&&void 0!==e?e:n;if(n||r){var i=new m.default;n&&i.clipboardData.setData("text/plain",n),r&&i.clipboardData.setData("text/html",r),this.getOrCreateFocusableElement(),this.onPaste(i)}}},{key:"setCopyableText",value:function(){var t=this.hot.getSelectedRangeLast();if(t){var e=t.getTopLeftCorner(),n=t.getBottomRightCorner(),r=e.row,i=e.col,o=n.row,a=n.col,s=Math.min(o,r+this.rowsLimit-1),l=Math.min(a,i+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:r,startCol:i,endRow:s,endCol:l}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),o===s&&a===l||this.hot.runHooks("afterCopyLimit",o-r+1,a-i+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function(){var t=this.hot.getActiveEditor(),e=t?t.TEXTAREA:void 0;e?this.focusableElement.setFocusableElement(e):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var t=this.hot.getActiveEditor();return t&&t.isOpened()}},{key:"populateValues",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:this.hot.getSelectedLast();if(t.length){for(var r=t.length-1,i=t[0].length-1,o=Math.min(n[0],n[2]),a=Math.max(n[0],n[2],r+o),s=Math.min(n[1],n[3]),l=Math.max(n[1],n[3],i+s),u=[],h=o,c=0;h<=a;h+=1){for(var d=[],f=s,p=0;f<=l;f+=1)d.push(t[c][p]),p=p===i?0:p+=1;u.push(d),c=c===r?0:c+=1}return this.hot.populateFromArray(o,s,u,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,s,a,l]}}},{key:"onCopy",value:function(t){var e=C.get(this);if((this.hot.isListening()||e.isTriggeredByCopy)&&!this.isEditorOpened()){this.setCopyableText(),e.isTriggeredByCopy=!1;var n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCopy",n,this.copyableRanges)){var r=c.default.stringify(n);if(t&&t.clipboardData){var i=(0,w.arrayToTable)(n);t.clipboardData.setData("text/plain",r),t.clipboardData.setData("text/html",i)}else"undefined"==typeof ClipboardEvent&&window.clipboardData.setData("Text",r);this.hot.runHooks("afterCopy",n,this.copyableRanges)}t.preventDefault()}}},{key:"onCut",value:function(t){var e=C.get(this);if((this.hot.isListening()||e.isTriggeredByCut)&&!this.isEditorOpened()){this.setCopyableText(),e.isTriggeredByCut=!1;var n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",n,this.copyableRanges)){var r=c.default.stringify(n);if(t&&t.clipboardData){var i=(0,w.arrayToTable)(n);t.clipboardData.setData("text/plain",r),t.clipboardData.setData("text/html",i)}else"undefined"==typeof ClipboardEvent&&window.clipboardData.setData("Text",r);this.hot.emptySelectedCells(),this.hot.runHooks("afterCut",n,this.copyableRanges)}t.preventDefault()}}},{key:"onPaste",value:function(t){if(this.hot.isListening()&&!this.isEditorOpened()){t&&t.preventDefault&&t.preventDefault();var e=void 0;if(t&&void 0!==t.clipboardData){var n=t.clipboardData.getData("text/html");e=n&&/(<table)|(<TABLE)/.test(n)?(0,w.tableToArray)(n):t.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==window.clipboardData&&(e=window.clipboardData.getData("Text"));var r="string"!=typeof e?e:c.default.parse(e);if(0!==r.length&&!1!==this.hot.runHooks("beforePaste",r,this.copyableRanges)){var i=this.populateValues(r),o=h(i,4),a=o[0],s=o[1],l=o[2],u=o[3];this.hot.selectCell(a,s,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",r,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(t){t.items.push({name:"---------"},(0,g.default)(this),(0,v.default)(this))}},{key:"onAfterOnCellMouseUp",value:function(){this.hot.isListening()&&!this.isEditorOpened()&&(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){var t=C.get(this).isFragmentSelectionEnabled;this.isEditorOpened()||(this.getOrCreateFocusableElement(),t&&this.focusableElement.getFocusableElement()!==document.activeElement&&(0,f.getSelectionText)()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var t=document.activeElement,e=this.hot.getActiveEditor();!e||t!==this.focusableElement.getFocusableElement()&&t!==e.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&((0,y.destroyElement)(this.focusableElement),this.focusableElement=null),a(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"destroy",this).call(this)}}]),S);function S(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,S);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,t));return e.columnsLimit=1e3,e.copyableRanges=[],e.pasteMode="overwrite",e.rowsLimit=1e3,C.set(e,{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),e}(0,p.registerPlugin)("CopyPaste",E),e.default=E},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t){return{key:"copy",name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_COPY)},callback:function(){t.copy()},disabled:function(){var t=this.getSelected();return!t||1<t.length},hidden:!1}};var r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3))},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t){return{key:"cut",name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_CUT)},callback:function(){t.cut()},disabled:function(){var t=this.getSelected();return!t||1<t.length},hidden:!1}};var r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3))},function(t,e,n){"use strict";e.__esModule=!0;var r,i=n(358),o=(r=i)&&r.__esModule?r:{default:r};e.default=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.clipboardData=new o.default}},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.__esModule=!0;var i=(function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}(o,[{key:"setData",value:function(t,e){this.data[t]=e}},{key:"getData",value:function(t){return this.data[t]||void 0}}]),o);function o(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.data={}}e.default=i},function(t,e,n){"use strict";e.__esModule=!0,e.destroyElement=e.deactivateElement=e.createElement=void 0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=u(n(8)),a=u(n(20)),s=n(1),l=n(42);function u(t){return t&&t.__esModule?t:{default:t}}var h=(r(c,[{key:"useSecondaryElement",value:function(){var t=function(){if(v)return v.parentElement||document.body.appendChild(v),v;var t=document.createElement("textarea");return(v=t).id="HandsontableCopyPaste",t.className="copyPaste",t.tabIndex=-1,t.autocomplete="off",t.wrap="hard",t.value=" ",document.body.appendChild(t),t}();this.listenersCount.has(t)||(this.listenersCount.add(t),g(this.eventManager,t,this)),this.mainElement=t}},{key:"setFocusableElement",value:function(t){this.listenersCount.has(t)||(this.listenersCount.add(t),g(this.eventManager,t,this)),this.mainElement=t}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",(0,l.isMobileBrowser)()||this.mainElement.select()}}]),c);function c(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),this.mainElement=null,this.eventManager=new o.default(this),this.listenersCount=new WeakSet}(0,s.mixin)(h,a.default);var d=0;function f(t){t.eventManager.clear()}var p=function(e,n){return function(t){return n.runLocalHooks(e,t)}};function g(t,e,n){t.addEventListener(e,"copy",p("copy",n)),t.addEventListener(e,"cut",p("cut",n)),t.addEventListener(e,"paste",p("paste",n))}var v=void 0;e.createElement=function(){var t=new h;return d+=1,t},e.deactivateElement=f,e.destroyElement=function(t){t instanceof h&&(0<d&&(d-=1),f(t),d<=0&&(d=0,v&&v.parentNode&&(v.parentNode.removeChild(v),v=null),t.mainElement=null))}},function(t,e,n){"use strict";e.__esModule=!0,e.arrayToTable=function(t){var e=t.length,n=["<table>"],r=document.createElement("div");document.documentElement.appendChild(r);for(var i=0;i<e;i+=1){var o=t[i],a=o.length,s=[];0===i&&n.push("<tbody>");for(var l=0;l<a;l+=1)r.innerText=""+((0,u.isEmpty)(o[l])?"":o[l]),s.push("<td>"+r.innerHTML+"</td>");n.push.apply(n,["<tr>"].concat(s,["</tr>"])),i+1===e&&n.push("</tbody>")}return document.documentElement.removeChild(r),n.push("</table>"),n.join("")},e.tableToArray=function(t){var e=[],n=t;if("string"==typeof n){var r=document.createElement("div");r.innerHTML=n.replace(/\n/g,""),n=r.querySelector("table")}if(n&&function(t){return"table"===(t&&t.nodeName||"").toLowerCase()}(n)){for(var i=n.rows,o=i&&i.length,a=[],s=0;s<o;s+=1){for(var l=i[s].cells,u=l.length,h=[],c=0;c<u;c+=1){var d=l[c];d.innerHTML=d.innerHTML.trim().replace(/<br(.|)>(\n?)/,"\n");var f=d.innerText;h.push(f)}a.push(h)}e.push.apply(e,a)}return e};var u=n(10)},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var f=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o,s=n(7),l=(o=s)&&o.__esModule?o:{default:o},u=n(5),h=n(1),c=n(4),p=n(0),d=n(9),g=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),v=n(363),m=n(57),y=n(217);var w=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(b,l.default),r(b,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().customBorders}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(t){return e.onAfterContextMenuDefaultOptions(t)}),this.addHook("afterInit",function(){return e.onAfterInit()}),a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(t,u){var h=this,c=u?Object.keys(u):["top","right","bottom","left"],e=(0,y.detectSelectionType)(t),d=(0,y.normalizeSelectionFactory)(e);(0,p.arrayEach)(t,function(t){for(var e=d(t),n=f(e,4),r=n[0],i=n[1],o=n[2],a=n[3],s=function(n){for(var t=function(e){(0,p.arrayEach)(c,function(t){h.prepareBorderFromCustomAdded(n,e,u,t)})},e=i;e<=a;e+=1)t(e)},l=r;l<=o;l+=1)s(l)})}},{key:"getBorders",value:function(t){var u=this;if(!Array.isArray(t))return this.savedBorders;var e=(0,y.detectSelectionType)(t),h=(0,y.normalizeSelectionFactory)(e),c=[];return(0,p.arrayEach)(t,function(t){for(var e=h(t),n=f(e,4),r=n[0],i=n[1],o=n[2],a=n[3],s=function(n){for(var t=function(e){(0,p.arrayEach)(u.savedBorders,function(t){t.row===n&&t.col===e&&c.push(t)})},e=i;e<=a;e+=1)t(e)},l=r;l<=o;l+=1)s(l)}),c}},{key:"clearBorders",value:function(t){var e=this;t?this.setBorders(t):((0,p.arrayEach)(this.savedBorders,function(t){e.clearBordersFromSelectionSettings(t.id),e.clearNullCellRange(),e.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(t,e){this.checkSavedBorders(t)||this.savedBorders.push(t);var n={row:t.row,col:t.col},r=new d.CellRange(n,n,n);this.checkCustomSelections(t,r,e)||(this.hot.selection.highlight.addCustomSelection({border:t,cellRange:r}),this.hot.view.wt.draw(!0))}},{key:"prepareBorderFromCustomAdded",value:function(t,e,n,r){var i=(0,m.createEmptyBorders)(t,e);n&&(i=(0,m.extendDefaultBorder)(i,n),(0,p.arrayEach)(this.hot.selection.highlight.customSelections,function(t){if(i.id===t.settings.id)return Object.assign(t.settings,n),i=t.settings,!1})),this.hot.setCellMeta(t,e,"borders",i),this.insertBorderIntoSettings(i,r)}},{key:"prepareBorderFromCustomAddedRange",value:function(i){var o=this,a=i.range;(0,c.rangeEach)(a.from.row,a.to.row,function(r){(0,c.rangeEach)(a.from.col,a.to.col,function(t){var e=(0,m.createEmptyBorders)(r,t),n=0;r===a.from.row&&(n+=1,(0,h.hasOwnProperty)(i,"top")&&(e.top=i.top)),r===a.to.row&&(n+=1,(0,h.hasOwnProperty)(i,"bottom")&&(e.bottom=i.bottom)),t===a.from.col&&(n+=1,(0,h.hasOwnProperty)(i,"left")&&(e.left=i.left)),t===a.to.col&&(n+=1,(0,h.hasOwnProperty)(i,"right")&&(e.right=i.right)),0<n&&(o.hot.setCellMeta(r,t,"borders",e),o.insertBorderIntoSettings(e))})})}},{key:"removeAllBorders",value:function(t,e){var n=(0,m.createId)(t,e);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}},{key:"setBorder",value:function(t,e,n,r){var i=this.hot.getCellMeta(t,e).borders;i&&void 0!==i.border||(i=(0,m.createEmptyBorders)(t,e)),r?(i[n]=(0,m.createSingleEmptyBorder)(),4===this.countHide(i)?this.removeAllBorders(t,e):(this.checkCustomSelectionsFromContextMenu(i,n,r)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(t,e,"borders",i))):(i[n]=(0,m.createDefaultCustomBorder)(),this.checkCustomSelectionsFromContextMenu(i,n,r)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(t,e,"borders",i))}},{key:"prepareBorder",value:function(t,e,i){var o=this;(0,p.arrayEach)(t,function(t){var n=t.start,r=t.end;if(n.row===r.row&&n.col===r.col)"noBorders"===e?o.removeAllBorders(n.row,n.col):o.setBorder(n.row,n.col,e,i);else switch(e){case"noBorders":(0,c.rangeEach)(n.col,r.col,function(e){(0,c.rangeEach)(n.row,r.row,function(t){o.removeAllBorders(t,e)})});break;case"top":(0,c.rangeEach)(n.col,r.col,function(t){o.setBorder(n.row,t,e,i)});break;case"right":(0,c.rangeEach)(n.row,r.row,function(t){o.setBorder(t,r.col,e,i)});break;case"bottom":(0,c.rangeEach)(n.col,r.col,function(t){o.setBorder(r.row,t,e,i)});break;case"left":(0,c.rangeEach)(n.row,r.row,function(t){o.setBorder(t,n.col,e,i)})}})}},{key:"createCustomBorders",value:function(t){var e=this;(0,p.arrayEach)(t,function(t){t.range?e.prepareBorderFromCustomAddedRange(t):e.prepareBorderFromCustomAdded(t.row,t.col,t)})}},{key:"countHide",value:function(t){var e=Object.values(t);return(0,p.arrayReduce)(e,function(t,e){var n=t;return e.hide&&(n+=1),n},0)}},{key:"clearBordersFromSelectionSettings",value:function(t){var e=(0,p.arrayMap)(this.hot.selection.highlight.customSelections,function(t){return t.settings.id}).indexOf(t);-1<e&&this.hot.selection.highlight.customSelections[e].clear(),this.hot.view.wt.draw(!0)}},{key:"clearNullCellRange",value:function(){var n=this;(0,p.arrayEach)(this.hot.selection.highlight.customSelections,function(t,e){if(null===t.cellRange)return n.hot.selection.highlight.customSelections.splice(e,1),!1})}},{key:"hideBorders",value:function(){var e=this;(0,p.arrayEach)(this.savedBorders,function(t){e.clearBordersFromSelectionSettings(t.id)})}},{key:"spliceBorder",value:function(t){var e=(0,p.arrayMap)(this.savedBorders,function(t){return t.id}).indexOf(t);-1<e&&this.savedBorders.splice(e,1)}},{key:"checkSavedBorders",value:function(n){var r=this,i=!1;return 4===this.countHide(n)?(this.spliceBorder(n.id),i=!0):(0,p.arrayEach)(this.savedBorders,function(t,e){if(n.id===t.id)return r.savedBorders[e]=n,!(i=!0)}),i}},{key:"checkCustomSelectionsFromContextMenu",value:function(e,n,r){var i=!1;return(0,p.arrayEach)(this.hot.selection.highlight.customSelections,function(t){if(e.id===t.settings.id)return(0,h.objectEach)(t.instanceBorders,function(t){t.toggleHiddenClass(n,r)}),!(i=!0)}),i}},{key:"checkCustomSelections",value:function(e,n,r){var t=this.countHide(e),i=!1;return 4===t?(this.removeAllBorders(e.row,e.col),this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange(),i=!0):(0,p.arrayEach)(this.hot.selection.highlight.customSelections,function(t){if(e.id===t.settings.id)return t.cellRange=n,r&&(0,h.objectEach)(t.instanceBorders,function(t){t.changeBorderStyle(r,e)}),!(i=!0)}),i}},{key:"changeBorderSettings",value:function(){var t=this.hot.getSettings().customBorders;Array.isArray(t)?(t.length||(this.savedBorders=t),this.createCustomBorders(t)):void 0!==t&&this.createCustomBorders(this.savedBorders)}},{key:"onAfterContextMenuDefaultOptions",value:function(t){this.hot.getSettings().customBorders&&t.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(g.CONTEXTMENU_ITEMS_BORDERS)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[(0,v.top)(this),(0,v.right)(this),(0,v.bottom)(this),(0,v.left)(this),(0,v.noBorders)(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"destroy",this).call(this)}}]),b);function b(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,t));return e.savedBorders=[],e}(0,u.registerPlugin)("customBorders",w),e.default=w},function(t,e,n){"use strict";e.__esModule=!0,e.top=e.right=e.noBorders=e.left=e.bottom=void 0;var r=l(n(364)),i=l(n(365)),o=l(n(366)),a=l(n(367)),s=l(n(368));function l(t){return t&&t.__esModule?t:{default:t}}e.bottom=r.default,e.left=i.default,e.noBorders=o.default,e.right=a.default,e.top=s.default},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(r){return{key:"borders:bottom",name:function(){var t=this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return(0,o.checkSelectionBorders)(this,"bottom")&&(t=(0,o.markSelected)(t)),t},callback:function(t,e){var n=(0,o.checkSelectionBorders)(this,"bottom");r.prepareBorder(e,"bottom",n)}}};var i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),o=n(57)},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(r){return{key:"borders:left",name:function(){var t=this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_BORDERS_LEFT);return(0,o.checkSelectionBorders)(this,"left")&&(t=(0,o.markSelected)(t)),t},callback:function(t,e){var n=(0,o.checkSelectionBorders)(this,"left");r.prepareBorder(e,"left",n)}}};var i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),o=n(57)},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(n){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback:function(t,e){n.prepareBorder(e,"noBorders")},disabled:function(){return!(0,i.checkSelectionBorders)(this)}}};var r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),i=n(57)},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(r){return{key:"borders:right",name:function(){var t=this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_BORDERS_RIGHT);return(0,o.checkSelectionBorders)(this,"right")&&(t=(0,o.markSelected)(t)),t},callback:function(t,e){var n=(0,o.checkSelectionBorders)(this,"right");r.prepareBorder(e,"right",n)}}};var i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),o=n(57)},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(r){return{key:"borders:top",name:function(){var t=this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_BORDERS_TOP);return(0,o.checkSelectionBorders)(this,"top")&&(t=(0,o.markSelected)(t)),t},callback:function(t,e){var n=(0,o.checkSelectionBorders)(this,"top");r.prepareBorder(e,"top",n)}}};var i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),o=n(57)},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=u(n(7)),s=u(n(8)),l=n(5);function u(t){return t&&t.__esModule?t:{default:t}}var h=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(c,o.default),r(c,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().dragToScroll}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(){return t.setupListening()}),this.addHook("afterOnCellCornerMouseDown",function(){return t.setupListening()}),this.registerEvents(),a(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),a(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),a(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(t){this.boundaries=t}},{key:"setCallback",value:function(t){this.callback=t}},{key:"check",value:function(t,e){var n=0,r=0;e<this.boundaries.top?r=e-this.boundaries.top:e>this.boundaries.bottom&&(r=e-this.boundaries.bottom),t<this.boundaries.left?n=t-this.boundaries.left:t>this.boundaries.right&&(n=t-this.boundaries.right),this.callback(n,r)}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(document,"mouseup",function(){return e.onMouseUp()}),this.eventManager.addEventListener(document,"mousemove",function(t){return e.onMouseMove(t)})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(){var n=this.hot.view.wt.wtTable.holder;n!==window&&(this.setBoundaries(n.getBoundingClientRect()),this.setCallback(function(t,e){t<0?n.scrollLeft-=50:0<t&&(n.scrollLeft+=50),e<0?n.scrollTop-=20:0<e&&(n.scrollTop+=20)}),this.listening=!0)}},{key:"onMouseMove",value:function(t){this.listening&&this.check(t.clientX,t.clientY)}},{key:"onMouseUp",value:function(){this.listening=!1}},{key:"destroy",value:function(){a(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"destroy",this).call(this)}}]),c);function c(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,t));return e.eventManager=new s.default(e),e.boundaries=null,e.callback=null,e.listening=!1,e}(0,l.registerPlugin)("dragToScroll",h),e.default=h},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=c(n(7)),s=n(5),l=n(0),u=c(n(371)),h=c(n(372));function c(t){return t&&t.__esModule?t:{default:t}}n(373);var d=new WeakMap,f=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(p,o.default),r(p,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnFreeze}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(t){return n.addContextMenuEntry(t)}),this.addHook("afterInit",function(){return n.onAfterInit()}),this.addHook("beforeColumnMove",function(t,e){return n.onBeforeColumnMove(t,e)}),a(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=d.get(this);t.afterFirstUse=!1,t.moveByFreeze=!1,a(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),a(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(t){var e=d.get(this),n=this.hot.getSettings();e.afterFirstUse||(e.afterFirstUse=!0),n.fixedColumnsLeft===this.hot.countCols()||t<=n.fixedColumnsLeft-1||(e.moveByFreeze=!0,t!==this.getMovePlugin().columnsMapper.getValueByIndex(t)&&(this.frozenColumnsBasePositions[n.fixedColumnsLeft]=t),this.getMovePlugin().moveColumn(t,n.fixedColumnsLeft),n.fixedColumnsLeft+=1)}},{key:"unfreezeColumn",value:function(t){var e=d.get(this),n=this.hot.getSettings();if(e.afterFirstUse||(e.afterFirstUse=!0),!(n.fixedColumnsLeft<=0||t>n.fixedColumnsLeft-1)){var r=this.getBestColumnReturnPosition(t);e.moveByFreeze=!0,n.fixedColumnsLeft-=1,this.getMovePlugin().moveColumn(t,r+1)}}},{key:"getMovePlugin",value:function(){return this.manualColumnMovePlugin||(this.manualColumnMovePlugin=this.hot.getPlugin("manualColumnMove")),this.manualColumnMovePlugin}},{key:"getBestColumnReturnPosition",value:function(t){var e=this.getMovePlugin(),n=this.hot.getSettings().fixedColumnsLeft,r=e.columnsMapper.getValueByIndex(n),i=void 0;if(null===this.frozenColumnsBasePositions[t]||void 0===this.frozenColumnsBasePositions[t])for(i=e.columnsMapper.getValueByIndex(t);null!==r&&r<=i;)n+=1,r=e.columnsMapper.getValueByIndex(n);else{for(i=this.frozenColumnsBasePositions[t],this.frozenColumnsBasePositions[t]=void 0;null!==r&&r<=i;)n+=1,r=e.columnsMapper.getValueByIndex(n);n=r}return n-1}},{key:"addContextMenuEntry",value:function(t){t.items.push({name:"---------"},(0,u.default)(this),(0,h.default)(this))}},{key:"onAfterInit",value:function(){this.getMovePlugin().isEnabled()||this.getMovePlugin().enablePlugin()}},{key:"onBeforeColumnMove",value:function(t,e){var n=d.get(this);if(n.afterFirstUse&&!n.moveByFreeze){var r=this.hot.getSettings().fixedColumnsLeft,i=e<r;if(i||(0,l.arrayEach)(t,function(t){if(t<r)return!(i=!0)}),i)return!1}n.moveByFreeze&&(n.moveByFreeze=!1)}},{key:"destroy",value:function(){a(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"destroy",this).call(this)}}]),p);function p(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,t));return d.set(e,{moveByFreeze:!1,afterFirstUse:!1}),e.frozenColumnsBasePositions=[],e.manualColumnMovePlugin=void 0,e}(0,s.registerPlugin)("manualColumnFreeze",f),e.default=f},function(t,e,n){"use strict";e.__esModule=!0;var i=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.default=function(r){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback:function(t,e){var n=i(e,1)[0].start.col;r.freezeColumn(n),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),e=!1;return void 0===t?e=!0:1<t.length?e=!0:(t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsLeft-1)&&(e=!0),e}}};var o=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3))},function(t,e,n){"use strict";e.__esModule=!0;var i=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.default=function(r){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback:function(t,e){var n=i(e,1)[0].start.col;r.unfreezeColumn(n),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),e=!1;return void 0===t?e=!0:1<t.length?e=!0:(t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsLeft)&&(e=!0),e}}};var o=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3))},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=g(n(7)),s=g(n(17)),l=n(0),E=n(2),u=n(4),h=g(n(8)),c=n(5),d=g(n(375)),f=g(n(376)),p=g(n(377));function g(t){return t&&t.__esModule?t:{default:t}}n(378),s.default.getSingleton().register("beforeColumnMove"),s.default.getSingleton().register("afterColumnMove"),s.default.getSingleton().register("unmodifyCol");var S=new WeakMap,v="ht__manualColumnMove",O="show-ui",T="on-moving--columns",N="after-selection--columns",m=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(y,o.default),r(y,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnMove}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(t,e,n,r){return i.onBeforeOnCellMouseDown(t,e,n,r)}),this.addHook("beforeOnCellMouseOver",function(t,e,n,r){return i.onBeforeOnCellMouseOver(t,e,n,r)}),this.addHook("afterScrollVertically",function(){return i.onAfterScrollVertically()}),this.addHook("modifyCol",function(t,e){return i.onModifyCol(t,e)}),this.addHook("beforeRemoveCol",function(t,e){return i.onBeforeRemoveCol(t,e)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol()}),this.addHook("afterCreateCol",function(t,e){return i.onAfterCreateCol(t,e)}),this.addHook("afterLoadData",function(){return i.onAfterLoadData()}),this.addHook("unmodifyCol",function(t){return i.onUnmodifyCol(t)}),this.registerEvents(),(0,E.addClass)(this.hot.rootElement,v),a(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),a(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=this.hot.getSettings().manualColumnMove;Array.isArray(t)&&this.columnsMapper.clearMap(),(0,E.removeClass)(this.hot.rootElement,v),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),a(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(t,e){this.moveColumns([t],e)}},{key:"moveColumns",value:function(t,r){var i=this,e=[].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(t)),n=S.get(this),o=this.hot.runHooks("beforeColumnMove",e,r);n.disallowMoving=!o,!1!==o&&((0,l.arrayEach)(t,function(t,e,n){n[e]=i.columnsMapper.getValueByIndex(t)}),(0,l.arrayEach)(t,function(t,e){var n=i.columnsMapper.getIndexByValue(t);n!==r&&i.columnsMapper.moveColumn(n,r+e)}),this.columnsMapper.clearNull()),this.hot.runHooks("afterColumnMove",e,r)}},{key:"changeSelection",value:function(t,e){this.hot.selectColumns(t,e)}},{key:"getColumnsWidth",value:function(t,e){for(var n=0,r=t;r<e;r++)n+=r<0?this.hot.view.wt.wtViewport.getRowHeaderWidth()||0:this.hot.view.wt.wtTable.getStretchedColumnWidth(r)||0;return n}},{key:"initialSettings",value:function(){var t=this.hot.getSettings().manualColumnMove;Array.isArray(t)?this.moveColumns(t,0):void 0!==t&&this.persistentStateLoad()}},{key:"isFixedColumnsLeft",value:function(t){return t<this.hot.getSettings().fixedColumnsLeft}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.columnsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var t={};this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value&&(this.columnsMapper._arrayMap=t.value)}},{key:"prepareColumnsToMoving",value:function(t,e){var n=[];return(0,u.rangeEach)(t,e,function(t){n.push(t)}),n}},{key:"refreshPositions",value:function(){var t=S.get(this),e=this.hot.view.wt.wtTable.getFirstVisibleColumn(),n=this.hot.view.wt.wtTable.getLastVisibleColumn(),r=this.hot.view.wt.wtTable,i=this.hot.view.wt.wtOverlays.scrollableElement,o="number"==typeof i.scrollX?i.scrollX:i.scrollLeft,a=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,t.coordsColumn),s=t.target.eventPageX-(t.rootElementOffset-(void 0===i.scrollX?o:0)),l=r.hider.offsetWidth,u=r.TBODY.offsetLeft,h=this.backlight.getOffset().left,c=this.backlight.getSize().width,d=0;if(t.rootElementOffset+r.holder.offsetWidth+o<t.target.eventPageX&&t.coordsColumn<t.countCols&&(t.coordsColumn+=1),t.hasRowHeaders&&(d=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsLeft(t.coordsColumn)&&(a+=o),a+=d,t.coordsColumn<0)0<t.fixedColumns?t.target.col=0:t.target.col=0<e?e-1:e;else if(t.target.TD.offsetWidth/2+a<=s){var f=t.coordsColumn>=t.countCols?t.countCols-1:t.coordsColumn;t.target.col=f+1,a+=t.target.TD.offsetWidth,t.target.col>n&&n<t.countCols&&this.hot.scrollViewportTo(void 0,n+1,void 0,!0)}else t.target.col=t.coordsColumn,t.target.col<=e&&t.target.col>=t.fixedColumns&&0<e&&this.hot.scrollViewportTo(void 0,e-1);t.target.col<=e&&t.target.col>=t.fixedColumns&&0<e&&this.hot.scrollViewportTo(void 0,e-1);var p=s,g=a;l<=s+c+h?p=l-c-h:s+h<u+d&&(p=u+d+Math.abs(h)),l-1<=a?g=l-1:0===g?g=1:void 0!==i.scrollX&&t.coordsColumn<t.fixedColumns&&(g-=t.rootElementOffset<=i.scrollX?t.rootElementOffset:0),this.backlight.setPosition(null,p),this.guideline.setPosition(null,g)}},{key:"updateColumnsMapper",value:function(){var t=this.hot.countSourceCols(),e=this.columnsMapper._arrayMap.length;if(0===e)this.columnsMapper.createMap(t||this.hot.getSettings().startCols);else if(e<t){var n=t-e;this.columnsMapper.insertItems(e,n)}else if(t<e){var r=t-1,i=[];(0,l.arrayEach)(this.columnsMapper._arrayMap,function(t,e){r<t&&i.push(e)}),this.columnsMapper.removeItems(i)}}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return e.onMouseMove(t)}),this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return e.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){var i=this.hot.view.wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),s=S.get(this),l=-1<t.realTarget.className.indexOf("sortAction");if(!a||!o||s.pressed||0!==t.button||l)return s.pressed=!1,void(s.columnsToMove.length=0,E.removeClass)(this.hot.rootElement,[T,O]);var u=this.guideline.isBuilt()&&!this.guideline.isAppended(),h=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&h&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));var c=a.from,d=a.to,f=Math.min(c.col,d.col),p=Math.max(c.col,d.col);if(e.row<0&&e.col>=f&&e.col<=p){r.column=!0,s.pressed=!0,s.target.eventPageX=t.pageX,s.coordsColumn=e.col,s.target.TD=n,s.target.col=e.col,s.columnsToMove=this.prepareColumnsToMoving(f,p),s.hasRowHeaders=!!this.hot.getSettings().rowHeaders,s.countCols=this.hot.countCols(),s.fixedColumns=this.hot.getSettings().fixedColumnsLeft,s.rootElementOffset=(0,E.offset)(this.hot.rootElement).left;var g=s.hasRowHeaders?-1:0,v=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,m=e.col<s.fixedColumns,y=this.hot.view.wt.wtOverlays.scrollableElement,w=y.scrollX?y.scrollX-s.rootElementOffset:0,b=t.layerX-(m?w:0),C=Math.abs(this.getColumnsWidth(f,e.col)+b);this.backlight.setPosition(v,this.getColumnsWidth(g,f)+C),this.backlight.setSize(this.getColumnsWidth(f,p+1),i.hider.offsetHeight-v),this.backlight.setOffset(null,-1*C),(0,E.addClass)(this.hot.rootElement,T)}else(0,E.removeClass)(this.hot.rootElement,N),s.pressed=!1,s.columnsToMove.length=0}},{key:"onMouseMove",value:function(t){var e=S.get(this);if(e.pressed){if(t.realTarget===this.backlight.element){var n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(n)})}e.target.eventPageX=t.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){var i=this.hot.getSelectedRangeLast(),o=S.get(this);i&&o.pressed&&(-1<o.columnsToMove.indexOf(e.col)?(0,E.removeClass)(this.hot.rootElement,O):(0,E.addClass)(this.hot.rootElement,O),r.row=!0,r.column=!0,r.cell=!0,o.coordsColumn=e.col,o.target.TD=n)}},{key:"onMouseUp",value:function(){var t=S.get(this);if(t.coordsColumn=void 0,t.pressed=!1,(t.backlightWidth=0,E.removeClass)(this.hot.rootElement,[T,O,N]),this.hot.selection.isSelectedByColumnHeader()&&(0,E.addClass)(this.hot.rootElement,N),!(t.columnsToMove.length<1||void 0===t.target.col||-1<t.columnsToMove.indexOf(t.target.col))){if(this.moveColumns(t.columnsToMove,t.target.col),this.persistentStateSave(),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0),!t.disallowMoving){var e=this.columnsMapper.getIndexByValue(t.columnsToMove[0]),n=this.columnsMapper.getIndexByValue(t.columnsToMove[t.columnsToMove.length-1]);this.changeSelection(e,n)}t.columnsToMove.length=0}}},{key:"onAfterScrollVertically",value:function(){var t=this.hot.view.wt.wtTable,e=t.getColumnHeaderHeight(0)+1+t.holder.scrollTop;this.backlight.setPosition(e),this.backlight.setSize(null,t.hider.offsetHeight-e)}},{key:"onAfterCreateCol",value:function(t,e){this.columnsMapper.shiftItems(t,e)}},{key:"onBeforeRemoveCol",value:function(t,e){var n=this;this.removedColumns.length=0,!1!==t&&(0,u.rangeEach)(t,t+e-1,function(t){n.removedColumns.push(n.hot.runHooks("modifyCol",t,n.pluginName))})}},{key:"onAfterRemoveCol",value:function(){this.columnsMapper.unshiftItems(this.removedColumns)}},{key:"onAfterLoadData",value:function(){this.updateColumnsMapper()}},{key:"onModifyCol",value:function(t,e){var n=t;if(e!==this.pluginName){var r=this.columnsMapper.getValueByIndex(n);n=null===r?n:r}return n}},{key:"onUnmodifyCol",value:function(t){var e=this.columnsMapper.getIndexByValue(t);return null===e?t:e}},{key:"onAfterPluginsInitialized",value:function(){this.updateColumnsMapper(),this.initialSettings(),this.backlight.build(),this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),a(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"destroy",this).call(this)}}]),y);function y(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,t));return S.set(e,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,disallowMoving:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0}}),e.removedColumns=[],e.columnsMapper=new d.default(e),e.eventManager=new h.default(e),e.backlight=new f.default(t),e.guideline=new p.default(t),e}(0,c.registerPlugin)("ManualColumnMove",m),e.default=m},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(56),s=(o=a)&&o.__esModule?o:{default:o},l=n(0),u=n(1),h=n(4);var c=(r(d,[{key:"createMap",value:function(t){var e=this,n=void 0===t?this._arrayMap.length:t;(this._arrayMap.length=0,h.rangeEach)(n-1,function(t){e._arrayMap[t]=t})}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveColumn",value:function(t,e){var n=this._arrayMap[t];this._arrayMap[t]=null,this._arrayMap.splice(e,0,n)}},{key:"clearNull",value:function(){this._arrayMap=(0,l.arrayFilter)(this._arrayMap,function(t){return null!==t})}}]),d);function d(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),this.manualColumnMove=t}(0,u.mixin)(c,s.default),e.default=c},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(224),s=(o=a)&&o.__esModule?o:{default:o},l=n(2);var u=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(h,s.default),r(h,[{key:"build",value:function(){(function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"build",this).call(this),(0,l.addClass)(this._element,"ht__manualColumnMove--backlight")}}]),h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(h.__proto__||Object.getPrototypeOf(h)).apply(this,arguments))}e.default=u},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(224),s=(o=a)&&o.__esModule?o:{default:o},l=n(2);var u=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(h,s.default),r(h,[{key:"build",value:function(){(function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"build",this).call(this),(0,l.addClass)(this._element,"ht__manualColumnMove--guideline")}}]),h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(h.__proto__||Object.getPrototypeOf(h)).apply(this,arguments))}e.default=u},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=f(n(7)),h=n(2),s=f(n(8)),l=n(12),u=n(0),c=n(4),d=n(5);function f(t){return t&&t.__esModule?t:{default:t}}var p=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(g,o.default),r(g,[{key:"isEnabled",value:function(){return this.hot.getSettings().manualColumnResize}},{key:"enablePlugin",value:function(){var r=this;if(!this.enabled){this.manualColumnWidths=[];var t=this.hot.getSettings().manualColumnResize,e=this.loadManualColumnWidths();this.addHook("modifyColWidth",function(t,e){return r.onModifyColWidth(t,e)}),this.addHook("beforeStretchingColumnWidth",function(t,e){return r.onBeforeStretchingColumnWidth(t,e)}),this.addHook("beforeColumnResize",function(t,e,n){return r.onBeforeColumnResize(t,e,n)}),void 0!==e?this.manualColumnWidths=e:Array.isArray(t)?this.manualColumnWidths=t:this.manualColumnWidths=[],this.bindEvents(),a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().manualColumnResize;Array.isArray(t)?this.manualColumnWidths=t:t||(this.manualColumnWidths=[])}},{key:"disablePlugin",value:function(){a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave","manualColumnWidths",this.manualColumnWidths)}},{key:"loadManualColumnWidths",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualColumnWidths",t),t.value}},{key:"setupHandlePosition",value:function(t){var e=this;if(!t.parentNode)return!1;this.currentTH=t;var n=this.hot.view.wt.wtTable.getCoords(t).col,r=(0,h.outerHeight)(this.currentTH);if(0<=n){var i=this.currentTH.getBoundingClientRect();if(this.currentCol=n,this.selectedCols=[],this.hot.selection.isSelected()&&this.hot.selection.isSelectedByColumnHeader()){var o=this.hot.getSelectedRangeLast(),a=o.from,s=o.to,l=a.col,u=s.col;u<=l&&(l=s.col,u=a.col),this.currentCol>=l&&this.currentCol<=u?(0,c.rangeEach)(l,u,function(t){return e.selectedCols.push(t)}):this.selectedCols.push(this.currentCol)}else this.selectedCols.push(this.currentCol);this.startOffset=i.left-6,this.startWidth=parseInt(i.width,10),this.handle.style.top=i.top+"px",this.handle.style.left=this.startOffset+this.startWidth+"px",this.handle.style.height=r+"px",this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.left=this.startOffset+this.currentWidth+"px"}},{key:"setupGuidePosition",value:function(){var t=parseInt((0,h.outerHeight)(this.handle),10),e=parseInt(this.handle.style.top,10)+t,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);(0,h.addClass)(this.handle,"active"),(0,h.addClass)(this.guide,"active"),this.guide.style.top=e+"px",this.guide.style.left=this.handle.style.left,this.guide.style.height=n-t+"px",this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.left=this.handle.style.left}},{key:"hideHandleAndGuide",value:function(){(0,h.removeClass)(this.handle,"active"),(0,h.removeClass)(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(t){if(t===this.hot.rootElement)return!1;var e=t.parentNode;return"THEAD"===e.tagName||this.checkIfColumnHeader(e)}},{key:"getTHFromTargetElement",value:function(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getTHFromTargetElement(t.parentNode):null}},{key:"onMouseOver",value:function(t){if(this.checkIfColumnHeader(t.target)){var e=this.getTHFromTargetElement(t.target);if(!e)return;var n=e.getAttribute("colspan");!e||null!==n&&1!==n||this.pressed||this.setupHandlePosition(e)}}},{key:"afterMouseDownTimeout",value:function(){function r(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.wt.wtOverlays.adjustElementsSize(!0)}function e(t,e){var n=i.hot.runHooks("beforeColumnResize",t,i.newSize,!0);void 0!==n&&(i.newSize=n),"all"===i.hot.getSettings().stretchH?i.clearManualSize(t):i.setManualSize(t,i.newSize),e&&r(),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",t,i.newSize,!0)}var i=this;2<=this.dblclick&&(1<this.selectedCols.length?((0,u.arrayEach)(this.selectedCols,function(t){e(t)}),r()):(0,u.arrayEach)(this.selectedCols,function(t){e(t,!0)})),this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(t){var e=this;(0,h.hasClass)(t.target,"manualColumnResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return e.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=(0,l.pageX)(t),this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(t){var e=this;this.pressed&&(this.currentWidth=this.startWidth+((0,l.pageX)(t)-this.startX),(0,u.arrayEach)(this.selectedCols,function(t){e.newSize=e.setManualSize(t,e.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){function n(){r.hot.forceFullRender=!0,r.hot.view.render(),r.hot.view.wt.wtOverlays.adjustElementsSize(!0)}function e(t,e){r.hot.runHooks("beforeColumnResize",t,r.newSize,!1),e&&n(),r.saveManualColumnWidths(),r.hot.runHooks("afterColumnResize",t,r.newSize)}var r=this;this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(1<this.selectedCols.length?((0,u.arrayEach)(this.selectedCols,function(t){e(t)}),n()):(0,u.arrayEach)(this.selectedCols,function(t){e(t,!0)})),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(t){return e.onMouseOver(t)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(t){return e.onMouseDown(t)}),this.eventManager.addEventListener(window,"mousemove",function(t){return e.onMouseMove(t)}),this.eventManager.addEventListener(window,"mouseup",function(){return e.onMouseUp()})}},{key:"setManualSize",value:function(t,e){var n=Math.max(e,20),r=this.hot.runHooks("modifyCol",t);return this.manualColumnWidths[r]=n}},{key:"clearManualSize",value:function(t){var e=this.hot.runHooks("modifyCol",t);this.manualColumnWidths[e]=void 0}},{key:"onModifyColWidth",value:function(t,e){var n=t;if(this.enabled){var r=this.hot.runHooks("modifyCol",e),i=this.manualColumnWidths[r];this.hot.getSettings().manualColumnResize&&i&&(n=i)}return n}},{key:"onBeforeStretchingColumnWidth",value:function(t,e){var n=this.manualColumnWidths[e];return void 0===n&&(n=t),n}},{key:"onBeforeColumnResize",value:function(){this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked={}}}]),g);function g(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,t));return e.currentTH=null,e.currentCol=null,e.selectedCols=[],e.currentWidth=null,e.newSize=null,e.startY=null,e.startWidth=null,e.startOffset=null,e.handle=document.createElement("DIV"),e.guide=document.createElement("DIV"),e.eventManager=new s.default(e),e.pressed=null,e.dblclick=0,e.autoresizeTimeout=null,e.manualColumnWidths=[],(0,h.addClass)(e.handle,"manualColumnResizer"),(0,h.addClass)(e.guide,"manualColumnResizerGuide"),e}(0,d.registerPlugin)("manualColumnResize",p),e.default=p},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=g(n(7)),s=g(n(17)),l=n(0),y=n(2),u=n(4),h=g(n(8)),c=n(5),d=g(n(381)),f=g(n(382)),p=g(n(383));function g(t){return t&&t.__esModule?t:{default:t}}n(384),s.default.getSingleton().register("beforeRowMove"),s.default.getSingleton().register("afterRowMove"),s.default.getSingleton().register("unmodifyRow");var w=new WeakMap,v="ht__manualRowMove",m="show-ui",b="on-moving--rows",C="after-selection--rows",E=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(S,o.default),r(S,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualRowMove}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(t,e,n,r){return i.onBeforeOnCellMouseDown(t,e,n,r)}),this.addHook("beforeOnCellMouseOver",function(t,e,n,r){return i.onBeforeOnCellMouseOver(t,e,n,r)}),this.addHook("afterScrollHorizontally",function(){return i.onAfterScrollHorizontally()}),this.addHook("modifyRow",function(t,e){return i.onModifyRow(t,e)}),this.addHook("beforeRemoveRow",function(t,e){return i.onBeforeRemoveRow(t,e)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow()}),this.addHook("afterCreateRow",function(t,e){return i.onAfterCreateRow(t,e)}),this.addHook("afterLoadData",function(){return i.onAfterLoadData()}),this.addHook("beforeColumnSort",function(t,e){return i.onBeforeColumnSort(t,e)}),this.addHook("unmodifyRow",function(t){return i.onUnmodifyRow(t)}),this.registerEvents(),(0,y.addClass)(this.hot.rootElement,v),a(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),a(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=this.hot.getSettings().manualRowMove;Array.isArray(t)&&this.rowsMapper.clearMap(),(0,y.removeClass)(this.hot.rootElement,v),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),a(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(t,e){this.moveRows([t],e)}},{key:"moveRows",value:function(t,r){var i=this,e=[].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(t)),n=w.get(this),o=this.hot.runHooks("beforeRowMove",e,r);n.disallowMoving=!1===o,n.disallowMoving||((0,l.arrayEach)(t,function(t,e,n){n[e]=i.rowsMapper.getValueByIndex(t)}),(0,l.arrayEach)(t,function(t,e){var n=i.rowsMapper.getIndexByValue(t);n!==r&&i.rowsMapper.moveRow(n,r+e)}),this.rowsMapper.clearNull()),this.hot.runHooks("afterRowMove",e,r)}},{key:"changeSelection",value:function(t,e){this.hot.selectRows(t,e)}},{key:"getRowsHeight",value:function(t,e){for(var n=0,r=t;r<e;r++)n+=this.hot.view.wt.wtTable.getRowHeight(r)||23;return n}},{key:"initialSettings",value:function(){var t=this.hot.getSettings().manualRowMove;if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){var e=this.persistentStateLoad();e.length&&this.moveRows(e,0)}}},{key:"isFixedRowTop",value:function(t){return t<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(t){return t>this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.rowsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}},{key:"prepareRowsToMoving",value:function(){var t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;var n=t.from,r=t.to,i=Math.min(n.row,r.row),o=Math.max(n.row,r.row);return(0,u.rangeEach)(i,o,function(t){e.push(t)}),e}},{key:"refreshPositions",value:function(){var t=w.get(this),e=t.target.coords,n=this.hot.view.wt.wtTable.getFirstVisibleRow(),r=this.hot.view.wt.wtTable.getLastVisibleRow(),i=this.hot.getSettings().fixedRowsTop,o=this.hot.countRows();e.row<i&&0<n&&this.hot.scrollViewportTo(n-1),e.row>=r&&r<o&&this.hot.scrollViewportTo(r+1,void 0,!0);var a=this.hot.view.wt.wtTable,s=t.target.TD,l=(0,y.offset)(this.hot.rootElement),u=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row),h=t.target.eventPageY-l.top+a.holder.scrollTop,c=a.hider.offsetHeight,d=a.TBODY.offsetTop,f=this.backlight.getOffset().top,p=this.backlight.getSize().height;this.isFixedRowTop(e.row)&&(u+=a.holder.scrollTop),e.row<0?t.target.row=0<n?n-1:n:s.offsetHeight/2+u<=h?(t.target.row=e.row+1,u+=0===e.row?s.offsetHeight-1:s.offsetHeight):t.target.row=e.row;var g=h,v=u;c<=h+p+f?g=c-p-f:h+f<d&&(g=d+Math.abs(f)),c-1<=u&&(v=c-1);var m=0;this.hot.view.wt.wtOverlays.topOverlay&&(m=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight),e.row>=i&&v-a.holder.scrollTop<m&&this.hot.scrollViewportTo(e.row),this.backlight.setPosition(g),this.guideline.setPosition(v)}},{key:"updateRowsMapper",value:function(){var t=this.hot.countSourceRows(),e=this.rowsMapper._arrayMap.length;if(0===e)this.rowsMapper.createMap(t||this.hot.getSettings().startRows);else if(e<t){var n=t-e;this.rowsMapper.insertItems(e,n)}else if(t<e){var r=t-1,i=[];(0,l.arrayEach)(this.rowsMapper._arrayMap,function(t,e){r<t&&i.push(e)}),this.rowsMapper.removeItems(i)}}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return e.onMouseMove(t)}),this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return e.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeColumnSort",value:function(t,e){w.get(this).disallowMoving=void 0!==e}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){var i=this.hot.view.wt.wtTable,o=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast(),s=w.get(this);if(!a||!o||s.pressed||0!==t.button)return s.pressed=!1,void(s.rowsToMove.length=0,y.removeClass)(this.hot.rootElement,[b,m]);var l=this.guideline.isBuilt()&&!this.guideline.isAppended(),u=this.backlight.isBuilt()&&!this.backlight.isAppended();l&&u&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));var h=a.from,c=a.to,d=Math.min(h.row,c.row),f=Math.max(h.row,c.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,s.pressed=!0,s.target.eventPageY=t.pageY,s.target.coords=e,s.target.TD=n,s.rowsToMove=this.prepareRowsToMoving();var p=i.holder.scrollLeft+this.hot.view.wt.wtViewport.getRowHeaderWidth();this.backlight.setPosition(null,p),this.backlight.setSize(i.hider.offsetWidth-p,this.getRowsHeight(d,f+1)),this.backlight.setOffset(-1*(this.getRowsHeight(d,e.row)+t.layerY),null),(0,y.addClass)(this.hot.rootElement,b),this.refreshPositions()}else(0,y.removeClass)(this.hot.rootElement,C),s.pressed=!1,s.rowsToMove.length=0}},{key:"onMouseMove",value:function(t){var e=w.get(this);if(e.pressed){if(t.realTarget===this.backlight.element){var n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,n)})}e.target.eventPageY=t.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){var i=this.hot.getSelectedRangeLast(),o=w.get(this);i&&o.pressed&&(-1<o.rowsToMove.indexOf(e.row)?(0,y.removeClass)(this.hot.rootElement,m):(0,y.addClass)(this.hot.rootElement,m),r.row=!0,r.column=!0,r.cell=!0,o.target.coords=e,o.target.TD=n)}},{key:"onMouseUp",value:function(){var t=w.get(this),e=t.target.row,n=t.rowsToMove.length;if(t.pressed=!1,(t.backlightHeight=0,y.removeClass)(this.hot.rootElement,[b,m,C]),this.hot.selection.isSelectedByRowHeader()&&(0,y.addClass)(this.hot.rootElement,C),!(n<1||void 0===e||-1<t.rowsToMove.indexOf(e)||t.rowsToMove[n-1]===e-1)){if(this.moveRows(t.rowsToMove,e),this.persistentStateSave(),this.hot.render(),!t.disallowMoving){var r=this.rowsMapper.getIndexByValue(t.rowsToMove[0]),i=this.rowsMapper.getIndexByValue(t.rowsToMove[n-1]);this.changeSelection(r,i)}t.rowsToMove.length=0}}},{key:"onAfterScrollHorizontally",value:function(){var t=this.hot.view.wt.wtTable,e=this.hot.view.wt.wtViewport.getRowHeaderWidth()+t.holder.scrollLeft;this.backlight.setPosition(null,e),this.backlight.setSize(t.hider.offsetWidth-e)}},{key:"onAfterCreateRow",value:function(t,e){this.rowsMapper.shiftItems(t,e)}},{key:"onBeforeRemoveRow",value:function(t,e){var n=this;this.removedRows.length=0,!1!==t&&(0,u.rangeEach)(t,t+e-1,function(t){n.removedRows.push(n.hot.runHooks("modifyRow",t,n.pluginName))})}},{key:"onAfterRemoveRow",value:function(){this.rowsMapper.unshiftItems(this.removedRows)}},{key:"onAfterLoadData",value:function(){this.updateRowsMapper()}},{key:"onModifyRow",value:function(t,e){var n=t;if(e!==this.pluginName){var r=this.rowsMapper.getValueByIndex(n);n=null===r?n:r}return n}},{key:"onUnmodifyRow",value:function(t){var e=this.rowsMapper.getIndexByValue(t);return null===e?t:e}},{key:"onAfterPluginsInitialized",value:function(){this.updateRowsMapper(),this.initialSettings(),this.backlight.build(),this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),this.rowsMapper.destroy(),a(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"destroy",this).call(this)}}]),S);function S(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,S);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,t));return w.set(e,{rowsToMove:[],pressed:void 0,disallowMoving:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0}}),e.removedRows=[],e.rowsMapper=new d.default(e),e.eventManager=new h.default(e),e.backlight=new f.default(t),e.guideline=new p.default(t),e}(0,c.registerPlugin)("ManualRowMove",E),e.default=E},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(56),s=(o=a)&&o.__esModule?o:{default:o},l=n(0),u=n(1),h=n(4);var c=(r(d,[{key:"createMap",value:function(t){var e=this,n=void 0===t?this._arrayMap.length:t;(this._arrayMap.length=0,h.rangeEach)(n-1,function(t){e._arrayMap[t]=t})}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveRow",value:function(t,e){var n=this._arrayMap[t];this._arrayMap[t]=null,this._arrayMap.splice(e,0,n)}},{key:"clearNull",value:function(){this._arrayMap=(0,l.arrayFilter)(this._arrayMap,function(t){return null!==t})}}]),d);function d(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),this.manualRowMove=t}(0,u.mixin)(c,s.default),e.default=c},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(225),s=(o=a)&&o.__esModule?o:{default:o},l=n(2);var u=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(h,s.default),r(h,[{key:"build",value:function(){(function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"build",this).call(this),(0,l.addClass)(this._element,"ht__manualRowMove--backlight")}}]),h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(h.__proto__||Object.getPrototypeOf(h)).apply(this,arguments))}e.default=u},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(225),s=(o=a)&&o.__esModule?o:{default:o},l=n(2);var u=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(h,s.default),r(h,[{key:"build",value:function(){(function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"build",this).call(this),(0,l.addClass)(this._element,"ht__manualRowMove--guideline")}}]),h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(h.__proto__||Object.getPrototypeOf(h)).apply(this,arguments))}e.default=u},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=f(n(7)),h=n(2),s=f(n(8)),l=n(12),u=n(0),c=n(4),d=n(5);function f(t){return t&&t.__esModule?t:{default:t}}var p=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(g,o.default),r(g,[{key:"isEnabled",value:function(){return this.hot.getSettings().manualRowResize}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){this.manualRowHeights=[];var t=this.hot.getSettings().manualRowResize,e=this.loadManualRowHeights();void 0!==e?this.manualRowHeights=e:Array.isArray(t)?this.manualRowHeights=t:this.manualRowHeights=[],this.addHook("modifyRowHeight",function(t,e){return n.onModifyRowHeight(t,e)}),this.bindEvents(),a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().manualRowResize;Array.isArray(t)?this.manualRowHeights=t:t||(this.manualRowHeights=[])}},{key:"disablePlugin",value:function(){a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave","manualRowHeights",this.manualRowHeights)}},{key:"loadManualRowHeights",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualRowHeights",t),t.value}},{key:"setupHandlePosition",value:function(t){var e=this;this.currentTH=t;var n=this.hot.view.wt.wtTable.getCoords(t).row,r=(0,h.outerWidth)(this.currentTH);if(0<=n){var i=this.currentTH.getBoundingClientRect();if(this.currentRow=n,this.selectedRows=[],this.hot.selection.isSelected()&&this.hot.selection.isSelectedByRowHeader()){var o=this.hot.getSelectedRangeLast(),a=o.from,s=o.to,l=a.row,u=s.row;u<=l&&(l=s.row,u=a.row),this.currentRow>=l&&this.currentRow<=u?(0,c.rangeEach)(l,u,function(t){return e.selectedRows.push(t)}):this.selectedRows.push(this.currentRow)}else this.selectedRows.push(this.currentRow);this.startOffset=i.top-6,this.startHeight=parseInt(i.height,10),this.handle.style.left=i.left+"px",this.handle.style.top=this.startOffset+this.startHeight+"px",this.handle.style.width=r+"px",this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top=this.startOffset+this.currentHeight+"px"}},{key:"setupGuidePosition",value:function(){var t=parseInt((0,h.outerWidth)(this.handle),10),e=parseInt(this.handle.style.left,10)+t,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);(0,h.addClass)(this.handle,"active"),(0,h.addClass)(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style.left=e+"px",this.guide.style.width=n-t+"px",this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){(0,h.removeClass)(this.handle,"active"),(0,h.removeClass)(this.guide,"active")}},{key:"checkIfRowHeader",value:function(t){if(t===this.hot.rootElement)return!1;var e=t.parentNode;return"TBODY"===e.tagName||this.checkIfRowHeader(e)}},{key:"getTHFromTargetElement",value:function(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getTHFromTargetElement(t.parentNode):null}},{key:"onMouseOver",value:function(t){if(this.checkIfRowHeader(t.target)){var e=this.getTHFromTargetElement(t.target);e&&(this.pressed||this.setupHandlePosition(e))}}},{key:"afterMouseDownTimeout",value:function(){function r(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.wt.wtOverlays.adjustElementsSize(!0)}function e(t,e){var n=i.hot.runHooks("beforeRowResize",t,i.newSize,!0);void 0!==n&&(i.newSize=n),i.setManualSize(t,i.newSize),e&&r(),i.hot.runHooks("afterRowResize",t,i.newSize,!0)}var i=this;2<=this.dblclick&&(1<this.selectedRows.length?((0,u.arrayEach)(this.selectedRows,function(t){e(t)}),r()):(0,u.arrayEach)(this.selectedRows,function(t){e(t,!0)})),this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(t){var e=this;(0,h.hasClass)(t.target,"manualRowResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return e.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=(0,l.pageY)(t),this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(t){var e=this;this.pressed&&(this.currentHeight=this.startHeight+((0,l.pageY)(t)-this.startY),(0,u.arrayEach)(this.selectedRows,function(t){e.newSize=e.setManualSize(t,e.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){function n(){r.hot.forceFullRender=!0,r.hot.view.render(),r.hot.view.wt.wtOverlays.adjustElementsSize(!0)}function e(t,e){r.hot.runHooks("beforeRowResize",t,r.newSize),e&&n(),r.saveManualRowHeights(),r.hot.runHooks("afterRowResize",t,r.newSize,!1)}var r=this;this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(1<this.selectedRows.length?((0,u.arrayEach)(this.selectedRows,function(t){e(t)}),n()):(0,u.arrayEach)(this.selectedRows,function(t){e(t,!0)})),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(t){return e.onMouseOver(t)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(t){return e.onMouseDown(t)}),this.eventManager.addEventListener(window,"mousemove",function(t){return e.onMouseMove(t)}),this.eventManager.addEventListener(window,"mouseup",function(){return e.onMouseUp()})}},{key:"setManualSize",value:function(t,e){var n=this.hot.runHooks("modifyRow",t);return this.manualRowHeights[n]=e}},{key:"onModifyRowHeight",value:function(t,e){if(this.enabled){var n=this.hot.getPlugin("autoRowSize"),r=n?n.heights[e]:null,i=this.hot.runHooks("modifyRow",e),o=this.manualRowHeights[i];if(void 0!==o&&(o===r||(t||0)<o))return o}return t}}]),g);function g(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,t));return e.currentTH=null,e.currentRow=null,e.selectedRows=[],e.currentHeight=null,e.newSize=null,e.startY=null,e.startHeight=null,e.startOffset=null,e.handle=document.createElement("DIV"),e.guide=document.createElement("DIV"),e.eventManager=new s.default(e),e.pressed=null,e.dblclick=0,e.autoresizeTimeout=null,e.manualRowHeights=[],(0,h.addClass)(e.handle,"manualRowResizer"),(0,h.addClass)(e.guide,"manualRowResizerGuide"),e}(0,d.registerPlugin)("manualRowResize",p),e.default=p},function(t,e,n){"use strict";e.__esModule=!0;var s=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=E(n(7)),l=E(n(17)),u=n(5),h=n(12),c=n(9),d=E(n(387)),f=E(n(163)),p=E(n(388)),g=E(n(389)),v=E(n(390)),m=n(0),y=n(1),w=n(22),b=n(4),C=n(226);function E(t){return t&&t.__esModule?t:{default:t}}function S(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}n(391),l.default.getSingleton().register("beforeMergeCells"),l.default.getSingleton().register("afterMergeCells"),l.default.getSingleton().register("beforeUnmergeCells"),l.default.getSingleton().register("afterUnmergeCells");var O=new WeakMap,T=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(N,o.default),r(N,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().mergeCells}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.mergedCellsCollection=new d.default(this),this.autofillCalculations=new p.default(this),this.selectionCalculations=new g.default(this),this.addHook("afterInit",function(){return t.onAfterInit.apply(t,arguments)}),this.addHook("beforeKeyDown",function(){return t.onBeforeKeyDown.apply(t,arguments)}),this.addHook("modifyTransformStart",function(){return t.onModifyTransformStart.apply(t,arguments)}),this.addHook("afterModifyTransformStart",function(){return t.onAfterModifyTransformStart.apply(t,arguments)}),this.addHook("modifyTransformEnd",function(){return t.onModifyTransformEnd.apply(t,arguments)}),this.addHook("modifyGetCellCoords",function(){return t.onModifyGetCellCoords.apply(t,arguments)}),this.addHook("beforeSetRangeEnd",function(){return t.onBeforeSetRangeEnd.apply(t,arguments)}),this.addHook("afterIsMultipleSelection",function(){return t.onAfterIsMultipleSelection.apply(t,arguments)}),this.addHook("afterRenderer",function(){return t.onAfterRenderer.apply(t,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return t.addMergeActionsToContextMenu.apply(t,arguments)}),this.addHook("afterGetCellMeta",function(){return t.onAfterGetCellMeta.apply(t,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return t.onAfterViewportRowCalculatorOverride.apply(t,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return t.onAfterViewportColumnCalculatorOverride.apply(t,arguments)}),this.addHook("modifyAutofillRange",function(){return t.onModifyAutofillRange.apply(t,arguments)}),this.addHook("afterCreateCol",function(){return t.onAfterCreateCol.apply(t,arguments)}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol.apply(t,arguments)}),this.addHook("afterCreateRow",function(){return t.onAfterCreateRow.apply(t,arguments)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow.apply(t,arguments)}),this.addHook("afterChange",function(){return t.onAfterChange.apply(t,arguments)}),this.addHook("beforeDrawBorders",function(){return t.onBeforeDrawAreaBorders.apply(t,arguments)}),this.addHook("afterDrawSelection",function(){return t.onAfterDrawSelection.apply(t,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return t.onBeforeRemoveCellClassNames.apply(t,arguments)}),a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.hot.render(),a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().mergeCells;this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(t){var e=!0;return!!t&&(f.default.containsNegativeValues(t)?((0,w.warn)(f.default.NEGATIVE_VALUES_WARNING(t)),e=!1):f.default.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?((0,w.warn)(f.default.IS_OUT_OF_BOUNDS_WARNING(t)),e=!1):f.default.isSingleCell(t)?((0,w.warn)(f.default.IS_SINGLE_CELL(t)),e=!1):f.default.containsZeroSpan(t)&&((0,w.warn)(f.default.ZERO_SPAN_WARNING(t)),e=!1),e)}},{key:"generateFromSettings",value:function(t){var i=this;if(Array.isArray(t)){var e,o=[];(0,m.arrayEach)(t,function(t){if(i.validateSetting(t)){var e=new c.CellCoords(t.row,t.col),n=new c.CellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),r=new c.CellRange(e,e,n);o.push(i.mergeRange(r,!0,!0))}}),o=o.filter(function(t){return!0!==t});var n=this.getBulkCollectionData(o);(e=this.hot).populateFromArray.apply(e,S(n))}}},{key:"getBulkCollectionData",value:function(t){var e,o=this.getBulkCollectionDataRange(t),a=(e=this.hot).getData.apply(e,S(o)).splice(0);return(0,m.arrayEach)(t,function(t){var e=s(t,3),r=e[0],i=e[1],n=e[2];(0,m.arrayEach)(n,function(t,n){(0,m.arrayEach)(t,function(t,e){a[r-o[0]+n][i-o[1]+e]=t})})}),[o[0],o[1],a]}},{key:"getBulkCollectionDataRange",value:function(t){var e=[0,0],n=[0,0],r=null,i=null,o=null;return(0,m.arrayEach)(t,function(t){r=t[0],i=t[1],o=t[2],e[0]=Math.min(r,e[0]),e[1]=Math.min(i,e[1]),n[0]=Math.max(r+o.length-1,n[0]),n[1]=Math.max(i+o[0].length-1,n[1])}),[].concat(e,n)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(t,e){return!!(1<arguments.length&&void 0!==e&&e)||this.validateSetting(t)}},{key:"toggleMergeOnSelection",value:function(){var t=this.hot.getSelectedRangeLast();if(t){t.setDirection("NW-SE");var e=t.from,n=t.to;this.toggleMerge(t),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}}},{key:"mergeSelection",value:function(t){var e=0<arguments.length&&void 0!==t?t:this.hot.getSelectedRangeLast();if(e){e.setDirection("NW-SE");var n=e.from,r=e.to;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}}},{key:"unmergeSelection",value:function(t){var e=0<arguments.length&&void 0!==t?t:this.hot.getSelectedRangeLast();if(e){var n=e.from,r=e.to;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}}},{key:"mergeRange",value:function(t,e,n){var r=this,i=1<arguments.length&&void 0!==e&&e,o=2<arguments.length&&void 0!==n&&n,a=t.getTopLeftCorner(),s=t.getBottomRightCorner(),l={row:a.row,col:a.col,rowspan:s.row-a.row+1,colspan:s.col-a.col+1},u=[],h=null;return!!this.canMergeRange(l,i)&&(this.hot.runHooks("beforeMergeCells",t,i),(0,b.rangeEach)(0,l.rowspan-1,function(n){(0,b.rangeEach)(0,l.colspan-1,function(t){var e=null;u[n]||(u[n]=[]),0===n&&0===t?e=r.hot.getDataAtCell(l.row,l.col):r.hot.setCellMeta(l.row+n,l.col+t,"hidden",!0),u[n][t]=e})}),this.hot.setCellMeta(l.row,l.col,"spanned",!0),!this.mergedCellsCollection.add(l)||(o?h=[l.row,l.col,u]:this.hot.populateFromArray(l.row,l.col,u,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",t,l,i),h))}},{key:"unmergeRange",value:function(t,e){var r=this,n=1<arguments.length&&void 0!==e&&e,i=this.mergedCellsCollection.getWithinRange(t);i&&(this.hot.runHooks("beforeUnmergeCells",t,n),(0,m.arrayEach)(i,function(n){r.mergedCellsCollection.remove(n.row,n.col),(0,b.rangeEach)(0,n.rowspan-1,function(e){(0,b.rangeEach)(0,n.colspan-1,function(t){r.hot.removeCellMeta(n.row+e,n.col+t,"hidden")})}),r.hot.removeCellMeta(n.row,n.col,"spanned")}),this.hot.render(),this.hot.runHooks("afterUnmergeCells",t,n))}},{key:"toggleMerge",value:function(t){var e=this.mergedCellsCollection.get(t.from.row,t.from.col);e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col?this.unmergeRange(t):this.mergeSelection(t)}},{key:"merge",value:function(t,e,n,r){var i=new c.CellCoords(t,e),o=new c.CellCoords(n,r);this.mergeRange(new c.CellRange(i,i,o))}},{key:"unmerge",value:function(t,e,n,r){var i=new c.CellCoords(t,e),o=new c.CellCoords(n,r);this.unmergeRange(new c.CellRange(i,i,o))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings().mergeCells),this.hot.render()}},{key:"onBeforeKeyDown",value:function(t){!t.ctrlKey&&!t.metaKey||t.altKey||77!==t.keyCode||(this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render(),(0,h.stopImmediatePropagation)(t))}},{key:"onAfterIsMultipleSelection",value:function(t){if(t)for(var e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=0;r<e.length;r+=1)if(n.highlight.row===e[r].row&&n.highlight.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1;return t}},{key:"onModifyTransformStart",value:function(t){var e,n=O.get(this),r=this.hot.getSelectedRangeLast(),i={row:t.row,col:t.col},o=new c.CellCoords(r.highlight.row,r.highlight.col),a=this.mergedCellsCollection.get(o.row,o.col);if(n.lastDesiredCoords||(n.lastDesiredCoords=new c.CellCoords(null,null)),a){var s=new c.CellCoords(a.row,a.col),l=new c.CellCoords(a.row+a.rowspan-1,a.col+a.colspan-1);new c.CellRange(s,s,l).includes(n.lastDesiredCoords)||(n.lastDesiredCoords=new c.CellCoords(null,null)),i.row=n.lastDesiredCoords.row?n.lastDesiredCoords.row-o.row:i.row,i.col=n.lastDesiredCoords.col?n.lastDesiredCoords.col-o.col:i.col,0<t.row?i.row=a.row+a.rowspan-1-o.row+t.row:t.row<0&&(i.row=o.row-a.row+t.row),0<t.col?i.col=a.col+a.colspan-1-o.col+t.col:t.col<0&&(i.col=o.col-a.col+t.col)}e=new c.CellCoords(r.highlight.row+i.row,r.highlight.col+i.col);var u=this.mergedCellsCollection.get(e.row,e.col);u&&(n.lastDesiredCoords=e,i={row:u.row-o.row,col:u.col-o.col}),0!==i.row&&(t.row=i.row),0!==i.col&&(t.col=i.col)}},{key:"onModifyTransformEnd",value:function(t){for(var e=this,n=this.hot.getSelectedRangeLast(),r=(0,y.clone)(t),i=this.selectionCalculations.getUpdatedSelectionRange(n,t),o=(0,y.clone)(r),a=this.mergedCellsCollection.getWithinRange(i,!0);o=(0,y.clone)(r),this.selectionCalculations.getUpdatedSelectionRange(n,r),(0,m.arrayEach)(a,function(t){e.selectionCalculations.snapDelta(r,n,t)}),r.row!==o.row||r.col!==o.col;);t.row=r.row,t.col=r.col}},{key:"onModifyGetCellCoords",value:function(t,e){var n=this.mergedCellsCollection.get(t,e);return n?[n.row,n.col,n.row+n.rowspan-1,n.col+n.colspan-1]:void 0}},{key:"addMergeActionsToContextMenu",value:function(t){t.items.push({name:"---------"},(0,v.default)(this))}},{key:"onAfterRenderer",value:function(t,e,n){var r=this.mergedCellsCollection.get(e,n);(0,C.applySpanProperties)(t,r,e,n)}},{key:"onBeforeSetRangeEnd",value:function(t){var e=this.hot.getSelectedRangeLast();e.highlight=new c.CellCoords(e.highlight.row,e.highlight.col),e.to=t;var n=!1;if(!(0===e.from.row&&e.to.row===this.hot.countRows()-1||0===e.from.col&&e.to.col===this.hot.countCols()-1))do{n=!1;for(var r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){var i=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(i)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}},{key:"onAfterGetCellMeta",value:function(t,e,n){var r=this.mergedCellsCollection.get(t,e);!r||r.row===t&&r.col===e||(n.copyable=!1)}},{key:"onAfterViewportRowCalculatorOverride",value:function(n){var r=this,t=this.hot.countCols(),i=void 0;(0,b.rangeEach)(0,t-1,function(t){if((i=r.mergedCellsCollection.get(n.startRow,t))&&i.row<n.startRow)return n.startRow=i.row,r.onAfterViewportRowCalculatorOverride.call(r,n);if(i=r.mergedCellsCollection.get(n.endRow,t)){var e=i.row+i.rowspan-1;if(e>n.endRow)return n.endRow=e,r.onAfterViewportRowCalculatorOverride.call(r,n)}return!0})}},{key:"onAfterViewportColumnCalculatorOverride",value:function(n){var r=this,t=this.hot.countRows(),i=void 0;(0,b.rangeEach)(0,t-1,function(t){if((i=r.mergedCellsCollection.get(t,n.startColumn))&&i.col<n.startColumn)return n.startColumn=i.col,r.onAfterViewportColumnCalculatorOverride.call(r,n);if(i=r.mergedCellsCollection.get(t,n.endColumn)){var e=i.col+i.colspan-1;if(e>n.endColumn)return n.endColumn=e,r.onAfterViewportColumnCalculatorOverride.call(r,n)}return!0})}},{key:"onModifyAutofillRange",value:function(t,e){this.autofillCalculations.correctSelectionAreaSize(e);var n=this.autofillCalculations.getDirection(e,t),r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e;var i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i?r=this.autofillCalculations.snapDragArea(e,r,n,i):r}},{key:"onAfterCreateCol",value:function(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}},{key:"onAfterRemoveCol",value:function(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}},{key:"onAfterCreateRow",value:function(t,e,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",t,e)}},{key:"onAfterRemoveRow",value:function(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}},{key:"onAfterChange",value:function(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}},{key:"onBeforeDrawAreaBorders",value:function(e,t){if(t&&"area"===t){var n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);(0,m.arrayEach)(r,function(t){n.getBottomRightCorner().row===t.getLastRow()&&n.getBottomRightCorner().col===t.getLastColumn()&&(e[2]=t.row,e[3]=t.col)})}}},{key:"onAfterModifyTransformStart",value:function(t,e,n){if(this.enabled){var r=this.mergedCellsCollection.get(t.row,t.col);if(r){var i=0<e,o=e<0,a=n<0,s=0<n,l=r.row+r.rowspan-1==this.hot.countRows()-1,u=0===r.row,h=r.col+r.colspan-1==this.hot.countCols()-1,c=0===r.col;(i&&l||o&&u||s&&h||a&&c)&&(t.row=r.row,t.col=r.col)}}}},{key:"onAfterDrawSelection",value:function(t,e,n,r){return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}]),N);function N(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,N);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,t));return O.set(e,{lastDesiredCoords:null}),e.mergedCellsCollection=null,e.autofillCalculations=null,e.selectionCalculations=null,e}(0,u.registerPlugin)("mergeCells",T),e.default=T},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a,s,l=(o=["The merged cell declared at [",", ","], overlaps with the other declared merged \n    cell. The overlapping merged cell was not added to the table, please fix your setup."],a=["The merged cell declared at [",", ","], overlaps with the other declared merged \n    cell. The overlapping merged cell was not added to the table, please fix your setup."],Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(a)}}))),u=n(163),h=(s=u)&&s.__esModule?s:{default:s},c=n(9),d=n(4),f=n(22),p=n(0),g=n(226),v=n(25);function m(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var y=(r(w,[{key:"get",value:function(e,n){var t=this.mergedCells,r=!1;return(0,p.arrayEach)(t,function(t){return!(t.row<=e&&t.row+t.rowspan-1>=e&&t.col<=n&&t.col+t.colspan-1>=n&&(r=t,1))}),r}},{key:"getByRange",value:function(e){var t=this.mergedCells,n=!1;return(0,p.arrayEach)(t,function(t){return!(t.row<=e.from.row&&t.row+t.rowspan-1>=e.to.row&&t.col<=e.from.col&&t.col+t.colspan-1>=e.to.col)||(n=t)}),n}},{key:"getWithinRange",value:function(t,e){var i=1<arguments.length&&void 0!==e&&e,n=this.mergedCells,o=[],a=t;if(!a.includesRange){var r=new c.CellCoords(a.from.row,a.from.col),s=new c.CellCoords(a.to.row,a.to.col);a=new c.CellRange(r,r,s)}return(0,p.arrayEach)(n,function(t){var e=new c.CellCoords(t.row,t.col),n=new c.CellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),r=new c.CellRange(e,e,n);i?a.overlaps(r)&&o.push(t):a.includesRange(r)&&o.push(t)}),!!o.length&&o}},{key:"add",value:function(t){var e=this.mergedCells,n=t.row,r=t.col,i=t.rowspan,o=t.colspan,a=new h.default(n,r,i,o),s=this.get(n,r),l=this.isOverlapping(a);return s||l?((0,f.warn)(w.IS_OVERLAPPING_WARNING(a)),!1):(this.hot&&a.normalize(this.hot),e.push(a),a)}},{key:"remove",value:function(t,e){var n=this.mergedCells,r=this.get(t,e),i=r?this.mergedCells.indexOf(r):null;return!(!r||!1===i)&&(n.splice(i,1),r)}},{key:"clear",value:function(){var i=this,t=this.mergedCells,n=[],o=[];(0,p.arrayEach)(t,function(t){var e=i.hot.getCell(t.row,t.col);e&&n.push([e,i.get(t.row,t.col),t.row,t.col])}),(this.mergedCells.length=0,p.arrayEach)(n,function(r,t){(0,d.rangeEach)(0,r.rowspan-1,function(n){(0,d.rangeEach)(0,r.colspan-1,function(t){if(0!==t||0!==n){var e=i.hot.getCell(r.row+n,r.col+t);e&&o.push([e,null,null,null])}})}),n[t][1]=null}),(0,p.arrayEach)(n,function(t){g.applySpanProperties.apply(void 0,m(t))}),(0,p.arrayEach)(o,function(t){g.applySpanProperties.apply(void 0,m(t))})}},{key:"isOverlapping",value:function(t){var e=new c.CellRange(null,new c.CellCoords(t.row,t.col),new c.CellCoords(t.row+t.rowspan-1,t.col+t.colspan-1)),n=!1;return(0,p.arrayEach)(this.mergedCells,function(t){return!new c.CellRange(null,new c.CellCoords(t.row,t.col),new c.CellCoords(t.row+t.rowspan-1,t.col+t.colspan-1)).overlaps(e)||!(n=!0)}),n}},{key:"isMergedParent",value:function(e,n){var t=this.mergedCells,r=!1;return(0,p.arrayEach)(t,function(t){return t.row!==e||t.col!==n||!(r=!0)}),r}},{key:"shiftCollections",value:function(t,e,n){var r=this,i=[0,0];switch(t){case"right":i[0]+=n;break;case"left":i[0]-=n;break;case"down":i[1]+=n;break;case"up":i[1]-=n}(0,p.arrayEach)(this.mergedCells,function(t){t.shift(i,e)}),(0,d.rangeEachReverse)(this.mergedCells.length-1,0,function(t){var e=r.mergedCells[t];e&&e.removed&&r.mergedCells.splice(r.mergedCells.indexOf(e),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(t){return(0,v.toSingleLine)(l,t.row,t.col)}}]),w);function w(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,w),this.plugin=t,this.mergedCells=[],this.hot=t.hot}e.default=y},function(t,e,n){"use strict";e.__esModule=!0;var y=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(1),d=n(9),w=n(0);var a=(r(s,[{key:"correctSelectionAreaSize",value:function(t){if(t[0]===t[2]&&t[1]===t[3]){var e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}},{key:"getDirection",value:function(t,e){return e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left"}},{key:"snapDragArea",value:function(t,e,n,r){var i=e.slice(0),o=this.getAutofillSize(t,e,n),a=y(t,4),s=a[0],l=a[1],u=a[2],h=a[3],c=-1<["up","down"].indexOf(n)?u-s+1:h-l+1,d=o-Math.floor(o/c)*c,f=this.getFarthestCollection(t,e,n,r);if(f)if("down"===n){var p=f.row+f.rowspan-s-d;i[2]+p>=this.plugin.hot.countRows()?i[2]-=d:i[2]+=d?p:0}else if("right"===n){var g=f.col+f.colspan-l-d;i[3]+g>=this.plugin.hot.countCols()?i[3]-=d:i[3]+=d?g:0}else if("up"===n){var v=u-d-f.row+1;i[0]+v<0?i[0]+=d:i[0]-=d?v:0}else if("left"===n){var m=h-d-f.col+1;i[1]+m<0?i[1]+=d:i[1]-=d?m:0}return this.updateCurrentFillCache({baseArea:t,dragDirection:n,foundMergedCells:r,fillSize:o,dragArea:i,cycleLength:c}),i}},{key:"updateCurrentFillCache",value:function(t){this.currentFillData||(this.currentFillData={}),(0,o.extend)(this.currentFillData,t)}},{key:"getAutofillSize",value:function(t,e,n){var r=y(t,4),i=r[0],o=r[1],a=r[2],s=r[3],l=y(e,4),u=l[0],h=l[1],c=l[2],d=l[3];switch(n){case"up":return i-u;case"down":return c-a;case"left":return o-h;case"right":return d-s;default:return null}}},{key:"getDragArea",value:function(t,e,n){var r=y(t,4),i=r[0],o=r[1],a=r[2],s=r[3],l=y(e,4),u=l[0],h=l[1],c=l[2],d=l[3];switch(n){case"up":return[u,h,i-1,s];case"down":return[a+1,o,c,s];case"left":return[u,h,a,o-1];case"right":return[i,s+1,c,d];default:return null}}},{key:"getFarthestCollection",value:function(t,e,n,r){var i=y(t,4),o=i[0],a=i[1],s=i[2],l=i[3],u=-1<["up","down"].indexOf(n),h=u?s:l,c=u?o:a,d=this.getAutofillSize(t,e,n),f=u?s-o+1:l-a+1,p=d-Math.floor(d/f)*f,g=null,v=null,m=null;switch(n){case"up":g="includesVertically",m=h-p+1;break;case"left":g="includesHorizontally",m=h-p+1;break;case"down":g="includesVertically",m=c+p-1;break;case"right":g="includesHorizontally",m=c+p-1}return(0,w.arrayEach)(r,function(t){t[g](m)&&t.isFarther(v,n)&&(v=t)}),v}},{key:"recreateAfterDataPopulation",value:function(t){if(this.currentFillData){var n=this.getRangeFromChanges(t),e=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,i=function(t,e){switch(r){case"up":return t.row-e>=n.from.row;case"down":return t.row+t.rowspan-1+e<=n.to.row;case"left":return t.col-e>=n.from.column;case"right":return t.col+t.colspan-1+e<=n.to.column;default:return null}},o=0,a=null,s=1;do{for(var l=0;l<e.length;l+=1){if(i(a=e[l],o=s*this.currentFillData.cycleLength))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan})}l===e.length-1&&(s+=1)}}while(i(a,o));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(t){var e={min:null,max:null},n={min:null,max:null};return(0,w.arrayEach)(t,function(t){(null===e.min||t[0]<e.min)&&(e.min=t[0]),(null===e.max||t[0]>e.max)&&(e.max=t[0]),(null===n.min||t[1]<n.min)&&(n.min=t[1]),(null===n.max||t[1]>n.max)&&(n.max=t[1])}),{from:{row:e.min,column:n.min},to:{row:e.max,column:n.max}}}},{key:"dragAreaOverlapsCollections",value:function(t,e,n){var r=this.getDragArea(t,e,n),i=y(r,4),o=i[0],a=i[1],s=i[2],l=i[3],u=new d.CellCoords(o,a),h=new d.CellCoords(s,l),c=new d.CellRange(u,u,h);return!!this.mergedCellsCollection.getWithinRange(c,!0)}}]),s);function s(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}e.default=a},function(t,e,n){"use strict";e.__esModule=!0;var h=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=n(9);var o=(r(a,[{key:"snapDelta",value:function(t,e,n){var r=e.to,i=r.row+t.row,o=r.col+t.col;t.row?this.jumpOverMergedCell(t,n,i):t.col&&this.jumpOverMergedCell(t,n,o)}},{key:"jumpOverMergedCell",value:function(t,e,n){var r=t.row||t.col,i=null,o=null,a=null;t.row?(i=e.includesVertically(n),o=e.row,a=e.getLastRow()):t.col&&(i=e.includesHorizontally(n),o=e.col,a=e.getLastColumn()),0!==r&&(0<r?i&&n!==o&&(r+=a-n+1):i&&n!==a&&(r-=n-o+1),t.row?t.row=r:t.col&&(t.col=r))}},{key:"getUpdatedSelectionRange",value:function(t,e){return new l.CellRange(t.highlight,t.from,new l.CellCoords(t.to.row+e.row,t.to.col+e.col))}},{key:"getSelectedMergedCellClassName",value:function(t,e,n,r){var i=h(n,4),o=i[0],a=i[1],s=i[2],l=i[3];if(void 0!==r&&o<=t&&t<=s&&a<=e&&e<=l){if(!this.plugin.mergedCellsCollection.isMergedParent(t,e))return;var u=this.plugin.mergedCellsCollection.get(t,e);if(!u)return;if(u.row+u.rowspan-1<=s&&u.col+u.colspan-1<=l)return this.fullySelectedMergedCellClassName+"-"+r;if(this.plugin.selectionCalculations.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange()))return this.fullySelectedMergedCellClassName+"-multiple"}}},{key:"isMergeCellFullySelected",value:function(t,e){var n=[];if(!e||!t)return!1;for(var r=0;r<t.rowspan;r+=1)for(var i=0;i<t.colspan;i+=1)n.push(new l.CellCoords(t.row+r,t.col+i));for(var o=0;o<n.length;o+=1){for(var a=[],s=0;s<e.length;s+=1)a[s]=e[s].includes(n[o]);if(!a.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var t=[],e=0;e<=7;e+=1)t.push(this.fullySelectedMergedCellClassName+"-"+e);return t.push(this.fullySelectedMergedCellClassName+"-multiple"),t}}]),a);function a(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),this.plugin=t,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}e.default=o},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(n){return{key:"mergeCells",name:function(){var t=this.getSelectedLast();if(t){var e=n.mergedCellsCollection.get(t[0],t[1]);if(e.row===t[0]&&e.col===t[1]&&e.row+e.rowspan-1===t[2]&&e.col+e.colspan-1===t[3])return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback:function(){n.toggleMergeOnSelection()},disabled:function(){var t=this.getSelectedLast();return!t||(a.default.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1})||this.selection.isSelectedByCorner())},hidden:!1}};var r,i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),o=n(163),a=(r=o)&&r.__esModule?r:{default:r}},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=n(2),o=n(42),a=u(n(7)),s=u(n(8)),l=n(5),h=n(9);function u(t){return t&&t.__esModule?t:{default:t}}var d=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(f,a.default),r(f,[{key:"isEnabled",value:function(){return(0,o.isMobileBrowser)()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new s.default(this)),this.registerListeners(),function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0}(f.prototype.__proto__||Object.getPrototypeOf(f.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var h=this;function e(t){if(1===h.dragged.length)return h.dragged.splice(0,h.dragged.length),!0;var e=h.dragged.indexOf(t);if(-1===e)return!1;0===e?h.dragged=h.dragged.slice(0,1):1===e&&(h.dragged=h.dragged.slice(-1))}this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(t){var e=void 0;return(0,c.hasClass)(t.target,"topLeftSelectionHandle-HitArea")?(e=h.hot.getSelectedRangeLast(),h.dragged.push("topLeft"),h.touchStartRange={width:e.getWidth(),height:e.getHeight(),direction:e.getDirection()},t.preventDefault(),!1):(0,c.hasClass)(t.target,"bottomRightSelectionHandle-HitArea")?(e=h.hot.getSelectedRangeLast(),h.dragged.push("bottomRight"),h.touchStartRange={width:e.getWidth(),height:e.getHeight(),direction:e.getDirection()},t.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(t){return(0,c.hasClass)(t.target,"topLeftSelectionHandle-HitArea")?(e.call(h,"topLeft"),h.touchStartRange=void 0,t.preventDefault(),!1):(0,c.hasClass)(t.target,"bottomRightSelectionHandle-HitArea")?(e.call(h,"bottomRight"),h.touchStartRange=void 0,t.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(t){var e=(0,c.getWindowScrollTop)(),n=(0,c.getWindowScrollLeft)(),r=void 0,i=void 0,o=void 0,a=void 0,s=void 0,l=void 0;if(0!==h.dragged.length){var u=document.elementFromPoint(t.touches[0].screenX-n,t.touches[0].screenY-e);u&&u!==h.lastSetCell&&("TD"!==u.nodeName&&"TH"!==u.nodeName||(-1===(r=h.hot.getCoords(u)).col&&(r.col=0),o=(i=h.hot.getSelectedRangeLast()).getWidth(),a=i.getHeight(),s=i.getDirection(),1===o&&1===a&&h.hot.selection.setRangeEnd(r),null!==(l=h.getCurrentRangeCoords(i,r,h.touchStartRange.direction,s,h.dragged[0])).start&&h.hot.selection.setRangeStart(l.start),h.hot.selection.setRangeEnd(l.end),h.lastSetCell=u),t.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(t,e,n,r,i){var o=t.getTopLeftCorner(),a=t.getBottomRightCorner(),s=t.getBottomLeftCorner(),l=t.getTopRightCorner(),u={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":u="topLeft"===i?{start:new h.CellCoords(e.row,t.highlight.col),end:new h.CellCoords(s.row,e.col)}:{start:new h.CellCoords(t.highlight.row,e.col),end:new h.CellCoords(e.row,o.col)};break;case"SE-NW":"bottomRight"===i&&(u={start:new h.CellCoords(a.row,e.col),end:new h.CellCoords(e.row,o.col)})}break;case"NW-SE":switch(r){case"NE-SW":"topLeft"===i?u={start:e,end:s}:u.end=e;break;case"NW-SE":"topLeft"===i?u={start:e,end:a}:u.end=e;break;case"SE-NW":"topLeft"===i?u={start:e,end:o}:u.end=e;break;case"SW-NE":"topLeft"===i?u={start:e,end:l}:u.end=e}break;case"SW-NE":switch(r){case"NW-SE":u="bottomRight"===i?{start:new h.CellCoords(e.row,o.col),end:new h.CellCoords(s.row,e.col)}:{start:new h.CellCoords(o.row,e.col),end:new h.CellCoords(e.row,a.col)};break;case"SW-NE":u="topLeft"===i?{start:new h.CellCoords(t.highlight.row,e.col),end:new h.CellCoords(e.row,a.col)}:{start:new h.CellCoords(e.row,o.col),end:new h.CellCoords(o.row,e.col)};break;case"SE-NW":"bottomRight"===i?u={start:new h.CellCoords(e.row,l.col),end:new h.CellCoords(o.row,e.col)}:"topLeft"===i&&(u={start:s,end:e})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"===i&&(u.end=e);break;case"SE-NW":"topLeft"===i?u.end=e:u={start:e,end:o}}}return u}},{key:"isDragged",value:function(){return 0<this.dragged.length}}]),f);function f(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,t));return e.dragged=[],e.eventManager=null,e.lastSetCell=null,e}(0,l.registerPlugin)("multipleSelectionHandles",d),e.default=d},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=h(n(7)),s=h(n(394)),l=n(0),u=n(5);function h(t){return t&&t.__esModule?t:{default:t}}var c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(d,o.default),r(d,[{key:"isEnabled",value:function(){return this.hot.getSettings().observeChanges}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.observer||(this.observer=new s.default(this.hot.getSourceData()),this._exposePublicApi()),this.observer.addLocalHook("change",function(t){return n.onDataChange(t)}),this.addHook("afterCreateRow",function(){return n.onAfterTableAlter()}),this.addHook("afterRemoveRow",function(){return n.onAfterTableAlter()}),this.addHook("afterCreateCol",function(){return n.onAfterTableAlter()}),this.addHook("afterRemoveCol",function(){return n.onAfterTableAlter()}),this.addHook("afterChange",function(t,e){return n.onAfterTableAlter(e)}),this.addHook("afterLoadData",function(t){return n.onAfterLoadData(t)}),a(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.observer&&(this.observer.destroy(),this.observer=null,this._deletePublicApi()),a(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"disablePlugin",this).call(this)}},{key:"onDataChange",value:function(t){var e=this;if(!this.observer.isPaused()){var n=this.pluginName+".change",r={add:function(t){isNaN(t.col)?e.hot.runHooks("afterCreateRow",t.row,1,n):e.hot.runHooks("afterCreateCol",t.col,1,n)},remove:function(t){isNaN(t.col)?e.hot.runHooks("afterRemoveRow",t.row,1,n):e.hot.runHooks("afterRemoveCol",t.col,1,n)},replace:function(t){e.hot.runHooks("afterChange",[[t.row,t.col,null,t.value]],n)}};(0,l.arrayEach)(t,function(t){r[t.op]&&r[t.op](t)}),this.hot.render()}this.hot.runHooks("afterChangesObserved")}},{key:"onAfterTableAlter",value:function(t){var e=this;"loadData"!==t&&(this.observer.pause(),this.hot.addHookOnce("afterChangesObserved",function(){return e.observer.resume()}))}},{key:"onAfterLoadData",value:function(t){t||this.observer.setObservedData(this.hot.getSourceData())}},{key:"destroy",value:function(){this.observer&&(this.observer.destroy(),this._deletePublicApi()),a(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"destroy",this).call(this)}},{key:"_exposePublicApi",value:function(){var t=this,e=this.hot;e.pauseObservingChanges=function(){return t.observer.pause()},e.resumeObservingChanges=function(){return t.observer.resume()},e.isPausedObservingChanges=function(){return t.observer.isPaused()}}},{key:"_deletePublicApi",value:function(){var t=this.hot;delete t.pauseObservingChanges,delete t.resumeObservingChanges,delete t.isPausedObservingChanges}}]),d);function d(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,t));return e.observer=null,e}e.default=c,(0,u.registerPlugin)("observeChanges",c)},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=u(n(395)),a=u(n(20)),s=n(1),l=n(396);function u(t){return t&&t.__esModule?t:{default:t}}var h=(r(c,[{key:"setObservedData",value:function(t){var e=this;this.observer&&o.default.unobserve(this.observedData,this.observer),this.observedData=t,this.observer=o.default.observe(this.observedData,function(t){return e.onChange(t)})}},{key:"isPaused",value:function(){return this.paused}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"onChange",value:function(t){this.runLocalHooks("change",(0,l.cleanPatches)(t))}},{key:"destroy",value:function(){o.default.unobserve(this.observedData,this.observer),this.observedData=null,this.observer=null}}]),c);function c(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),this.observedData=null,this.observer=null,this.paused=!1,this.setObservedData(t)}(0,s.mixin)(h,a.default),e.default=h},function(t,e,n){"use strict";var r,S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},O=Error;!function(l){var c=function(t){if(v(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(r);return e};var f={add:function(t,e){return t[e]=this.value,!0},remove:function(t,e){return delete t[e],!0},replace:function(t,e){return t[e]=this.value,!0},move:function(t,e,n){var r={op:"_get",path:this.from};return o(n,[r]),o(n,[{op:"remove",path:this.from}]),o(n,[{op:"add",path:this.path,value:r.value}]),!0},copy:function(t,e,n){var r={op:"_get",path:this.from};return o(n,[r]),o(n,[{op:"add",path:this.path,value:r.value}]),!0},test:function(t,e){return function t(e,n){switch(void 0===e?"undefined":S(e)){case"undefined":case"boolean":case"string":case"number":return e===n;case"object":if(null===e)return null===n;if(v(e)){if(!v(n)||e.length!==n.length)return!1;for(var r=0,i=e.length;r<i;r++)if(!t(e[r],n[r]))return!1;return!0}var o=c(n).length;if(c(e).length!==o)return!1;for(r=0;r<o;r++)if(!t(e[r],n[r]))return!1;return!0;default:return!1}}(t[e],this.value)},_get:function(t,e){this.value=t[e]}},p={add:function(t,e){return t.splice(e,0,this.value),!0},remove:function(t,e){return t.splice(e,1),!0},replace:function(t,e){return t[e]=this.value,!0},move:f.move,copy:f.copy,test:f.test,_get:f._get},g={add:function(t){for(var e in g.remove.call(this,t),this.value)this.value.hasOwnProperty(e)&&(t[e]=this.value[e]);return!0},remove:function(t){for(var e in t)t.hasOwnProperty(e)&&f.remove.call(this,t,e);return!0},replace:function(t){return o(t,[{op:"remove",path:this.path}]),o(t,[{op:"add",path:this.path,value:this.value}]),!0},move:f.move,copy:f.copy,test:function(t){return JSON.stringify(t)===JSON.stringify(this.value)},_get:function(t){this.value=t}};function d(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}var v,u=[],h=function(t){this.observers=[],this.obj=t},m=function(t,e){this.callback=t,this.observer=e};function y(t){return"object"===(void 0===t?"undefined":S(t))?JSON.parse(JSON.stringify(t)):t}function w(t){for(var e,n=0,r=u.length;n<r;n++)if(u[n].obj===t.object){e=u[n];break}b(e.value,t.object,t.patches,""),t.patches.length&&o(e.value,t.patches);var i=t.patches;return 0<i.length&&(t.patches=[],t.callback&&t.callback(i)),i}function b(t,e,n,r){for(var i=c(e),o=c(t),a=!1,s=o.length-1;0<=s;s--){var l=t[h=o[s]];if(e.hasOwnProperty(h)){var u=e[h];"object"==(void 0===l?"undefined":S(l))&&null!=l&&"object"==(void 0===u?"undefined":S(u))&&null!=u?b(l,u,n,r+"/"+d(h)):l!=u&&(!0,n.push({op:"replace",path:r+"/"+d(h),value:y(u)}))}else n.push({op:"remove",path:r+"/"+d(h)}),a=!0}if(a||i.length!=o.length)for(s=0;s<i.length;s++){var h=i[s];t.hasOwnProperty(h)||n.push({op:"add",path:r+"/"+d(h),value:y(e[h])})}}function C(t){for(var e,n=0,r=t.length;n<r;){if(!(48<=(e=t.charCodeAt(n))&&e<=57))return!1;n++}return!0}function o(t,e,n){for(var r,i,o=!1,a=0,s=e.length;a<s;){r=e[a],a++;for(var l=(r.path||"").split("/"),u=t,h=1,c=l.length,d=void 0;;){if(i=l[h],n&&void 0===d&&(void 0===u[i]?d=l.slice(0,h).join("/"):h==c-1&&(d=r.path),void 0!==d&&this.validator(r,a-1,t,d)),h++,void 0===i&&c<=h){o=g[r.op].call(r,u,i,t);break}if(v(u)){if("-"===i)i=u.length;else{if(n&&!C(i))throw new E("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a-1,r.path,r);i=parseInt(i,10)}if(c<=h){if(n&&"add"===r.op&&i>u.length)throw new E("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a-1,r.path,r);o=p[r.op].call(r,u,i,t);break}}else if(i&&-1!=i.indexOf("~")&&(i=i.replace(/~1/g,"/").replace(/~0/g,"~")),c<=h){o=f[r.op].call(r,u,i,t);break}u=u[i]}}return o}l.unobserve=function(t,e){e.unobserve()},l.observe=function(t,e){var n,r=function(t){for(var e=0,n=u.length;e<n;e++)if(u[e].obj===t)return u[e]}(t);if(r?n=function(t,e){for(var n=0,r=t.observers.length;n<r;n++)if(t.observers[n].callback===e)return t.observers[n].observer}(r,e):(r=new h(t),u.push(r)),n)return n;if(n={},r.value=y(t),e){n.callback=e,n.next=null;var i=this.intervals||[100,1e3,1e4,6e4];if(void 0===i.push)throw new O("jsonpatch.intervals must be an array");var o=0,a=function(){w(n)},s=function(){clearTimeout(n.next),n.next=setTimeout(function(){a(),o=0,n.next=setTimeout(l,i[o++])},0)},l=function t(){a(),o==i.length&&(o=i.length-1),n.next=setTimeout(t,i[o++])};"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mousedown",s),window.addEventListener("mouseup",s),window.addEventListener("keydown",s)):(document.documentElement.attachEvent("onmousedown",s),document.documentElement.attachEvent("onmouseup",s),document.documentElement.attachEvent("onkeydown",s))),n.next=setTimeout(l,i[o++])}return n.patches=[],n.object=t,n.unobserve=function(){w(n),clearTimeout(n.next),function(t,e){for(var n=0,r=t.observers.length;n<r;n++)if(t.observers[n].observer===e)return t.observers.splice(n,1)}(r,n),"undefined"!=typeof window&&(window.removeEventListener?(window.removeEventListener("mousedown",s),window.removeEventListener("mouseup",s),window.removeEventListener("keydown",s)):(document.documentElement.detachEvent("onmousedown",s),document.documentElement.detachEvent("onmouseup",s),document.documentElement.detachEvent("onkeydown",s)))},r.observers.push(new m(e,n)),n},l.generate=w,v=Array.isArray?Array.isArray:function(t){return t.push&&"number"==typeof t.length},l.apply=o,l.compare=function(t,e){var n=[];return b(t,e,n,""),n};var a,E=(i(t,a=O),t);function t(t,e,n,r,i){a.call(this,t),this.message=t,this.name=e,this.index=n,this.operation=r,this.tree=i}l.JsonPatchError=E,l.Error=E,l.validator=function(t,e,n,r){if("object"!==(void 0===t?"undefined":S(t))||null===t||v(t))throw new E("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(!f[t.op])throw new E("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n);if("string"!=typeof t.path)throw new E("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(("move"===t.op||"copy"===t.op)&&"string"!=typeof t.from)throw new E("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&void 0===t.value)throw new E("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&function t(e){if(void 0===e)return!0;if("array"==typeof e||"object"==(void 0===e?"undefined":S(e)))for(var n in e)if(t(e[n]))return!0;return!1}(t.value))throw new E("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n)if("add"==t.op){var i=t.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new E("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if("replace"===t.op||"remove"===t.op||"_get"===t.op){if(t.path!==r)throw new E("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if("move"===t.op||"copy"===t.op){var a={op:"_get",path:t.from,value:void 0},s=l.validate([a],n);if(s&&"OPERATION_PATH_UNRESOLVABLE"===s.name)throw new E("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}},l.validate=function(t,e){try{if(!v(t))throw new E("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)e=JSON.parse(JSON.stringify(e)),o.call(this,e,t,!0);else for(var n=0;n<t.length;n++)this.validator(t[n],n)}catch(t){if(t instanceof E)return t;throw t}}}(r=r||{}),e.apply=r.apply,e.observe=r.observe,e.unobserve=r.unobserve,e.generate=r.generate,e.compare=r.compare,e.validate=r.validate,e.validator=r.validator,e.JsonPatchError=r.JsonPatchError,e.Error=r.Error},function(t,e,n){"use strict";e.__esModule=!0;var o=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.cleanPatches=function(t){var e=[],n=(0,r.arrayFilter)(t,function(t){return!/[/]length/gi.test(t.path)&&!!i(t.path)});return n=(0,r.arrayMap)(n,function(t){var e=i(t.path);return t.row=e.row,t.col=e.col,t}),n=(0,r.arrayFilter)(n,function(t){if(-1!==["add","remove"].indexOf(t.op)&&!isNaN(t.col)){if(-1!==e.indexOf(t.col))return!1;e.push(t.col)}return!0}),e.length=0,n},e.parsePath=i;var r=n(0);function i(t){var e=t.match(/^\/(\d+)\/?(.*)?$/);if(!e)return null;var n=o(e,3),r=n[1],i=n[2];return{row:parseInt(r,10),col:/^\d*$/.test(i)?parseInt(i,10):i}}},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o,s=n(7),l=(o=s)&&o.__esModule?o:{default:o},u=n(5),h=n(1),f=n(4),c=n(10);function d(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i}function p(t,e){return!((0,c.isUndefined)(t)||null===t||!t.toLowerCase||0===t.length)&&(!(0,c.isUndefined)(e)&&null!==e&&-1!==e.toString().toLowerCase().indexOf(t.toLowerCase()))}var g=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(v,l.default),r(v,[{key:"isEnabled",value:function(){return this.hot.getSettings().search}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings().search;this.updatePluginSettings(e),this.addHook("beforeRenderer",function(){return t.onBeforeRenderer.apply(t,arguments)}),a(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){function t(){return e.onBeforeRenderer.apply(e,arguments)}var e=this;this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterRender",function(){e.hot.removeHook("beforeRenderer",t)}),a(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),a(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(s,t,e){var l=this,u=1<arguments.length&&void 0!==t?t:this.getCallback(),h=2<arguments.length&&void 0!==e?e:this.getQueryMethod(),n=this.hot.countRows(),r=this.hot.countCols(),c=[],d=this.hot;return(0,f.rangeEach)(0,n-1,function(a){(0,f.rangeEach)(0,r-1,function(t){var e=l.hot.getDataAtCell(a,t),n=l.hot.getCellMeta(a,t),r=n.search.callback||u,i=(n.search.queryMethod||h)(s,e);if(i){var o={row:a,col:t,data:e};c.push(o)}r&&r(d,a,t,e,i)})}),c}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(t){this.callback=t}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(t){this.queryMethod=t}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(t){this.searchResultClass=t}},{key:"updatePluginSettings",value:function(t){(0,h.isObject)(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}},{key:"onBeforeRenderer",value:function(t,e,n,r,i,o){var a,s=o.className||[],l=[];"string"==typeof s?l=s.split(" "):(a=l).push.apply(a,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(s)),this.isEnabled()&&o.isSearchResult?l.includes(this.searchResultClass)||l.push(""+this.searchResultClass):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),o.className=l.join(" ")}},{key:"destroy",value:function(){a(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"destroy",this).call(this)}}]),v);function v(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,t));return e.callback=d,e.queryMethod=p,e.searchResultClass="htSearchResult",e}(0,u.registerPlugin)("search",g),e.default=g},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o,s=n(2),l=n(0),u=n(7),h=(o=u)&&o.__esModule?o:{default:o},c=n(5),d=n(43);var f=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(p,h.default),r(p,[{key:"isEnabled",value:function(){return(0,d.isTouchSupported)()}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterRender",function(){return t.onAfterRender()}),this.registerEvents(),a(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,a(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){a(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var t=this;this.addHook("beforeTouchScroll",function(){return t.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return t.onAfterMomentumScroll()})}},{key:"onAfterRender",value:function(){if(!this.lockedCollection){var t=this.hot.view.wt.wtOverlays,e=t.topOverlay,n=t.bottomOverlay,r=t.leftOverlay,i=t.topLeftCornerOverlay,o=t.bottomLeftCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),n.clone&&this.scrollbars.push(n),this.scrollbars.push(r),i&&this.scrollbars.push(i),o&&o.clone&&this.scrollbars.push(o),this.clones.length=0,e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),o&&o.clone&&this.clones.push(o.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,(0,l.arrayEach)(this.clones,function(t){(0,s.addClass)(t,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var t=this;this.freezeOverlays=!1,(0,l.arrayEach)(this.clones,function(t){(0,s.removeClass)(t,"hide-tween"),(0,s.addClass)(t,"show-tween")}),setTimeout(function(){(0,l.arrayEach)(t.clones,function(t){(0,s.removeClass)(t,"show-tween")})},400),(0,l.arrayEach)(this.scrollbars,function(t){t.refresh(),t.resetFixedPosition()}),this.hot.view.wt.wtOverlays.syncScrollWithMaster()}}]),p);function p(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,t));return e.scrollbars=[],e.clones=[],e.lockedCollection=!1,e.freezeOverlays=!1,e}(0,c.registerPlugin)("touchScroll",f),e.default=f},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(17),s=(o=a)&&o.__esModule?o:{default:o},u=n(0),p=n(4),h=n(1),l=n(12),c=n(23);function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function g(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function v(d){var f=this;this.instance=d,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,d.addHook("afterChange",function(t,e){t&&"UndoRedo.undo"!==e&&"UndoRedo.redo"!==e&&"MergeCells"!==e&&f.done(new v.ChangeAction(t))}),d.addHook("afterCreateRow",function(t,e,n){if("UndoRedo.undo"!==n&&"UndoRedo.undo"!==n&&"auto"!==n){var r=new v.CreateRowAction(t,e);f.done(r)}}),d.addHook("beforeRemoveRow",function(t,e,n,r){if("UndoRedo.undo"!==r&&"UndoRedo.redo"!==r&&"auto"!==r){var i=f.instance.getSourceDataArray(),o=(i.length+t)%i.length,a=d.toPhysicalRow(o),s=(0,h.deepClone)(i.slice(a,a+e));f.done(new v.RemoveRowAction(o,s))}}),d.addHook("afterCreateCol",function(t,e,n){"UndoRedo.undo"!==n&&"UndoRedo.redo"!==n&&"auto"!==n&&f.done(new v.CreateColumnAction(t,e))}),d.addHook("beforeRemoveCol",function(t,r,e,n){if("UndoRedo.undo"!==n&&"UndoRedo.redo"!==n&&"auto"!==n){var i=f.instance.getSourceDataArray(),o=(f.instance.countCols()+t)%f.instance.countCols(),a=[],s=[],l=[];(0,p.rangeEach)(i.length-1,function(t){var e=[],n=i[t];(0,p.rangeEach)(o,r-1+o,function(t){e.push(n[d.runHooks("modifyCol",t)])}),a.push(e)}),(0,p.rangeEach)(r-1,function(t){l.push(d.runHooks("modifyCol",o+t))}),Array.isArray(d.getSettings().colHeaders)&&(0,p.rangeEach)(r-1,function(t){s.push(d.getSettings().colHeaders[d.runHooks("modifyCol",o+t)]||null)});var u=f.instance.getPlugin("manualColumnMove"),h=u.isEnabled()?u.columnsMapper.__arrayMap:[],c=new v.RemoveColumnAction(o,l,a,s,h);f.done(c)}}),d.addHook("beforeCellAlignment",function(t,e,n,r){var i=new v.CellAlignmentAction(t,e,n,r);f.done(i)}),d.addHook("beforeFilter",function(t){f.done(new v.FiltersAction(t))}),d.addHook("beforeRowMove",function(t,e){!1!==t&&f.done(new v.RowMoveAction(t,e))}),d.addHook("beforeMergeCells",function(t,e){e||f.done(new v.MergeCellsAction(d,t))}),d.addHook("afterUnmergeCells",function(t,e){e||f.done(new v.UnmergeCellsAction(d,t))})}v.prototype.done=function(t){this.ignoreNewActions||(this.doneActions.push(t),this.undoneActions.length=0)},v.prototype.undo=function(){if(this.isUndoAvailable()){var t=this.doneActions.pop(),e=(0,h.deepClone)(t),n=this.instance;if(!1===n.runHooks("beforeUndo",e))return;this.ignoreNewActions=!0;var r=this;t.undo(this.instance,function(){r.ignoreNewActions=!1,r.undoneActions.push(t)}),n.runHooks("afterUndo",e)}},v.prototype.redo=function(){if(this.isRedoAvailable()){var t=this.undoneActions.pop(),e=(0,h.deepClone)(t),n=this.instance;if(!1===n.runHooks("beforeRedo",e))return;this.ignoreNewActions=!0;var r=this;t.redo(this.instance,function(){r.ignoreNewActions=!1,r.doneActions.push(t)}),n.runHooks("afterRedo",e)}},v.prototype.isUndoAvailable=function(){return 0<this.doneActions.length},v.prototype.isRedoAvailable=function(){return 0<this.undoneActions.length},v.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},(v.Action=function(){}).prototype.undo=function(){},v.Action.prototype.redo=function(){},v.ChangeAction=function(t){this.changes=t,this.actionType="change"},(0,h.inherit)(v.ChangeAction,v.Action),v.ChangeAction.prototype.undo=function(t,e){for(var n=(0,h.deepClone)(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0),o=0,a=n.length;o<a;o++)n[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtRowProp(n,null,null,"UndoRedo.undo");for(var s=0,l=n.length;s<l;s++)t.getSettings().minSpareRows&&n[s][0]+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(n[s][0]+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&n[s][1]+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(n[s][1]+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())},v.ChangeAction.prototype.redo=function(t,e){for(var n=(0,h.deepClone)(this.changes),r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtRowProp(n,null,null,"UndoRedo.redo")},v.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},(0,h.inherit)(v.CreateRowAction,v.Action),v.CreateRowAction.prototype.undo=function(t,e){var n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},v.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row",this.index,this.amount,"UndoRedo.redo")},v.RemoveRowAction=function(t,e){this.index=t,this.data=e,this.actionType="remove_row"},(0,h.inherit)(v.RemoveRowAction,v.Action),v.RemoveRowAction.prototype.undo=function(t,e){t.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterRender",e),t.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")},v.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},v.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},(0,h.inherit)(v.CreateColumnAction,v.Action),v.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},v.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col",this.index,this.amount,"UndoRedo.redo")},v.RemoveColumnAction=function(t,e,n,r,i){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.actionType="remove_col"},(0,h.inherit)(v.RemoveColumnAction,v.Action),v.RemoveColumnAction.prototype.undo=function(n,t){function e(t,e,n){return n[r.indexes.indexOf(o[e])]}var r=this,i=void 0,o=this.indexes.slice(0).sort(),a=[];(0,p.rangeEach)(this.data.length-1,function(t){a[t]=(0,u.arrayMap)(r.data[t],e)});var s;s=(0,u.arrayMap)(this.headers,e);var l=[];n.runHooks("beforeCreateCol",this.indexes[0],this.indexes.length,"UndoRedo.undo"),(0,p.rangeEach)(this.data.length-1,function(e){i=n.getSourceDataAtRow(e),(0,p.rangeEach)(o.length-1,function(t){i.splice(o[t],0,a[e][t]),l.push([e,o[t],null,a[e][t]])})}),n.getPlugin("formulas")&&n.getPlugin("formulas").onAfterSetDataAtCell(l),void 0!==this.headers&&(0,p.rangeEach)(s.length-1,function(t){n.getSettings().colHeaders.splice(o[t],0,s[t])}),n.getPlugin("manualColumnMove")&&(n.getPlugin("manualColumnMove").columnsMapper.__arrayMap=this.columnPositions),n.addHookOnce("afterRender",t),n.runHooks("afterCreateCol",this.indexes[0],this.indexes.length,"UndoRedo.undo"),n.getPlugin("formulas")&&n.getPlugin("formulas").recalculateFull(),n.render()},v.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},(v.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r}).prototype.undo=function(o,t){var a=this;(0,u.arrayEach)(this.range,function(t){for(var e=t.from,n=t.to,r=e.row;r<=n.row;r+=1)for(var i=e.col;i<=n.col;i+=1)o.setCellMeta(r,i,"className",a.stateBefore[r][i]||" htLeft")}),o.addHookOnce("afterRender",t),o.render()},v.CellAlignmentAction.prototype.redo=function(i,t){(0,c.align)(this.range,this.type,this.alignment,function(t,e){return i.getCellMeta(t,e)},function(t,e,n,r){return i.setCellMeta(t,e,n,r)}),i.addHookOnce("afterRender",t),i.render()},v.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},(0,h.inherit)(v.FiltersAction,v.Action),v.FiltersAction.prototype.undo=function(t,e){var n=t.getPlugin("filters");t.addHookOnce("afterRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},v.FiltersAction.prototype.redo=function(t,e){var n=t.getPlugin("filters");t.addHookOnce("afterRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};var m=(g(y,v.Action),r(y,[{key:"undo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",e),n.unmergeRange(this.cellRange,!0),t.populateFromArray(this.cellRange.from.row,this.cellRange.from.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",e),n.mergeRange(this.cellRange)}}]),y);function y(t,e){d(this,y);var n=f(this,(y.__proto__||Object.getPrototypeOf(y)).call(this));return n.cellRange=e,n.rangeData=t.getData(e.from.row,e.from.col,e.to.row,e.to.col),n}v.MergeCellsAction=m;var w=(g(b,v.Action),r(b,[{key:"undo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",e),n.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",e),n.unmergeRange(this.cellRange,!0),t.render()}}]),b);function b(t,e){d(this,b);var n=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return n.cellRange=e,n}function C(){var t=this;void 0===t.getSettings().undo||t.getSettings().undo?t.undoRedo||(t.undoRedo=new v(t),function(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}(t),t.addHook("beforeKeyDown",E),t.addHook("afterChange",S)):t.undoRedo&&(delete t.undoRedo,function(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}(t),t.removeHook("beforeKeyDown",E),t.removeHook("afterChange",S))}function E(t){!t.ctrlKey&&!t.metaKey||t.altKey||(89===t.keyCode||t.shiftKey&&90===t.keyCode?(this.undoRedo.redo(),(0,l.stopImmediatePropagation)(t)):90===t.keyCode&&(this.undoRedo.undo(),(0,l.stopImmediatePropagation)(t)))}function S(t,e){if("loadData"===e)return this.undoRedo.clear()}v.UnmergeCellsAction=w,v.RowMoveAction=function(t,e){this.rows=t.slice(),this.target=e},(0,h.inherit)(v.RowMoveAction,v.Action),v.RowMoveAction.prototype.undo=function(t,e){var n=t.getPlugin("manualRowMove");t.addHookOnce("afterRender",e);for(var r=this.rows[0]<this.target?-1*this.rows.length:0,i=this.rows[0]>this.target?this.rows[0]+this.rows.length:this.rows[0],o=[],a=this.rows.length+r,s=r;s<a;s+=1)o.push(this.target+s);n.moveRows(o.slice(),i),t.render(),t.selectCell(this.rows[0],0,this.rows[this.rows.length-1],t.countCols()-1,!1,!1)},v.RowMoveAction.prototype.redo=function(t,e){var n=t.getPlugin("manualRowMove");t.addHookOnce("afterRender",e),n.moveRows(this.rows.slice(),this.target),t.render();var r=this.rows[0]<this.target?this.target-this.rows.length:this.target;t.selectCell(r,0,r+this.rows.length-1,t.countCols()-1,!1,!1)};var O=s.default.getSingleton();O.add("afterInit",C),O.add("afterUpdateSettings",C),O.register("beforeUndo"),O.register("afterUndo"),O.register("beforeRedo"),O.register("afterRedo"),e.default=v},function(t,e,n){"use strict";e.__esModule=!0,e.TrimRows=e.NestedRows=e.NestedHeaders=e.HiddenRows=e.HiddenColumns=e.HeaderTooltips=e.GanttChart=e.Formulas=e.Filters=e.MultiColumnSorting=e.ExportFile=e.DropdownMenu=e.ColumnSummary=e.CollapsibleColumns=e.BindRowsWithHeaders=void 0;var r=y(n(401)),i=y(n(406)),o=y(n(407)),a=y(n(409)),s=y(n(411)),l=y(n(416)),u=y(n(421)),h=y(n(450)),c=y(n(463)),d=y(n(467)),f=y(n(468)),p=y(n(471)),g=y(n(476)),v=y(n(480)),m=y(n(484));function y(t){return t&&t.__esModule?t:{default:t}}e.BindRowsWithHeaders=r.default,e.CollapsibleColumns=i.default,e.ColumnSummary=o.default,e.DropdownMenu=a.default,e.ExportFile=s.default,e.MultiColumnSorting=l.default,e.Filters=u.default,e.Formulas=h.default,e.GanttChart=c.default,e.HeaderTooltips=d.default,e.HiddenColumns=g.default,e.HiddenRows=v.default,e.NestedHeaders=f.default,e.NestedRows=p.default,e.TrimRows=m.default},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=h(n(7)),s=n(4),l=n(5),u=h(n(402));function h(t){return t&&t.__esModule?t:{default:t}}var c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(d,o.default),r(d,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().bindRowsWithHeaders}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var t=this.hot.getSettings().bindRowsWithHeaders;"string"!=typeof t&&(t=u.default.DEFAULT_STRATEGY),this.bindStrategy.setStrategy(t),this.bindStrategy.createMap(this.hot.countSourceRows()),this.addHook("modifyRowHeader",function(t){return n.onModifyRowHeader(t)}),this.addHook("afterCreateRow",function(t,e){return n.onAfterCreateRow(t,e)}),this.addHook("beforeRemoveRow",function(t,e){return n.onBeforeRemoveRow(t,e)}),this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow()}),this.addHook("afterLoadData",function(t){return n.onAfterLoadData(t)}),a(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){a(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.removedRows.length=0,this.bindStrategy.clearMap(),a(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(t){return this.bindStrategy.translate(this.hot.runHooks("modifyRow",t))}},{key:"onAfterCreateRow",value:function(t,e){this.bindStrategy.createRow(t,e)}},{key:"onBeforeRemoveRow",value:function(t,e){var n=this;this.removedRows.length=0,!1!==t&&(0,s.rangeEach)(t,t+e-1,function(t){n.removedRows.push(n.hot.runHooks("modifyRow",t))})}},{key:"onAfterRemoveRow",value:function(){this.bindStrategy.removeRow(this.removedRows)}},{key:"onAfterLoadData",value:function(t){t||this.bindStrategy.createMap(this.hot.countSourceRows())}},{key:"destroy",value:function(){this.bindStrategy.destroy(),a(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"destroy",this).call(this)}}]),d);function d(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,t));return e.bindStrategy=new u.default,e.removedRows=[],e}(0,l.registerPlugin)("bindRowsWithHeaders",c),e.default=c},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(4),a=n(31),s=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(403));var l=(r(u,null,[{key:"DEFAULT_STRATEGY",get:function(){return"loose"}}]),r(u,[{key:"setStrategy",value:function(t){var e=s[(0,a.toUpperCaseFirst)(t)];if(!e)throw new Error('Bind strategy "'+t+'" does not exist.');this.strategy=new e}},{key:"createMap",value:function(t){var e=this.strategy,n=void 0===t?e._arrayMap.length:t;(e._arrayMap.length=0,o.rangeEach)(n-1,function(t){e._arrayMap.push(t)})}},{key:"createRow",value:function(){var t;(t=this.strategy).createRow.apply(t,arguments)}},{key:"removeRow",value:function(){var t;(t=this.strategy).removeRow.apply(t,arguments)}},{key:"translate",value:function(){var t;return(t=this.strategy).getValueByIndex.apply(t,arguments)}},{key:"clearMap",value:function(){this.strategy.clearMap()}},{key:"destroy",value:function(){this.strategy&&this.strategy.destroy(),this.strategy=null}}]),u);function u(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),this.strategy=null}e.default=l},function(t,e,n){"use strict";e.__esModule=!0,e.Strict=e.Loose=void 0;var r=o(n(404)),i=o(n(405));function o(t){return t&&t.__esModule?t:{default:t}}e.Loose=r.default,e.Strict=i.default},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(56),s=(o=a)&&o.__esModule?o:{default:o},l=n(1);var u=(r(h,[{key:"createRow",value:function(t,e){this.shiftItems(t,e)}},{key:"removeRow",value:function(t,e){this.unshiftItems(t,e)}},{key:"destroy",value:function(){this._arrayMap=null}}],[{key:"STRATEGY_NAME",get:function(){return"loose"}}]),h);function h(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h)}(0,l.mixin)(u,s.default),e.default=u},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(56),s=(o=a)&&o.__esModule?o:{default:o},l=n(1);var u=(r(h,[{key:"createRow",value:function(t,e){this.insertItems(t,e)}},{key:"removeRow",value:function(t,e){this.removeItems(t,e)}},{key:"destroy",value:function(){this._arrayMap=null}}],[{key:"STRATEGY_NAME",get:function(){return"strict"}}]),h);function h(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h)}(0,l.mixin)(u,s.default),e.default=u},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var s=n(1),l=n(0),c=n(4),o=n(22),u=n(2),h=p(n(8)),d=n(5),f=n(12);function p(t){return t&&t.__esModule?t:{default:t}}var g=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(v,p(n(7)).default),r(v,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().collapsibleColumns}},{key:"enablePlugin",value:function(){var r=this;this.enabled||(this.settings=this.hot.getSettings().collapsibleColumns,"boolean"!=typeof this.settings&&this.parseSettings(),this.hiddenColumnsPlugin=this.hot.getPlugin("hiddenColumns"),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.checkDependencies(),this.addHook("afterRender",function(){return r.onAfterRender()}),this.addHook("afterInit",function(){return r.onAfterInit()}),this.addHook("afterGetColHeader",function(t,e){return r.onAfterGetColHeader(t,e)}),this.addHook("beforeOnCellMouseDown",function(t,e,n){return r.onBeforeOnCellMouseDown(t,e,n)}),this.eventManager=new h.default(this.hot),a(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.settings=null,this.buttonEnabledList={},this.hiddenColumnsPlugin=null,this.collapsedSections={},this.clearButtons(),a(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var t=this.hot.view.wt.getSetting("columnHeaders").length,e=this.hot.view.wt.wtTable.THEAD,o=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,a=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,s=function(t){t&&t.parentNode.removeChild(t)};(0,c.rangeEach)(0,t-1,function(t){var n=e.childNodes[t],r=o.childNodes[t],i=a?a.childNodes[t]:null;(0,c.rangeEach)(0,n.childNodes.length-1,function(t){var e=n.childNodes[t].querySelector(".collapsibleIndicator");s(e),r&&r.childNodes[t]&&(e=r.childNodes[t].querySelector(".collapsibleIndicator"),s(e)),a&&i&&i.childNodes[t]&&(e=i.childNodes[t].querySelector(".collapsibleIndicator"),s(e))})},!0)}}},{key:"parseSettings",value:function(){var e=this;(0,s.objectEach)(this.settings,function(t){e.buttonEnabledList[t.row]||(e.buttonEnabledList[t.row]={}),e.buttonEnabledList[t.row][t.col]=t.collapsible})}},{key:"meetsDependencies",value:function(){var t=this.hot.getSettings();return t.nestedHeaders&&t.hiddenColumns}},{key:"checkDependencies",value:function(){var t=this.hot.getSettings();this.meetsDependencies()||(t.nestedHeaders||(0,o.warn)("You need to configure the Nested Headers plugin in order to use collapsible headers."),t.hiddenColumns||(0,o.warn)("You need to configure the Hidden Columns plugin in order to use collapsible headers."))}},{key:"generateIndicator",value:function(t,e){var n=e.parentNode,r=n.parentNode,i=-1*r.childNodes.length+Array.prototype.indexOf.call(r.childNodes,n);if(0<Object.keys(this.buttonEnabledList).length&&(!this.buttonEnabledList[i]||!this.buttonEnabledList[i][t]))return null;var o=document.createElement("DIV");return(0,u.addClass)(o,"collapsibleIndicator"),this.collapsedSections[i]&&!0===this.collapsedSections[i][t]?((0,u.addClass)(o,"collapsed"),(0,u.fastInnerText)(o,"+")):((0,u.addClass)(o,"expanded"),(0,u.fastInnerText)(o,"-")),o}},{key:"markSectionAs",value:function(t,e,n,r){switch(this.collapsedSections[e]||(this.collapsedSections[e]={}),t){case"collapsed":this.collapsedSections[e][n]=!0;break;case"expanded":this.collapsedSections[e][n]=void 0}if(r)for(var i=this.nestedHeadersPlugin.colspanArray,o=this.nestedHeadersPlugin.rowCoordsToLevel(e),a=this.nestedHeadersPlugin.getChildHeaders(e,n),s=i[o+1],l=1;l<a.length;l++)s&&1<s[a[l]].colspan&&this.markSectionAs(t,e+1,a[l],!0)}},{key:"expandSection",value:function(t){this.markSectionAs("expanded",t.row,t.col,!0),this.toggleCollapsibleSection(t,"expand")}},{key:"collapseSection",value:function(t){this.markSectionAs("collapsed",t.row,t.col,!0),this.toggleCollapsibleSection(t,"collapse")}},{key:"toggleAllCollapsibleSections",value:function(o){var a=this,t=this.nestedHeadersPlugin.colspanArray;!0===this.settings?(0,l.arrayEach)(t,function(t,i){(0,l.arrayEach)(t,function(t,e){if(1<t.colspan){var n=a.nestedHeadersPlugin.levelToRowCoords(parseInt(i,10)),r=parseInt(e,10);a.markSectionAs("collapse"===o?"collapsed":"expanded",n,r,!0),a.toggleCollapsibleSection({row:n,col:r},o)}})}):(0,s.objectEach)(this.buttonEnabledList,function(t,i){(0,s.objectEach)(t,function(t,e){var n=parseInt(i,10),r=parseInt(e,10);a.markSectionAs("collapse"===o?"collapsed":"expanded",n,r,!0),a.toggleCollapsibleSection({row:n,col:r},o)})})}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(n,r){var i=this;n.row&&(n.row=parseInt(n.row,10)),n.col&&(n.col=parseInt(n.col,10));for(var o=this.hiddenColumnsPlugin.hiddenColumns,t=this.nestedHeadersPlugin.colspanArray,e=this.nestedHeadersPlugin.rowCoordsToLevel(n.row),a=t[e][n.col].colspan,s=this.nestedHeadersPlugin.getChildHeaders(n.row,n.col),l=e+1,u=t[l],h=u&&u[s[0]].colspan||1;h===a&&l<this.columnHeaderLevelCount;)h=(u=t[l+=1])&&u[s[0]].colspan||1;(0,c.rangeEach)(h,a-1,function(t){var e=n.col+t;switch(r){case"collapse":i.hiddenColumnsPlugin.isHidden(e)||o.push(e);break;case"expand":i.hiddenColumnsPlugin.isHidden(e)&&o.splice(o.indexOf(e),1)}}),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0)}},{key:"onAfterGetColHeader",value:function(t,e){if(e.hasAttribute("colspan")&&1<e.getAttribute("colspan")&&t>=this.hot.getSettings().fixedColumnsLeft){var n=this.generateIndicator(t,e);null!==n&&e.querySelector("div:first-child").appendChild(n)}}},{key:"onBeforeOnCellMouseDown",value:function(t,e){if((0,u.hasClass)(t.target,"collapsibleIndicator"))return(0,u.hasClass)(t.target,"expanded")?(this.collapsedSections[e.row]||(this.collapsedSections[e.row]=[]),this.markSectionAs("collapsed",e.row,e.col,!0),this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection(e,"collapse")):(0,u.hasClass)(t.target,"collapsed")&&(this.markSectionAs("expanded",e.row,e.col,!0),this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection(e,"expand")),(0,f.stopImmediatePropagation)(t),!1}},{key:"onAfterInit",value:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length}},{key:"onAfterRender",value:function(){this.nestedHeadersPlugin.enabled&&this.hiddenColumnsPlugin.enabled||this.disablePlugin()}},{key:"destroy",value:function(){this.settings=null,this.buttonEnabledList=null,this.hiddenColumnsPlugin=null,this.nestedHeadersPlugin=null,this.collapsedSections=null,this.columnHeaderLevelCount=null,a(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"destroy",this).call(this)}}]),v);function v(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,t));return e.settings=null,e.buttonEnabledList={},e.hiddenColumnsPlugin=null,e.nestedHeadersPlugin=null,e.collapsedSections={},e.columnHeaderLevelCount=null,e.eventManager=null,e}(0,d.registerPlugin)("collapsibleColumns",g),e.default=g},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=u(n(7)),a=n(1),s=n(5),l=u(n(408));function u(t){return t&&t.__esModule?t:{default:t}}var h=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(c,o.default),r(c,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSummary}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.settings=this.hot.getSettings().columnSummary,this.endpoints=new l.default(this,this.settings),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeCreateRow",function(t,e,n){return i.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,e,null,n)}),this.addHook("beforeCreateCol",function(t,e,n){return i.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,e,null,n)}),this.addHook("beforeRemoveRow",function(){for(var t,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=i.endpoints).resetSetupBeforeStructureAlteration.apply(t,["remove_row"].concat(n))}),this.addHook("beforeRemoveCol",function(){for(var t,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=i.endpoints).resetSetupBeforeStructureAlteration.apply(t,["remove_col"].concat(n))}),this.addHook("beforeRowMove",function(){return i.onBeforeRowMove.apply(i,arguments)}),this.addHook("afterCreateRow",function(t,e,n){return i.endpoints.resetSetupAfterStructureAlteration("insert_row",t,e,null,n)}),this.addHook("afterCreateCol",function(t,e,n){return i.endpoints.resetSetupAfterStructureAlteration("insert_col",t,e,null,n)}),this.addHook("afterRemoveRow",function(){for(var t,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=i.endpoints).resetSetupAfterStructureAlteration.apply(t,["remove_row"].concat(n))}),this.addHook("afterRemoveCol",function(){for(var t,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=i.endpoints).resetSetupAfterStructureAlteration.apply(t,["remove_col"].concat(n))}),this.addHook("afterRowMove",function(){return i.onAfterRowMove.apply(i,arguments)}),function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0}(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t)}}},{key:"calculateSum",value:function(e){var n=this,r=0;return(0,a.objectEach)(e.ranges,function(t){r+=n.getPartialSum(t,e.sourceColumn)}),r}},{key:"getPartialSum",value:function(t,e){var n=0,r=t[1]||t[0],i=null,o=0;do{var a=((""+(i=this.getCellValue(r,e)||0)).split(".")[1]||[]).length||1;o<a&&(o=a),n+=i||0,r-=1}while(r>=t[0]);return Math.round(n*Math.pow(10,o))/Math.pow(10,o)}},{key:"calculateMinMax",value:function(n,r){var i=this,o=null;return(0,a.objectEach)(n.ranges,function(t){var e=i.getPartialMinMax(t,n.sourceColumn,r);if(null===o&&null!==e&&(o=e),null!==e)switch(r){case"min":o=Math.min(o,e);break;case"max":o=Math.max(o,e)}}),null===o?"Not enough data":o}},{key:"getPartialMinMax",value:function(t,e,n){var r=null,i=t[1]||t[0],o=void 0;do{if(o=this.getCellValue(i,e)||null,null===r)r=o;else if(null!==o)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o)}i-=1}while(i>=t[0]);return r}},{key:"countEmpty",value:function(t,e){for(var n=0,r=t[1]||t[0];this.getCellValue(r,e)||(n+=1),(r-=1)>=t[0];);return n}},{key:"countEntries",value:function(r){var i=this,o=0,t=r.ranges;return(0,a.objectEach)(t,function(t){var e=void 0===t[1]?1:t[1]-t[0]+1,n=i.countEmpty(t,r.sourceColumn);o+=e,o-=n}),o}},{key:"calculateAverage",value:function(t){return this.calculateSum(t)/this.countEntries(t)}},{key:"getCellValue",value:function(t,e){var n=this.endpoints.getVisualRowIndex(t),r=this.endpoints.getVisualColumnIndex(e),i=this.hot.getSourceDataAtCell(t,e);if(-1<(this.hot.getCellMeta(n,r).className||"").indexOf("columnSummaryResult"))return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof i&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error("ColumnSummary plugin: cell at ("+t+", "+e+") is not in a numeric format. Cannot do the calculation.");return i}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}},{key:"onBeforeRowMove",value:function(t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName)}},{key:"onAfterRowMove",value:function(t,e){this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}}]),c);function c(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,t));return e.endpoints=null,e}(0,s.registerPlugin)("columnSummary",h),e.default=h},function(t,e,n){"use strict";e.__esModule=!0;var h=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var f=n(0),o=n(22),a=n(55);var s=(r(l,[{key:"getEndpoint",value:function(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}},{key:"getAllEndpoints",value:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(t){return this.parseSettings(t.call(this))}},{key:"parseSettings",value:function(t){var n=this,r=[],e=t;if(e||"function"!=typeof this.settings)return e=e||this.settings,(0,f.arrayEach)(e,function(t){var e={};n.assignSetting(t,e,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(t,e,"reversedRowCoords",!1),n.assignSetting(t,e,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),n.assignSetting(t,e,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),n.assignSetting(t,e,"sourceColumn",t.destinationColumn),n.assignSetting(t,e,"type","sum"),n.assignSetting(t,e,"forceNumeric",!1),n.assignSetting(t,e,"suppressDataTypeErrors",!0),n.assignSetting(t,e,"suppressDataTypeErrors",!0),n.assignSetting(t,e,"customFunction",null),n.assignSetting(t,e,"readOnly",!0),n.assignSetting(t,e,"roundFloat",!1),r.push(e)}),r;this.settingsType="function"}},{key:"assignSetting",value:function(t,e,n,r){if("ranges"!==n||void 0!==t[n]){if("ranges"!==n||0!==t[n].length)if(void 0===t[n]){if(r instanceof Error)throw r;e[n]=r}else"destinationRow"===n&&e.reversedRowCoords?e[n]=this.hot.countRows()-t[n]-1:e[n]=t[n]}else e[n]=r}},{key:"resetSetupBeforeStructureAlteration",value:function(e,n,r){if("function"===this.settingsType){var i=-1<e.indexOf("row")?"row":"col",t=this.getAllEndpoints();(0,f.arrayEach)(t,function(t){"row"==i&&t.destinationRow>=n&&("insert_row"===e?t.alterRowOffset=r:"remove_row"===e&&(t.alterRowOffset=-1*r)),"col"==i&&t.destinationColumn>=n&&("insert_col"===e?t.alterColumnOffset=r:"remove_col"===e&&(t.alterColumnOffset=-1*r))}),this.resetAllEndpoints(t,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(t,e,n,r,i,o){var a=this,s=!(5<arguments.length&&void 0!==o)||o;if("function"!==this.settingsType){var l=-1<t.indexOf("row")?"row":"col",u=-1<t.indexOf("remove")?-1:1,h=this.getAllEndpoints(),c=0===t.indexOf("move_row"),d=e;(0,f.arrayEach)(h,function(t){"row"==l&&t.destinationRow>=d&&(t.alterRowOffset=u*n),"col"==l&&t.destinationColumn>=d&&(t.alterColumnOffset=u*n)}),this.resetAllEndpoints(h,!c),c?(0,f.arrayEach)(h,function(t){a.extendEndpointRanges(t,d,r[0],r.length),a.recreatePhysicalRanges(t),a.clearOffsetInformation(t)}):(0,f.arrayEach)(h,function(t){a.shiftEndpointCoordinates(t,d)}),s&&this.refreshAllEndpoints()}else this.hot.addHookOnce("beforeRender",function t(){return a.hot.removeHook("beforeRender",t),a.refreshAllEndpoints()})}},{key:"clearOffsetInformation",value:function(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(t,e,n,r){(0,f.arrayEach)(t.ranges,function(t){t[1]&&(e>=t[0]&&e<=t[1]?n>t[1]?t[1]+=r:n<t[0]&&(t[0]-=r):n>=t[0]&&n<=t[1]&&(t[1]-=r,e<=t[0]&&(t[0]+=1,t[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(t){var r=this,e=t.ranges,i=[],o=[];(0,f.arrayEach)(e,function(t){var e=[];if(t[1])for(var n=t[0];n<=t[1];n++)e.push(r.recordTranslator.toPhysicalRow(n));else e.push(r.recordTranslator.toPhysicalRow(t[0]));o.push(e)}),(0,f.arrayEach)(o,function(n){var r=[];(0,f.arrayEach)(n,function(t,e){0===e?r.push(t):n[e]!==n[e-1]+1&&(r.push(n[e-1]),i.push(r),(r=[]).push(t)),e===n.length-1&&(r.push(t),i.push(r))})}),t.ranges=i}},{key:"shiftEndpointCoordinates",value:function(r,i){r.alterRowOffset&&0!==r.alterRowOffset?(r.destinationRow+=r.alterRowOffset||0,(0,f.arrayEach)(r.ranges,function(n){(0,f.arrayEach)(n,function(t,e){i<=t&&(n[e]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&0!==r.alterColumnOffset&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(t,e){var n=this,r=!(1<arguments.length&&void 0!==e)||e,i=t;this.cellsToSetCache=[],i=i||this.getAllEndpoints(),(0,f.arrayEach)(i,function(t){n.resetEndpointValue(t,r)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshAllEndpoints",value:function(){var e=this;this.cellsToSetCache=[],(0,f.arrayEach)(this.getAllEndpoints(),function(t){e.currentEndpoint=t,e.plugin.calculate(t),e.setEndpointValue(t,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(t){var i=this,o=[];this.cellsToSetCache=[],(0,f.arrayEach)(t,function(t,n,r){""+(t[2]||"")!=""+t[3]&&(0,f.arrayEach)(i.getAllEndpoints(),function(t,e){i.hot.propToCol(r[n][1])===t.sourceColumn&&-1===o.indexOf(e)&&o.push(e)})}),(0,f.arrayEach)(o,function(t){i.refreshEndpoint(i.getEndpoint(t))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(t,e){var n=!(1<arguments.length&&void 0!==e)||e,r=t.alterRowOffset||0,i=t.alterColumnOffset||0,o=this.recordTranslator.toVisual(t.destinationRow,t.destinationColumn),a=h(o,2),s=a[0],l=a[1],u=this.hot.getCellMeta(s,l);u.readOnly=!1,u.className="",this.cellsToSetCache.push([this.recordTranslator.toVisualRow(t.destinationRow+(n?r:0)),this.recordTranslator.toVisualColumn(t.destinationColumn+(n?i:0)),""])}},{key:"setEndpointValue",value:function(t,e,n){var r=2<arguments.length&&void 0!==n&&n,i=-1*t.alterRowOffset||0,o=-1*t.alterColumnOffset||0,a=this.getVisualRowIndex(t.destinationRow),s=this.hot.getCellMeta(this.getVisualRowIndex(t.destinationRow+i),t.destinationColumn+o);a>this.hot.countRows()||t.destinationColumn>this.hot.countCols()?this.throwOutOfBoundsWarning():("init"!==e&&s.readOnly===t.readOnly||(s.readOnly=t.readOnly,s.className="columnSummaryResult"),t.roundFloat&&!isNaN(t.result)&&(t.result=t.result.toFixed(t.roundFloat)),r?this.hot.setDataAtCell(a,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([a,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0)}},{key:"getVisualRowIndex",value:function(t){return this.hot.runHooks("unmodifyRow",t,"columnSummary")}},{key:"getVisualColumnIndex",value:function(t){return this.hot.runHooks("unmodifyCol",t,"columnSummary")}},{key:"throwOutOfBoundsWarning",value:function(){(0,o.warn)("One of the  Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),l);function l(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=e,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[],this.recordTranslator=(0,a.getTranslator)(this.hot)}e.default=s},function(t,e,n){"use strict";e.__esModule=!0;function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=m(n(7)),s=n(0),l=m(n(222)),u=m(n(8)),h=n(2),c=m(n(223)),d=m(n(162)),f=n(5),p=m(n(17)),g=n(12),v=n(45);function m(t){return t&&t.__esModule?t:{default:t}}n(410),p.default.getSingleton().register("afterDropdownMenuDefaultOptions"),p.default.getSingleton().register("beforeDropdownMenuShow"),p.default.getSingleton().register("afterDropdownMenuShow"),p.default.getSingleton().register("afterDropdownMenuHide"),p.default.getSingleton().register("afterDropdownMenuExecute");var y="changeType",w=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(b,o.default),r(b,null,[{key:"DEFAULT_ITEMS",get:function(){return[v.COLUMN_LEFT,v.COLUMN_RIGHT,v.SEPARATOR,v.REMOVE_COLUMN,v.SEPARATOR,v.CLEAR_COLUMN,v.SEPARATOR,v.READ_ONLY,v.SEPARATOR,v.ALIGNMENT]}}]),r(b,[{key:"isEnabled",value:function(){return this.hot.getSettings().dropdownMenu}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.itemsFactory=new c.default(this.hot,b.DEFAULT_ITEMS);var e=this.hot.getSettings().dropdownMenu,n={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){i.hot.runHooks("afterDropdownMenuDefaultOptions",n),i.itemsFactory.setPredefinedItems(n.items);var t=i.itemsFactory.getItems(e);i.menu&&i.menu.destroy(),i.menu=new d.default(i.hot,{className:"htDropdownMenu",keepInViewport:!0}),i.hot.runHooks("beforeDropdownMenuSetItems",t),i.menu.setMenuItems(t),i.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),i.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),i.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),i.menu.addLocalHook("executeCommand",function(){for(var t,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=i.executeCommand).call.apply(t,[i].concat(n))}),(0,s.arrayEach)(t,function(t){return i.commandExecutor.registerCommand(t.key,t)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(t){return e.onTableClick(t)})}},{key:"open",value:function(t){this.menu&&(this.menu.open(),t.width&&this.menu.setOffset("left",t.width),this.menu.setPosition(t),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv)}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(t){for(var e,n=arguments.length,r=Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=this.commandExecutor).execute.apply(e,[t].concat(r))}},{key:"setListening",value:function(t){var e=!(0<arguments.length&&void 0!==t)||t;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(t){if((0,g.stopPropagation)(t),(0,h.hasClass)(t.target,y)&&!this.menu.isOpened()){var e=t.target.getBoundingClientRect();this.open({left:e.left,top:e.top+t.target.offsetHeight+3,width:e.width,height:e.height})}}},{key:"onAfterGetColHeader",value:function(t,e){var n=e.parentNode;if(n){var r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(!(t<0||i!==r.length-1)){var o=e.querySelector("."+y);if(!this.enabled||!o)if(this.enabled){var a=document.createElement("button");a.className=y,a.onclick=function(){return!1},e.firstChild.insertBefore(a,e.firstChild.firstChild)}else o&&o.parentNode.removeChild(o)}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"destroy",this).call(this)}}]),b);function b(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,t));return n.eventManager=new u.default(n),n.commandExecutor=new l.default(n.hot),n.itemsFactory=null,n.menu=null,n.hot.addHook("afterGetColHeader",function(t,e){return n.onAfterGetColHeader(t,e)}),n}w.SEPARATOR={name:v.SEPARATOR},(0,f.registerPlugin)("dropdownMenu",w),e.default=w},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=h(n(7)),a=n(5),s=h(n(412)),l=n(413),u=h(l);function h(t){return t&&t.__esModule?t:{default:t}}var c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(d,o.default),r(d,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:{};return this._createTypeFormatter(t,n).export()}},{key:"exportAsBlob",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:{};return this._createBlob(this._createTypeFormatter(t,n))}},{key:"downloadFile",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:{},r=this._createTypeFormatter(t,n),i=this._createBlob(r),o=window.URL||window.webkitURL,a=document.createElement("a"),s=r.options.filename+"."+r.options.fileExtension;if(void 0!==a.download){var l=o.createObjectURL(i);a.style.display="none",a.setAttribute("href",l),a.setAttribute("download",s),document.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),document.body.removeChild(a),setTimeout(function(){o.revokeObjectURL(l)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(i,s)}},{key:"_createTypeFormatter",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:{};if(!l.EXPORT_TYPES[t])throw new Error('Export format type "'+t+'" is not supported.');return(0,u.default)(t,new s.default(this.hot),n)}},{key:"_createBlob",value:function(t){var e=null;return"undefined"!=typeof Blob&&(e=new Blob([t.export()],{type:t.options.mimeType+";charset="+t.options.encoding})),e}}]),d);function d(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}(0,a.registerPlugin)("exportFile",c),e.default=c},function(t,e,n){"use strict";e.__esModule=!0;var c=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=n(4);var o=(r(a,[{key:"setOptions",value:function(t){this.options=t}},{key:"getData",value:function(){var r=this,t=this._getDataRange(),e=t.startRow,i=t.startCol,n=t.endRow,o=t.endCol,a=this.options,s=[];return(0,l.rangeEach)(e,n,function(e){var n=[];!a.exportHiddenRows&&r._isHiddenRow(e)||((0,l.rangeEach)(i,o,function(t){!a.exportHiddenColumns&&r._isHiddenColumn(t)||n.push(r.hot.getDataAtCell(e,t))}),s.push(n))}),s}},{key:"getRowHeaders",value:function(){var e=this,n=[];if(this.options.rowHeaders){var t=this._getDataRange(),r=t.startRow,i=t.endRow,o=this.hot.getRowHeader();(0,l.rangeEach)(r,i,function(t){!e.options.exportHiddenRows&&e._isHiddenRow(t)||n.push(o[t])})}return n}},{key:"getColumnHeaders",value:function(){var e=this,n=[];if(this.options.columnHeaders){var t=this._getDataRange(),r=t.startCol,i=t.endCol,o=this.hot.getColHeader();(0,l.rangeEach)(r,i,function(t){!e.options.exportHiddenColumns&&e._isHiddenColumn(t)||n.push(o[t])})}return n}},{key:"_getDataRange",value:function(){var t=this.hot.countCols()-1,e=this.hot.countRows()-1,n=c(this.options.range,4),r=n[0],i=void 0===r?0:r,o=n[1],a=void 0===o?0:o,s=n[2],l=void 0===s?e:s,u=n[3],h=void 0===u?t:u;return{startRow:i=Math.max(i,0),startCol:a=Math.max(a,0),endRow:l=Math.min(l,e),endCol:h=Math.min(h,t)}}},{key:"_isHiddenRow",value:function(t){return this.hot.hasHook("hiddenRow")&&this.hot.runHooks("hiddenRow",t)}},{key:"_isHiddenColumn",value:function(t){return this.hot.hasHook("hiddenColumn")&&this.hot.runHooks("hiddenColumn",t)}}]),a);function a(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),this.hot=t,this.options={}}e.default=o},function(t,e,n){"use strict";e.__esModule=!0,e.EXPORT_TYPES=e.TYPE_PDF=e.TYPE_EXCEL=e.TYPE_CSV=void 0,e.default=function(t,e,n){return"function"!=typeof h[t]?null:new h[t](e,n)};var r,i=n(414),o=(r=i)&&r.__esModule?r:{default:r};var a,s,l,u=e.TYPE_CSV="csv",h=(e.TYPE_EXCEL="excel",e.TYPE_PDF="pdf",e.EXPORT_TYPES=(a={},s=u,l=o.default,s in a?Object.defineProperty(a,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[s]=l,a))},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,l=n(0),a=n(10),s=n(415),u=(o=s)&&o.__esModule?o:{default:o};var h=String.fromCharCode(13),c=String.fromCharCode(34),d=String.fromCharCode(10),f=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(p,u.default),r(p,[{key:"export",value:function(){var n=this,r=this.options,t=this.dataProvider.getData(),e=this.dataProvider.getColumnHeaders(),i=0<e.length,o=this.dataProvider.getRowHeaders(),a=0<o.length,s=r.bom?String.fromCharCode(65279):"";return i&&(e=(0,l.arrayMap)(e,function(t){return n._escapeCell(t,!0)}),a&&(s+=r.columnDelimiter),s+=e.join(r.columnDelimiter),s+=r.rowDelimiter),(0,l.arrayEach)(t,function(t,e){0<e&&(s+=r.rowDelimiter),a&&(s+=n._escapeCell(o[e])+r.columnDelimiter),s+=t.map(function(t){return n._escapeCell(t)}).join(r.columnDelimiter)}),s}},{key:"_escapeCell",value:function(t,e){var n=1<arguments.length&&void 0!==e&&e,r=(0,a.stringify)(t);return""!==r&&(n||0<=r.indexOf(h)||0<=r.indexOf(c)||0<=r.indexOf(d)||0<=r.indexOf(this.options.columnDelimiter))&&(r='"'+(r=r.replace(new RegExp('"',"g"),'""'))+'"'),r}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}}]),p);function p(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}e.default=f},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(1),a=n(31);var s=(r(l,null,[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),r(l,[{key:"_mergeOptions",value:function(t){var e=(0,o.clone)(this.constructor.DEFAULT_OPTIONS),n=new Date;return e=(0,o.extend)((0,o.clone)(l.DEFAULT_OPTIONS),e),(e=(0,o.extend)(e,t)).filename=(0,a.substitute)(e.filename,{YYYY:n.getFullYear(),MM:(""+(n.getMonth()+1)).padStart(2,"0"),DD:(""+n.getDate()).padStart(2,"0")}),e}}]),l);function l(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),this.dataProvider=t,this.options=this._mergeOptions(e),this.dataProvider.setOptions(this.options)}e.default=s},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o,s=n(220),l=(o=s)&&o.__esModule?o:{default:o},u=n(51),h=n(160),c=n(5),d=n(86),f=n(2),p=n(417),g=n(418),v=n(419);n(420);var m="multiColumnSorting",y="columnSorting";(0,u.registerRootComparator)(m,p.rootComparator);var w=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(b,l.default),r(b,[{key:"isEnabled",value:function(){return a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){return!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[y]&&(0,g.warnAboutPluginsConflict)(),a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){return a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(t){return a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"sort",this).call(this,t)}},{key:"clearSort",value:function(){return a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(t){return a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"getSortConfig",this).call(this,t)}},{key:"setSortConfig",value:function(t){return a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"setSortConfig",this).call(this,t)}},{key:"getNormalizedSortConfigs",value:function(t){var e=0<arguments.length&&void 0!==t?t:[];return Array.isArray(e)?e:[e]}},{key:"updateHeaderClasses",value:function(t){for(var e,n=arguments.length,r=Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"updateHeaderClasses",this)).call.apply(e,[this,t].concat(r)),(0,f.removeClass)(t,(0,v.getClassedToRemove)(t)),!1!==this.enabled&&(0,f.addClass)(t,v.getClassesToAdd.apply(void 0,r))}},{key:"onUpdateSettings",value:function(t){return this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[y]&&(0,g.warnAboutPluginsConflict)(),a(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"onUpdateSettings",this).call(this,t)}},{key:"onAfterOnCellMouseDown",value:function(t,e){!1!==(0,h.wasHeaderClickedProperly)(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&((0,d.isPressedCtrlKey)()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,"append"))):this.sort(this.getColumnNextConfig(e.col)))}}]),b);function b(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,t));return e.pluginKey=m,e}(0,c.registerPlugin)(m,w),e.default=w},function(t,e,n){"use strict";e.__esModule=!0,e.rootComparator=function(c,d){return function(t,e){var u=r(t).slice(1),h=r(e).slice(1);return function t(e){var n=c[e],r=d[e],i=u[e],o=h[e],a=r.multiColumnSorting,s=(a.compareFunctionFactory?a.compareFunctionFactory:(0,f.getCompareFunctionFactory)(r.type))(n,r,a)(i,o);if(s===f.DO_NOT_SWAP){var l=e+1;if(void 0!==d[l])return t(l)}return s}(0)}};var f=n(51);function r(t){return Array.isArray(t)?t:Array.from(t)}},function(t,e,n){"use strict";e.__esModule=!0,e.warnAboutPluginsConflict=function(){(0,r.warn)("Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously.")};var r=n(22)},function(t,e,n){"use strict";e.__esModule=!0,e.getClassesToAdd=function(t,e,n){var r=[];if(!1===n)return r;t.isColumnSorted(e)&&1<t.getNumberOfSortedColumns()&&r.push(i+"-"+(t.getIndexOfColumnInSortQueue(e)+1));return r},e.getClassedToRemove=function(t){var e=t.className.split(" "),n=new RegExp("^"+i+"-[0-9]{1,2}$");return e.filter(function(t){return n.test(t)})};var i="sort"},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var i=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t};function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var s,l,u=(s=["The filter conditions have been applied properly, but couldnât be displayed visually.\n        The overall amount of conditions exceed the capability of the dropdown menu.\n        For more details see the documentation."],l=["The filter conditions have been applied properly, but couldnât be displayed visually.\n        The overall amount of conditions exceed the capability of the dropdown menu.\n        For more details see the documentation."],Object.freeze(Object.defineProperties(s,{raw:{value:Object.freeze(l)}}))),h=M(n(7)),f=n(0),c=n(25),d=n(22),p=n(4),g=M(n(8)),v=n(2),m=n(5),y=n(45),w=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),b=M(n(422)),C=M(n(442)),E=M(n(444)),S=M(n(447)),O=M(n(235)),T=M(n(236)),N=M(n(448)),R=n(67),_=n(164);function M(t){return t&&t.__esModule?t:{default:t}}n(449);var A=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(k,h.default),r(k,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().filters}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){this.trimRowsPlugin=this.hot.getPlugin("trimRows"),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var t=function(e){return e.addLocalHook("accept",function(){return n.onActionBarSubmit("accept")}),e.addLocalHook("cancel",function(){return n.onActionBarSubmit("cancel")}),e.addLocalHook("change",function(t){return n.onComponentChange(e,t)}),e};if(!this.components.get("filter_by_condition")){var e=new b.default(this.hot,{id:"filter_by_condition",name:function(){return n.hot.getTranslatedPhrase(w.FILTERS_DIVS_FILTER_BY_CONDITION)+":"},addSeparator:!1});e.addLocalHook("afterClose",function(){return n.onSelectUIClosed()}),this.components.set("filter_by_condition",t(e))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new C.default(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var r=new b.default(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0});r.addLocalHook("afterClose",function(){return n.onSelectUIClosed()}),this.components.set("filter_by_condition2",t(r))}this.components.get("filter_by_value")||this.components.set("filter_by_value",t(new E.default(this.hot,{id:"filter_by_value",name:function(){return n.hot.getTranslatedPhrase(w.FILTERS_DIVS_FILTER_BY_VALUE)+":"}}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",t(new S.default(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new O.default),this.conditionUpdateObserver||(this.conditionUpdateObserver=new N.default(this.conditionCollection,function(t){return n.getDataMapAtColumn(t)}),this.conditionUpdateObserver.addLocalHook("update",function(t){return n.updateComponents(t)})),this.components.forEach(function(t){t.show()}),this.registerEvents(),this.addHook("beforeDropdownMenuSetItems",function(t){return n.onBeforeDropdownMenuSetItems(t)}),this.addHook("afterDropdownMenuDefaultOptions",function(t){return n.onAfterDropdownMenuDefaultOptions(t)}),this.addHook("afterDropdownMenuShow",function(){return n.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return n.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(t){return n.onAfterChange(t)}),this.hot.getSettings().trimRows=!0,this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().dropdownMenu&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),a(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"enablePlugin",this).call(this)}}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(t){return e.onTableClick(t)})}},{key:"disablePlugin",value:function(){this.enabled&&(this.dropdownMenuPlugin.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(t){t.hide()}),this.conditionCollection.clean(),this.trimRowsPlugin.untrimAll()),a(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(t,e,n,r){var i=3<arguments.length&&void 0!==r?r:_.OPERATION_AND,o=this.t.toPhysicalColumn(t);this.conditionCollection.addCondition(o,{command:{key:e},args:n},i)}},{key:"removeConditions",value:function(t){var e=this.t.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}},{key:"clearConditions",value:function(t){if(void 0===t)this.conditionCollection.clean();else{var e=this.t.toPhysicalColumn(t);this.conditionCollection.clearConditions(e)}}},{key:"filter",value:function(){var t=this._createDataFilter(),e=!this.conditionCollection.isEmpty(),n=[],r=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",r))if(e){var i=[];n=(this.trimRowsPlugin.trimmedRows.length=0,f.arrayMap)(t.filter(),function(t){return t.meta.visualRow});var o=(0,R.createArrayAssertion)(n);(0,p.rangeEach)(this.hot.countSourceRows()-1,function(t){o(t)||i.push(t)}),this.trimRowsPlugin.trimRows(i),n.length||this.hot.deselectCell()}else this.trimRowsPlugin.untrimAll();this.hot.view.wt.wtOverlays.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection(),this.hot.runHooks("afterFilter",r)}},{key:"getSelectedColumn",value:function(){return this.lastSelectedColumn}},{key:"clearColumnSelection",value:function(){var t=this.hot.getSelectedLast()||[],e=i(t,2),n=e[0],r=e[1];void 0!==n&&void 0!==r&&this.hot.selectCell(n,r)}},{key:"getDataMapAtColumn",value:function(t){var h=this,c=this.t.toVisualColumn(t),d=[];return(0,f.arrayEach)(this.hot.getSourceDataAtCol(c),function(t,e){var n=h.hot.getCellMeta(e,c),r=n.row,i=n.col,o=n.visualCol,a=n.visualRow,s=n.type,l=n.instance,u=n.dateFormat;d.push({meta:{row:r,col:i,visualCol:o,visualRow:a,type:s,instance:l,dateFormat:u},value:(0,R.toEmptyString)(t)})}),d}},{key:"onAfterChange",value:function(t){var r=this;t&&(0,f.arrayEach)(t,function(t){var e=i(t,2)[1],n=r.hot.propToCol(e);r.conditionCollection.hasConditions(n)&&r.updateValueComponentCondition(n)})}},{key:"updateValueComponentCondition",value:function(t){var e=this.hot.getDataAtCol(t),n=(0,R.unifyColumnValues)(e);this.conditionUpdateObserver.updateStatesAtColumn(t,n)}},{key:"restoreComponents",value:function(t){var e=this.getSelectedColumn(),n=e&&e.physicalIndex;t.forEach(function(t){!1===t.isHidden()&&t.restoreState(n)})}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents([this.components.get("filter_by_condition"),this.components.get("filter_operators"),this.components.get("filter_by_condition2"),this.components.get("filter_by_value")])}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(t){var e=(0,f.arrayMap)(t,function(t){return t.key});this.components.forEach(function(t){t[-1===e.indexOf(t.getMenuItemDescriptor().key)?"hide":"show"]()}),this.initHiddenRowsCache()}},{key:"onAfterDropdownMenuDefaultOptions",value:function(e){e.items.push({name:y.SEPARATOR}),this.components.forEach(function(t){e.items.push(t.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(t,e,n,r){var i=t;return i===_.OPERATION_OR&&e.command.key!==_.CONDITION_NONE&&n.command.key!==_.CONDITION_NONE&&r.command.key!==_.CONDITION_NONE?i=_.OPERATION_OR_THEN_VARIABLE:r.command.key!==_.CONDITION_NONE&&(e.command.key!==_.CONDITION_NONE&&n.command.key!==_.CONDITION_NONE||(i=_.OPERATION_AND)),i}},{key:"onActionBarSubmit",value:function(t){if("accept"===t){var e=this.getSelectedColumn(),n=e&&e.physicalIndex,r=this.components.get("filter_by_condition").getState(),i=this.components.get("filter_by_condition2").getState(),o=this.components.get("filter_by_value").getState(),a=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,i,o);this.conditionUpdateObserver.groupChanges(),this.conditionCollection.clearConditions(n),r.command.key===_.CONDITION_NONE&&i.command.key===_.CONDITION_NONE&&o.command.key===_.CONDITION_NONE?this.conditionCollection.removeConditions(n):(r.command.key!==_.CONDITION_NONE&&(this.conditionCollection.addCondition(n,r,a),i.command.key!==_.CONDITION_NONE&&this.conditionCollection.addCondition(n,i,a)),o.command.key!==_.CONDITION_NONE&&this.conditionCollection.addCondition(n,o,a)),this.conditionUpdateObserver.flush(),this.components.get("filter_operators").saveState(n),this.components.get("filter_by_value").saveState(n),this.saveHiddenRowsCache(n),this.trimRowsPlugin.trimmedRows.length=0,this.filter()}this.dropdownMenuPlugin.close()}},{key:"onComponentChange",value:function(t,e){t===this.components.get("filter_by_condition")&&(e.showOperators?this.showComponents(this.components.get("filter_by_condition2"),this.components.get("filter_operators")):this.hideComponents(this.components.get("filter_by_condition2"),this.components.get("filter_operators"))),t.constructor!==b.default||e.inputsCount||this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin.setListening()}},{key:"onAfterGetColHeader",value:function(t,e){var n=this.t.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?(0,v.addClass)(e,"htFiltersActive"):(0,v.removeClass)(e,"htFiltersActive")}},{key:"onTableClick",value:function(t){var e=(0,v.closest)(t.target,"TH");if(e){var n=this.hot.getCoords(e).col,r=this.t.toPhysicalColumn(n);this.lastSelectedColumn={visualIndex:n,physicalIndex:r}}}},{key:"destroy",value:function(){this.enabled&&(this.components.forEach(function(t){t.destroy()}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hiddenRowsCache.clear(),this.trimRowsPlugin.disablePlugin()),a(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"destroy",this).call(this)}},{key:"_createDataFilter",value:function(t){var e=this,n=0<arguments.length&&void 0!==t?t:this.conditionCollection;return new T.default(n,function(t){return e.getDataMapAtColumn(t)})}},{key:"updateComponents",value:function(t){if(this.dropdownMenuPlugin.enabled){var e=t.editedConditionStack.conditions,n=t.editedConditionStack.column,r=e.filter(function(t){return t.name===_.CONDITION_BY_VALUE}),i=e.filter(function(t){return t.name!==_.CONDITION_BY_VALUE}),o=this.conditionCollection.columnTypes[n];2===r.length||3===i.length?(0,d.warn)((0,c.toSingleLine)(u)):(0<i.length&&this.showComponentForParticularColumn(this.components.get("filter_operators"),n),this.components.get("filter_by_condition").updateState(i[0],n),this.components.get("filter_by_condition2").updateState(i[1],n),this.components.get("filter_by_value").updateState(t),this.components.get("filter_operators").updateState(o,n))}}},{key:"showComponentForParticularColumn",value:function(t,e){if(this.hiddenRowsCache.has(e)){var n=this.getIndexesOfComponents(t);this.removeIndexesFromHiddenRowsCache(e,n)}else this.hiddenRowsCache.set(e,[])}},{key:"removeIndexesFromHiddenRowsCache",value:function(t,e){var n=this.hiddenRowsCache.get(t);(0,f.arrayEach)(e,function(t){n.includes(t)&&n.splice(n.indexOf(t),1)})}},{key:"getIndexesOfComponents",value:function(){for(var t=this.dropdownMenuPlugin.menu,r=[],e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return(0,f.arrayEach)(n,function(n){(0,f.arrayEach)(t.menuItems,function(t,e){t.key===n.getMenuItemDescriptor().key&&r.push(e)})}),r}},{key:"changeComponentsVisibility",value:function(t){for(var e=!(0<arguments.length&&void 0!==t)||t,n=this.dropdownMenuPlugin.menu.hotMenu,r=n.getPlugin("hiddenRows"),i=arguments.length,o=Array(1<i?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var s=this.getIndexesOfComponents.apply(this,o);e?r.showRows(s):r.hideRows(s),n.render()}},{key:"initHiddenRowsCache",value:function(){var e=this;this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){var t=e.lastSelectedColumn.physicalIndex;e.hiddenRowsCache.has(t)||e.hiddenRowsCache.set(t,e.getIndexesOfComponents(e.components.get("filter_operators"),e.components.get("filter_by_condition2"))),e.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:{rows:e.hiddenRowsCache.get(t)}})})}},{key:"saveHiddenRowsCache",value:function(t){this.hiddenRowsCache.set(t,this.dropdownMenuPlugin.menu.hotMenu.getPlugin("hiddenRows").hiddenRows)}},{key:"hideComponents",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!1].concat(e))}},{key:"showComponents",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!0].concat(e))}}]),k);function k(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,k);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,t));return n.eventManager=new g.default(n),n.trimRowsPlugin=null,n.dropdownMenuPlugin=null,n.conditionCollection=null,n.conditionUpdateObserver=null,n.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),n.lastSelectedColumn=null,n.hiddenRowsCache=new Map,n.hot.addHook("afterGetColHeader",function(t,e){return n.onAfterGetColHeader(t,e)}),n}(0,m.registerPlugin)("filters",A),e.default=A},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=n(2),o=n(12),u=n(0),a=n(18),s=n(1),h=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),c=m(n(88)),d=n(164),f=m(d),p=m(n(166)),g=m(n(441)),v=n(11);function m(t){return t&&t.__esModule?t:{default:t}}var y=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(w,c.default),r(w,[{key:"registerHooks",value:function(){var e=this;this.getSelectElement().addLocalHook("select",function(t){return e.onConditionSelect(t)}),this.getSelectElement().addLocalHook("afterClose",function(){return e.onSelectUIClosed()}),(0,u.arrayEach)(this.getInputElements(),function(t){t.addLocalHook("keydown",function(t){return e.onInputKeyDown(t)})})}},{key:"setState",value:function(t){var r=this;if(this.reset(),t){var i=(0,s.clone)(t.command);i.name.startsWith(h.FILTERS_CONDITIONS_NAMESPACE)&&(i.name=this.hot.getTranslatedPhrase(i.name)),this.getSelectElement().setValue(i),(0,u.arrayEach)(t.args,function(t,e){if(e>i.inputsCount-1)return!1;var n=r.getInputElement(e);n.setValue(t),n[i.inputsCount>e?"show":"hide"](),e||setTimeout(function(){return n.focus()},10)})}}},{key:"getState",value:function(){var n=this.getSelectElement().getValue()||(0,v.getConditionDescriptor)(d.CONDITION_NONE),r=[];return(0,u.arrayEach)(this.getInputElements(),function(t,e){n.inputsCount>e&&r.push(t.getValue())}),{command:n,args:r}}},{key:"updateState",value:function(t,e){var n=t?(0,v.getConditionDescriptor)(t.name):(0,v.getConditionDescriptor)(d.CONDITION_NONE);this.setCachedState(e,{command:n,args:t?t.args:[]}),t||(0,u.arrayEach)(this.getInputElements(),function(t){return t.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(t){return t instanceof g.default})[0]}},{key:"getInputElement",value:function(t){var e=0<arguments.length&&void 0!==t?t:0;return this.getInputElements()[e]}},{key:"getInputElements",value:function(){return this.elements.filter(function(t){return t instanceof p.default})}},{key:"getMenuItemDescriptor",value:function(){var s=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return s.isHidden()},renderer:function(t,e,n,r,i,o){(0,l.addClass)(e.parentNode,"htFiltersMenuCondition"),s.addSeparator&&(0,l.addClass)(e.parentNode,"border");var a=document.createElement("div");return(0,l.addClass)(a,"htFiltersMenuLabel"),a.textContent=o,e.appendChild(a),e.parentNode.hasAttribute("ghost-table")||(0,u.arrayEach)(s.elements,function(t){return e.appendChild(t.element)}),e}}}},{key:"reset",value:function(){var t,e=this.hot.getPlugin("filters").getSelectedColumn(),n=e&&e.visualIndex,r=(t=this.hot).getDataType.apply(t,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(this.hot.getSelectedLast()||[0,n])),i=(0,f.default)(r);(0,u.arrayEach)(this.getInputElements(),function(t){return t.hide()}),this.getSelectElement().setItems(i),function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0}(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"reset",this).call(this),this.getSelectElement().setValue(i[0])}},{key:"onConditionSelect",value:function(n){(0,u.arrayEach)(this.getInputElements(),function(t,e){t[n.inputsCount>e?"show":"hide"](),e||setTimeout(function(){return t.focus()},10)}),this.runLocalHooks("change",n)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(t){(0,a.isKey)(t.keyCode,"ENTER")?(this.runLocalHooks("accept"),(0,o.stopImmediatePropagation)(t)):(0,a.isKey)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,o.stopImmediatePropagation)(t))}}]),w);function w(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,w);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,t));return n.id=e.id,n.name=e.name,n.addSeparator=e.addSeparator,n.elements.push(new g.default(n.hot)),n.elements.push(new p.default(n.hot,{placeholder:h.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),n.elements.push(new p.default(n.hot,{placeholder:h.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),n.registerHooks(),n}e.default=y},function(t,e,n){"use strict";var r;e.__esModule=!0;var i=n(1);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){return t[l]["state_"+e]}function s(t,e,n){t[l]["state_"+e]=n}var l="_states",u=(o(r={},l,{}),o(r,"getCachedState",function(t){return a(this,t)}),o(r,"setCachedState",function(t,e){s(this,t,e)}),o(r,"saveState",function(t){s(this,t,this.getState())}),o(r,"restoreState",function(t){this.setState(a(this,t))}),o(r,"hasSavedState",function(t){return void 0!==a(this,t)}),o(r,"clearState",function(t){s(this,t)}),o(r,"clearStates",function(){this[l]={}}),r);(0,i.defineGetter)(u,"MIXIN_NAME","stateSaver",{writable:!1,enumerable:!1}),e.default=u},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0,e.condition=a;var r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),i=n(11);var o=e.CONDITION_NAME="none";function a(){return!0}(0,i.registerCondition)(o,a,{name:r.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0,e.condition=s;var r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),i=n(11),o=n(227);var a=e.CONDITION_NAME="not_empty";function s(t,e){return!(0,i.getCondition)(o.CONDITION_NAME,e)(t)}(0,i.registerCondition)(a,s,{name:r.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0,e.condition=s;var r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),i=n(11),o=n(228);var a=e.CONDITION_NAME="neq";function s(t,e){return!(0,i.getCondition)(o.CONDITION_NAME,e)(t)}(0,i.registerCondition)(a,s,{name:r.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0;var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.condition=s;var i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),o=n(11);var a=e.CONDITION_NAME="gt";function s(t,e){var n=r(e,1)[0];return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>n}(0,o.registerCondition)(a,s,{name:i.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0;var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.condition=s;var i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),o=n(11);var a=e.CONDITION_NAME="gte";function s(t,e){var n=r(e,1)[0];return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>=n}(0,o.registerCondition)(a,s,{name:i.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0;var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.condition=s;var i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),o=n(11);var a=e.CONDITION_NAME="lt";function s(t,e){var n=r(e,1)[0];return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<n}(0,o.registerCondition)(a,s,{name:i.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0;var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.condition=s;var i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),o=n(11);var a=e.CONDITION_NAME="lte";function s(t,e){var n=r(e,1)[0];return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<=n}(0,o.registerCondition)(a,s,{name:i.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0,e.condition=s;var r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),i=n(11),o=n(229);var a=e.CONDITION_NAME="not_between";function s(t,e){return!(0,i.getCondition)(o.CONDITION_NAME,e)(t)}(0,i.registerCondition)(a,s,{name:r.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0;var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.condition=l;var i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),o=n(10),a=n(11);var s=e.CONDITION_NAME="begins_with";function l(t,e){var n=r(e,1)[0];return(0,o.stringify)(t.value).toLowerCase().startsWith((0,o.stringify)(n))}(0,a.registerCondition)(s,l,{name:i.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0;var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.condition=l;var i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),o=n(10),a=n(11);var s=e.CONDITION_NAME="ends_with";function l(t,e){var n=r(e,1)[0];return(0,o.stringify)(t.value).toLowerCase().endsWith((0,o.stringify)(n))}(0,a.registerCondition)(s,l,{name:i.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0,e.condition=s;var r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),i=n(11),o=n(232);var a=e.CONDITION_NAME="not_contains";function s(t,e){return!(0,i.getCondition)(o.CONDITION_NAME,e)(t)}(0,i.registerCondition)(a,s,{name:r.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0,e.condition=u;var r,i=n(32),o=(r=i)&&r.__esModule?r:{default:r},a=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),s=n(11);var l=e.CONDITION_NAME="date_tomorrow";function u(t){var e=(0,o.default)(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame((0,o.default)().subtract(-1,"days").startOf("day"),"d")}(0,s.registerCondition)(l,u,{name:a.FILTERS_CONDITIONS_TOMORROW,inputsCount:0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0,e.condition=u;var r,i=n(32),o=(r=i)&&r.__esModule?r:{default:r},a=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),s=n(11);var l=e.CONDITION_NAME="date_today";function u(t){var e=(0,o.default)(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame((0,o.default)().startOf("day"),"d")}(0,s.registerCondition)(l,u,{name:a.FILTERS_CONDITIONS_TODAY,inputsCount:0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0,e.condition=u;var r,i=n(32),o=(r=i)&&r.__esModule?r:{default:r},a=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),s=n(11);var l=e.CONDITION_NAME="date_yesterday";function u(t){var e=(0,o.default)(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame((0,o.default)().subtract(1,"days").startOf("day"),"d")}(0,s.registerCondition)(l,u,{name:a.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0;var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.condition=s;var i=n(11),o=n(67),a=e.CONDITION_NAME="by_value";function s(t,e){return(0,r(e,1)[0])(t.value)}(0,i.registerCondition)(a,s,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var e=r(t,1)[0];return[(0,o.createArrayAssertion)(e)]},showOperators:!1})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0,e.condition=o;var r=n(11),i=e.CONDITION_NAME="true";function o(){return!0}(0,r.registerCondition)(i,o,{name:"True"})},function(t,e,n){"use strict";e.__esModule=!0,e.CONDITION_NAME=void 0,e.condition=o;var r=n(11),i=e.CONDITION_NAME="false";function o(){return!1}(0,r.registerCondition)(i,o,{name:"False"})},function(t,e,n){"use strict";e.__esModule=!0;function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=d(n(162)),s=n(1),l=n(0),u=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),h=n(45),c=d(n(69));function d(t){return t&&t.__esModule?t:{default:t}}var f=new WeakMap,p=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(g,c.default),r(g,null,[{key:"DEFAULTS",get:function(){return(0,s.clone)({className:"htUISelect",wrapIt:!1})}}]),r(g,[{key:"registerHooks",value:function(){var t=this;this.addLocalHook("click",function(){return t.onClick()})}},{key:"setItems",value:function(t){this.items=this.translateNames(t),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(t){var e=this;return(0,l.arrayEach)(t,function(t){t.name=e.translateIfPossible(t.name)}),t}},{key:"build",value:function(){var e=this;a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"build",this).call(this),this.menu=new o.default(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0}),this.menu.setMenuItems(this.items);var t=new c.default(this.hot,{className:"htUISelectCaption"}),n=new c.default(this.hot,{className:"htUISelectDropdown"}),r=f.get(this);r.caption=t,r.captionElement=t.element,r.dropdown=n,(0,l.arrayEach)([t,n],function(t){return e._element.appendChild(t.element)}),this.menu.addLocalHook("select",function(t){return e.onMenuSelect(t)}),this.menu.addLocalHook("afterClose",function(){return e.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var t=void 0;t=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(u.FILTERS_CONDITIONS_NONE),f.get(this).captionElement.textContent=t,a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var t=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:t.left-5,top:t.top,width:t.width,height:t.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(t){t.name!==h.SEPARATOR&&(this.options.value=t,this.closeOptions(),this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var t=f.get(this),e=t.caption,n=t.dropdown;e&&e.destroy(),n&&n.destroy(),a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"destroy",this).call(this)}}]),g);function g(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,t,(0,s.extend)(g.DEFAULTS,e)));return f.set(n,{}),n.menu=null,n.items=[],n.registerHooks(),n}e.default=p},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a,s=(o=["Radio button with index "," doesn't exist."],a=["Radio button with index "," doesn't exist."],Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(a)}}))),l=n(2),u=n(0),h=n(25),c=m(n(88)),d=n(68),f=n(165),p=n(233),g=n(234),v=m(n(443));function m(t){return t&&t.__esModule?t:{default:t}}var y=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(w,c.default),r(w,[{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(t,e){return(0,l.addClass)(e.parentNode,"htFiltersMenuOperators"),e.parentNode.hasAttribute("ghost-table")||(0,u.arrayEach)(n.elements,function(t){return e.appendChild(t.element)}),e}}}},{key:"buildOperatorsElement",value:function(){var n=this,r=[f.OPERATION_ID,p.OPERATION_ID];(0,u.arrayEach)(r,function(t){var e=new v.default(n.hot,{name:"operator",label:{htmlFor:t,textContent:(0,d.getOperationName)(t)},value:t,checked:t===r[0],id:t});e.addLocalHook("change",function(t){return n.onRadioInputChange(t)}),n.elements.push(e)})}},{key:"setChecked",value:function(n){if(this.elements.length<n)throw Error((0,h.toSingleLine)(s,n));(0,u.arrayEach)(this.elements,function(t,e){t.setChecked(e===n)})}},{key:"getActiveOperationId",value:function(){var t=this.elements.find(function(t){return t instanceof v.default&&t.isChecked()});return t?t.getValue():f.OPERATION_ID}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(e){this.reset(),e&&this.getActiveOperationId()!==e&&(0,u.arrayEach)(this.elements,function(t){t.setChecked(t.getValue()===e)})}},{key:"updateState",value:function(t,e){var n=e,r=0<arguments.length&&void 0!==t?t:f.OPERATION_ID;r===g.OPERATION_ID&&(r=p.OPERATION_ID),this.setCachedState(n,r)}},{key:"reset",value:function(){this.setChecked(0)}},{key:"onRadioInputChange",value:function(t){this.setState(t.realTarget.value)}}]),w);function w(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,w);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,t));return n.id=e.id,n.name=e.name,n.buildOperatorsElement(),n}e.default=y},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(1),s=n(69),l=(o=s)&&o.__esModule?o:{default:o};var u=new WeakMap,h=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(c,l.default),r(c,null,[{key:"DEFAULTS",get:function(){return(0,a.clone)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r(c,[{key:"build",value:function(){(function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"build",this).call(this);var t=u.get(this);t.input=this._element.firstChild;var e=document.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),t.label=e,this._element.appendChild(e),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var t=u.get(this);t.input.checked=this.options.checked,t.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(t){var e=!(0<arguments.length&&void 0!==t)||t;this.options.checked=e,this.update()}},{key:"focus",value:function(){this.isBuilt()&&u.get(this).input.focus()}}]),c);function c(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,t,(0,a.extend)(c.DEFAULTS,e)));return u.set(n,{}),n}e.default=h},function(t,e,n){"use strict";e.__esModule=!0;var f=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=n(2),o=n(12),p=n(0),a=n(18),g=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),v=n(67),s=h(n(88)),u=h(n(445)),m=n(164),y=n(11);function h(t){return t&&t.__esModule?t:{default:t}}var c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(d,s.default),r(d,[{key:"registerHooks",value:function(){var e=this;this.getMultipleSelectElement().addLocalHook("keydown",function(t){return e.onInputKeyDown(t)})}},{key:"setState",value:function(t){if(this.reset(),t&&t.command.key===m.CONDITION_BY_VALUE){var e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0])}}},{key:"getState",value:function(){var t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?m.CONDITION_NONE:m.CONDITION_BY_VALUE},args:[t.getValue()],itemsSnapshot:e}}},{key:"updateState",value:function(t){function e(t,e,n,r,i){var o=(0,p.arrayFilter)(e,function(t){return t.name===m.CONDITION_BY_VALUE}),a=f(o,1)[0],s={},l=d.hot.getTranslatedPhrase(g.FILTERS_VALUES_BLANK_CELLS);if(a){var u=(0,p.arrayMap)(r(t,i),function(t){return t.value});u=(0,v.unifyColumnValues)(u),n&&(a.args[0]=n);var h=[],c=(0,v.intersectValues)(u,a.args[0],l,function(t){t.checked&&h.push(t.value)});s.args=[h],s.command=(0,y.getConditionDescriptor)(m.CONDITION_BY_VALUE),s.itemsSnapshot=c}else s.args=[],s.command=(0,y.getConditionDescriptor)(m.CONDITION_NONE);d.setCachedState(t,s)}var d=this;e(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&e(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(t){return t instanceof u.default})[0]}},{key:"getMenuItemDescriptor",value:function(){var s=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return s.isHidden()},renderer:function(t,e,n,r,i,o){(0,l.addClass)(e.parentNode,"htFiltersMenuValue");var a=document.createElement("div");return(0,l.addClass)(a,"htFiltersMenuLabel"),a.textContent=o,e.appendChild(a),e.parentNode.hasAttribute("ghost-table")||(0,p.arrayEach)(s.elements,function(t){return e.appendChild(t.element)}),e}}}},{key:"reset",value:function(){var t=this.hot.getTranslatedPhrase(g.FILTERS_VALUES_BLANK_CELLS),e=(0,v.unifyColumnValues)(this._getColumnVisibleValues()),n=(0,v.intersectValues)(e,e,t);this.getMultipleSelectElement().setItems(n),function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0}(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(e)}},{key:"onInputKeyDown",value:function(t){(0,a.isKey)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,o.stopImmediatePropagation)(t))}},{key:"_getColumnVisibleValues",value:function(){var t=this.hot.getPlugin("filters").getSelectedColumn(),e=t&&t.visualIndex;return(0,p.arrayMap)(this.hot.getDataAtCol(e),function(t){return(0,v.toEmptyString)(t)})}}]),d);function d(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,t));return n.id=e.id,n.name=e.name,n.elements.push(new u.default(n.hot)),n.registerHooks(),n}e.default=c},function(t,e,n){"use strict";e.__esModule=!0;function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(2),s=n(1),l=n(0),u=n(18),h=n(34),c=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),d=n(12),f=m(n(69)),p=m(n(166)),g=m(n(446)),v=n(67);function m(t){return t&&t.__esModule?t:{default:t}}function y(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var w=new WeakMap,b=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(C,f.default),r(C,null,[{key:"DEFAULTS",get:function(){return(0,s.clone)({className:"htUIMultipleSelect",value:[]})}}]),r(C,[{key:"registerHooks",value:function(){var e=this;this.searchInput.addLocalHook("keydown",function(t){return e.onInputKeyDown(t)}),this.searchInput.addLocalHook("input",function(t){return e.onInput(t)}),this.selectAllUI.addLocalHook("click",function(t){return e.onSelectAllClick(t)}),this.clearAllUI.addLocalHook("click",function(t){return e.onClearAllClick(t)})}},{key:"setItems",value:function(t){this.items=t,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"getItems",value:function(){return[].concat(y(this.items))}},{key:"getValue",value:function(){return function(t){var e=[];return(0,l.arrayEach)(t,function(t){t.checked&&e.push(t.value)}),e}(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var e=this;a(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"build",this).call(this);var t=document.createElement("div"),n=new f.default(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});function r(t){e._element&&(e.itemsBox&&e.itemsBox.destroy(),(0,o.addClass)(t,"htUIMultipleSelectHot"),e.itemsBox=new e.hot.constructor(t,{data:e.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(t,e,n,r,i,o){t.title=o.instance.getDataAtRowProp(e,o.label.property)},autoWrapCol:!0,height:110,colWidths:function(){return e.itemsBox.container.scrollWidth-(0,o.getScrollbarWidth)()},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function(t){return e.onItemsBoxBeforeKeyDown(t)}}),e.itemsBox.init())}this._element.appendChild(this.searchInput.element),this._element.appendChild(n.element),this._element.appendChild(t),r(t),setTimeout(function(){return r(t)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(function(t,e){var n=(0,v.createArrayAssertion)(e);return(0,l.arrayMap)(t,function(t){return t.checked=n(t.value),t})}(this.items,this.options.value)),a(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,a(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(t){var e=t.target.value.toLowerCase(),n=void 0;n=""===e?[].concat(y(this.items)):(0,l.arrayFilter)(this.items,function(t){return 0<=(""+t.value).toLowerCase().indexOf(e)}),this.itemsBox.loadData(n)}},{key:"onInputKeyDown",value:function(t){this.runLocalHooks("keydown",t,this),(0,h.partial)(u.isKey,t.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&((0,d.stopImmediatePropagation)(t),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onItemsBoxBeforeKeyDown",value:function(t){var e=(0,h.partial)(u.isKey,t.keyCode);e("ESCAPE")&&this.runLocalHooks("keydown",t,this),e("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")||((0,d.stopImmediatePropagation)(t),this.itemsBox.unlisten(),this.itemsBox.deselectCell(),this.searchInput.focus())}},{key:"onSelectAllClick",value:function(t){t.preventDefault(),(0,l.arrayEach)(this.itemsBox.getSourceData(),function(t){t.checked=!0}),this.itemsBox.render()}},{key:"onClearAllClick",value:function(t){t.preventDefault(),(0,l.arrayEach)(this.itemsBox.getSourceData(),function(t){t.checked=!1}),this.itemsBox.render()}}]),C);function C(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,C);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,t,(0,s.extend)(C.DEFAULTS,e)));return w.set(n,{}),n.searchInput=new p.default(n.hot,{placeholder:c.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"}),n.selectAllUI=new g.default(n.hot,{textContent:c.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"}),n.clearAllUI=new g.default(n.hot,{textContent:c.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"}),n.items=[],n.itemsBox=null,n.registerHooks(),n}e.default=b},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(1),s=n(69),l=(o=s)&&o.__esModule?o:{default:o};var u=new WeakMap,h=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(c,l.default),r(c,null,[{key:"DEFAULTS",get:function(){return(0,a.clone)({href:"#",tagName:"a"})}}]),r(c,[{key:"build",value:function(){(function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"build",this).call(this),u.get(this).link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(u.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}]),c);function c(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,t,(0,a.extend)(c.DEFAULTS,e)));return u.set(n,{}),n}e.default=h},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(2),a=n(0),s=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),l=h(n(88)),u=h(n(166));function h(t){return t&&t.__esModule?t:{default:t}}var c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(d,l.default),r(d,null,[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r(d,[{key:"registerHooks",value:function(){var n=this;(0,a.arrayEach)(this.elements,function(t){t.addLocalHook("click",function(t,e){return n.onButtonClick(t,e)})})}},{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(t,e){return(0,o.addClass)(e.parentNode,"htFiltersMenuActionBar"),e.parentNode.hasAttribute("ghost-table")||(0,a.arrayEach)(n.elements,function(t){return e.appendChild(t.element)}),e}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(t,e){e.options.identifier===d.BUTTON_OK?this.accept():this.cancel()}}]),d);function d(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,t));return n.id=e.id,n.name=e.name,n.elements.push(new u.default(n.hot,{type:"button",value:s.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:d.BUTTON_OK})),n.elements.push(new u.default(n.hot,{type:"button",value:s.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:d.BUTTON_CANCEL})),n.registerHooks(),n}e.default=c},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=n(0),o=n(1),h=n(34),a=s(n(20)),c=s(n(235)),d=s(n(236)),f=n(67);function s(t){return t&&t.__esModule?t:{default:t}}var l=(r(p,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var e=this;this.grouping=!1,(0,u.arrayEach)(this.changes,function(t){e.updateStatesAtColumn(t)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(t){this.latestEditedColumnPosition=this.conditionCollection.orderStack.indexOf(t)}},{key:"updateStatesAtColumn",value:function(t,e){var l=this;if(this.grouping)-1===this.changes.indexOf(t)&&this.changes.push(t);else{var n=this.conditionCollection.exportAllConditions(),r=this.conditionCollection.orderStack.indexOf(t);-1===r&&(r=this.latestEditedColumnPosition);var i=n.slice(0,r),o=n.slice(r);o.length&&o[0].column===t&&o.shift();var a=(0,h.curry)(function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],r=new c.default,i=[].concat(t,n);r.importAllConditions(i);var o=l.columnDataFactory(e),a=void 0;a=r.isEmpty()?o:new d.default(r,function(t){return l.columnDataFactory(t)}).filter(),a=(0,u.arrayMap)(a,function(t){return t.meta.visualRow});var s=(0,f.createArrayAssertion)(a);return(0,u.arrayFilter)(o,function(t){return s(t.meta.visualRow)})})(i),s=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:s},dependentConditionStacks:o,filteredRowsFactory:a,conditionArgsChange:e})}}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=[].concat(this.conditionCollection.orderStack)}},{key:"_onConditionAfterClean",value:function(){var e=this;(0,u.arrayEach)(this.latestOrderStack,function(t){e.updateStatesAtColumn(t)})}},{key:"destroy",value:function(){var n=this;this.clearLocalHooks(),(0,o.objectEach)(this,function(t,e){n[e]=null})}}]),p);function p(t){var e=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){return[]};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),this.conditionCollection=t,this.columnDataFactory=n,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(t){return e._onConditionBeforeModify(t)}),this.conditionCollection.addLocalHook("afterAdd",function(t){return e.updateStatesAtColumn(t)}),this.conditionCollection.addLocalHook("afterClear",function(t){return e.updateStatesAtColumn(t)}),this.conditionCollection.addLocalHook("beforeClean",function(){return e._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return e._onConditionAfterClean()})}(0,o.mixin)(l,a.default),e.default=l},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var h=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=v(n(7)),s=n(0),l=n(1),u=v(n(8)),c=n(5),d=n(46),f=v(n(451)),p=v(n(460)),g=v(n(461));function v(t){return t&&t.__esModule?t:{default:t}}var m=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(y,o.default),r(y,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().formulas}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var t=this.hot.getSettings().formulas;(0,l.isObject)(t)&&(0,l.isObject)(t.variables)&&(0,l.objectEach)(t.variables,function(t,e){return n.setVariable(e,t)}),this.addHook("afterColumnSort",function(){return n.onAfterColumnSort.apply(n,arguments)}),this.addHook("afterCreateCol",function(){return n.onAfterCreateCol.apply(n,arguments)}),this.addHook("afterCreateRow",function(){return n.onAfterCreateRow.apply(n,arguments)}),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("afterRemoveCol",function(){return n.onAfterRemoveCol.apply(n,arguments)}),this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow.apply(n,arguments)}),this.addHook("afterSetDataAtCell",function(){return n.onAfterSetDataAtCell.apply(n,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return n.onAfterSetDataAtCell.apply(n,arguments)}),this.addHook("beforeColumnSort",function(){return n.onBeforeColumnSort.apply(n,arguments)}),this.addHook("beforeCreateCol",function(){return n.onBeforeCreateCol.apply(n,arguments)}),this.addHook("beforeCreateRow",function(){return n.onBeforeCreateRow.apply(n,arguments)}),this.addHook("beforeRemoveCol",function(){return n.onBeforeRemoveCol.apply(n,arguments)}),this.addHook("beforeRemoveRow",function(){return n.onBeforeRemoveRow.apply(n,arguments)}),this.addHook("beforeValidate",function(){return n.onBeforeValidate.apply(n,arguments)}),this.addHook("beforeValueRender",function(){return n.onBeforeValueRender.apply(n,arguments)}),this.addHook("modifyData",function(){return n.onModifyData.apply(n,arguments)}),this.sheet.addLocalHook("afterRecalculate",function(){return n.onSheetAfterRecalculate.apply(n,arguments)}),a(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){a(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"disablePlugin",this).call(this)}},{key:"getCellValue",value:function(t,e){var n=this.sheet.getCellAt(t,e);return n?n.getError()||n.getValue():void 0}},{key:"hasComputedCellValue",value:function(t,e){return null!==this.sheet.getCellAt(t,e)}},{key:"recalculate",value:function(){this.sheet.recalculate()}},{key:"recalculateFull",value:function(){this.sheet.recalculateFull()}},{key:"recalculateOptimized",value:function(){this.sheet.recalculateOptimized()}},{key:"setVariable",value:function(t,e){this.sheet.setVariable(t,e)}},{key:"getVariable",value:function(t){return this.sheet.getVariable(t)}},{key:"onSheetAfterRecalculate",value:function(t){if(this._skipRendering)this._skipRendering=!1;else{var r=this.hot;(0,s.arrayEach)(t,function(t){var e=t.row,n=t.column;r.validateCell(r.getDataAtCell(e,n),r.getCellMeta(e,n),function(){})}),r.render()}}},{key:"onModifyData",value:function(t,e,n,r){"get"===r&&this.hasComputedCellValue(t,e)?n.value=this.getCellValue(t,e):"set"===r&&(0,d.isFormulaExpression)(n.value)&&(n.value=(0,d.toUpperCaseFormula)(n.value))}},{key:"onBeforeValueRender",value:function(t){var e=t;return(0,d.isFormulaExpressionEscaped)(e)&&(e=(0,d.unescapeFormulaExpression)(e)),e}},{key:"onBeforeValidate",value:function(t,e,n){var r=this.hot.propToCol(n),i=t;return this.hasComputedCellValue(e,r)&&(i=this.getCellValue(e,r)),i}},{key:"onAfterSetDataAtCell",value:function(t,e){var u=this;"loadData"!==e&&(this.dataProvider.clearChanges(),(0,s.arrayEach)(t,function(t){var e=h(t,4),n=e[0],r=e[1],i=e[2],o=e[3],a=u.hot.propToCol(r),s=u.t.toPhysicalRow(n),l=o;(0,d.isFormulaExpression)(l)&&(l=(0,d.toUpperCaseFormula)(l)),u.dataProvider.collectChanges(s,a,l),i!==l&&u.sheet.applyChanges(s,a,l)}),this.recalculate())}},{key:"onBeforeCreateRow",value:function(t,e,n){"UndoRedo.undo"===n&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateRow",value:function(t,e,n){this.sheet.alterManager.triggerAlter("insert_row",t,e,"UndoRedo.undo"!==n)}},{key:"onBeforeRemoveRow",value:function(t,e){this.undoRedoSnapshot.save("row",t,e)}},{key:"onAfterRemoveRow",value:function(t,e){this.sheet.alterManager.triggerAlter("remove_row",t,e)}},{key:"onBeforeCreateCol",value:function(t,e,n){"UndoRedo.undo"===n&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateCol",value:function(t,e,n){this.sheet.alterManager.triggerAlter("insert_column",t,e,"UndoRedo.undo"!==n)}},{key:"onBeforeRemoveCol",value:function(t,e){this.undoRedoSnapshot.save("column",t,e)}},{key:"onAfterRemoveCol",value:function(t,e){this.sheet.alterManager.triggerAlter("remove_column",t,e)}},{key:"onBeforeColumnSort",value:function(t,e){this.sheet.alterManager.prepareAlter("column_sorting",t,e)}},{key:"onAfterColumnSort",value:function(t,e){this.sheet.alterManager.triggerAlter("column_sorting",t,e)}},{key:"onAfterLoadData",value:function(){this._skipRendering=!0,this.recalculateFull()}},{key:"destroy",value:function(){this.dataProvider.destroy(),this.dataProvider=null,this.sheet.destroy(),this.sheet=null,a(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"destroy",this).call(this)}}]),y);function y(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,t));return e.eventManager=new u.default(e),e.dataProvider=new p.default(e.hot),e.sheet=new f.default(e.hot,e.dataProvider),e.undoRedoSnapshot=new g.default(e.sheet),e._skipRendering=!1,e}(0,c.registerPlugin)("formulas",m),e.default=m},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var p=n(70),a=n(0),o=d(n(20)),s=n(55),l=n(1),u=d(n(47)),g=d(n(452)),v=n(46),h=d(n(453)),c=d(n(454));function d(t){return t&&t.__esModule?t:{default:t}}var f=(r(m,[{key:"recalculate",value:function(){switch(this._state){case 3:this.recalculateFull();break;case 2:this.recalculateOptimized()}}},{key:"recalculateOptimized",value:function(){var n=this,t=this.matrix.getOutOfDateCells();(0,a.arrayEach)(t,function(t){var e=n.dataProvider.getSourceDataAtCell(t.row,t.column);(0,v.isFormulaExpression)(e)&&n.parseExpression(t,e.substr(1))}),this._state=1,this.runLocalHooks("afterRecalculate",t,"optimized")}},{key:"recalculateFull",value:function(){var r=this,t=this.dataProvider.getSourceDataByRange();this.matrix.reset(),(0,a.arrayEach)(t,function(t,n){(0,a.arrayEach)(t,function(t,e){(0,v.isFormulaExpression)(t)&&r.parseExpression(new u.default(n,e),t.substr(1))})}),this._state=1,this.runLocalHooks("afterRecalculate",t,"full")}},{key:"setVariable",value:function(t,e){this.parser.setVariable(t,e)}},{key:"getVariable",value:function(t){return this.parser.getVariable(t)}},{key:"applyChanges",value:function(t,e,n){this.matrix.remove({row:t,column:e}),(0,v.isFormulaExpression)(n)&&this.parseExpression(new u.default(t,e),n.substr(1));var r=this.getCellDependencies.apply(this,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(this.t.toVisual(t,e)));(0,a.arrayEach)(r,function(t){t.setState(u.default.STATE_OUT_OFF_DATE)}),this._state=2}},{key:"parseExpression",value:function(t,e){t.setState(u.default.STATE_COMPUTING),this._processingCell=t;var n=this.parser.parse((0,v.toUpperCaseFormula)(e)),r=n.error,i=n.result;(0,v.isFormulaExpression)(i)?this.parseExpression(t,i.substr(1)):(t.setValue(i),t.setError(r),t.setState(u.default.STATE_UP_TO_DATE)),this.matrix.add(t),this._processingCell=null}},{key:"getCellAt",value:function(t,e){return this.matrix.getCellAt(t,e)}},{key:"getCellDependencies",value:function(t,e){return this.matrix.getDependencies({row:t,column:e})}},{key:"_onCallCellValue",value:function(t,e){var n=t.row,r=t.column,i=new g.default(n,r);if(!this.dataProvider.isInDataRange(i.row,i.column))throw Error(p.ERROR_REF);this.matrix.registerCellRef(i),this._processingCell.addPrecedent(i);var o=this.dataProvider.getRawDataAtCell(n.index,r.index);if((0,p.error)(o)){var a=this.matrix.getCellAt(n.index,r.index);if(a&&a.hasError())throw Error(o)}if((0,v.isFormulaExpression)(o)){var s=this.parser.parse(o.substr(1)),l=s.error,u=s.result;if(l)throw Error(l);e(u)}else e(o)}},{key:"_onCallRangeValue",value:function(t,e,n){var c=t.row,d=t.column,f=this,r=e.row,i=e.column,o=this.dataProvider.getRawDataByRange(c.index,d.index,r.index,i.index);n((0,a.arrayMap)(o,function(t,e){return function(t,h){return(0,a.arrayMap)(t,function(t,e){var n=c.index+h,r=d.index+e,i=new g.default(n,r);if(!f.dataProvider.isInDataRange(i.row,i.column))throw Error(p.ERROR_REF);f.matrix.registerCellRef(i),f._processingCell.addPrecedent(i);var o=t;if((0,p.error)(o)){var a=f.matrix.getCellAt(i.row,i.column);if(a&&a.hasError())throw Error(o)}if((0,v.isFormulaExpression)(o)){var s=f.parser.parse(o.substr(1)),l=s.error,u=s.result;if(l)throw Error(l);o=u}return o})}(t,e)}))}},{key:"_onAfterAlter",value:function(){this.recalculateOptimized()}},{key:"destroy",value:function(){this.hot=null,this.t=null,this.dataProvider.destroy(),this.dataProvider=null,this.alterManager.destroy(),this.alterManager=null,this.parser=null,this.matrix.reset(),this.matrix=null}}]),m);function m(t,e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,m),this.hot=t,this.t=(0,s.getTranslator)(this.hot),this.dataProvider=e,this.parser=new p.Parser,this.matrix=new h.default(this.t),this.alterManager=new c.default(this),this._processingCell=null,this._state=3,this.parser.on("callCellValue",function(){return n._onCallCellValue.apply(n,arguments)}),this.parser.on("callRangeValue",function(){return n._onCallRangeValue.apply(n,arguments)}),this.alterManager.addLocalHook("afterAlter",function(){return n._onAfterAlter.apply(n,arguments)})}(0,l.mixin)(f,o.default),e.default=f},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(70),s=n(237);var l=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(u,((o=s)&&o.__esModule?o:{default:o}).default),r(u,[{key:"toString",value:function(){return(0,a.toLabel)({index:this.row,isAbsolute:!1},{index:this.column,isAbsolute:!1})}}]),u);function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments))}e.default=l},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,s=n(0),a=n(47),l=(o=a)&&o.__esModule?o:{default:o};var u=(r(h,[{key:"getCellAt",value:function(e,n){var r=null;return(0,s.arrayEach)(this.data,function(t){if(t.row===e&&t.column===n)return r=t,!1}),r}},{key:"getOutOfDateCells",value:function(){return(0,s.arrayFilter)(this.data,function(t){return t.isState(l.default.STATE_OUT_OFF_DATE)})}},{key:"add",value:function(e){(0,s.arrayFilter)(this.data,function(t){return t.isEqual(e)}).length||this.data.push(e)}},{key:"remove",value:function(e){var r=Array.isArray(e);this.data=(0,s.arrayFilter)(this.data,function(t){return!function(e,t){var n=!1;return r?(0,s.arrayEach)(t,function(t){if(e.isEqual(t))return!(n=!0)}):n=e.isEqual(t),n}(t,e)})}},{key:"getDependencies",value:function(t){var i=this;return function e(t){var n,r=(n=t,(0,s.arrayReduce)(i.data,function(t,e){return e.hasPrecedent(n)&&-1===t.indexOf(e)&&t.push(e),t},[]));return r.length&&(0,s.arrayEach)(r,function(t){t.hasPrecedents()&&(r=r.concat(e(i.t.toVisual(t))))}),r}(t)}},{key:"registerCellRef",value:function(e){(0,s.arrayFilter)(this.cellReferences,function(t){return t.isEqual(e)}).length||this.cellReferences.push(e)}},{key:"removeCellRefsAtRange",value:function(t,e){var n=t.row,r=t.column,i=e.row,o=e.column,a=[];return this.cellReferences=(0,s.arrayFilter)(this.cellReferences,function(t){return!function(t){return void 0===n||t.row>=n&&t.row<=i}(t)||!function(t){return void 0===r||t.column>=r&&t.column<=o}(t)||(a.push(t),!1)}),a}},{key:"reset",value:function(){this.data.length=0,this.cellReferences.length=0}}]),h);function h(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),this.t=t,this.data=[],this.cellReferences=[]}e.default=u},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.registerOperation=w;var o,a=n(1),s=n(20),l=(o=s)&&o.__esModule?o:{default:o},u=p(n(455)),h=p(n(456)),c=p(n(457)),d=p(n(458)),f=p(n(459));function p(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}var g=new Map;w(u.OPERATION_NAME,u),w(h.OPERATION_NAME,h),w(c.OPERATION_NAME,c),w(d.OPERATION_NAME,d),w(f.OPERATION_NAME,f);var v=(r(m,[{key:"prepareAlter",value:function(t){if(!g.has(t))throw Error('Alter operation "'+t+'" not exist.');for(var e=arguments.length,n=Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];g.get(t).prepare.apply(this,n)}},{key:"triggerAlter",value:function(t){if(!g.has(t))throw Error('Alter operation "'+t+'" not exist.');for(var e=arguments.length,n=Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];g.get(t).operate.apply(this,n),this.runLocalHooks.apply(this,["afterAlter"].concat(n))}},{key:"destroy",value:function(){this.sheet=null,this.hot=null,this.dataProvider=null,this.matrix=null}}]),m);function m(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,m),this.sheet=t,this.hot=t.hot,this.dataProvider=t.dataProvider,this.matrix=t.matrix}(0,a.mixin)(v,l.default),e.default=v;var y=function(){};function w(t,e){g.has(t)||g.set(t,{prepare:e.prepare||y,operate:e.operate||y})}},function(t,e,n){"use strict";e.__esModule=!0,e.OPERATION_NAME=void 0,e.prepare=function(){var t=this.matrix,e=this.dataProvider;h=new WeakMap,(0,r.arrayEach)(t.data,function(t){h.set(t,e.t.toVisualRow(t.row))})},e.operate=function(){var t=this.matrix,a=this.dataProvider;(t.cellReferences.length=0,r.arrayEach)(t.data,function(t){t.setState(l.default.STATE_OUT_OFF_DATE),t.clearPrecedents();var e=t.row,n=t.column,r=a.getSourceDataAtCell(e,n);if((0,s.isFormulaExpression)(r)){var i=h.get(t),o=new u.default(r);o.translate({row:a.t.toVisualRow(e)-i}),a.updateSourceData(e,n,o.toString())}}),h=null};var r=n(0),s=n(46),l=i(n(47)),u=i(n(71));function i(t){return t&&t.__esModule?t:{default:t}}e.OPERATION_NAME="column_sorting";var h=void 0},function(t,e,n){"use strict";e.__esModule=!0,e.OPERATION_NAME=void 0,e.operate=function(l,u){var h=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],t=this.matrix,c=this.dataProvider,d=[0,u];(0,r.arrayEach)(t.cellReferences,function(t){t.column>=l&&t.translateTo.apply(t,d)}),(0,r.arrayEach)(t.data,function(t){var e=t.row,n=t.column;if(t.column>=l&&(t.translateTo.apply(t,d),t.setState(p.default.STATE_OUT_OFF_DATE)),h){var r=t.row,i=t.column,o=c.getSourceDataAtCell(r,i);if((0,f.isFormulaExpression)(o)){var a=(0,f.cellCoordFactory)("column",l),s=new g.default(o);s.useCustomModifier(v),s.translate({column:u},a({row:e,column:n})),c.updateSourceData(r,i,s.toString())}}})};var r=n(0),f=n(46),p=i(n(47)),g=i(n(71));function i(t){return t&&t.__esModule?t:{default:t}}e.OPERATION_NAME="insert_column";function v(t,e,n,r){var i=t.start,o=t.end,a=n,s=n;return i[e].index<r&&(a=0),o[e].index<r&&(s=0),[a,s,!1]}},function(t,e,n){"use strict";e.__esModule=!0,e.OPERATION_NAME=void 0,e.operate=function(l,u){var h=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],t=this.matrix,c=this.dataProvider,d=[u,0];(0,r.arrayEach)(t.cellReferences,function(t){t.row>=l&&t.translateTo.apply(t,d)}),(0,r.arrayEach)(t.data,function(t){var e=t.row,n=t.column;if(t.row>=l&&(t.translateTo.apply(t,d),t.setState(p.default.STATE_OUT_OFF_DATE)),h){var r=t.row,i=t.column,o=c.getSourceDataAtCell(r,i);if((0,f.isFormulaExpression)(o)){var a=(0,f.cellCoordFactory)("row",l),s=new g.default(o);s.useCustomModifier(v),s.translate({row:u},a({row:e,column:n})),c.updateSourceData(r,i,s.toString())}}})};var r=n(0),f=n(46),p=i(n(47)),g=i(n(71));function i(t){return t&&t.__esModule?t:{default:t}}e.OPERATION_NAME="insert_row";function v(t,e,n,r){var i=t.start,o=t.end,a=n,s=n;return i[e].index<r&&(a=0),o[e].index<r&&(s=0),[a,s,!1]}},function(t,e,n){"use strict";e.__esModule=!0,e.OPERATION_NAME=void 0,e.operate=function(l,t){var u=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],h=-t,e=this.matrix,c=this.dataProvider,n=this.sheet,d=[0,h],r=Math.abs(h)-1,i=e.removeCellRefsAtRange({column:l},{column:l+r}),o=[];(0,a.arrayEach)(e.data,function(e){(0,a.arrayEach)(i,function(t){e.hasPrecedent(t)&&(e.removePrecedent(t),e.setState(p.default.STATE_OUT_OFF_DATE),(0,a.arrayEach)(n.getCellDependencies(e.row,e.column),function(t){t.setState(p.default.STATE_OUT_OFF_DATE)}))}),e.column>=l&&e.column<=l+r&&o.push(e)}),e.remove(o),(0,a.arrayEach)(e.cellReferences,function(t){t.column>=l&&t.translateTo.apply(t,d)}),(0,a.arrayEach)(e.data,function(t){var e=t.row,n=t.column;if(t.column>=l&&(t.translateTo.apply(t,d),t.setState(p.default.STATE_OUT_OFF_DATE)),u){var r=t.row,i=t.column,o=c.getSourceDataAtCell(r,i);if((0,f.isFormulaExpression)(o)){var a=(0,f.cellCoordFactory)("column",l),s=new g.default(o);s.useCustomModifier(v),s.translate({column:h},a({row:e,column:n})),c.updateSourceData(r,i,s.toString())}}})};var a=n(0),f=n(46),p=r(n(47)),g=r(n(71));function r(t){return t&&t.__esModule?t:{default:t}}e.OPERATION_NAME="remove_column";function v(t,e,n,r){var i=t.start,o=t.end,a=t.type,s=i[e].index,l=o[e].index,u=Math.abs(n)-1,h=n,c=n,d=!1;return r<=s&&l<=r+u&&(d=!0),d||"cell"!==a||s<=r&&(c=h=0),d||"range"!==a||(s<=r&&(h=0),l<r?c=0:l<=r+u&&(c-=Math.min(l-(r+u),0))),s+h<0&&(h-=s+h),[h,c,d]}},function(t,e,n){"use strict";e.__esModule=!0,e.OPERATION_NAME=void 0,e.operate=function(l,t){var u=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],h=-t,e=this.matrix,c=this.dataProvider,n=this.sheet,d=[h,0],r=Math.abs(h)-1,i=e.removeCellRefsAtRange({row:l},{row:l+r}),o=[];(0,a.arrayEach)(e.data,function(e){(0,a.arrayEach)(i,function(t){e.hasPrecedent(t)&&(e.removePrecedent(t),e.setState(p.default.STATE_OUT_OFF_DATE),(0,a.arrayEach)(n.getCellDependencies(e.row,e.column),function(t){t.setState(p.default.STATE_OUT_OFF_DATE)}))}),e.row>=l&&e.row<=l+r&&o.push(e)}),e.remove(o),(0,a.arrayEach)(e.cellReferences,function(t){t.row>=l&&t.translateTo.apply(t,d)}),(0,a.arrayEach)(e.data,function(t){var e=t.row,n=t.column;if(t.row>=l&&(t.translateTo.apply(t,d),t.setState(p.default.STATE_OUT_OFF_DATE)),u){var r=t.row,i=t.column,o=c.getSourceDataAtCell(r,i);if((0,f.isFormulaExpression)(o)){var a=(0,f.cellCoordFactory)("row",l),s=new g.default(o);s.useCustomModifier(v),s.translate({row:h},a({row:e,column:n})),c.updateSourceData(r,i,s.toString())}}})};var a=n(0),f=n(46),p=r(n(47)),g=r(n(71));function r(t){return t&&t.__esModule?t:{default:t}}e.OPERATION_NAME="remove_row";function v(t,e,n,r){var i=t.start,o=t.end,a=t.type,s=i[e].index,l=o[e].index,u=Math.abs(n)-1,h=n,c=n,d=!1;return r<=s&&l<=r+u&&(d=!0),d||"cell"!==a||s<=r&&(c=h=0),d||"range"!==a||(s<=r&&(h=0),l<r?c=0:l<=r+u&&(c-=Math.min(l-(r+u),0))),s+h<0&&(h-=s+h),[h,c,d]}},function(t,e,n){"use strict";e.__esModule=!0;var u=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=n(0),o=n(4),h=n(1),a=n(55);function c(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var s=(r(d,[{key:"collectChanges",value:function(t,e,n){this.changes[this._coordId(t,e)]=n}},{key:"clearChanges",value:function(){this.changes={}}},{key:"isInDataRange",value:function(t,e){return 0<=t&&t<this.hot.countRows()&&0<=e&&e<this.hot.countCols()}},{key:"getDataAtCell",value:function(t,e){var n=this._coordId.apply(this,c(this.t.toPhysical(t,e)));return(0,h.hasOwnProperty)(this.changes,n)?this.changes[n]:this.hot.getDataAtCell(t,e)}},{key:"getDataByRange",value:function(i,o,t,e){var a=this,s=this.hot.getData(i,o,t,e);return(0,l.arrayEach)(s,function(t,r){(0,l.arrayEach)(t,function(t,e){var n=a._coordId.apply(a,c(a.t.toPhysical(r+i,e+o)));(0,h.hasOwnProperty)(a.changes,n)&&(s[r][e]=a.changes[n])})}),s}},{key:"getSourceDataAtCell",value:function(t,e){var n=this._coordId(t,e);return(0,h.hasOwnProperty)(this.changes,n)?this.changes[n]:this.hot.getSourceDataAtCell(t,e)}},{key:"getSourceDataByRange",value:function(t,e,n,r){return this.hot.getSourceDataArray(t,e,n,r)}},{key:"getRawDataAtCell",value:function(t,e){return this.getSourceDataAtCell.apply(this,c(this.t.toPhysical(t,e)))}},{key:"getRawDataByRange",value:function(t,e,n,r){var l=this,i=[];return(0,o.rangeEach)(t,n,function(a){var s=[];(0,o.rangeEach)(e,r,function(t){var e=l.t.toPhysical(a,t),n=u(e,2),r=n[0],i=n[1],o=l._coordId(r,i);(0,h.hasOwnProperty)(l.changes,o)?s.push(l.changes[o]):s.push(l.getSourceDataAtCell(r,i))}),i.push(s)}),i}},{key:"updateSourceData",value:function(t,e,n){this.hot.getSourceData()[t][this.hot.colToProp(e)]=n}},{key:"_coordId",value:function(t,e){return t+":"+e}},{key:"destroy",value:function(){this.hot=null,this.changes=null,this.t=null}}]),d);function d(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),this.hot=t,this.changes={},this.t=(0,a.getTranslator)(this.hot)}e.default=s},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=n(0),o=a(n(462)),h=a(n(47));function a(t){return t&&t.__esModule?t:{default:t}}var s=(r(l,[{key:"save",value:function(i,o,a){var t=this.sheet,e=t.matrix,s=t.dataProvider,l=[];(0,u.arrayEach)(e.data,function(t){var e=t.row,n=t.column;if(t[i]<o||t[i]>o+(a-1)){var r=s.getSourceDataAtCell(e,n);l.push({row:e,column:n,value:r})}}),this.stack.push({axis:i,index:o,amount:a,changes:l})}},{key:"restore",value:function(){var t=this.sheet,i=t.matrix,o=t.dataProvider,e=this.stack.pop(),a=e.axis,s=e.index,l=e.amount,n=e.changes;n&&(0,u.arrayEach)(n,function(t){t[a]>s+(l-1)&&(t[a]-=l);var e=t.row,n=t.column,r=t.value;o.getSourceDataAtCell(e,n)!==r&&(o.updateSourceData(e,n,r),i.getCellAt(e,n).setState(h.default.STATE_OUT_OFF_DATE))})}},{key:"destroy",value:function(){this.sheet=null,this.stack=null}}]),l);function l(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),this.sheet=t,this.stack=new o.default}e.default=s},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.__esModule=!0;var i=(function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}(o,[{key:"push",value:function(){var t;(t=this.items).push.apply(t,arguments)}},{key:"pop",value:function(){return this.items.pop()}},{key:"peek",value:function(){return this.isEmpty()?void 0:this.items[this.items.length-1]}},{key:"isEmpty",value:function(){return!this.size()}},{key:"size",value:function(){return this.items.length}}]),o);function o(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.items=t}e.default=i},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=g(n(7)),s=n(2),h=n(1),l=n(22),u=n(84),c=n(5),d=n(167),f=g(n(464)),p=g(n(465));function g(t){return t&&t.__esModule?t:{default:t}}n(466);var v=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(m,o.default),r(m,[{key:"checkDependencies",value:function(){this.hot.getSettings().colHeaders||(0,l.warn)("You need to enable the colHeaders property in your Gantt Chart Handsontable in order for it to work properly.")}},{key:"isEnabled",value:function(){return!!this.hot.getSettings().ganttChart}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.checkDependencies(),this.parseSettings(),this.currentYear=this.settings.startYear||(new Date).getFullYear(),this.dateCalculator=new f.default({year:this.currentYear,allowSplitWeeks:this.settings.allowSplitWeeks,hideDaysBeforeFullWeeks:this.settings.hideDaysBeforeFullWeeks,hideDaysAfterFullWeeks:this.settings.hideDaysAfterFullWeeks}),this.dateCalculator.setFirstWeekDay(this.settings.firstWeekDay),this.monthList=this.dateCalculator.getMonthList(),this.monthHeadersArray=this.generateMonthHeaders(),this.weekHeadersArray=this.generateWeekHeaders(),this.overallWeekSectionCount=this.dateCalculator.countWeekSections(),this.assignGanttSettings(),this.nestedHeadersPlugin&&(this.applyDataSource(),this.colorData&&this.setRangeBarColors(this.colorData)),this.addHook("afterInit",function(){return t.onAfterInit()}),(0,s.addClass)(this.hot.rootElement,"ganttChart"),a(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.internalUpdateSettings||(this.dataFeed&&this.dataFeed.hotSource&&this.dataFeed.removeSourceHotHooks(this.dataFeed.hotSource),this.settings={},this.dataFeed={},this.currentYear=null,this.monthList=[],this.rangeBars={},this.rangeList={},this.rangeBarMeta={},this.hotSource=null,this.deassignGanttSettings(),(0,s.removeClass)(this.hot.rootElement,"ganttChart"),a(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"disablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),a(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"updatePlugin",this).call(this)}},{key:"parseSettings",value:function(){this.settings=this.hot.getSettings().ganttChart,"boolean"==typeof this.settings&&(this.settings={}),this.settings.firstWeekDay||(this.settings.firstWeekDay="monday"),void 0===this.settings.allowSplitWeeks&&(this.settings.allowSplitWeeks=!0),"function"!=typeof this.settings.weekHeaderGenerator&&(this.settings.weekHeaderGenerator=null)}},{key:"applyDataSource",value:function(){if(this.settings.dataSource){var t=this.settings.dataSource;t.instance?this.loadData(t.instance,t.startDateColumn,t.endDateColumn,t.additionalData,t.asyncUpdates):this.loadData(t)}}},{key:"loadData",value:function(t,e,n,r,i){this.dataFeed=new p.default(this.hot,t,e,n,r,i),this.hot.render()}},{key:"clearRangeBars",value:function(){this.rangeBars={}}},{key:"clearRangeList",value:function(){this.rangeList={}}},{key:"getRangeBarCoordinates",value:function(t){return this.rangeList[t]}},{key:"generateMonthHeaders",value:function(t){var e=0<arguments.length&&void 0!==t?t:this.currentYear;return this.dateCalculator.generateHeaderSet("months",this.settings.weekHeaderGenerator,e)}},{key:"generateWeekHeaders",value:function(t){var e=0<arguments.length&&void 0!==t?t:this.currentYear;return this.dateCalculator.generateHeaderSet("weeks",this.settings.weekHeaderGenerator,e)}},{key:"assignGanttSettings",value:function(){var s=this;this.initialSettings=(0,h.deepClone)(this.hot.getSettings());var t={data:(0,u.createEmptySpreadsheetData)(1,this.overallWeekSectionCount),readOnly:!0,renderer:function(t,e,n,r,i,o,a){return s.uniformBackgroundRenderer(t,e,n,r,i,o,a)},colWidths:60,hiddenColumns:!this.hot.getSettings().hiddenColumns||this.hot.getSettings().hiddenColumns,nestedHeaders:[this.monthHeadersArray.slice(),this.weekHeadersArray.slice()],collapsibleColumns:!this.hot.getSettings().collapsibleColumns||this.hot.getSettings().collapsibleColumns,columnSorting:!1,copyPaste:!1};this.internalUpdateSettings=!0,this.hot.updateSettings(t),this.internalUpdateSettings=void 0}},{key:"deassignGanttSettings",value:function(){this.internalUpdateSettings=!0,this.initialSettings&&this.hot.updateSettings(this.initialSettings),this.internalUpdateSettings=void 0}},{key:"cacheRangeBarMeta",value:function(t,e,n,r){this.rangeBarMeta[t]||(this.rangeBarMeta[t]={}),this.rangeBarMeta[t][e]||(this.rangeBarMeta[t][e]={}),this.rangeBarMeta[t][e][n]=r}},{key:"applyRangeBarMetaCache",value:function(){var i=this;(0,h.objectEach)(this.rangeBarMeta,function(t,r){(0,h.objectEach)(t,function(t,n){(0,h.objectEach)(t,function(t,e){i.hot.setCellMeta(r,n,e,t)})})})}},{key:"getAdjacentWeekColumn",value:function(t,e,n){var r=(0,d.parseDate)(t),i=!0===n?-7:7,o=r.setDate(r.getDate()+i);return this.dateCalculator.dateToColumn(o)}},{key:"addRangeBar",value:function(n,t,e,r){var i=this;null!==t&&null!==e&&this.prepareDaysInColumnsInfo((0,d.parseDate)(t),(0,d.parseDate)(e));var o=this.dateCalculator.dateToColumn(t),a=this.dateCalculator.dateToColumn(e),s=(0,d.getDateYear)(t),l=!1,u=!1;return null===o&&this.settings.hideDaysBeforeFullWeeks&&!1!==(o=this.getAdjacentWeekColumn(t,!0,!1))&&(l=!0),null===a&&this.settings.hideDaysAfterFullWeeks&&!1!==(a=this.getAdjacentWeekColumn(e,!1,!0))&&(u=!0),!(!this.dateCalculator.isValidRangeBarData(t,e)||!1===o||!1===a)&&(this.rangeBars[s]||(this.rangeBars[s]={}),this.rangeBars[s][n]||(this.rangeBars[s][n]={}),this.rangeBars[s][n][o]={barLength:a-o+1,partialStart:!l&&!this.dateCalculator.isOnTheEdgeOfWeek(t)[0],partialEnd:!u&&!this.dateCalculator.isOnTheEdgeOfWeek(e)[1],additionalData:{}},(0,h.objectEach)(r,function(t,e){i.rangeBars[s][n][o].additionalData[e]=t}),s===this.dateCalculator.getYear()&&(this.colorData[n]&&(this.rangeBars[s][n][o].colors=this.colorData[n]),this.rangeList[n]=[n,o],this.renderRangeBar(n,o,a,r)),[n,o])}},{key:"prepareDaysInColumnsInfo",value:function(t,e){for(var n=t.getFullYear();n<=e.getFullYear();n++)void 0===this.dateCalculator.daysInColumns[n]&&(this.dateCalculator.calculateWeekStructure(n),this.dateCalculator.generateHeaderSet("weeks",null,n))}},{key:"getRangeBarData",value:function(t,e){var n=this.dateCalculator.getYear(),r=this.getRangeBarCoordinates(t);if(!r)return!1;var i=this.rangeBars[n][r[0]][r[1]];return!(!i||t!==r[0]||!(e===r[1]||e>r[1]&&e<r[1]+i.barLength))&&i}},{key:"updateRangeBarData",value:function(t,e,n){var r=this.getRangeBarData(t,e);(0,h.objectEach)(n,function(t,e){r[e]!==t&&(r[e]=t)})}},{key:"renderRangeBar",value:function(t,e,n){for(var r=this.dateCalculator.getYear(),i=this.rangeBars[r][t][e],o=e;o<=n;o++){var a=this.hot.getCellMeta(t,o),s=(a.className||"")+" rangeBar";(o===e&&i.partialStart||o===n&&i.partialEnd)&&(s+=" partial"),o===n&&(s+=" last"),this.hot.setCellMeta(t,o,"originalClassName",a.className),this.hot.setCellMeta(t,o,"className",s),this.hot.setCellMeta(t,o,"additionalData",i.additionalData),this.cacheRangeBarMeta(t,o,"originalClassName",a.className),this.cacheRangeBarMeta(t,o,"className",s),this.cacheRangeBarMeta(t,o,"additionalData",i.additionalData)}}},{key:"removeRangeBarByDate",value:function(t,e){var n=this.dateCalculator.dateToColumn(e);this.removeRangeBarByColumn(t,n)}},{key:"removeRangeBarByColumn",value:function(r,i){var o=this,t=this.dateCalculator.getYear(),e=this.rangeBars[t][r][i];e&&(this.unrenderRangeBar(r,i,i+e.barLength-1),this.rangeBars[t][r][i]=null,(0,h.objectEach)(this.rangeList,function(t,e){var n=parseInt(e,10);JSON.stringify(t)===JSON.stringify([r,i])&&(o.rangeList[n]=null)}))}},{key:"removeAllRangeBars",value:function(){var r=this;(0,h.objectEach)(this.rangeBars,function(t,n){(0,h.objectEach)(t,function(t,e){r.removeRangeBarByColumn(n,e)})})}},{key:"unrenderRangeBar",value:function(t,e,n){for(var r=e;r<=n;r++){var i=this.hot.getCellMeta(t,r);this.hot.setCellMeta(t,r,"className",i.originalClassName),this.hot.setCellMeta(t,r,"originalClassName",void 0),this.cacheRangeBarMeta(t,r,"className",i.originalClassName),this.cacheRangeBarMeta(t,r,"originalClassName",void 0)}this.hot.render()}},{key:"uniformBackgroundRenderer",value:function(t,e,n,r,i,o,a){var s=this.getRangeBarData(n,r),l=this.getRangeBarCoordinates(n);e.innerHTML="",a.className&&(e.className=a.className);var u="";(0,h.objectEach)(a.additionalData,function(t,e){u+=e+": "+t+"\n"}),u=u.replace(/\n$/,""),e.title=u,s&&s.colors?r===l[1]&&s.partialStart||r===l[1]+s.barLength-1&&s.partialEnd?e.style.background=s.colors[1]:e.style.background=s.colors[0]:e.style.background=""}},{key:"setRangeBarColors",value:function(t){var r=this;this.colorData=t,(0,h.objectEach)(t,function(t,e){var n=r.getRangeBarCoordinates(e);n&&r.updateRangeBarData(n[0],n[1],{colors:t})}),this.hot.render()}},{key:"setYear",value:function(t){var e=(0,h.extend)(this.hot.getSettings().ganttChart,{startYear:t});this.hot.updateSettings({ganttChart:e})}},{key:"onAfterInit",value:function(){this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.applyDataSource()}},{key:"onUpdateSettings",value:function(){this.internalUpdateSettings?this.applyRangeBarMetaCache():a(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"onUpdateSettings",this).call(this)}},{key:"destroy",value:function(){this.hotSource&&this.dataFeed.removeSourceHotHooks(this.hotSource),a(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"destroy",this).call(this)}}]),m);function m(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,m);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(m.__proto__||Object.getPrototypeOf(m)).call(this,t));return e.settings={},e.dateCalculator=null,e.currentYear=null,e.monthList=[],e.monthHeadersArray=[],e.weekHeadersArray=[],e.rangeBars={},e.rangeList={},e.nestedHeadersPlugin=null,e.hotSource=null,e.overallWeekSectionCount=null,e.initialSettings=null,e.dataFeed=null,e.colorData={},e.rangeBarMeta=Object.create(null),e}(0,c.registerPlugin)("ganttChart",v),e.default=v},function(t,e,n){"use strict";e.__esModule=!0;var C=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var p=n(0),u=n(1),o=n(22),g=n(167);var a=(r(l,[{key:"setYear",value:function(t){this.year=t,this.monthListCache[t]=this.calculateMonthData(t),this.calculateWeekStructure(t)}},{key:"setFirstWeekDay",value:function(t){var e=t.toLowerCase();"monday"!==e&&"sunday"!==e&&(0,o.warn)("First day of the week must be set to either Monday or Sunday"),this.firstWeekDay=e,this.calculateWeekStructure()}},{key:"countWeekSections",value:function(){return this.weekSectionCount}},{key:"getFirstWeekDay",value:function(){return this.firstWeekDay}},{key:"getYear",value:function(){return this.year}},{key:"getMonthList",value:function(t){var e=0<arguments.length&&void 0!==t?t:this.year;return this.monthListCache[e]||(this.monthListCache[e]=this.calculateMonthData(e)),this.monthListCache[e]}},{key:"getFullMonthList",value:function(){return this.monthListCache}},{key:"dateToColumn",value:function(t){var e=(0,g.parseDate)(t);if(!e)return!1;var n=e.getMonth(),r=e.getDate()-1,i=e.getFullYear();return this.getWeekColumn(r,n,i)}},{key:"getWeekColumn",value:function(n,t,e){var r=2<arguments.length&&void 0!==e?e:this.getYear(),i=null,o=this.getMonthCacheArray(t,r);return(0,p.arrayEach)(o,function(t){if((0,u.objectEach)(t,function(t,e){if(-1<t.indexOf(n+1))return i=parseInt(e,10),!1}),i)return!1}),i}},{key:"getMonthCacheArray",value:function(r,t){var i=this,o=1<arguments.length&&void 0!==t?t:this.getYear(),a=this.getMonthList(o),s=[];if(this.allowSplitWeeks)s.push(this.daysInColumns[o][r]);else{var l=-1;(0,u.objectEach)(this.daysInColumns[o],function(t,e){var n=a[e];if(1<Object.keys(t).length&&(l+=1),l===r)return 0<n.daysBeforeFullWeeks&&s.push(i.daysInColumns[o][parseInt(e,10)-1]),s.push(t),0<n.daysAfterFullWeeks&&s.push(i.daysInColumns[o][parseInt(e,10)+1]),!1})}return s}},{key:"columnToDate",value:function(n,t){var e=1<arguments.length&&void 0!==t?t:this.getYear(),r=null;(0,u.objectEach)(this.daysInColumns[e],function(t,e){if(t[n])return r=e,!1});var i=this.daysInColumns[e][r][n];if(1!==i.length)return{start:new Date(e,r,i[0]),end:new Date(e,r,i[i.length-1])};var o=new Date(e,r,i[0]);return{start:o,end:o}}},{key:"isOnTheEdgeOfWeek",value:function(t){var n=this,r=(0,g.parseDate)(t);if(!r)return null;var e=r.getMonth(),i=r.getDate()-1,o=r.getFullYear(),a=this.getMonthCacheArray(e,o),s=!1;return(0,p.arrayEach)(a,function(t){if((0,u.objectEach)(t,function(t){if(!n.allowSplitWeeks&&7!==t.length&&(0==i||i==new Date(r.getYear(),r.getMonth()+1,0).getDate()-1))return!0;var e=t.indexOf(1+i);return 0===e?!(s=[1,0]):e===t.length-1?!(s=[0,1]):void 0}),s)return!1}),s}},{key:"generateHeaderSet",value:function(v,m,t){var y=this,w=2<arguments.length&&void 0!==t?t:this.year,e=this.getMonthList(w),b=[];return(0,u.objectEach)(e,function(t,e){var n=0<t.daysBeforeFullWeeks?1:0,r=0<t.daysAfterFullWeeks?1:0,i=y.hideDaysBeforeFullWeeks?0:n,o=y.hideDaysAfterFullWeeks?0:r,a=t.fullWeeks+(y.allowSplitWeeks?i+o:0),s=parseInt(e,10),l="";if("months"===v)b.push({label:t.name,colspan:a});else if("weeks"===v)for(var u=0;u<a;u++){var h=null,c=null;if(y.allowSplitWeeks||1!==t.fullWeeks){var d=y.getWeekColumnRange({monthObject:t,monthNumber:s,headerIndex:u,areDaysBeforeFullWeeksVisible:i,areDaysAfterFullWeeksVisible:o,headerCount:a,year:w}),f=C(d,2);h=f[0],c=f[1]}else{var p=y.getWeekColumnRange({monthObject:t,monthNumber:s,headerIndex:u,headerCount:a,areDaysBeforeFullWeeksVisible:i,areDaysAfterFullWeeksVisible:o,mixedMonth:!0,year:w}),g=C(p,2);h=g[0],c=g[1]}l=h===c?""+h:h+" -  "+c,b.push(m?m.call(y,h,c):l),y.addDaysToCache(s,b.length-1,h,c,w)}}),b}},{key:"getWeekColumnRange",value:function(t){var e=t.monthObject,n=t.monthNumber,r=t.headerIndex,i=t.headerCount,o=t.areDaysBeforeFullWeeksVisible,a=t.areDaysAfterFullWeeksVisible,s=t.mixedMonth,l=void 0!==s&&s,u=t.year,h=void 0===u?this.year:u,c=this.getMonthList(h),d=this.allowSplitWeeks,f=null,p=null;return l?f=0===n?(p=c[n+1].daysBeforeFullWeeks,g.DEC_LENGTH-(g.WEEK_LENGTH-p)+1):n===c.length-1?(p=g.WEEK_LENGTH-c[n-1].daysAfterFullWeeks,c[n-1].days-c[n-1].daysAfterFullWeeks+1):(p=c[n+1].daysBeforeFullWeeks,c[n-1].days-(g.WEEK_LENGTH-p)+1):p=d&&o&&0===r?(f=r+1,e.daysBeforeFullWeeks):d&&a&&r===i-1?(f=e.days-e.daysAfterFullWeeks+1,e.days):(f=null,(f=d?e.daysBeforeFullWeeks+(r-o)*g.WEEK_LENGTH+1:e.daysBeforeFullWeeks+r*g.WEEK_LENGTH+1)+g.WEEK_LENGTH-1),[f,p]}},{key:"addDaysToCache",value:function(t,e,n,r,i){var o=4<arguments.length&&void 0!==i?i:this.getYear();if(this.daysInColumns[o]||(this.daysInColumns[o]={}),this.daysInColumns[o][t]||(this.daysInColumns[o][t]={}),this.daysInColumns[o][t][e]||(this.daysInColumns[o][t][e]=[]),n<=r)for(var a=n;a<=r;a++)this.daysInColumns[o][t][e].push(a);else{for(var s=0<=t-1?this.countMonthDays(t):31,l=n;l<=s;l++)this.daysInColumns[o][t][e].push(l);for(var u=1;u<=r;u++)this.daysInColumns[o][t][e].push(u)}}},{key:"isValidRangeBarData",value:function(t,e){var n=(0,g.parseDate)(t),r=(0,g.parseDate)(e);return n&&r&&n.getTime()<=r.getTime()}},{key:"calculateMonthData",value:function(t){var e=0<arguments.length&&void 0!==t?t:this.year;return[{name:"January",days:31},{name:"February",days:new Date(e,2,0).getDate()},{name:"March",days:31},{name:"April",days:30},{name:"May",days:31},{name:"June",days:30},{name:"July",days:31},{name:"August",days:31},{name:"September",days:30},{name:"October",days:31},{name:"November",days:30},{name:"December",days:31}].slice(0)}},{key:"countMonths",value:function(t){var e=0<arguments.length&&void 0!==t?t:this.getYear();return this.monthListCache[e].length}},{key:"countMonthDays",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:this.getYear();return this.monthListCache[n][t-1].days}},{key:"countMonthFullWeeks",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:this.getYear();return this.monthListCache[n][t-1].fullWeeks}},{key:"calculateWeekStructure",value:function(t){var a=this,s=0<arguments.length&&void 0!==t?t:this.getYear();this.monthListCache[s]=this.calculateMonthData(s);var e=this.getFirstWeekDay(),l=this.getMonthList(s),u=[],h=this.hideDaysBeforeFullWeeks?0:1,c=this.hideDaysAfterFullWeeks?0:1,d=0,f=0;"monday"===e&&(d=1),(0,p.arrayEach)(l,function(t,e){var n=new Date(s,e,1).getDay(),r=0;if(t.daysBeforeFullWeeks=(7-n+d)%7,!a.allowSplitWeeks&&t.daysBeforeFullWeeks&&(u.push((0,g.getMixedMonthObject)((0,g.getMixedMonthName)(e,l),e)),r+=1),t.fullWeeks=Math.floor((t.days-t.daysBeforeFullWeeks)/7),t.daysAfterFullWeeks=t.days-t.daysBeforeFullWeeks-7*t.fullWeeks,a.allowSplitWeeks){var i=h*(t.daysBeforeFullWeeks?1:0),o=c*(t.daysAfterFullWeeks?1:0);f+=t.fullWeeks+i+o}else e===l.length-1&&t.daysAfterFullWeeks&&(u.push((0,g.getMixedMonthObject)((0,g.getMixedMonthName)(e,l),null)),r+=1),f+=t.fullWeeks+r}),(0,p.arrayEach)(u,function(t,e){var n=t.index;delete t.index,a.addMixedMonth(null===n?n:e+n,t,s)}),s===this.getYear()&&(this.weekSectionCount=f)}},{key:"addMixedMonth",value:function(t,e,n){null===t?this.monthListCache[n].push(e):this.monthListCache[n].splice(t,0,e)}}]),l);function l(t){var e=t.year,n=t.allowSplitWeeks,r=void 0===n||n,i=t.hideDaysBeforeFullWeeks,o=void 0!==i&&i,a=t.hideDaysAfterFullWeeks,s=void 0!==a&&a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),this.year=e,this.firstWeekDay="monday",this.allowSplitWeeks=r,this.hideDaysBeforeFullWeeks=o,this.hideDaysAfterFullWeeks=s,this.weekSectionCount=0,this.monthListCache={},this.daysInColumns={},this.calculateWeekStructure()}e.default=a},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=n(1),o=n(0),a=n(4),s=n(167);var u=(r(h,[{key:"applyData",value:function(t,e,n,r,i){if("[object Array]"===Object.prototype.toString.call(t))1<t.length&&this.chartInstance.alter("insert_row",0,t.length-1,this.pluginName+".loadData"),this.loadData(t);else if(t instanceof this.chartInstance.constructor){var o=t.countRows();1<o&&this.chartInstance.alter("insert_row",0,o-1,this.pluginName+".loadData"),this.bindWithHotInstance(t,e,n,r,i)}}},{key:"bindWithHotInstance",value:function(t,e,n,r,i){this.hotSource={instance:t,startColumn:e,endColumn:n,additionalData:r,asyncUpdates:i},this.addSourceHotHooks(),this.asyncCall(this.updateFromSource)}},{key:"asyncCall",value:function(t){var e=this;this.hotSource.asyncUpdates?(this.asyncStart(),setTimeout(function(){t.call(e),e.asyncEnd()},0)):t.call(this)}},{key:"asyncStart",value:function(){this.ongoingAsync=!0}},{key:"asyncEnd",value:function(){this.ongoingAsync=!1}},{key:"addSourceHotHooks",value:function(){var e=this;this.sourceHooks={afterLoadData:function(){return e.onAfterSourceLoadData()},afterChange:function(t){return e.onAfterSourceChange(t)},afterColumnSort:function(){return e.onAfterColumnSort()}},this.hotSource.instance.addHook("afterLoadData",this.sourceHooks.afterLoadData),this.hotSource.instance.addHook("afterChange",this.sourceHooks.afterChange),this.hotSource.instance.addHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"removeSourceHotHooks",value:function(t){this.sourceHooks.afterLoadData&&t.instance.removeHook("afterLoadData",this.sourceHooks.afterLoadData),this.sourceHooks.afterChange&&t.instance.removeHook("afterChange",this.sourceHooks.afterChange),this.sourceHooks.afterColumnSort&&t.instance.removeHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"getDataFromSource",value:function(t){var r={},e=this.hotSource,i=void 0,o=[];void 0===t?i=e.instance.getData(0,0,e.instance.countRows()-1,e.instance.countCols()-1):(i=[])[t]=e.instance.getDataAtRow(t);for(var n=function(t){r={};var n=i[t];if(null===n[e.startColumn]||""===n[e.startColumn])return"continue";(0,l.objectEach)(e.additionalData,function(t,e){r[e]=n[t]}),o.push([t,n[e.startColumn],n[e.endColumn],r,t])},a=t||0,s=i.length;a<(t?t+1:s);a++)n(a);return o}},{key:"updateFromSource",value:function(t){var e=this.getDataFromSource(t);!t&&isNaN(t)&&(this.chartPlugin.clearRangeBars(),this.chartPlugin.clearRangeList()),this.loadData(e),this.chartInstance.render()}},{key:"loadData",value:function(t){var r=this,i=[];(0,o.arrayEach)(t,function(t,e){t.row=e;var n=r.splitRangeIfNeeded(t);i=i.concat(n)}),(0,o.arrayEach)(i,function(t){r.chartPlugin.addRangeBar(t.row,(0,s.getStartDate)(t),(0,s.getEndDate)(t),(0,s.getAdditionalData)(t)),delete t.row})}},{key:"splitRangeIfNeeded",value:function(n){var r=[],t=new Date((0,s.getStartDate)(n)),e=new Date((0,s.getEndDate)(n));if("string"==typeof t||"string"==typeof e)return!1;var i=t.getFullYear(),o=e.getFullYear();return i===o?[n]:((0,a.rangeEach)(i,o,function(t){var e=(0,l.clone)(n);t!==i&&(0,s.setStartDate)(e,"01/01/"+t),t!==o&&(0,s.setEndDate)(e,"12/31/"+t),r.push(e)}),r)}},{key:"onAfterSourceChange",value:function(a){var s=this;this.asyncCall(function(){if(a){for(var t={},e=0,n=a.length;e<n;e++){var r=a[e],i=parseInt(r[0],10),o=parseInt(r[1],10);t[i]||(t[i]={}),t[i][o]=[r[2],r[3]]}(0,l.objectEach)(t,function(t,e){var n=parseInt(e,10);s.chartPlugin.getRangeBarCoordinates(n)&&s.chartPlugin.removeRangeBarByColumn(n,s.chartPlugin.rangeList[n][1]),s.updateFromSource(e)})}})}},{key:"onAfterSourceLoadData",value:function(){var t=this;this.asyncCall(function(){t.chartPlugin.removeAllRangeBars(),t.updateFromSource()})}},{key:"onAfterColumnSort",value:function(){var t=this;this.asyncCall(function(){t.chartPlugin.removeAllRangeBars(),t.updateFromSource()})}}]),h);function h(t,e,n,r,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),this.data=e,this.chartInstance=t,this.chartPlugin=this.chartInstance.getPlugin("ganttChart"),this.hotSource=null,this.sourceHooks={},this.ongoingAsync=!1,this.applyData(e,n,r,i,o||!1)}e.default=u},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o,s=n(2),l=n(5),u=n(4),h=n(7);var c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(d,((o=h)&&o.__esModule?o:{default:o}).default),r(d,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().headerTooltips}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.settings=this.hot.getSettings().headerTooltips,this.parseSettings(),this.addHook("afterGetColHeader",function(t,e){return n.onAfterGetHeader(t,e)}),this.addHook("afterGetRowHeader",function(t,e){return n.onAfterGetHeader(t,e)}),a(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.settings=null,this.clearTitleAttributes(),a(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"disablePlugin",this).call(this)}},{key:"parseSettings",value:function(){"boolean"==typeof this.settings&&(this.settings={rows:!0,columns:!0,onlyTrimmed:!1})}},{key:"clearTitleAttributes",value:function(){var t=this.hot.view.wt.getSetting("columnHeaders").length,i=this.hot.view.wt.wtTable.THEAD,o=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,e=this.hot.view.wt.wtOverlays.topLeftCornerOverlay,a=e?e.clone.wtTable.THEAD:null;(0,u.rangeEach)(0,t-1,function(t){var e=i.childNodes[t],n=o.childNodes[t],r=a?a.childNodes[t]:null;(0,u.rangeEach)(0,e.childNodes.length-1,function(t){e.childNodes[t].removeAttribute("title"),n&&n.childNodes[t]&&n.childNodes[t].removeAttribute("title"),a&&r&&r.childNodes[t]&&r.childNodes[t].removeAttribute("title")})},!0)}},{key:"onAfterGetHeader",value:function(t,e){var n=e.querySelector("span"),r="THEAD"===e.parentNode.parentNode.nodeName;(r&&this.settings.columns||!r&&this.settings.rows)&&(this.settings.onlyTrimmed?(0,s.outerWidth)(n)>=(0,s.outerWidth)(e)&&0!==(0,s.outerWidth)(n)&&e.setAttribute("title",n.textContent):e.setAttribute("title",n.textContent))}},{key:"destroy",value:function(){this.settings=null,a(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"destroy",this).call(this)}}]),d);function d(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,t));return e.settings=null,e}(0,l.registerPlugin)("headerTooltips",c),e.default=c},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=w(["You have declared a Nested Header overlapping the Fixed Columns section - it may lead to visual\n          glitches. To prevent that kind of problems, split the nested headers between the fixed and non-fixed columns."],["You have declared a Nested Header overlapping the Fixed Columns section - it may lead to visual\n          glitches. To prevent that kind of problems, split the nested headers between the fixed and non-fixed columns."]),s=w(["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\n                is currently not supported and might result in glitches."],["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\n                is currently not supported and might result in glitches."]),g=n(2),v=n(4),m=n(0),l=n(1),u=n(25),h=n(22),c=n(5),d=y(n(7)),f=n(9),p=y(n(469));function y(t){return t&&t.__esModule?t:{default:t}}function w(t,e){return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}n(470);var b=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(C,d.default),r(C,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedHeaders}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.settings=this.hot.getSettings().nestedHeaders,this.addHook("afterGetColumnHeaderRenderers",function(t){return i.onAfterGetColumnHeaderRenderers(t)}),this.addHook("afterInit",function(){return i.onAfterInit()}),this.addHook("afterOnCellMouseDown",function(t,e){return i.onAfterOnCellMouseDown(t,e)}),this.addHook("beforeOnCellMouseOver",function(t,e,n,r){return i.onBeforeOnCellMouseOver(t,e,n,r)}),this.addHook("afterViewportColumnCalculatorOverride",function(t){return i.onAfterViewportColumnCalculatorOverride(t)}),this.addHook("modifyColWidth",function(t,e){return i.onModifyColWidth(t,e)}),this.setupColspanArray(),this.checkForFixedColumnsCollision(),this.columnHeaderLevelCount=this.hot.view?this.hot.view.wt.getSetting("columnHeaders").length:0,a(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearColspans(),this.settings=[],this.columnHeaderLevelCount=0,this.colspanArray=[],this.ghostTable.clear(),a(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),a(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"updatePlugin",this).call(this),this.ghostTable.buildWidthsMapper()}},{key:"clearColspans",value:function(){if(this.hot.view)for(var t=this.hot.view.wt.getSetting("columnHeaders").length,e=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,i=0;i<t;i++){var o=e.childNodes[i];if(!o)break;for(var a=n.childNodes[i],s=r?r.childNodes[i]:null,l=0,u=o.childNodes.length;l<u;l++)o.childNodes[l].removeAttribute("colspan"),a&&a.childNodes[l]&&a.childNodes[l].removeAttribute("colspan"),r&&s&&s.childNodes[l]&&s.childNodes[l].removeAttribute("colspan")}}},{key:"checkForFixedColumnsCollision",value:function(){var n=this,r=this.hot.getSettings().fixedColumnsLeft;(0,m.arrayEach)(this.colspanArray,function(t,e){n.getNestedParent(e,r)!==r&&(0,h.warn)((0,u.toSingleLine)(o))})}},{key:"checkForOverlappingHeaders",value:function(){var a=this;(0,m.arrayEach)(this.colspanArray,function(t,o){(0,m.arrayEach)(a.colspanArray[o],function(t,e){if(1<t.colspan){var n=a.levelToRowCoords(o),r=a.getChildHeaders(n,e);if(0<r.length){var i=0;return(0,m.arrayEach)(r,function(t){i+=a.getColspan(n+1,t)}),i>t.colspan&&(0,h.warn)((0,u.toSingleLine)(s)),!1}}})})}},{key:"setupColspanArray",value:function(){var o=this;(0,l.objectEach)(this.settings,function(t,i){(0,l.objectEach)(t,function(t,e,n){if(function(t,e){t[e]||(t[e]=[])}(o.colspanArray,i),void 0===n[e].colspan)o.colspanArray[i].push({label:n[e]||"",colspan:1,hidden:!1});else{var r=n[e].colspan||1;o.colspanArray[i].push({label:n[e].label||"",colspan:r,hidden:!1}),o.fillColspanArrayWithDummies(r,i)}})})}},{key:"fillColspanArrayWithDummies",value:function(t,e){var n=this;(0,v.rangeEach)(0,t-2,function(){n.colspanArray[e].push({label:"",colspan:1,hidden:!0})})}},{key:"headerRendererFactory",value:function(h){var c=this;return function(t,e){if(e.removeAttribute("colspan"),(0,g.removeClass)(e,"hiddenHeader"),c.colspanArray[h][t]&&c.colspanArray[h][t].colspan){var n=c.colspanArray[h][t].colspan,r=c.hot.getSettings().fixedColumnsLeft||0,i=c.hot.view.wt.wtOverlays.topLeftCornerOverlay,o=c.hot.view.wt.wtOverlays.leftOverlay,a=!!i&&i.clone.wtTable.THEAD.contains(e),s=!!o&&o.clone.wtTable.THEAD.contains(e);1<n&&e.setAttribute("colspan",a||s?Math.min(n,r-t):n),(a||s&&t===r-1)&&(0,g.addClass)(e,"overlayEdge")}c.colspanArray[h][t]&&c.colspanArray[h][t].hidden&&(0,g.addClass)(e,"hiddenHeader"),(0,g.empty)(e);var l=document.createElement("DIV");(0,g.addClass)(l,"relative");var u=document.createElement("SPAN");(0,g.addClass)(u,"colHeader"),(0,g.fastInnerHTML)(u,c.colspanArray[h][t]&&c.colspanArray[h][t].label||""),l.appendChild(u),e.appendChild(l),c.hot.runHooks("afterGetColHeader",t,e)}}},{key:"getColspan",value:function(t,e){var n=this.colspanArray[this.rowCoordsToLevel(t)][e];return n?n.colspan:1}},{key:"levelToRowCoords",value:function(t){return t-this.columnHeaderLevelCount}},{key:"rowCoordsToLevel",value:function(t){return t+this.columnHeaderLevelCount}},{key:"getNestedParent",value:function(t,e){if(t<0)return!1;var n=this.colspanArray[t][e]?this.colspanArray[t][e].colspan:1,r=!!this.colspanArray[t][e]&&this.colspanArray[t][e].hidden;if(1<n||1===n&&!1===r)return e;var i=e-1;do{if(1<this.colspanArray[t][i].colspan)break;i-=1}while(0<=e);return i}},{key:"getChildHeaders",value:function(t,e){var n=this.rowCoordsToLevel(t),r=this.colspanArray[n+1],i=this.getNestedParent(n,e),o=this.colspanArray[n][e].colspan,a=[];return r&&(0,v.rangeEach)(i,i+o-1,function(t){r[t]&&1<r[t].colspan&&(o-=r[t].colspan-1),r[t]&&!r[t].hidden&&-1===a.indexOf(t)&&a.push(t)}),a}},{key:"fillTheRemainingColspans",value:function(){var r=this;(0,l.objectEach)(this.settings,function(e,n){(0,v.rangeEach)(r.colspanArray[n].length-1,r.hot.countCols()-1,function(t){r.colspanArray[n].push({label:e[t]||"",colspan:1,hidden:!1})},!0)})}},{key:"updateHeadersHighlight",value:function(){var a=this,t=this.hot.getSelectedLast();if(void 0!==t){var s=this.hot.view.wt.wtOverlays,l=this.hot.selection.isSelectedByColumnHeader(),u=Math.min(t[1],t[3]),h=Math.max(t[1],t[3]),c=l?-1:this.columnHeaderLevelCount-1,d=[],e=function(n){return function(t,e){return function(){return e(t,n)}}},f=e("ht__highlight"),p=e("ht__active_highlight");(0,v.rangeEach)(u,h,function(o){for(var t=function(e){var t=a.getNestedParent(e,o),n=[s.topOverlay?s.topOverlay.clone.wtTable.getColumnHeader(t,e):void 0,s.topLeftCornerOverlay?s.topLeftCornerOverlay.clone.wtTable.getColumnHeader(t,e):void 0],r=a.getColspan(e-a.columnHeaderLevelCount,t),i=u<=t&&t+r-1<=h;(0,m.arrayEach)(n,function(t){if(void 0===t)return!1;!l&&e<c||l&&!i?(d.push(f(t,g.removeClass)),l&&d.push(p(t,g.removeClass))):(d.push(f(t,g.addClass)),l&&d.push(p(t,g.addClass)))})},e=a.columnHeaderLevelCount-1;-1<e;e--)t(e)}),(0,m.arrayEach)(d,function(t){t()}),d.length=0}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(n){var r=this,i=n.startColumn;(0,v.rangeEach)(0,Math.max(this.columnHeaderLevelCount-1,0),function(t){var e=r.getNestedParent(t,n.startColumn);e<n.startColumn&&(i=Math.min(i,e))}),n.startColumn=i}},{key:"onAfterOnCellMouseDown",value:function(t,e){if(e.row<0){var n=this.getColspan(e.row,e.col),r=e.col+n-1;if(1<n){var i=this.hot.countRows()-1;this.hot.selection.setRangeEnd(new f.CellCoords(i,r))}}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){if(!(0<=e.row||e.col<0)&&this.hot.view.isMouseDown()){var i=this.hot.getSelectedRangeLast(),o=i.from,a=i.to,s=this.getColspan(e.row,e.col),l=e.col+s-1,u=!1;if(o.col<=a.col?(e.col<o.col&&l===a.col||e.col<o.col&&l<o.col||e.col<o.col&&l>=o.col&&l<a.col)&&(u=!0):(e.col<a.col&&l>o.col||e.col>o.col||e.col<=a.col&&l>o.col||e.col>a.col&&l>o.col)&&(u=!0),u){var h=[a.col,o.col];o.col=h[0],a.col=h[1]}if(1<s){var c;r.column=!0,r.cell=!0;var d=[];o.col===a.col&&(l<=o.col&&e.col<o.col?d.push(a.col,e.col):d.push(e.col<o.col?e.col:o.col,l>a.col?l:a.col)),o.col<a.col&&d.push(e.col<o.col?e.col:o.col,l),o.col>a.col&&d.push(o.col,e.col),(c=this.hot).selectColumns.apply(c,d)}}}},{key:"onAfterInit",value:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length,this.fillTheRemainingColspans(),this.checkForOverlappingHeaders(),this.ghostTable.buildWidthsMapper()}},{key:"onAfterGetColumnHeaderRenderers",value:function(t){if(t){t.length=0;for(var e=this.colspanArray.length-1;0<=e;e--)t.push(this.headerRendererFactory(e));t.reverse()}this.updateHeadersHighlight()}},{key:"onModifyColWidth",value:function(t,e){var n=this.ghostTable.widthsCache[e];return n<t?t:n}},{key:"destroy",value:function(){this.settings=null,this.columnHeaderLevelCount=null,this.colspanArray=null,a(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"destroy",this).call(this)}}]),C);function C(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,C);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,t));return e.settings=[],e.columnHeaderLevelCount=0,e.colspanArray=[],e.ghostTable=new p.default(e),e}(0,c.registerPlugin)("nestedHeaders",b),e.default=b},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var m=n(2),y=n(1);var o=(r(a,[{key:"buildWidthsMapper",value:function(){this.container=document.createElement("div"),this.buildGhostTable(this.container),this.nestedHeaders.hot.rootElement.appendChild(this.container);for(var t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length,n=0;n<e;n++)this.widthsCache.push(t[n].offsetWidth);this.container.parentNode.removeChild(this.container),this.container=null,this.nestedHeaders.hot.render()}},{key:"buildGhostTable",value:function(t){for(var e=document,n=e.createDocumentFragment(),r=e.createElement("table"),i=!1,o=!!this.nestedHeaders.hot.getSettings().dropdownMenu,a=this.nestedHeaders.colspanArray.length,s=this.nestedHeaders.hot.countCols(),l=a-1,u=0;u<a;u++){var h=e.createElement("tr");i=!1;for(var c=0;c<s;c++){var d=e.createElement("th"),f=(0,y.clone)(this.nestedHeaders.colspanArray[u][c]);f&&!f.hidden&&(u===l&&(1<f.colspan&&(i=!0),o&&(f.label+='<button class="changeType"></button>')),(0,m.fastInnerHTML)(d,f.label),d.colSpan=f.colspan,h.appendChild(d))}r.appendChild(h)}if(i){for(var p=e.createElement("tr"),g=0;g<s;g++){var v=e.createElement("th");p.appendChild(v)}r.appendChild(p)}n.appendChild(r),t.appendChild(n)}},{key:"clear",value:function(){this.container=null,this.widthsCache.length=0}}]),a);function a(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),this.nestedHeaders=t,this.container=void 0,this.widthsCache=[]}e.default=o},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=g(n(7)),s=n(5),l=n(4),u=n(0),h=n(9),c=g(n(472)),d=g(n(473)),f=g(n(238)),p=g(n(474));function g(t){return t&&t.__esModule?t:{default:t}}function v(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}n(475);var m=new WeakMap,y=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(w,o.default),r(w,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedRows}},{key:"enablePlugin",value:function(){var t=this;this.sourceData=this.hot.getSourceData(),this.trimRowsPlugin=this.hot.getPlugin("trimRows"),this.manualRowMovePlugin=this.hot.getPlugin("manualRowMove"),this.bindRowsWithHeadersPlugin=this.hot.getPlugin("bindRowsWithHeaders"),this.dataManager=new c.default(this,this.hot,this.sourceData),this.collapsingUI=new d.default(this,this.hot,this.trimRowsPlugin),this.headersUI=new f.default(this,this.hot),this.contextMenuUI=new p.default(this,this.hot),this.dataManager.rewriteCache(),this.addHook("afterInit",function(){return t.onAfterInit.apply(t,arguments)}),this.addHook("beforeRender",function(){return t.onBeforeRender.apply(t,arguments)}),this.addHook("modifyRowData",function(){return t.onModifyRowData.apply(t,arguments)}),this.addHook("modifySourceLength",function(){return t.onModifySourceLength.apply(t,arguments)}),this.addHook("beforeDataSplice",function(){return t.onBeforeDataSplice.apply(t,arguments)}),this.addHook("beforeDataFilter",function(){return t.onBeforeDataFilter.apply(t,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return t.onAfterContextMenuDefaultOptions.apply(t,arguments)}),this.addHook("afterGetRowHeader",function(){return t.onAfterGetRowHeader.apply(t,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow.apply(t,arguments)}),this.addHook("modifyRemovedAmount",function(){return t.onModifyRemovedAmount.apply(t,arguments)}),this.addHook("beforeAddChild",function(){return t.onBeforeAddChild.apply(t,arguments)}),this.addHook("afterAddChild",function(){return t.onAfterAddChild.apply(t,arguments)}),this.addHook("beforeDetachChild",function(){return t.onBeforeDetachChild.apply(t,arguments)}),this.addHook("afterDetachChild",function(){return t.onAfterDetachChild.apply(t,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return t.onModifyRowHeaderWidth.apply(t,arguments)}),this.addHook("afterCreateRow",function(){return t.onAfterCreateRow.apply(t,arguments)}),this.addHook("beforeRowMove",function(){return t.onBeforeRowMove.apply(t,arguments)}),this.addHook("afterRowMove",function(){return t.onAfterRowMove.apply(t,arguments)}),this.trimRowsPlugin.isEnabled()||(this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().trimRows=!0),a(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){a(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),a(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(t,e){var n,r,i=m.get(this),o=t.length,a=[],s=this.dataManager.translateTrimmedRow(e),l=!0,u=void 0,h=null;for(u=0;u<o;u++)a.push(this.dataManager.translateTrimmedRow(t[u])),this.dataManager.isParent(a[u])&&(l=!1);if(-1<a.indexOf(s)||!l)return!1;if(n=this.dataManager.getRowParent(a[0]),null==(h=this.dataManager.getRowParent(s))&&(h=this.dataManager.getRowParent(s-1)),null==h&&(h=this.dataManager.getDataObject(s-1),i.movedToFirstChild=!0),!h)return!1;for(r=n===h,i.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(h),this.collapsingUI.collapsedRowsStash.stash(),r||(Math.max.apply(Math,a)<=s?this.collapsingUI.collapsedRowsStash.shiftStash(a[0],-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(s,t.length)),i.changeSelection=!0,(a[o-1]<=s&&r||!0===i.movedToFirstChild)&&(t.reverse(),a.reverse(),!0!==i.movedToFirstChild&&(s-=1)),u=0;u<o;u++)this.dataManager.moveRow(a[u],s);if(a[a.length-1]<s)for(u=o-1;0<=u;u--)this.dataManager.moveCellMeta(a[u],s);else for(u=0;u<o;u++)this.dataManager.moveCellMeta(a[u],s);return(a[o-1]<=s&&r||this.dataManager.isParent(s))&&t.reverse(),this.dataManager.rewriteCache(),!1}},{key:"onAfterRowMove",value:function(t,e){var n=m.get(this);if(n.changeSelection){var r,i,o=t.length,a=0,s=0,l=null;if(this.collapsingUI.collapsedRowsStash.applyStash(),r=this.dataManager.translateTrimmedRow(e),n.movedToFirstChild)n.movedToFirstChild=!1,s=(a=e)+o-1,e>=Math.max.apply(Math,v(t))&&(a-=o,s-=o);else if(n.movedToCollapsed){var u=this.dataManager.getRowParent(r-1);null==u&&(u=this.dataManager.getDataObject(r-1)),s=a=this.dataManager.getRowIndex(u)}else t[o-1]<e?a=(s=e-1)-o+1:s=(a=e)+o-1;l=this.hot.selection,i=this.hot.countCols()-1,l.setRangeStart(new h.CellCoords(a,0)),l.setRangeEnd(new h.CellCoords(s,i),!0),n.changeSelection=!1}}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n){this.collapsingUI.toggleState(t,e,n)}},{key:"onModifyRowData",value:function(t){return this.dataManager.getDataObject(t)}},{key:"onModifySourceLength",value:function(){return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(t,e,n){return this.dataManager.spliceData(t,e,n),!1}},{key:"onBeforeDataFilter",value:function(t,e){var n=[],r=this.dataManager.translateTrimmedRow(t),i=m.get(this);return(0,l.rangeEach)(r,r+e-1,function(t){n.push(t)}),this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r,e),this.collapsingUI.collapsedRowsStash.shiftStash(r,-1*e),this.dataManager.filterData(t,e,n),!(i.skipRender=!0)}},{key:"onAfterContextMenuDefaultOptions",value:function(t){return this.contextMenuUI.appendOptions(t)}},{key:"onAfterGetRowHeader",value:function(t,e){this.headersUI.appendLevelIndicators(t,e)}},{key:"onModifyRowHeaderWidth",value:function(t){return this.headersUI.rowHeaderWidthCache||t}},{key:"onAfterRemoveRow",value:function(t,e,n,r){var i=this;if(r!==this.pluginName){var o=m.get(this);setTimeout(function(){o.skipRender=null,i.headersUI.updateRowHeaderWidth(),i.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onModifyRemovedAmount",value:function(t,e){var i=this,o=[],a=0;return(0,l.rangeEach)(e,e+t-1,function(t){var e=!1,n=i.collapsingUI.translateTrimmedRow(t),r=i.dataManager.getDataObject(n);i.dataManager.hasChildren(r)&&(o.push(r),(0,u.arrayEach)(o,function(t){if(-1<t.__children.indexOf(r))return!(e=!0)}),e||(a+=i.dataManager.countChildren(r))),e=!1,(0,u.arrayEach)(o,function(t){if(-1<t.__children.indexOf(r))return!(e=!0)}),e&&(a-=1)}),t+a}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(t,e,n){n!==this.pluginName&&this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){this.bindRowsWithHeadersPlugin.bindStrategy.strategy&&this.bindRowsWithHeadersPlugin.bindStrategy.createMap(this.hot.countSourceRows());var t=Math.max.apply(Math,v(this.dataManager.cache.levels));0<t&&this.headersUI.updateRowHeaderWidth(t)}},{key:"onBeforeRender",value:function(t,e){m.get(this).skipRender&&(e.skipRender=!0)}}]),w);function w(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,w);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,t));return e.sourceData=null,e.trimRowsPlugin=null,e.bindRowsWithHeadersPlugin=null,e.dataManager=null,e.headersUI=null,m.set(e,{changeSelection:!1,movedToFirstChild:!1,movedToCollapsed:!1,skipRender:null}),e}(0,s.registerPlugin)("nestedRows",y),e.default=y},function(t,e,n){"use strict";e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t};function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var d=n(4),a=n(1),l=n(0),s=n(55);var u=(i(h,[{key:"rewriteCache",value:function(){var e=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},(0,d.rangeEach)(0,this.data.length-1,function(t){e.cacheNode(e.data[t],0,null)})}},{key:"cacheNode",value:function(e,n,t){var r=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:t,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&(0,l.arrayEach)(e.__children,function(t){r.cacheNode(t,n+1,e)})}},{key:"getDataObject",value:function(t){return null==t?null:this.cache.rows[t]}},{key:"readTreeNodes",value:function(t,e,n,r){var i=this,o=!1,a=e;if(isNaN(a)&&a.end)return a;var s=t;return s||(s={__children:this.data},o=!0,a-=1),null!=n&&a===n?{result:s,end:!0}:null!=r&&s===r?{result:a,end:!0}:(a+=1,s.__children&&(0,l.arrayEach)(s.__children,function(t){if(i.parentReference.set(t,o?null:s),a=i.readTreeNodes(t,a,n,r),isNaN(a)&&a.end)return!1}),a)}},{key:"updateParentReference",value:function(){this.readTreeNodes({__children:this.data},0,this.hot.countRows())}},{key:"mockParent",value:function(){var t=this.mockNode();return t.__children=this.data,t}},{key:"mockNode",value:function(){var n={};return(0,a.objectEach)(this.data[0],function(t,e){n[e]=null}),n}},{key:"getRowIndex",value:function(t){return null==t?null:this.cache.nodeInfo.get(t).row}},{key:"getRowIndexWithinParent",value:function(t){var e=null;e=isNaN(t)?t:this.getDataObject(t);var n=this.getRowParent(t);return null==n?this.data.indexOf(e):n.__children.indexOf(e)}},{key:"countAllRows",value:function(){var t={__children:this.data};return this.countChildren(t)}},{key:"countChildren",value:function(t){var e=this,n=0,r=t;return isNaN(r)||(r=this.getDataObject(r)),r&&r.__children?((0,l.arrayEach)(r.__children,function(t){n+=1,t.__children&&(n+=e.countChildren(t))}),n):0}},{key:"getRowParent",value:function(t){var e=void 0;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}},{key:"getRowObjectParent",value:function(t){return"object"!==(void 0===t?"undefined":r(t))?null:this.cache.nodeInfo.get(t).parent}},{key:"getRowLevel",value:function(t){var e=null;return(e=isNaN(t)?t:this.getDataObject(t))?this.getRowObjectLevel(e):null}},{key:"getRowObjectLevel",value:function(t){return null==t?null:this.cache.nodeInfo.get(t).level}},{key:"hasChildren",value:function(t){var e=t;return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)}},{key:"isParent",value:function(t){var e=t;return isNaN(e)||(e=this.getDataObject(e)),!!(0,a.hasOwnProperty)(e,"__children")}},{key:"addChild",value:function(t,e){var n=e;this.hot.runHooks("beforeAddChild",t,n);var r=null;t&&(r=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(t)+1,1);var i=t;t||(i=this.mockParent()),i.__children||(i.__children=[]),n=n||this.mockNode(),i.__children.push(n),this.rewriteCache();var o=this.getRowIndex(n);this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",t,n)}},{key:"addChildAtIndex",value:function(t,e,n,r){var i=n;this.hot.runHooks("beforeAddChild",t,i,e),this.hot.runHooks("beforeCreateRow",r+1,1);var o=t;t||(o=this.mockParent()),o.__children||(o.__children=[]),i=i||this.mockNode(),o.__children.splice(e,null,i),this.rewriteCache(),this.hot.runHooks("afterCreateRow",r+1,1),this.hot.runHooks("afterAddChild",t,i,e)}},{key:"addSibling",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:"below",r=this.translateTrimmedRow(t),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null,t);break;case"above":this.addChildAtIndex(i,o,null,t)}}},{key:"detachFromParent",value:function(t,e){var n=this,r=!(1<arguments.length&&void 0!==e)||e,i=null,o=[];i=Array.isArray(t)?((0,d.rangeEach)(t[0],t[2],function(t){var e=n.translateTrimmedRow(t);o.push(n.getDataObject(e))}),(0,d.rangeEach)(0,o.length-2,function(t){n.detachFromParent(o[t],!1)}),o[o.length-1]):t;var a=this.getRowIndex(i),s=this.getRowIndexWithinParent(i),l=this.getRowParent(i),u=this.getRowParent(l),h=this.getRowIndex(u),c=null;this.hot.runHooks("beforeDetachChild",l,i),null!=s&&(this.hot.runHooks("beforeRemoveRow",a,1,[a],this.plugin.pluginName),l.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",a,1,[a],this.plugin.pluginName),u?(c=h+this.countChildren(u),this.hot.runHooks("beforeCreateRow",c,1,this.plugin.pluginName),u.__children.push(i)):(c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c,1,this.plugin.pluginName),this.data.push(i))),this.rewriteCache(),this.hot.runHooks("afterCreateRow",c,1,this.plugin.pluginName),r&&this.hot.render(),this.hot.runHooks("afterDetachChild",l,i)}},{key:"filterData",value:function(t,e,n){var r=this,i=[];(0,l.arrayEach)(n,function(t){i.push(r.getDataObject(t))}),(0,l.arrayEach)(i,function(t){var e=r.getRowIndexWithinParent(t),n=r.getRowParent(t);null===n?r.data.splice(e,1):n.__children.splice(e,1)}),this.rewriteCache()}},{key:"spliceData",value:function(t,e,n){var r=this.translateTrimmedRow(t);if(null!=r){var i=this.getDataObject(r-1),o=null,a=null;a=i&&i.__children&&0===i.__children.length?(o=i,0):(o=this.getRowParent(r),this.getRowIndexWithinParent(r)),o?n?o.__children.splice(a,e,n):o.__children.splice(a,e):n?this.data.splice(a,e,n):this.data.splice(a,e),this.rewriteCache()}}},{key:"moveRow",value:function(t,e){var n=this.isParent(e),r=this.getRowParent(t),i=this.getRowIndexWithinParent(t),o=this.getRowParent(e);null==o&&(o=this.getRowParent(e-1)),null==o&&(o=this.getDataObject(e-1)),o?o.__children||(o.__children=[]):(o=this.getDataObject(e)).__children=[];var a=this.getRowParent(e-1),s=n?this.countChildren(a):this.getRowIndexWithinParent(e),l=r.__children.slice(i,i+1);r.__children.splice(i,1),o.__children.splice(s,0,l[0])}},{key:"moveCellMeta",value:function(t,e){var n=this.hot.getCellMetaAtRow(t);this.hot.spliceCellsMeta(e,0,n),this.hot.spliceCellsMeta(t+(t<e?0:1),1)}},{key:"translateTrimmedRow",value:function(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}}]),h);function h(t,e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),this.hot=e,this.data=n,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},this.recordTranslator=(0,s.getTranslator)(this.hot)}e.default=u},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(12),h=n(0),a=n(4),s=n(2),l=c(n(168)),u=c(n(238));function c(t){return t&&t.__esModule?t:{default:t}}var d=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(f,l.default),r(f,[{key:"collapseChildren",value:function(t,e,n){var r,i=this,o=!(1<arguments.length&&void 0!==e)||e,a=!(2<arguments.length&&void 0!==n)||n,s=[],l=null,u=null;return u=isNaN(t)?(l=t,this.dataManager.getRowIndex(l)):(l=this.dataManager.getDataObject(t),t),this.dataManager.hasChildren(l)&&(0,h.arrayEach)(l.__children,function(t){s.push(i.dataManager.getRowIndex(t))}),r=this.collapseRows(s,!0,!1),a&&this.trimRowsPlugin.trimRows(r),o&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(u)&&this.collapsedRows.push(u),r}},{key:"collapseMultipleChildren",value:function(t,e,n){var r=this,i=!(1<arguments.length&&void 0!==e)||e,o=!(2<arguments.length&&void 0!==n)||n,a=[];(0,h.arrayEach)(t,function(t){a=a.concat(r.collapseChildren(t,!1,!1))}),o&&this.trimRowsPlugin.trimRows(a),i&&this.renderAndAdjust()}},{key:"collapseRow",value:function(t,e){var n=!(1<arguments.length&&void 0!==e)||e;this.collapseRows([t],n)}},{key:"collapseRows",value:function(t,e,n){var r=this,i=!(1<arguments.length&&void 0!==e)||e,o=2<arguments.length&&void 0!==n&&n,a=[];return(0,h.arrayEach)(t,function(t){a.push(t),i&&r.collapseChildRows(t,a)}),o&&this.trimRowsPlugin.trimRows(a),a}},{key:"collapseChildRows",value:function(t,e,n,r){var i=1<arguments.length&&void 0!==e?e:[],o=this,a=3<arguments.length&&void 0!==r&&r;if(this.dataManager.hasChildren(t)){var s=this.dataManager.getDataObject(t);(0,h.arrayEach)(s.__children,function(t){var e=o.dataManager.getRowIndex(t);i.push(e),o.collapseChildRows(e,i)})}a&&this.trimRowsPlugin.trimRows(i)}},{key:"expandRow",value:function(t,e){var n=!(1<arguments.length&&void 0!==e)||e;this.expandRows([t],n)}},{key:"expandRows",value:function(t,e,n){var r=this,i=!(1<arguments.length&&void 0!==e)||e,o=2<arguments.length&&void 0!==n&&n,a=[];return(0,h.arrayEach)(t,function(t){a.push(t),i&&r.expandChildRows(t,a)}),o&&this.trimRowsPlugin.untrimRows(a),a}},{key:"expandChildRows",value:function(t,e,n,r){var i=1<arguments.length&&void 0!==e?e:[],o=this,a=3<arguments.length&&void 0!==r&&r;if(this.dataManager.hasChildren(t)){var s=this.dataManager.getDataObject(t);(0,h.arrayEach)(s.__children,function(t){if(!o.isAnyParentCollapsed(t)){var e=o.dataManager.getRowIndex(t);i.push(e),o.expandChildRows(e,i)}})}a&&this.trimRowsPlugin.untrimRows(i)}},{key:"expandChildren",value:function(t,e,n){var r,i=this,o=!(1<arguments.length&&void 0!==e)||e,a=!(2<arguments.length&&void 0!==n)||n,s=[],l=null,u=null;return u=isNaN(t)?(l=t,this.dataManager.getRowIndex(t)):(l=this.dataManager.getDataObject(t),t),this.collapsedRows.splice(this.collapsedRows.indexOf(u),1),this.dataManager.hasChildren(l)&&(0,h.arrayEach)(l.__children,function(t){var e=i.dataManager.getRowIndex(t);s.push(e)}),r=this.expandRows(s,!0,!1),a&&this.trimRowsPlugin.untrimRows(r),o&&this.renderAndAdjust(),r}},{key:"expandMultipleChildren",value:function(t,e,n){var r=this,i=!(1<arguments.length&&void 0!==e)||e,o=!(2<arguments.length&&void 0!==n)||n,a=[];(0,h.arrayEach)(t,function(t){a=a.concat(r.expandChildren(t,!1,!1))}),o&&this.trimRowsPlugin.untrimRows(a),i&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var e=this,t=this.hot.getSourceData(),n=[];(0,h.arrayEach)(t,function(t){e.dataManager.hasChildren(t)&&n.push(t)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}},{key:"expandAll",value:function(){var e=this,t=this.hot.getSourceData(),n=[];(0,h.arrayEach)(t,function(t){e.dataManager.hasChildren(t)&&n.push(t)}),this.expandMultipleChildren(n),this.renderAndAdjust()}},{key:"areChildrenCollapsed",value:function(t){var n=this,e=null,r=!0;return e=isNaN(t)?t:this.dataManager.getDataObject(t),this.dataManager.hasChildren(e)&&(0,h.arrayEach)(e.__children,function(t){var e=n.dataManager.getRowIndex(t);if(!n.trimRowsPlugin.isTrimmed(e))return r=!1}),r}},{key:"isAnyParentCollapsed",value:function(t){for(var e=t;null!==e;){e=this.dataManager.getRowParent(e);var n=this.dataManager.getRowIndex(e);if(-1<this.collapsedRows.indexOf(n))return!0}return!1}},{key:"toggleState",value:function(t,e){if(!(0<=e.col)){var n=this.translateTrimmedRow(e.row);(0,s.hasClass)(t.target,u.default.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),(0,o.stopImmediatePropagation)(t))}}},{key:"translateTrimmedRow",value:function(t){return this.trimRowsPlugin.rowsMapper.getValueByIndex(t)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize()}}]),f);function f(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,t,e));return i.trimRowsPlugin=t.trimRowsPlugin,i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,!1)},shiftStash:function(t,e){var n=1<arguments.length&&void 0!==e?e:1,r=i.translateTrimmedRow(t);(0,h.arrayEach)(i.lastCollapsedRows,function(t,e){r-1<t&&(i.lastCollapsedRows[e]=t+n)})},applyStash:function(){i.hot.runHooks("skipLengthCache",100),i.collapseMultipleChildren(i.lastCollapsedRows,!0),i.lastCollapsedRows=void 0},trimStash:function(t,e){(0,a.rangeEach)(t,t+e-1,function(t){var e=i.lastCollapsedRows.indexOf(t);-1<e&&i.lastCollapsedRows.splice(e,1)})}},i}e.default=d},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(4),s=n(0),l=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3)),u=n(168),h=(o=u)&&o.__esModule?o:{default:o};var c=new WeakMap,d=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(f,h.default),r(f,[{key:"appendOptions",value:function(r){var n=this,t=[{key:"add_child",name:function(){return this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:function(){var t=n.dataManager.translateTrimmedRow(n.hot.getSelectedLast()[0]),e=n.dataManager.getDataObject(t);n.dataManager.addChild(e)},disabled:function(){var t=n.hot.getSelectedLast();return!t||t[0]<0||n.hot.selection.isSelectedByColumnHeader()||n.hot.countRows()>=n.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(l.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:function(){n.dataManager.detachFromParent(n.hot.getSelectedLast())},disabled:function(){var t=n.hot.getSelectedLast(),e=n.dataManager.translateTrimmedRow(t[0]);return!n.dataManager.getRowParent(e)||!t||t[0]<0||n.hot.selection.isSelectedByColumnHeader()||n.hot.countRows()>=n.hot.getSettings().maxRows}},{name:"---------"}];return(0,a.rangeEach)(0,r.items.length-1,function(n){if(0===n)return(0,s.arrayEach)(t,function(t,e){r.items.splice(n+e,0,t)}),!1}),this.modifyRowInsertingOptions(r)}},{key:"modifyRowInsertingOptions",value:function(n){var r=c.get(this);return(0,a.rangeEach)(0,n.items.length-1,function(t){var e=r[n.items[t].key];null!=e&&(n.items[t].callback=e)}),n}}]),f);function f(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,t,e));return c.set(n,{row_above:function(t,e){n.dataManager.addSibling(e.start.row,"above")},row_below:function(t,e){n.dataManager.addSibling(e.start.row,"below")}}),n.dataManager=n.plugin.dataManager,n}e.default=d},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t};function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var s=g(n(7)),l=n(2),u=n(4),h=n(0),c=n(5),d=n(45),f=g(n(477)),p=g(n(478));function g(t){return t&&t.__esModule?t:{default:t}}n(479);var v=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(m,s.default),i(m,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenColumns}},{key:"enablePlugin",value:function(){var r=this;this.enabled||(this.hot.hasColHeaders()?this.addHook("afterGetColHeader",function(t,e){return r.onAfterGetColHeader(t,e)}):this.addHook("afterRenderer",function(t,e,n){return r.onAfterGetColHeader(n,t)}),this.addHook("afterContextMenuDefaultOptions",function(t){return r.onAfterContextMenuDefaultOptions(t)}),this.addHook("afterGetCellMeta",function(t,e,n){return r.onAfterGetCellMeta(t,e,n)}),this.addHook("modifyColWidth",function(t,e){return r.onModifyColWidth(t,e)}),this.addHook("beforeSetRangeStartOnly",function(t){return r.onBeforeSetRangeStart(t)}),this.addHook("beforeSetRangeEnd",function(t){return r.onBeforeSetRangeEnd(t)}),this.addHook("hiddenColumn",function(t){return r.isHidden(t)}),this.addHook("beforeStretchingColumnWidth",function(t,e){return r.onBeforeStretchingColumnWidth(t,e)}),this.addHook("afterCreateCol",function(t,e){return r.onAfterCreateCol(t,e)}),this.addHook("afterRemoveCol",function(t,e){return r.onAfterRemoveCol(t,e)}),this.hot.view&&this.onAfterPluginsInitialized(),a(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),a(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.settings={},this.hiddenColumns=[],this.lastSelectedColumn=-1,this.hot.render(),a(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(t){var n=this;(0,h.arrayEach)(t,function(t){var e=parseInt(t,10);e=n.getLogicalColumnIndex(e),n.isHidden(e,!0)&&n.hiddenColumns.splice(n.hiddenColumns.indexOf(e),1)})}},{key:"showColumn",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showColumns(e)}},{key:"hideColumns",value:function(t){var n=this;(0,h.arrayEach)(t,function(t){var e=parseInt(t,10);e=n.getLogicalColumnIndex(e),n.isHidden(e,!0)||n.hiddenColumns.push(e)})}},{key:"hideColumn",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideColumns(e)}},{key:"isHidden",value:function(t,e){var n=t;return 1<arguments.length&&void 0!==e&&e||(n=this.getLogicalColumnIndex(n)),-1<this.hiddenColumns.indexOf(n)}},{key:"resetCellsMeta",value:function(){(0,h.arrayEach)(this.hot.getCellsMeta(),function(t){t&&(t.skipColumnOnPaste=!1,null!==t.baseRenderer&&(t.renderer=t.baseRenderer,t.baseRenderer=null))})}},{key:"getLogicalColumnIndex",value:function(t){return this.hot.runHooks("modifyCol",t)}},{key:"onBeforeStretchingColumnWidth",value:function(t,e){var n=t;return this.isHidden(e)&&(n=0),n}},{key:"onModifyColWidth",value:function(t,e){return this.isHidden(e)?.1:this.settings.indicators&&(this.isHidden(e+1)||this.isHidden(e-1))?t+(this.hot.hasColHeaders()?15:0):void 0}},{key:"onAfterGetCellMeta",value:function(t,e,n){var r=this.hot.runHooks("unmodifyCol",e);if(!1===this.settings.copyPasteEnabled&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(r)?(n.renderer!==y&&(n.baseRenderer=n.renderer),n.renderer=y):null!==n.baseRenderer&&(n.renderer=n.baseRenderer,n.baseRenderer=null),this.isHidden(n.visualCol-1)){var i=!0,o=n.visualCol-1;n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");do{if(!this.isHidden(o)){i=!1;break}o-=1}while(0<=o);i&&-1===n.className.indexOf("firstVisibleColumn")&&(n.className+=" firstVisibleColumn")}else if(n.className){var a=n.className.split(" ");if(a.length){var s=a.indexOf("afterHiddenColumn");-1<s&&a.splice(s,1);var l=a.indexOf("firstVisibleColumn");-1<l&&a.splice(l,1),n.className=a.join(" ")}}}},{key:"onModifyCopyableRange",value:function(t){function i(t,e,n,r){a.push({startRow:t,endRow:e,startCol:n,endCol:r})}var o=this,a=[];return(0,h.arrayEach)(t,function(e){var n=!0,r=0;(0,u.rangeEach)(e.startCol,e.endCol,function(t){n=o.isHidden(t)?(n||i(e.startRow,e.endRow,r,t-1),!0):(n&&(r=t),t===e.endCol&&i(e.startRow,e.endRow,r,t),!1)})}),a}},{key:"onAfterGetColHeader",value:function(t,e){if(!this.isHidden(t)){var n=!0,r=t-1;do{if(!this.isHidden(r)){n=!1;break}r-=1}while(0<=r);n&&(0,l.addClass)(e,"firstVisibleColumn"),this.settings.indicators&&(this.isHidden(t-1)&&(0,l.addClass)(e,"afterHiddenColumn"),this.isHidden(t+1)&&-1<t&&(0,l.addClass)(e,"beforeHiddenColumn"))}}},{key:"onBeforeSetRangeStart",value:function(t){var i=this;0<t.col||(t.col=0,t.col=function t(e){var n=e,r=i.getLogicalColumnIndex(n);return i.isHidden(r,!0)&&(n=t(n+=1)),n}(t.col))}},{key:"onBeforeSetRangeEnd",value:function(i){var o=this,a=this.hot.countCols();i.col=function t(e){var n=e,r=o.getLogicalColumnIndex(n);return o.isHidden(r,!0)&&(o.lastSelectedColumn>n||i.col===a-1?0<n?n=t(n-=1):(0,u.rangeEach)(0,o.lastSelectedColumn,function(t){if(!o.isHidden(t))return n=t,!1}):n=t(n+=1)),n}(i.col),this.lastSelectedColumn=i.col}},{key:"onAfterContextMenuDefaultOptions",value:function(t){t.items.push({name:d.SEPARATOR},(0,f.default)(this),(0,p.default)(this))}},{key:"onAfterCreateCol",value:function(n,r){var i=[];(0,h.arrayEach)(this.hiddenColumns,function(t){var e=t;n<=e&&(e+=r),i.push(e)}),this.hiddenColumns=i}},{key:"onAfterRemoveCol",value:function(n,r){var i=[];(0,h.arrayEach)(this.hiddenColumns,function(t){var e=t;n<=e&&(e-=r),i.push(e)}),this.hiddenColumns=i}},{key:"onAfterPluginsInitialized",value:function(){var e=this,t=this.hot.getSettings().hiddenColumns;"object"===(void 0===t?"undefined":r(t))&&(void 0===(this.settings=t).copyPasteEnabled&&(t.copyPasteEnabled=!0),Array.isArray(t.columns)&&this.hideColumns(t.columns),t.copyPasteEnabled||this.addHook("modifyCopyableRange",function(t){return e.onModifyCopyableRange(t)}))}},{key:"destroy",value:function(){a(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"destroy",this).call(this)}}]),m);function m(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,m);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(m.__proto__||Object.getPrototypeOf(m)).call(this,t));return e.settings={},e.hiddenColumns=[],e.lastSelectedColumn=-1,e}function y(t,e){e.textContent=""}(0,c.registerPlugin)("hiddenColumns",v),e.default=v},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.default=function(o){return{key:"hidden_columns_hide",name:function(){var t=this.getSelectedLast(),e=0;if(Array.isArray(t)){var n=r(t,4);n[1]-n[3]!=0&&(e=1)}return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_HIDE_COLUMN,e)},callback:function(){var t=this.getSelectedRangeLast(),e=t.from,n=t.to,r=Math.min(e.col,n.col),i=Math.max(e.col,n.col);(0,a.rangeEach)(r,i,function(t){return o.hideColumn(t)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.isSelectedByColumnHeader()}}};var a=n(4),i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3))},function(t,e,n){"use strict";e.__esModule=!0;var h=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.default=function(s){var l=[],u=[];return{key:"hidden_columns_show",name:function(){var t=this.getSelectedLast(),e=0;if(Array.isArray(t)){var n=h(t,4),r=n[1],i=n[3];if(i<r){var o=[i,r];r=o[0],i=o[1]}var a=0;r===i?a=l.length+u.length:(0,c.rangeEach)(r,i,function(t){s.isHidden(t)&&(a+=1)}),e=a<=1?0:1}return this.getTranslatedPhrase(d.CONTEXTMENU_ITEMS_SHOW_COLUMN,e)},callback:function(){var t=this.getSelectedRangeLast(),e=t.from,n=t.to,r=Math.min(e.col,n.col),i=Math.max(e.col,n.col);r===i?(l.length===r&&(s.showColumns(l),l.length=0),u.length===this.countSourceCols()-(r+1)&&(s.showColumns(u),u.length=0)):(0,c.rangeEach)(r,i,function(t){return s.showColumn(t)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){if(!s.hiddenColumns.length||!this.selection.isSelectedByColumnHeader())return!0;l.length=0,u.length=0;var t=this.getSelectedRangeLast(),e=t.from,n=t.to,r=Math.min(e.col,n.col),i=Math.max(e.col,n.col),o=!1;if(r===i){var a=this.countSourceCols();(0,c.rangeEach)(0,a,function(t){if(l.length+u.length===s.hiddenColumns.length)return!1;t<r&&s.isHidden(t)?l.push(t):s.isHidden(t)&&u.push(t)}),a-=1,(l.length===r&&0<r||u.length===a-r&&r<a)&&(o=!0)}else(0,c.rangeEach)(r,i,function(t){if(s.isHidden(t))return!(o=!0)});return!o}}};var c=n(4),d=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3))},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t};function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var s=p(n(7)),l=n(2),u=n(4),h=n(0),c=n(5),d=p(n(481)),f=p(n(482));function p(t){return t&&t.__esModule?t:{default:t}}n(483);var g=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(v,s.default),i(v,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenRows}},{key:"enablePlugin",value:function(){var r=this;this.enabled||(this.hot.hasRowHeaders()?this.addHook("afterGetRowHeader",function(t,e){return r.onAfterGetRowHeader(t,e)}):this.addHook("afterRenderer",function(t,e){return r.onAfterGetRowHeader(e,t)}),this.addHook("afterContextMenuDefaultOptions",function(t){return r.onAfterContextMenuDefaultOptions(t)}),this.addHook("afterGetCellMeta",function(t,e,n){return r.onAfterGetCellMeta(t,e,n)}),this.addHook("modifyRowHeight",function(t,e){return r.onModifyRowHeight(t,e)}),this.addHook("beforeSetRangeStartOnly",function(t){return r.onBeforeSetRangeStartOnly(t)}),this.addHook("beforeSetRangeStart",function(t){return r.onBeforeSetRangeStart(t)}),this.addHook("beforeSetRangeEnd",function(t){return r.onBeforeSetRangeEnd(t)}),this.addHook("hiddenRow",function(t){return r.isHidden(t)}),this.addHook("afterCreateRow",function(t,e){return r.onAfterCreateRow(t,e)}),this.addHook("afterRemoveRow",function(t,e){return r.onAfterRemoveRow(t,e)}),this.hot.view&&this.onAfterPluginsInitialized(),a(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),a(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.settings={},this.hiddenRows=[],this.lastSelectedRow=-1,a(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(t){var n=this;(0,h.arrayEach)(t,function(t){var e=parseInt(t,10);e=n.getLogicalRowIndex(e),n.isHidden(e,!0)&&n.hiddenRows.splice(n.hiddenRows.indexOf(e),1)})}},{key:"showRow",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showRows(e)}},{key:"hideRows",value:function(t){var n=this;(0,h.arrayEach)(t,function(t){var e=parseInt(t,10);e=n.getLogicalRowIndex(e),n.isHidden(e,!0)||n.hiddenRows.push(e)})}},{key:"hideRow",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideRows(e)}},{key:"isHidden",value:function(t,e){var n=t;return 1<arguments.length&&void 0!==e&&e||(n=this.getLogicalRowIndex(n)),-1<this.hiddenRows.indexOf(n)}},{key:"resetCellsMeta",value:function(){(0,h.arrayEach)(this.hot.getCellsMeta(),function(t){t&&(t.skipRowOnPaste=!1)})}},{key:"getLogicalRowIndex",value:function(t){return this.hot.runHooks("modifyRow",t)}},{key:"onAfterGetCellMeta",value:function(t,e,n){var r=this.hot.runHooks("unmodifyRow",t);if(!1===this.settings.copyPasteEnabled&&this.isHidden(r)?n.skipRowOnPaste=!0:n.skipRowOnPaste=!1,this.isHidden(r-1)){var i=!0,o=r-1;n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");do{if(!this.isHidden(o)){i=!1;break}o-=1}while(0<=o);i&&-1===n.className.indexOf("firstVisibleRow")&&(n.className+=" firstVisibleRow")}else if(n.className){var a=n.className.split(" ");if(a.length){var s=a.indexOf("afterHiddenRow");-1<s&&a.splice(s,1);var l=a.indexOf("firstVisibleRow");-1<l&&a.splice(l,1),n.className=a.join(" ")}}}},{key:"onAfterGetRowHeader",value:function(t,e){var n=e.parentNode;n&&(this.isHidden(t)?(0,l.addClass)(n,"hide"):(0,l.removeClass)(n,"hide"));var r=!0,i=t-1;do{if(!this.isHidden(i)){r=!1;break}i-=1}while(0<=i);r&&(0,l.addClass)(e,"firstVisibleRow"),this.settings.indicators&&this.hot.hasRowHeaders()&&(this.isHidden(t-1)&&(0,l.addClass)(e,"afterHiddenRow"),this.isHidden(t+1)&&(0,l.addClass)(e,"beforeHiddenRow"))}},{key:"onModifyRowHeight",value:function(t,e){return this.isHidden(e)?.1:t}},{key:"onModifyCopyableRange",value:function(t){function i(t,e,n,r){a.push({startRow:t,endRow:e,startCol:n,endCol:r})}var o=this,a=[];return(0,h.arrayEach)(t,function(e){var n=!0,r=0;(0,u.rangeEach)(e.startRow,e.endRow,function(t){n=o.isHidden(t)?(n||i(r,t-1,e.startCol,e.endCol),!0):(n&&(r=t),t===e.endRow&&i(r,t,e.startCol,e.endCol),!1)})}),a}},{key:"onBeforeSetRangeStart",value:function(t){var i=this,o=this.hot.getSelectedLast()||!1,a=this.hot.countRows()-1;t.row=function t(e){var n=0,r=e;return o&&(n=o[0]<r?1:-1,i.lastSelectedRow=o[0]),a<r||r<0?i.lastSelectedRow:(i.isHidden(r)&&(r=t(r+n)),r)}(t.row)}},{key:"onBeforeSetRangeStartOnly",value:function(t){var r=this;0<t.row||(t.row=0,t.row=function t(e){var n=e;return r.isHidden(n)&&(n=t(n+=1)),n}(t.row))}},{key:"onBeforeSetRangeEnd",value:function(r){var i=this,o=this.hot.countRows();r.row=function t(e){var n=e;return i.isHidden(n)&&(i.lastSelectedRow>n||r.row===o-1?0<n?n=t(n-=1):(0,u.rangeEach)(0,i.lastSelectedRow,function(t){if(!i.isHidden(t))return n=t,!1}):n=t(n+=1)),n}(r.row),this.lastSelectedRow=r.row}},{key:"onAfterContextMenuDefaultOptions",value:function(t){t.items.push({name:"---------"},(0,d.default)(this),(0,f.default)(this))}},{key:"onAfterCreateRow",value:function(n,r){var i=[];(0,h.arrayEach)(this.hiddenRows,function(t){var e=t;n<=e&&(e+=r),i.push(e)}),this.hiddenRows=i}},{key:"onAfterRemoveRow",value:function(n,r){var i=[];(0,h.arrayEach)(this.hiddenRows,function(t){var e=t;n<=e&&(e-=r),i.push(e)}),this.hiddenRows=i}},{key:"onAfterPluginsInitialized",value:function(){var e=this,t=this.hot.getSettings().hiddenRows;"object"===(void 0===t?"undefined":r(t))&&(void 0===(this.settings=t).copyPasteEnabled&&(t.copyPasteEnabled=!0),Array.isArray(t.rows)&&this.hideRows(t.rows),t.copyPasteEnabled||this.addHook("modifyCopyableRange",function(t){return e.onModifyCopyableRange(t)}))}},{key:"destroy",value:function(){a(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"destroy",this).call(this)}}]),v);function v(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,t));return e.settings={},e.hiddenRows=[],e.lastSelectedRow=-1,e}(0,c.registerPlugin)("hiddenRows",g),e.default=g},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.default=function(o){return{key:"hidden_rows_hide",name:function(){var t=this.getSelectedLast(),e=0;if(Array.isArray(t)){var n=r(t,3);n[0]-n[2]!=0&&(e=1)}return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_HIDE_ROW,e)},callback:function(){var t=this.getSelectedRangeLast(),e=t.from,n=t.to,r=Math.min(e.row,n.row),i=Math.max(e.row,n.row);(0,a.rangeEach)(r,i,function(t){return o.hideRow(t)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.isSelectedByRowHeader()}}};var a=n(4),i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3))},function(t,e,n){"use strict";e.__esModule=!0;var h=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.default=function(s){var l=[],u=[];return{key:"hidden_rows_show",name:function(){var t=this.getSelectedLast(),e=0;if(Array.isArray(t)){var n=h(t,3),r=n[0],i=n[2];if(i<r){var o=[i,r];r=o[0],i=o[1]}var a=0;r===i?a=l.length+u.length:(0,c.rangeEach)(r,i,function(t){s.isHidden(t)&&(a+=1)}),e=a<=1?0:1}return this.getTranslatedPhrase(d.CONTEXTMENU_ITEMS_SHOW_ROW,e)},callback:function(){var t=this.getSelectedRangeLast(),e=t.from,n=t.to,r=Math.min(e.row,n.row),i=Math.max(e.row,n.row);r===i?(l.length===r&&(s.showRows(l),l.length=0),u.length===this.countSourceRows()-(r+1)&&(s.showRows(u),u.length=0)):(0,c.rangeEach)(r,i,function(t){return s.showRow(t)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){if(!s.hiddenRows.length||!this.selection.isSelectedByRowHeader())return!0;l.length=0,u.length=0;var t=this.getSelectedRangeLast(),e=t.from,n=t.to,r=Math.min(e.row,n.row),i=Math.max(e.row,n.row),o=!1;if(r===i){var a=this.countSourceRows();(0,c.rangeEach)(0,a,function(t){if(l.length+u.length===s.hiddenRows.length)return!1;t<r?s.isHidden(t)&&l.push(t):s.isHidden(t)&&u.push(t)}),a-=1,(l.length===r&&0<r||u.length===a-r&&r<a)&&(o=!0)}else(0,c.rangeEach)(r,i,function(t){if(s.isHidden(t))return!(o=!0)});return!o}}};var c=n(4),d=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(n(3))},function(t,e){},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:a(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}var o=c(n(7)),s=n(0),l=n(4),u=n(5),h=c(n(485));function c(t){return t&&t.__esModule?t:{default:t}}var d=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(f,o.default),r(f,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().trimRows}},{key:"enablePlugin",value:function(){var r=this;if(!this.enabled){var t=this.hot.getSettings().trimRows;Array.isArray(t)&&(this.trimmedRows=t),this.rowsMapper.createMap(this.hot.countSourceRows()),this.addHook("modifyRow",function(t,e){return r.onModifyRow(t,e)}),this.addHook("unmodifyRow",function(t,e){return r.onUnmodifyRow(t,e)}),this.addHook("beforeCreateRow",function(t,e,n){return r.onBeforeCreateRow(t,e,n)}),this.addHook("afterCreateRow",function(t,e){return r.onAfterCreateRow(t,e)}),this.addHook("beforeRemoveRow",function(t,e){return r.onBeforeRemoveRow(t,e)}),this.addHook("afterRemoveRow",function(){return r.onAfterRemoveRow()}),this.addHook("afterLoadData",function(t){return r.onAfterLoadData(t)}),a(f.prototype.__proto__||Object.getPrototypeOf(f.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().trimRows;Array.isArray(t)&&(this.disablePlugin(),this.enablePlugin()),a(f.prototype.__proto__||Object.getPrototypeOf(f.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.trimmedRows=[],this.removedRows.length=0,this.rowsMapper.clearMap(),a(f.prototype.__proto__||Object.getPrototypeOf(f.prototype),"disablePlugin",this).call(this)}},{key:"trimRows",value:function(t){var n=this;(0,s.arrayEach)(t,function(t){var e=parseInt(t,10);n.isTrimmed(e)||n.trimmedRows.push(e)}),this.hot.runHooks("skipLengthCache",100),this.rowsMapper.createMap(this.hot.countSourceRows()),this.hot.runHooks("afterTrimRow",t)}},{key:"trimRow",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.trimRows(e)}},{key:"untrimRows",value:function(t){var n=this;(0,s.arrayEach)(t,function(t){var e=parseInt(t,10);n.isTrimmed(e)&&n.trimmedRows.splice(n.trimmedRows.indexOf(e),1)}),this.hot.runHooks("skipLengthCache",100),this.rowsMapper.createMap(this.hot.countSourceRows()),this.hot.runHooks("afterUntrimRow",t)}},{key:"untrimRow",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.untrimRows(e)}},{key:"isTrimmed",value:function(t){return-1<this.trimmedRows.indexOf(t)}},{key:"untrimAll",value:function(){this.untrimRows([].concat(this.trimmedRows))}},{key:"onModifyRow",value:function(t,e){var n=t;return e!==this.pluginName&&(n=this.rowsMapper.getValueByIndex(n)),n}},{key:"onUnmodifyRow",value:function(t,e){var n=t;return e!==this.pluginName&&(n=this.rowsMapper.getIndexByValue(n)),n}},{key:"onBeforeCreateRow",value:function(t,e,n){return!(this.isEnabled()&&0<this.trimmedRows.length&&"auto"===n)}},{key:"onAfterCreateRow",value:function(t,e){this.rowsMapper.shiftItems(t,e)}},{key:"onBeforeRemoveRow",value:function(t,e){var n=this;this.removedRows.length=0,!1!==t&&(0,l.rangeEach)(t,t+e-1,function(t){n.removedRows.push(n.hot.runHooks("modifyRow",t,n.pluginName))})}},{key:"onAfterRemoveRow",value:function(){this.rowsMapper.unshiftItems(this.removedRows)}},{key:"onAfterLoadData",value:function(t){t||this.rowsMapper.createMap(this.hot.countSourceRows())}},{key:"destroy",value:function(){this.rowsMapper.destroy(),a(f.prototype.__proto__||Object.getPrototypeOf(f.prototype),"destroy",this).call(this)}}]),f);function f(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,t));return e.trimmedRows=[],e.removedRows=[],e.rowsMapper=new h.default(e),e}(0,u.registerPlugin)("trimRows",d),e.default=d},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,a=n(56),s=(o=a)&&o.__esModule?o:{default:o},l=n(1),u=n(4);var h=(r(c,[{key:"createMap",value:function(t){var e=this,n=0,r=void 0===t?this._arrayMap.length:t;(this._arrayMap.length=0,u.rangeEach)(r-1,function(t){e.trimRows.isTrimmed(t)?n+=1:e._arrayMap[t-n]=t})}},{key:"destroy",value:function(){this._arrayMap=null}}]),c);function c(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),this.trimRows=t}(0,l.mixin)(h,s.default),e.default=h}],a.c=l,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=239)).default;function a(t){if(l[t])return l[t].exports;var e=l[t]={i:t,l:!1,exports:{}};return s[t].call(e.exports,e,e.exports,a),e.l=!0,e.exports}var s,l}),function(){var a;window.AmCharts?a=window.AmCharts:(a={},(window.AmCharts=a).themes={},a.maps={},a.inheriting={},a.charts=[],a.onReadyArray=[],a.useUTC=!1,a.updateRate=60,a.uid=0,a.lang={},a.translations={},a.mapTranslations={},a.windows={},a.initHandlers=[],a.amString="am",a.pmString="pm"),a.Class=function(t){function e(){arguments[0]!==a.inheriting&&(this.events={},this.construct.apply(this,arguments))}for(var n in t.inherits?(e.prototype=new t.inherits(a.inheriting),e.base=t.inherits.prototype,delete t.inherits):(e.prototype.createEvents=function(){for(var t=0;t<arguments.length;t++)this.events[arguments[t]]=[]},e.prototype.listenTo=function(t,e,n){this.removeListener(t,e,n),t.events[e].push({handler:n,scope:this})},e.prototype.addListener=function(t,e,n){this.removeListener(this,t,e),t&&this.events[t]&&this.events[t].push({handler:e,scope:n})},e.prototype.removeListener=function(t,e,n){if(t&&t.events&&(t=t.events[e]))for(e=t.length-1;0<=e;e--)t[e].handler===n&&t.splice(e,1)},e.prototype.fire=function(t){for(var e=this.events[t.type],n=0;n<e.length;n++){var r=e[n];r.handler.call(r.scope,t)}}),t)e.prototype[n]=t[n];return e},a.addChart=function(t){window.requestAnimationFrame?a.animationRequested||(a.animationRequested=!0,window.requestAnimationFrame(a.update)):a.updateInt||(a.updateInt=setInterval(function(){a.update()},Math.round(1e3/a.updateRate))),a.charts.push(t)},a.removeChart=function(t){for(var e=a.charts,n=e.length-1;0<=n;n--)e[n]==t&&e.splice(n,1);0===e.length&&(a.requestAnimation&&(window.cancelAnimationFrame(a.requestAnimation),a.animationRequested=!1),a.updateInt&&(clearInterval(a.updateInt),a.updateInt=NaN))},a.isModern=!0,a.getIEVersion=function(){var t,e=0;return"Microsoft Internet Explorer"==navigator.appName&&(t=navigator.userAgent,null!==/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(t)&&(e=parseFloat(RegExp.$1))),e},a.applyLang=function(t,e){var n=a.translations;e.dayNames=a.extend({},a.dayNames),e.shortDayNames=a.extend({},a.shortDayNames),e.monthNames=a.extend({},a.monthNames),e.shortMonthNames=a.extend({},a.shortMonthNames),e.amString="am",e.pmString="pm",(n=n&&n[t])&&(a.lang=n,(e.langObj=n).monthNames&&(e.dayNames=a.extend({},n.dayNames),e.shortDayNames=a.extend({},n.shortDayNames),e.monthNames=a.extend({},n.monthNames),e.shortMonthNames=a.extend({},n.shortMonthNames)),n.am&&(e.amString=n.am),n.pm&&(e.pmString=n.pm)),a.amString=e.amString,a.pmString=e.pmString},a.IEversion=a.getIEVersion(),a.IEversion<9&&0<a.IEversion&&(a.isModern=!1,a.isIE=!0),a.dx=0,a.dy=0,(document.addEventListener||window.opera)&&(a.isNN=!0,a.isIE=!1,a.dx=.5,a.dy=.5),document.attachEvent&&(a.isNN=!1,a.isIE=!0,a.isModern||(a.dx=0,a.dy=0)),window.chrome&&(a.chrome=!0),a.handleMouseUp=function(t){for(var e=a.charts,n=0;n<e.length;n++){var r=e[n];r&&r.handleReleaseOutside&&r.handleReleaseOutside(t)}},a.handleMouseMove=function(t){for(var e=a.charts,n=0;n<e.length;n++){var r=e[n];r&&r.handleMouseMove&&r.handleMouseMove(t)}},a.handleKeyUp=function(t){for(var e=a.charts,n=0;n<e.length;n++){var r=e[n];r&&r.handleKeyUp&&r.handleKeyUp(t)}},a.handleWheel=function(t){for(var e=a.charts,n=0;n<e.length;n++){var r=e[n];if(r&&r.mouseIsOver){(r.mouseWheelScrollEnabled||r.mouseWheelZoomEnabled)&&r.handleWheel&&(r.handleMouseMove(t),r.handleWheel(t));break}}},a.resetMouseOver=function(){for(var t=a.charts,e=0;e<t.length;e++){var n=t[e];n&&(n.mouseIsOver=!1)}},a.ready=function(t){a.onReadyArray.push(t)},a.handleLoad=function(){a.isReady=!0;for(var t=a.onReadyArray,e=0;e<t.length;e++){var n=t[e];isNaN(a.processDelay)?n():setTimeout(n,a.processDelay*e)}a.onReadyArray=[]},a.addInitHandler=function(t,e){a.initHandlers.push({method:t,types:e})},a.callInitHandler=function(t){var e=a.initHandlers;if(a.initHandlers)for(var n=0;n<e.length;n++){var r=e[n];r.types?a.isInArray(r.types,t.type)&&r.method(t):r.method(t)}},a.getUniqueId=function(){return a.uid++,"AmChartsEl-"+a.uid},a.addGlobalListeners=function(){a.globalListenersAdded||(a.globalListenersAdded=!0,a.isNN&&(document.addEventListener("mousemove",a.handleMouseMove),document.addEventListener("keyup",a.handleKeyUp),document.addEventListener("mouseup",a.handleMouseUp,!0),window.addEventListener("load",a.handleLoad,!0)),a.isIE&&(document.attachEvent("onmousemove",a.handleMouseMove),document.attachEvent("onmouseup",a.handleMouseUp),window.attachEvent("onload",a.handleLoad)))},a.addGlobalListeners(),a.addWheelListeners=function(){a.wheelIsListened||(a.isNN&&(window.addEventListener("DOMMouseScroll",a.handleWheel,!0),document.addEventListener("mousewheel",a.handleWheel,!0)),a.isIE&&document.attachEvent("onmousewheel",a.handleWheel)),a.wheelIsListened=!0},a.clear=function(){var t=a.charts;if(t)for(var e=t.length-1;0<=e;e--)t[e].clear();a.updateInt&&clearInterval(a.updateInt),a.requestAnimation&&window.cancelAnimationFrame(a.requestAnimation),a.charts=[],a.isNN&&(document.removeEventListener("mousemove",a.handleMouseMove,!0),document.removeEventListener("keyup",a.handleKeyUp,!0),document.removeEventListener("mouseup",a.handleMouseUp,!0),window.removeEventListener("load",a.handleLoad,!0),window.removeEventListener("DOMMouseScroll",a.handleWheel,!0),document.removeEventListener("mousewheel",a.handleWheel,!0)),a.isIE&&(document.detachEvent("onmousemove",a.handleMouseMove),document.detachEvent("onmouseup",a.handleMouseUp),window.detachEvent("onload",a.handleLoad)),a.globalListenersAdded=!1,a.wheelIsListened=!1},a.makeChart=function(t,e,n){var r,i=e.type,o=e.theme;switch(a.addGlobalListeners(),a.isString(o)&&(o=a.themes[o],e.theme=o),i){case"serial":r=new a.AmSerialChart(o);break;case"xy":r=new a.AmXYChart(o);break;case"pie":r=new a.AmPieChart(o);break;case"radar":r=new a.AmRadarChart(o);break;case"gauge":r=new a.AmAngularGauge(o);break;case"funnel":r=new a.AmFunnelChart(o);break;case"map":r=new a.AmMap(o);break;case"stock":r=new a.AmStockChart(o);break;case"gantt":r=new a.AmGanttChart(o)}return a.extend(r,e),a.isReady?isNaN(n)?r.write(t):setTimeout(function(){a.realWrite(r,t)},n):a.ready(function(){isNaN(n)?r.write(t):setTimeout(function(){a.realWrite(r,t)},n)}),r},a.realWrite=function(t,e){t.write(e)},a.updateCount=0,a.validateAt=Math.round(a.updateRate/10),a.update=function(){var t=a.charts;a.updateCount++;var e=!1;if(a.updateCount==a.validateAt&&(e=!0,a.updateCount=0),t)for(var n=t.length-1;0<=n;n--)t[n].update&&t[n].update(),e&&(t[n].autoResize?t[n].validateSize&&t[n].validateSize():t[n].premeasure&&t[n].premeasure());window.requestAnimationFrame&&(a.requestAnimation=window.requestAnimationFrame(a.update))},"complete"==document.readyState&&a.handleLoad()}(),function(){var c=window.AmCharts;c.toBoolean=function(t,e){if(void 0===t)return e;switch(String(t).toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return!!t}},c.removeFromArray=function(t,e){var n;if(void 0!==e&&void 0!==t)for(n=t.length-1;0<=n;n--)t[n]==e&&t.splice(n,1)},c.getPath=function(){var t=document.getElementsByTagName("script");if(t)for(var e=0;e<t.length;e++){var n=t[e].src;if(-1!==n.search(/\/(amcharts|ammap)\.js/))return n.replace(/\/(amcharts|ammap)\.js.*/,"/")}},c.normalizeUrl=function(t){return""!==t&&-1===t.search(/\/$/)?t+"/":t},c.isAbsolute=function(t){return 0===t.search(/^http[s]?:|^\//)},c.isInArray=function(t,e){for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1},c.getDecimals=function(t){var e=0;return isNaN(t)||(-1!=(t=String(t)).indexOf("e-")?e=Number(t.split("-")[1]):-1!=t.indexOf(".")&&(e=t.split(".")[1].length)),e},c.wordwrap=function(t,e,n,r){var i,o,a,s;if(t+="",e<1)return t;for(i=-1,t=(s=t.split(/\r\n|\n|\r/)).length;++i<t;s[i]+=a){for(a=s[i],s[i]="";a.length>e;s[i]+=c.trim(a.slice(0,o))+((a=a.slice(o)).length?n:""))o=2==r||(o=a.slice(0,e+1).match(/\S*(\s)?$/))[1]?e:o.input.length-o[0].length||1==r&&e||o.input.length+(o=a.slice(e).match(/^\S*/))[0].length;a=c.trim(a)}return s.join(n)},c.trim=function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},c.wrappedText=function(t,e,n,r,i,o,a,s){var l=c.text(t,e,n,r,i,o,a);if(l){var u=l.getBBox();if(u.width>s){var h="\n";c.isModern||(h="<br>"),2<(s=Math.floor(s/(u.width/e.length)))&&(s-=2),e=c.wordwrap(e,s,h,!0),l.remove(),l=c.text(t,e,n,r,i,o,a)}}return l},c.getStyle=function(t,e){var n="";if(document.defaultView&&document.defaultView.getComputedStyle)try{n=document.defaultView.getComputedStyle(t,"").getPropertyValue(e)}catch(t){}else t.currentStyle&&(e=e.replace(/\-(\w)/g,function(t,e){return e.toUpperCase()}),n=t.currentStyle[e]);return n},c.removePx=function(t){if(void 0!==t)return Number(t.substring(0,t.length-2))},c.getURL=function(t,e){if(t)if("_self"!=e&&e)if("_top"==e&&window.top)window.top.location.href=t;else if("_parent"==e&&window.parent)window.parent.location.href=t;else if("_blank"==e)window.open(t);else{var n=document.getElementsByName(e)[0];n?n.src=t:(n=c.windows[e])&&n.opener&&!n.opener.closed?n.location.href=t:c.windows[e]=window.open(t)}else window.location.href=t},c.ifArray=function(t){return!!(t&&"object"==typeof t&&0<t.length)},c.callMethod=function(t,e){var n;for(n=0;n<e.length;n++){var r=e[n];if(r){r[t]&&r[t]();var i,o=r.length;if(0<o)for(i=0;i<o;i++){var a=r[i];a&&a[t]&&a[t]()}}}},c.toNumber=function(t){return"number"==typeof t?t:Number(String(t).replace(/[^0-9\-.]+/g,""))},c.toColor=function(t){if(""!==t&&void 0!==t)if(-1!=t.indexOf(",")){var e;for(t=t.split(","),e=0;e<t.length;e++){var n=t[e].substring(t[e].length-6,t[e].length);t[e]="#"+n}}else t="#"+(t=t.substring(t.length-6,t.length));return t},c.toCoordinate=function(t,e,n){var r;return void 0!==t&&(t=String(t),n&&n<e&&(e=n),r=Number(t),-1!=t.indexOf("!")&&(r=e-Number(t.substr(1))),-1!=t.indexOf("%")&&(r=e*Number(t.substr(0,t.length-1))/100)),r},c.fitToBounds=function(t,e,n){return t<e&&(t=e),n<t&&(t=n),t},c.isDefined=function(t){return void 0!==t},c.stripNumbers=function(t){return t.replace(/[0-9]+/g,"")},c.roundTo=function(t,e){if(e<0)return t;var n=Math.pow(10,e);return Math.round(t*n)/n},c.toFixed=function(t,e){var n=!1;t<0&&(n=!0,t=Math.abs(t));var r=String(Math.round(t*Math.pow(10,e)));if(0<e){var i,o=r.length;if(o<e)for(i=0;i<e-o;i++)r="0"+r;return""===(o=r.substring(0,r.length-e))&&(o=0),r=o+"."+r.substring(r.length-e,r.length),n?"-"+r:r}return String(r)},c.formatDuration=function(t,e,n,r,i,o){var a=c.intervals,s=o.decimalSeparator;if(t>=a[e].contains){var l=t-Math.floor(t/a[e].contains)*a[e].contains;return"ss"==e?1==(l=c.formatNumber(l,o)).split(s)[0].length&&(l="0"+l):l=c.roundTo(l,o.precision),("mm"==e||"hh"==e)&&l<10&&(l="0"+l),n=l+""+r[e]+n,t=Math.floor(t/a[e].contains),e=a[e].nextInterval,c.formatDuration(t,e,n,r,i,o)}if("ss"==e&&(1==(t=c.formatNumber(t,o)).split(s)[0].length&&(t="0"+t)),"mm"==e&&(t=c.roundTo(t,o.precision)),("mm"==e||"hh"==e)&&t<10&&(t="0"+t),n=t+""+r[e]+n,a[i].count>a[e].count)for(t=a[e].count;t<a[i].count;t++)"ss"==(e=a[e].nextInterval)||"mm"==e||"hh"==e?n="00"+r[e]+n:"DD"==e&&(n="0"+r[e]+n);return":"==n.charAt(n.length-1)&&(n=n.substring(0,n.length-1)),n},c.formatNumber=function(t,e,n,r,i){t=c.roundTo(t,e.precision),isNaN(n)&&(n=e.precision);var o,a=e.decimalSeparator;null==a&&(a=","),null==(e=e.thousandsSeparator)&&(e=" "),o=t<0?"-":"",t=Math.abs(t);var s=!1;-1!=(h=String(t)).indexOf("e")&&(s=!0),0<=n&&!s&&(h=c.toFixed(t,n));var l="";if(s)l=h;else{var u,h=h.split(".");for(u=(s=String(h[0])).length;0<=u;u-=3)l=u!=s.length?0!==u?s.substring(u-3,u)+e+l:s.substring(u-3,u)+l:s.substring(u-3,u);void 0!==h[1]&&(l=l+a+h[1]),void 0!==n&&0<n&&"0"!=l&&(l=c.addZeroes(l,a,n))}return l=o+l,o||!0!==r||0===t||(l="+"+l),!0===i&&(l+="%"),l},c.addZeroes=function(t,e,n){return void 0===(t=t.split(e))[1]&&0<n&&(t[1]="0"),t[1].length<n?(t[1]+="0",c.addZeroes(t[0]+e+t[1],e,n)):void 0!==t[1]?t[0]+e+t[1]:t[0]},c.scientificToNormal=function(t){var e,n;if("-"==(t=String(t).split("e"))[1].substr(0,1)){for(e="0.",n=0;n<Math.abs(Number(t[1]))-1;n++)e+="0";e+=t[0].split(".").join("")}else{var r=0;for((e=t[0].split("."))[1]&&(r=e[1].length),e=t[0].split(".").join(""),n=0;n<Math.abs(Number(t[1]))-r;n++)e+="0"}return e},c.toScientific=function(t,e){if(0===t)return"0";var n=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r=String(r).split(".").join(e);return String(r)+"e"+n},c.randomColor=function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).substr(-6)},c.hitTest=function(t,e,n){var r=!1,i=t.x,o=t.x+t.width,a=t.y,s=t.y+t.height,l=c.isInRectangle;return(r=(r=(r=(r=r||l(i,a,e))||l(i,s,e))||l(o,a,e))||l(o,s,e))||!0===n||(r=c.hitTest(e,t,!0)),r},c.isInRectangle=function(t,e,n){return t>=n.x-5&&t<=n.x+n.width+5&&e>=n.y-5&&e<=n.y+n.height+5},c.isPercents=function(t){if(-1!=String(t).indexOf("%"))return!0},c.formatValue=function(t,e,n,r,i,o,a,s){var l;if(e)for(void 0===i&&(i=""),l=0;l<n.length;l++){var u=n[l],h=e[u];void 0!==h&&(h=o?c.addPrefix(h,s,a,r):c.formatNumber(h,r),t=t.replace(new RegExp("\\[\\["+i+u+"\\]\\]","g"),h))}return t},c.formatDataContextValue=function(t,e){if(t){var n,r=t.match(/\[\[.*?\]\]/g);for(n=0;n<r.length;n++){var i;void 0!==e[i=(i=r[n]).substr(2,i.length-4)]&&(t=t.replace(new RegExp("\\[\\["+i+"\\]\\]","g"),e[i]))}}return t},c.massReplace=function(t,e){for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];void 0===r&&(r=""),t=t.replace(n,r)}return t},c.cleanFromEmpty=function(t){return t.replace(/\[\[[^\]]*\]\]/g,"")},c.addPrefix=function(t,e,n,r,i){var o,a,s,l=c.formatNumber(t,r),u="";if(0===t)return"0";if(t<0&&(u="-"),1<(t=Math.abs(t))){for(o=e.length-1;-1<o;o--)if(t>=e[o].number&&(a=t/e[o].number,(s=Number(r.precision))<1&&(s=1),n=c.roundTo(a,s),s=c.formatNumber(n,{precision:-1,decimalSeparator:r.decimalSeparator,thousandsSeparator:r.thousandsSeparator}),!i||a==n)){l=u+""+s+e[o].prefix;break}}else for(o=0;o<n.length;o++)if(t<=n[o].number){a=t/n[o].number,s=Math.abs(Math.floor(Math.log(a)*Math.LOG10E)),l=u+""+(a=c.roundTo(a,s))+n[o].prefix;break}return l},c.remove=function(t){t&&t.remove()},c.getEffect=function(t){return">"==t&&(t="easeOutSine"),"<"==t&&(t="easeInSine"),"elastic"==t&&(t="easeOutElastic"),t},c.getObjById=function(t,e){var n,r;for(r=0;r<t.length;r++){var i=t[r];if(i.id==e){n=i;break}}return n},c.applyTheme=function(t,e,n){e=e||c.theme;try{e=JSON.parse(JSON.stringify(e))}catch(t){}e&&e[n]&&c.extend(t,e[n])},c.isString=function(t){return"string"==typeof t},c.extend=function(t,e,n){var r;for(r in t=t||{},e)n&&t.hasOwnProperty(r)||(t[r]=e[r]);return t},c.copyProperties=function(t,e){for(var n in t)t.hasOwnProperty(n)&&"events"!=n&&void 0!==t[n]&&"function"!=typeof t[n]&&"cname"!=n&&(e[n]=t[n])},c.processObject=function(t,e,n,r){if(!1==t instanceof e&&(t=r?c.extend(new e(n),t):c.extend(t,new e(n),!0)).listeners)for(var i in t.listeners)e=t.listeners[i],t.addListener(e.event,e.method);return t},c.fixNewLines=function(t){var e=RegExp("\\n","g");return t=t&&t.replace(e,"<br />")},c.fixBrakes=function(t){if(c.isModern){var e=RegExp("<br>","g");t=t&&t.replace(e,"\n")}else t=c.fixNewLines(t);return t},c.deleteObject=function(t,e){if(t&&(null==e&&(e=20),0!==e))if("[object Array]"===Object.prototype.toString.call(t))for(var n=0;n<t.length;n++)c.deleteObject(t[n],e-1),t[n]=null;else if(t&&!t.tagName)try{for(n in t.theme=null,t)t[n]&&("object"==typeof t[n]&&c.deleteObject(t[n],e-1),"function"!=typeof t[n]&&(t[n]=null))}catch(t){}},c.bounce=function(t,e,n,r,i){return(e/=i)<1/2.75?7.5625*r*e*e+n:e<2/2.75?r*(7.5625*(e-=1.5/2.75)*e+.75)+n:e<2.5/2.75?r*(7.5625*(e-=2.25/2.75)*e+.9375)+n:r*(7.5625*(e-=2.625/2.75)*e+.984375)+n},c.easeInOutQuad=function(t,e,n,r,i){return(e/=i/2)<1?r/2*e*e+n:-r/2*(--e*(e-2)-1)+n},c.easeInSine=function(t,e,n,r,i){return-r*Math.cos(e/i*(Math.PI/2))+r+n},c.easeOutSine=function(t,e,n,r,i){return r*Math.sin(e/i*(Math.PI/2))+n},c.easeOutElastic=function(t,e,n,r,i){t=1.70158;var o=0,a=r;return 0===e?n:1==(e/=i)?n+r:(o=o||.3*i,t=a<Math.abs(r)?(a=r,o/4):o/(2*Math.PI)*Math.asin(r/a),a*Math.pow(2,-10*e)*Math.sin(2*(e*i-t)*Math.PI/o)+r+n)},c.fixStepE=function(t){t=t.toExponential(0).split("e");var e=Number(t[1]);return 9==Number(t[0])&&e++,c.generateNumber(1,e)},c.generateNumber=function(t,e){var n,r,i="";for(n=e<0?Math.abs(e)-1:Math.abs(e),r=0;r<n;r++)i+="0";return e<0?Number("0."+i+String(t)):Number(String(t)+i)},c.setCN=function(t,e,n,r){if(t.addClassNames&&e&&(e=e.node)&&n){var i=e.getAttribute("class");t=t.classNamePrefix+"-",r&&(t=""),i?e.setAttribute("class",i+" "+t+n):e.setAttribute("class",t+n)}},c.removeCN=function(t,e,n){(e=e&&e.node)&&n&&(e=e.classList)&&e.remove(t.classNamePrefix+"-"+n)},c.parseDefs=function(t,e){for(var n in t){var r=typeof t[n];if(0<t[n].length&&"object"==r)for(var i=0;i<t[n].length;i++)r=document.createElementNS(c.SVG_NS,n),e.appendChild(r),c.parseDefs(t[n][i],r);else"object"==r?(r=document.createElementNS(c.SVG_NS,n),e.appendChild(r),c.parseDefs(t[n],r)):e.setAttribute(n,t[n])}}}(),function(){var T=window.AmCharts;T.AxisBase=T.Class({construct:function(t){this.createEvents("clickItem","rollOverItem","rollOutItem","rollOverGuide","rollOutGuide","clickGuide"),this.titleDY=this.y=this.x=this.dy=this.dx=0,this.axisThickness=1,this.axisColor="#000000",this.axisAlpha=1,this.gridCount=this.tickLength=5,this.gridAlpha=.15,this.gridThickness=1,this.gridColor="#000000",this.dashLength=0,this.labelFrequency=1,this.showLastLabel=this.showFirstLabel=!0,this.fillColor="#FFFFFF",this.fillAlpha=0,this.labelsEnabled=!0,this.labelRotation=0,this.autoGridCount=!0,this.offset=0,this.guides=[],this.visible=!0,this.counter=0,this.guides=[],this.ignoreAxisWidth=this.inside=!1,this.minHorizontalGap=75,this.minVerticalGap=35,this.titleBold=!0,this.minorGridEnabled=!1,this.minorGridAlpha=.07,this.autoWrap=!1,this.titleAlign="middle",this.labelOffset=0,this.bcn="axis-",this.centerLabels=!1,this.firstDayOfWeek=1,this.centerLabelOnFullPeriod=this.markPeriodChange=this.boldPeriodBeginning=!0,this.titleWidth=0,this.periods=[{period:"fff",count:1},{period:"fff",count:5},{period:"fff",count:10},{period:"fff",count:50},{period:"fff",count:100},{period:"fff",count:500},{period:"ss",count:1},{period:"ss",count:5},{period:"ss",count:10},{period:"ss",count:30},{period:"mm",count:1},{period:"mm",count:5},{period:"mm",count:10},{period:"mm",count:30},{period:"hh",count:1},{period:"hh",count:3},{period:"hh",count:6},{period:"hh",count:12},{period:"DD",count:1},{period:"DD",count:2},{period:"DD",count:3},{period:"DD",count:4},{period:"DD",count:5},{period:"WW",count:1},{period:"MM",count:1},{period:"MM",count:2},{period:"MM",count:3},{period:"MM",count:6},{period:"YYYY",count:1},{period:"YYYY",count:2},{period:"YYYY",count:5},{period:"YYYY",count:10},{period:"YYYY",count:50},{period:"YYYY",count:100}],this.dateFormats=[{period:"fff",format:"NN:SS.QQQ"},{period:"ss",format:"JJ:NN:SS"},{period:"mm",format:"JJ:NN"},{period:"hh",format:"JJ:NN"},{period:"DD",format:"MMM DD"},{period:"WW",format:"MMM DD"},{period:"MM",format:"MMM"},{period:"YYYY",format:"YYYY"}],this.nextPeriod={fff:"ss",ss:"mm",mm:"hh",hh:"DD",DD:"MM",MM:"YYYY"},T.applyTheme(this,t,"AxisBase")},zoom:function(t,e){this.start=t,this.end=e,this.dataChanged=!0,this.draw()},fixAxisPosition:function(){var t=this.position;"H"==this.orientation?("left"==t&&(t="bottom"),"right"==t&&(t="top")):("bottom"==t&&(t="left"),"top"==t&&(t="right")),this.position=t},init:function(){this.createBalloon()},draw:function(){var t=this.chart;this.prevBY=this.prevBX=NaN,this.allLabels=[],this.counter=0,this.destroy(),this.fixAxisPosition(),this.setBalloonBounds(),this.labels=[];var e=t.container,n=e.set();t.gridSet.push(n),this.set=n,e=e.set(),t.axesLabelsSet.push(e),this.labelsSet=e,this.axisLine=new this.axisRenderer(this),this.autoGridCount?("V"==this.orientation?(t=this.height/this.minVerticalGap)<3&&(t=3):t=this.width/this.minHorizontalGap,this.gridCountR=Math.max(t,1)):this.gridCountR=this.gridCount,this.axisWidth=this.axisLine.axisWidth,this.addTitle()},setOrientation:function(t){this.orientation=t?"H":"V"},addTitle:function(){var t=this.title;if(this.titleLabel=null,t){var e=this.chart,n=this.titleColor;void 0===n&&(n=e.color);var r=this.titleFontSize;isNaN(r)&&(r=e.fontSize+1),t=T.text(e.container,t,n,e.fontFamily,r,this.titleAlign,this.titleBold),T.setCN(e,t,this.bcn+"title"),this.titleLabel=t}},positionTitle:function(){var t=this.titleLabel;if(t){var e,n,r={};0<(i=this.labelsSet).length()?r=i.getBBox():(r.x=0,r.y=0,r.width=this.width,r.height=this.height,T.VML&&(r.y+=this.y,r.x+=this.x)),i.push(t);var i=r.x,o=r.y;T.VML&&(o-=this.y,i-=this.x);var a=r.width,s=(r=r.height,this.width),l=this.height,u=0,h=t.getBBox().height/2,c=this.inside,d=this.titleAlign;switch(this.position){case"top":e="left"==d?-1:"right"==d?s:s/2,n=o-10-h;break;case"bottom":e="left"==d?-1:"right"==d?s:s/2,n=o+r+10+h;break;case"left":e=i-10-h,c&&(e-=5),u=-90,n=("left"==d?l+1:"right"==d?-1:l/2)+this.titleDY,this.titleWidth=10+h;break;case"right":e=i+a+10+h,c&&(e+=7),n=("left"==d?l+2:"right"==d?-2:l/2)+this.titleDY,this.titleWidth=10+h,u=-90}this.marginsChanged?(t.translate(e,n),this.tx=e,this.ty=n):t.translate(this.tx,this.ty),this.marginsChanged=!1,isNaN(this.titleRotation)||(u=this.titleRotation),0!==u&&t.rotate(u)}},pushAxisItem:function(e,t){var n=this,r=e.graphics();0<r.length()&&(t?n.labelsSet.push(r):n.set.push(r)),(r=e.getLabel())&&(n.labelsSet.push(r),r.click(function(t){n.handleMouse(t,e,"clickItem")}).touchend(function(t){n.handleMouse(t,e,"clickItem")}).mouseover(function(t){n.handleMouse(t,e,"rollOverItem")}).mouseout(function(t){n.handleMouse(t,e,"rollOutItem")}))},handleMouse:function(t,e,n){this.fire({type:n,value:e.value,serialDataItem:e.serialDataItem,axis:this,target:e.label,chart:this.chart,event:t})},addGuide:function(t){for(var e=this.guides,n=!1,r=e.length,i=0;i<e.length;i++)e[i]==t&&(n=!0,r=i);(t=T.processObject(t,T.Guide,this.theme)).id||(t.id="guideAuto"+r+"_"+(new Date).getTime()),n||e.push(t)},removeGuide:function(t){var e,n=this.guides;for(e=0;e<n.length;e++)n[e]==t&&n.splice(e,1)},handleGuideOver:function(t){clearTimeout(this.chart.hoverInt);var e={x:0,y:0,width:0,height:0};t.graphics&&(e=t.graphics.getBBox());var n=this.x+e.x+e.width/2,r=(e=this.y+e.y+e.height/2,t.fillColor);void 0===r&&(r=t.lineColor),this.chart.showBalloon(t.balloonText,r,!0,n,e),this.fire({type:"rollOverGuide",guide:t,chart:this.chart})},handleGuideOut:function(t){this.chart.hideBalloon(),this.fire({type:"rollOutGuide",guide:t,chart:this.chart})},handleGuideClick:function(t){this.chart.hideBalloon(),this.fire({type:"clickGuide",guide:t,chart:this.chart})},addEventListeners:function(t,e){var n=this;t.mouseover(function(){n.handleGuideOver(e)}),t.mouseup(function(){n.handleGuideClick(e)}),t.touchstart(function(){n.handleGuideOver(e)}),t.mouseout(function(){n.handleGuideOut(e)})},getBBox:function(){var t;return this.labelsSet&&(t=this.labelsSet.getBBox()),t?T.VML||(t={x:t.x+this.x,y:t.y+this.y,width:t.width,height:t.height}):t={x:0,y:0,width:0,height:0},t},destroy:function(){T.remove(this.set),T.remove(this.labelsSet);var t=this.axisLine;t&&T.remove(t.axisSet),T.remove(this.grid0)},chooseMinorFrequency:function(t){for(var e=10;0<e;e--)if(t/e==Math.round(t/e))return t/e},parseDatesDraw:function(){var t,e,n,r,i,o,a,s=this.chart,l=this.showFirstLabel,u=this.showLastLabel,h="",c=T.extractPeriod(this.minPeriod),d=T.getPeriodDuration(c.period,c.count),f=this.firstDayOfWeek,p=this.boldPeriodBeginning;t=this.minorGridEnabled;var g,v,m=this.gridAlpha,y=(w=this.choosePeriod(0)).period,w=w.count,b=T.getPeriodDuration(y,w);b<d&&(y=c.period,w=c.count,b=d),"WW"==(c=y)&&(c="DD"),this.stepWidth=this.getStepWidth(this.timeDifference);var C=Math.ceil(this.timeDifference/b)+5,E=n=T.resetDateToMin(new Date(this.startTime-b),y,w,f).getTime();(c==y&&1==w&&this.centerLabelOnFullPeriod||this.autoWrap||this.centerLabels)&&(i=b*this.stepWidth,this.autoWrap&&!this.centerLabels&&(i=-i)),this.cellWidth=d*this.stepWidth,d=-1,(o=Math.round(n/b))/2==Math.round(o/2)&&(d=-2,n-=b),o=this.firstTime;var S=0,O=0;if(t&&1<w&&(g=this.chooseMinorFrequency(w),v=T.getPeriodDuration(y,g),"DD"==y&&(v+=T.getPeriodDuration("hh")),"fff"==y&&(v=1)),0<this.gridCountR)for(C-5-d>this.autoRotateCount&&!isNaN(this.autoRotateAngle)&&(this.labelRotationR=this.autoRotateAngle),t=d;t<=C;t++){if(a=o+b*(t+Math.floor((E-o)/b))-S,"DD"==y&&(a+=36e5),a=T.resetDateToMin(new Date(a),y,w,f).getTime(),"MM"==y&&(1.5<=(e=(a-n)/b)&&(a=a-(e-1)*b+T.getPeriodDuration("DD",3),a=T.resetDateToMin(new Date(a),y,1).getTime(),S+=b)),e=(a-this.startTime)*this.stepWidth,"radar"==s.type){if((e=this.axisWidth-e)<0||e>this.axisWidth)continue}else this.rotate?"date"==this.type&&"middle"==this.gridPosition&&(O=-b*this.stepWidth/2):"date"==this.type&&(e=this.axisWidth-e);if(h=!1,this.nextPeriod[c]&&(h=this.checkPeriodChange(this.nextPeriod[c],1,a,n,c)),n=!1,h&&this.markPeriodChange?(h=this.dateFormatsObject[this.nextPeriod[c]],this.twoLineMode&&(h=this.dateFormatsObject[c]+"\n"+h,h=T.fixBrakes(h)),n=!0):h=this.dateFormatsObject[c],p||(n=!1),this.currentDateFormat=h,h=T.formatDate(new Date(a),h,s),(t==d&&!l||t==C&&!u)&&(h=" "),this.labelFunction&&(h=this.labelFunction(h,new Date(a),this,y,w,r).toString()),this.boldLabels&&(n=!0),r=new this.axisItemRenderer(this,e,h,!1,i,O,!1,n),this.pushAxisItem(r),r=n=a,!isNaN(g))for(e=1;e<w;e+=g)this.gridAlpha=this.minorGridAlpha,h=a+v*e,h=T.resetDateToMin(new Date(h),y,g,f).getTime(),h=new this.axisItemRenderer(this,(h-this.startTime)*this.stepWidth,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!0),this.pushAxisItem(h);this.gridAlpha=m}},choosePeriod:function(t){var e=T.getPeriodDuration(this.periods[t].period,this.periods[t].count),n=this.periods;return this.timeDifference<e&&0<t?n[t-1]:Math.ceil(this.timeDifference/e)<=this.gridCountR?n[t]:t+1<n.length?this.choosePeriod(t+1):n[t]},getStepWidth:function(t){var e;return this.startOnAxis?(e=this.axisWidth/(t-1),1==t&&(e=this.axisWidth)):e=this.axisWidth/t,e},timeZoom:function(t,e){this.startTime=t,this.endTime=e},minDuration:function(){var t=T.extractPeriod(this.minPeriod);return T.getPeriodDuration(t.period,t.count)},checkPeriodChange:function(t,e,n,r,i){n=new Date(n);var o=new Date(r),a=this.firstDayOfWeek;return r=e,"DD"==t&&(e=1),n=T.resetDateToMin(n,t,e,a).getTime(),e=T.resetDateToMin(o,t,e,a).getTime(),!("DD"==t&&"hh"!=i&&n-e<T.getPeriodDuration(t,r)-T.getPeriodDuration("hh",1))&&n!=e},generateDFObject:function(){var t;for(this.dateFormatsObject={},t=0;t<this.dateFormats.length;t++){var e=this.dateFormats[t];this.dateFormatsObject[e.period]=e.format}},hideBalloon:function(){this.balloon&&this.balloon.hide&&this.balloon.hide(),this.prevBY=this.prevBX=NaN},formatBalloonText:function(t){return t},showBalloon:function(t,e,n,r){var i,o=this.offset;switch(this.position){case"bottom":e=this.height+o;break;case"top":e=-o;break;case"left":t=-o;break;case"right":t=this.width+o}if(n=n||this.currentDateFormat,"V"==this.orientation){if(e<0||e>this.height)return;if(isNaN(e))return void this.hideBalloon();e=this.adjustBalloonCoordinate(e,r),r=this.coordinateToValue(e)}else{if(t<0||t>this.width)return;if(isNaN(t))return void this.hideBalloon();t=this.adjustBalloonCoordinate(t,r),r=this.coordinateToValue(t)}(o=this.chart.chartCursor)&&(i=o.index),this.balloon&&void 0!==r&&this.balloon.enabled&&(this.balloonTextFunction?("date"!=this.type&&!0!==this.parseDates||(r=new Date(r)),r=this.balloonTextFunction(r)):this.balloonText?r=this.formatBalloonText(this.balloonText,i,n):isNaN(r)||(r=this.formatValue(r,n)),t==this.prevBX&&e==this.prevBY||(this.balloon.setPosition(t,e),this.prevBX=t,this.prevBY=e,r&&this.balloon.showBalloon(r)))},adjustBalloonCoordinate:function(t){return t},createBalloon:function(){var t=this.chart,e=t.chartCursor;e&&("mouse"!=(e=e.cursorPosition)&&(this.stickBalloonToCategory=!0),"start"==e&&(this.stickBalloonToStart=!0),"ValueAxis"==this.cname&&(this.stickBalloonToCategory=!1)),this.balloon&&(this.balloon.destroy&&this.balloon.destroy(),T.extend(this.balloon,t.balloon,!0))},setBalloonBounds:function(){var t=this.balloon;if(t){var e=this.chart;t.cornerRadius=0,t.shadowAlpha=0,t.borderThickness=1,t.borderAlpha=1,t.adjustBorderColor=!1,t.showBullet=!1,(this.balloon=t).chart=e,t.mainSet=e.plotBalloonsSet,t.pointerWidth=this.tickLength,!this.parseDates&&"date"!=this.type||(t.pointerWidth=0),t.className=this.id,(e="V")==this.orientation&&(e="H"),this.stickBalloonToCategory||(t.animationDuration=0);var n,r,i,o,a=this.inside,s=this.width,l=this.height;switch(this.position){case"bottom":n=0,r=s,o=a?(i=0,l):(i=l)+1e3;break;case"top":n=0,r=s,o=a?(i=0,l):(i=-1e3,0);break;case"left":i=0,o=l,r=a?(n=0,s):(n=-1e3,0);break;case"right":i=0,o=l,r=a?(n=0,s):(n=s)+1e3}t.drop||(t.pointerOrientation=e),t.setBounds(n,i,r,o)}}})}(),function(){var R=window.AmCharts;R.ValueAxis=R.Class({inherits:R.AxisBase,construct:function(t){this.cname="ValueAxis",this.createEvents("axisChanged","logarithmicAxisFailed","axisZoomed","axisIntZoomed"),R.ValueAxis.base.construct.call(this,t),this.dataChanged=!0,this.stackType="none",this.position="left",this.unitPosition="right",this.includeAllValues=this.recalculateToPercents=this.includeHidden=this.includeGuidesInMinMax=this.integersOnly=!1,this.durationUnits={DD:"d. ",hh:":",mm:":",ss:""},this.scrollbar=!1,this.baseValue=0,this.radarCategoriesEnabled=!0,this.axisFrequency=1,this.gridType="polygons",this.useScientificNotation=!1,this.axisTitleOffset=10,this.pointPosition="axis",this.minMaxMultiplier=1,this.logGridLimit=2,this.totalTextOffset=this.treatZeroAs=0,this.minPeriod="ss",this.relativeStart=0,this.relativeEnd=1,R.applyTheme(this,t,this.cname)},updateData:function(){this.gridCountR<=0&&(this.gridCountR=1),this.totals=[],this.data=this.chart.chartData;var t=this.chart;"xy"!=t.type&&(this.stackGraphs("smoothedLine"),this.stackGraphs("line"),this.stackGraphs("column"),this.stackGraphs("step")),this.recalculateToPercents&&this.recalculate(),this.synchronizationMultiplier&&this.synchronizeWith?(R.isString(this.synchronizeWith)&&(this.synchronizeWith=t.getValueAxisById(this.synchronizeWith)),this.synchronizeWith&&(this.synchronizeWithAxis(this.synchronizeWith),this.foundGraphs=!0)):(this.foundGraphs=!1,this.getMinMax(),(0===this.start&&this.end==this.data.length-1&&isNaN(this.minZoom)&&isNaN(this.maxZoom)||isNaN(this.fullMin)&&isNaN(this.fullMax))&&(this.fullMin=this.min,this.fullMax=this.max,"date"!=this.type&&this.strictMinMax&&(isNaN(this.minimum)||(this.fullMin=this.minimum),isNaN(this.maximum)||(this.fullMax=this.maximum)),this.logarithmic&&(this.fullMin=this.logMin,0===this.fullMin&&(this.fullMin=this.treatZeroAs)),"date"==this.type&&(this.minimumDate||(this.fullMin=this.minRR),this.maximumDate||(this.fullMax=this.maxRR),this.strictMinMax&&(this.minimumDate&&(this.fullMin=this.minimumDate.getTime()),this.maximumDate&&(this.fullMax=this.maximumDate.getTime())))))},draw:function(){R.ValueAxis.base.draw.call(this);var t=this.chart,e=this.set;this.labelRotationR=this.labelRotation,R.setCN(t,this.set,"value-axis value-axis-"+this.id),R.setCN(t,this.labelsSet,"value-axis value-axis-"+this.id),R.setCN(t,this.axisLine.axisSet,"value-axis value-axis-"+this.id);var n=this.type;if("duration"==n&&(this.duration="ss"),!0===this.dataChanged&&(this.updateData(),this.dataChanged=!1),"date"==n&&(this.logarithmic=!1,this.min=this.minRR,this.max=this.maxRR,this.reversed=!1,this.getDateMinMax()),this.logarithmic){var r=this.treatZeroAs,i=this.getExtremes(0,this.data.length-1).min;if(!isNaN(this.minimum)&&this.minimum<i&&(i=this.minimum),this.logMin=i,this.minReal<i&&(this.minReal=i),isNaN(this.minReal)&&(this.minReal=i),0<r&&0===i&&(this.minReal=i=r),i<=0||this.minimum<=0)return void this.fire({type:"logarithmicAxisFailed",chart:t})}this.grid0=null;var o,a,s=t.dx,l=t.dy;r=!1,i=this.logarithmic;if(isNaN(this.min)||isNaN(this.max)||!this.foundGraphs||1/0==this.min||-1/0==this.max)r=!0;else{"date"==this.type&&this.min==this.max&&(this.max+=this.minDuration(),this.min-=this.minDuration());var u=this.labelFrequency,h=this.showFirstLabel,c=this.showLastLabel,d=1,f=0;if(this.minCalc=this.min,this.maxCalc=this.max,this.strictMinMax&&(isNaN(this.minimum)||(this.min=this.minimum),isNaN(this.maximum)||(this.max=this.maximum),this.min==this.max))return;if(isNaN(this.minZoom)||(this.minReal=this.min=this.minZoom),isNaN(this.maxZoom)||(this.max=this.maxZoom),this.logarithmic){a=this.fullMin;var p=this.fullMax;isNaN(this.minimum)||(a=this.minimum),isNaN(this.maximum)||(p=this.maximum);p=Math.log(p)*Math.LOG10E-Math.log(a)*Math.LOG10E;var g=Math.log(this.max)/Math.LN10-Math.log(a)*Math.LOG10E;this.relativeStart=R.roundTo((Math.log(this.minReal)/Math.LN10-Math.log(a)*Math.LOG10E)/p,5),this.relativeEnd=R.roundTo(g/p,5)}else this.relativeStart=R.roundTo(R.fitToBounds((this.min-this.fullMin)/(this.fullMax-this.fullMin),0,1),5),this.relativeEnd=R.roundTo(R.fitToBounds((this.max-this.fullMin)/(this.fullMax-this.fullMin),0,1),5);var v;p=Math.round((this.maxCalc-this.minCalc)/this.step)+1;!0===i?(v=Math.log(this.max)*Math.LOG10E-Math.log(this.minReal)*Math.LOG10E,this.stepWidth=this.axisWidth/v,v>this.logGridLimit&&(p=Math.ceil(Math.log(this.max)*Math.LOG10E)+1,f=Math.round(Math.log(this.minReal)*Math.LOG10E),p>this.gridCountR&&(d=Math.ceil(p/this.gridCountR)))):this.stepWidth=this.axisWidth/(this.max-this.min);var m,y=0;for(this.step<1&&-1<this.step&&(y=R.getDecimals(this.step)),this.integersOnly&&(y=0),y>this.maxDecCount&&(y=this.maxDecCount),g=this.precision,isNaN(g)||(y=g),isNaN(this.maxZoom)&&(this.max=R.roundTo(this.max,this.maxDecCount),this.min=R.roundTo(this.min,this.maxDecCount)),(a={}).precision=y,a.decimalSeparator=t.nf.decimalSeparator,a.thousandsSeparator=t.nf.thousandsSeparator,this.numberFormatter=a,this.exponential=!1,a=f;a<p;a+=d){var w=R.roundTo(this.step*a+this.min,y);-1!=String(w).indexOf("e")&&(this.exponential=!0)}this.duration&&(this.maxInterval=R.getMaxInterval(this.max,this.duration));var b;y=this.step,w=this.minorGridAlpha;if(this.minorGridEnabled&&(b=this.getMinorGridStep(y,this.stepWidth*y)),this.autoGridCount||0!==this.gridCount)if("date"==n)this.generateDFObject(),this.timeDifference=this.max-this.min,this.maxTime=this.lastTime=this.max,this.startTime=this.firstTime=this.min,this.parseDatesDraw();else for(p>=this.autoRotateCount&&!isNaN(this.autoRotateAngle)&&(this.labelRotationR=this.autoRotateAngle),n=this.minCalc,i&&(p++,n=this.maxCalc-p*y),this.gridCountReal=p,a=this.startCount=f;a<p;a+=d)if(f=y*a+n,f=R.roundTo(f,this.maxDecCount+1),(!this.integersOnly||Math.round(f)==f)&&(isNaN(g)||Number(R.toFixed(f,g))==f)){if(!0===i)if(v>this.logGridLimit){if((f=Math.pow(10,a))>this.max)continue}else if(f<=0&&(f=n+y*a+y/2)<=0)continue;var C;if(m=this.formatValue(f,!1,a),Math.round(a/u)!=a/u&&(m=void 0),(0===a&&!h||a==p-1&&!c)&&(m=" "),o=this.getCoordinate(f),this.rotate&&this.autoWrap&&(C=this.stepWidth*y-10),m=new this.axisItemRenderer(this,o,m,void 0,C,void 0,void 0,this.boldLabels),this.pushAxisItem(m),f==this.baseValue&&"radar"!=t.type){var E,S,O=this.width,T=this.height;"H"==this.orientation?0<=o&&o<=O+1&&(E=[o,o,o+s],S=[T,0,l]):0<=o&&o<=T+1&&(E=[0,O,O+s],S=[o,o,o+l]),E&&(o=R.fitToBounds(2*this.gridAlpha,0,1),isNaN(this.zeroGridAlpha)||(o=this.zeroGridAlpha),(o=R.line(t.container,E,S,this.gridColor,o,1,this.dashLength)).translate(this.x,this.y),this.grid0=o,t.axesSet.push(o),o.toBack(),R.setCN(t,o,this.bcn+"zero-grid-"+this.id),R.setCN(t,o,this.bcn+"zero-grid"))}if(!isNaN(b)&&0<w&&a<p-1){for(o=y/b,i&&(b=y*(a+d)+this.minCalc,b=R.roundTo(b,this.maxDecCount+1),v>this.logGridLimit&&(b=Math.pow(10,a+d)),b=(b-f)/(o=9)),O=this.gridAlpha,this.gridAlpha=this.minorGridAlpha,T=1;T<o;T++){var N=this.getCoordinate(f+b*T);N=new this.axisItemRenderer(this,N,"",!1,0,0,!1,!1,0,!0);this.pushAxisItem(N)}this.gridAlpha=O}}if(0<(C=(v=this.guides).length)){for(E=this.fillAlpha,a=this.fillAlpha=0;a<C;a++)s=NaN,b=(S=v[a]).above,isNaN(S.toValue)||(s=this.getCoordinate(S.toValue),m=new this.axisItemRenderer(this,s,"",!0,NaN,NaN,S),this.pushAxisItem(m,b)),l=NaN,isNaN(S.value)||(l=this.getCoordinate(S.value),m=new this.axisItemRenderer(this,l,S.label,!0,NaN,(s-l)/2,S),this.pushAxisItem(m,b)),isNaN(s)&&(s=(l-=3)+3),m&&(u=m.label)&&this.addEventListeners(u,S),isNaN(s-l)||l<0&&s<0||(s=new this.guideFillRenderer(this,l,s,S),this.pushAxisItem(s,b),b=s.graphics(),S.graphics=b,this.addEventListeners(b,S));this.fillAlpha=E}m=this.baseValue,this.min>this.baseValue&&this.max>this.baseValue&&(m=this.min),this.min<this.baseValue&&this.max<this.baseValue&&(m=this.max),i&&m<this.minReal&&(m=this.minReal),this.baseCoord=this.getCoordinate(m,!0),(m={type:"axisChanged",target:this,chart:t}).min=i?this.minReal:this.min,m.max=this.max,this.fire(m),this.axisCreated=!0}i=this.axisLine.set,m=this.labelsSet,e.translate(this.x,this.y),m.translate(this.x,this.y),this.positionTitle(),"radar"!=t.type&&i.toFront(),!this.visible||r?(e.hide(),i.hide(),m.hide()):(e.show(),i.show(),m.show()),this.axisY=this.y,this.axisX=this.x},getDateMinMax:function(){this.minimumDate&&(this.minimumDate instanceof Date||(this.minimumDate=R.getDate(this.minimumDate,this.chart.dataDateFormat,"fff")),this.min=this.minimumDate.getTime()),this.maximumDate&&(this.maximumDate instanceof Date||(this.maximumDate=R.getDate(this.maximumDate,this.chart.dataDateFormat,"fff")),this.max=this.maximumDate.getTime())},formatValue:function(t,e,n){var r=this.exponential,i=this.logarithmic,o=this.numberFormatter,a=this.chart;if(o)return!0===this.logarithmic&&(r=-1!=String(t).indexOf("e")),this.useScientificNotation&&(r=!0),this.usePrefixes&&(r=!1),r?(r=(n=-1==String(t).indexOf("e")?t.toExponential(15):String(t)).split("e"),n=Number(r[0]),r=Number(r[1]),n=R.roundTo(n,14),e||isNaN(this.precision)||(n=R.roundTo(n,this.precision)),10==n&&(r+=n=1),n=n+"e"+r,0===t&&(n="0"),1==t&&(n="1")):(i&&((r=String(t).split("."))[1]?(o.precision=r[1].length,n<0&&(o.precision=Math.abs(n)),e&&1<t&&(o.precision=0),e||isNaN(this.precision)||(o.precision=this.precision)):o.precision=-1),n=this.usePrefixes?R.addPrefix(t,a.prefixesOfBigNumbers,a.prefixesOfSmallNumbers,o,!e):R.formatNumber(t,o,o.precision)),this.duration&&(e&&(o.precision=0),n=R.formatDuration(t,this.duration,"",this.durationUnits,this.maxInterval,o)),"date"==this.type&&(n=R.formatDate(new Date(t),this.currentDateFormat,a)),this.recalculateToPercents?n+="%":(e=this.unit)&&(n="left"==this.unitPosition?e+n:n+e),this.labelFunction&&(n="date"==this.type?this.labelFunction(n,new Date(t),this).toString():this.labelFunction(t,n,this).toString()),n},getMinorGridStep:function(t,e){var n=[5,4,2];e<60&&n.shift();for(var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),i=0;i<n.length;i++){var o=t/n[i],a=Math.floor(Math.log(Math.abs(o))*Math.LOG10E);if(!(1<Math.abs(r-a)))if(t<1){if((a=Math.pow(10,-a)*o)==Math.round(a))return o}else if(o==Math.round(o))return o}return 1},stackGraphs:function(t){var e=this.stackType;"stacked"==e&&(e="regular"),"line"==e&&(e="none"),"100% stacked"==e&&(e="100%"),this.stackType=e;var n,r,i,o,a,s,l=[],u=[],h=[],c=[],d=this.chart.graphs,f=this.baseValue,p=!1;if("line"!=t&&"step"!=t&&"smoothedLine"!=t||(p=!0),p&&("regular"==e||"100%"==e))for(a=0;a<d.length;a++)(o=d[a]).stackGraph=null,o.hidden||(i=o.type,o.chart==this.chart&&o.valueAxis==this&&t==i&&o.stackable&&(r&&(o.stackGraph=r),r=o));for(o=this.start-10,r=this.end+10,a=this.data.length-1,o=R.fitToBounds(o,0,a),r=R.fitToBounds(r,0,a),s=o;s<=r;s++){var g=0;for(a=0;a<d.length;a++)if((o=d[a]).hidden)o.newStack&&(h[s]=NaN,u[s]=NaN);else if(i=o.type,o.chart==this.chart&&o.valueAxis==this&&t==i&&o.stackable)if(n=(i=this.data[s].axes[this.id].graphs[o.id]).values.value,isNaN(n))o.newStack&&(h[s]=NaN,u[s]=NaN);else{var v=R.getDecimals(n);g<v&&(g=v),isNaN(c[s])?c[s]=Math.abs(n):c[s]+=Math.abs(n),c[s]=R.roundTo(c[s],g),v=o.fillToGraph,p&&v&&(v=this.data[s].axes[this.id].graphs[v.id])&&(i.values.open=v.values.value),"regular"==e&&(p&&(isNaN(l[s])?(l[s]=n,i.values.close=n,i.values.open=this.baseValue):(isNaN(n)?i.values.close=l[s]:i.values.close=n+l[s],i.values.open=l[s],l[s]=i.values.close)),"column"==t&&(o.newStack&&(h[s]=NaN,u[s]=NaN),(i.values.close=n)<0?(i.values.close=n,isNaN(u[s])?i.values.open=f:(i.values.close+=u[s],i.values.open=u[s]),u[s]=i.values.close):(i.values.close=n,isNaN(h[s])?i.values.open=f:(i.values.close+=h[s],i.values.open=h[s]),h[s]=i.values.close)))}}for(s=this.start;s<=this.end;s++)for(a=0;a<d.length;a++)(o=d[a]).hidden?o.newStack&&(h[s]=NaN,u[s]=NaN):(i=o.type,o.chart==this.chart&&o.valueAxis==this&&t==i&&o.stackable&&(n=(i=this.data[s].axes[this.id].graphs[o.id]).values.value,isNaN(n)||(l=n/c[s]*100,i.values.percents=l,i.values.total=c[s],o.newStack&&(h[s]=NaN,u[s]=NaN),"100%"==e&&(isNaN(u[s])&&(u[s]=0),isNaN(h[s])&&(h[s]=0),l<0?(i.values.close=R.fitToBounds(l+u[s],-100,100),i.values.open=u[s],u[s]=i.values.close):(i.values.close=R.fitToBounds(l+h[s],-100,100),i.values.open=h[s],h[s]=i.values.close)))))},recalculate:function(){var t,e=this.chart,n=e.graphs;for(t=0;t<n.length;t++){var r=n[t];if(r.valueAxis==this){var i="value";"candlestick"!=r.type&&"ohlc"!=r.type||(i="open");var o,a,s,l=this.end+2;l=R.fitToBounds(this.end+1,0,this.data.length-1);if(0<(d=this.start)&&d--,a=this.start,r.compareFromStart&&(a=0),!isNaN(e.startTime)&&(s=e.categoryAxis)){var u=s.minDuration(),h=(u=new Date(e.startTime+u/2),R.resetDateToMin(new Date(e.startTime),s.minPeriod).getTime());R.resetDateToMin(new Date(u),s.minPeriod).getTime()>h&&a++}for((s=e.recalculateFromDate)&&(s=R.getDate(s,e.dataDateFormat,"fff"),a=e.getClosestIndex(e.chartData,"time",s.getTime(),!0,0,e.chartData.length),l=e.chartData.length-1),s=a;s<=l&&(o=(a=this.data[s].axes[this.id].graphs[r.id]).values[i],r.recalculateValue&&(o=a.dataContext[r.valueField+r.recalculateValue]),isNaN(o));s++);for(this.recBaseValue=o,i=d;i<=l;i++){(a=this.data[i].axes[this.id].graphs[r.id]).percents={};var c,d=a.values;for(c in d)a.percents[c]="percents"!=c?d[c]/o*100-100:d[c]}}}},getMinMax:function(){var t,e=!1,n=this.chart,r=n.graphs;for(t=0;t<r.length;t++){var i=r[t].type;"line"!=i&&"step"!=i&&"smoothedLine"!=i||!this.expandMinMax||(e=!0)}if(e&&(0<this.start&&this.start--,this.end<this.data.length-1&&this.end++),"serial"==n.type&&(!0!==n.categoryAxis.parseDates||e||this.end<this.data.length-1&&this.end++),this.includeAllValues&&(this.start=0,this.end=this.data.length-1),e=this.minMaxMultiplier,n=this.getExtremes(this.start,this.end),this.min=n.min,this.max=n.max,this.minRR=this.min,this.maxRR=this.max,e=(this.max-this.min)*(e-1),this.min-=e,this.max+=e,e=this.guides.length,this.includeGuidesInMinMax&&0<e)for(n=0;n<e;n++)(r=this.guides[n]).toValue<this.min&&(this.min=r.toValue),r.value<this.min&&(this.min=r.value),r.toValue>this.max&&(this.max=r.toValue),r.value>this.max&&(this.max=r.value);isNaN(this.minimum)||(this.min=this.minimum),isNaN(this.maximum)||(this.max=this.maximum),"date"==this.type&&this.getDateMinMax(),this.min>this.max&&(e=this.max,this.max=this.min,this.min=e),isNaN(this.minZoom)||(this.min=this.minZoom),isNaN(this.maxZoom)||(this.max=this.maxZoom),this.minCalc=this.min,this.maxCalc=this.max,this.minReal=this.min,this.maxReal=this.max,0===this.min&&0===this.max&&(this.max=9),this.min>this.max&&(this.min=this.max-1),e=this.min,n=this.max,t=0===(r=this.max-this.min)?Math.pow(10,Math.floor(Math.log(Math.abs(this.max))*Math.LOG10E))/10:Math.pow(10,Math.floor(Math.log(Math.abs(r))*Math.LOG10E))/10,isNaN(this.maximum)&&(this.max=Math.ceil(this.max/t)*t+t),isNaN(this.minimum)&&(this.min=Math.floor(this.min/t)*t-t),this.min<0&&0<=e&&(this.min=0),0<this.max&&n<=0&&(this.max=0),"100%"==this.stackType&&(this.min=this.min<0?-100:0,this.max=this.max<0?0:100),r=this.max-this.min,t=Math.pow(10,Math.floor(Math.log(Math.abs(r))*Math.LOG10E))/10,this.step=Math.ceil(r/this.gridCountR/t)*t,r=Math.pow(10,Math.floor(Math.log(Math.abs(this.step))*Math.LOG10E)),r=R.fixStepE(r),5<(t=Math.ceil(this.step/r))&&(t=10),t<=5&&2<t&&(t=5),this.step=Math.ceil(this.step/(r*t))*r*t,isNaN(this.setStep)||(this.step=this.setStep),r<1?(this.maxDecCount=Math.abs(Math.log(Math.abs(r))*Math.LOG10E),this.maxDecCount=Math.round(this.maxDecCount),this.step=R.roundTo(this.step,this.maxDecCount+1)):this.maxDecCount=0,this.min=this.step*Math.floor(this.min/this.step),this.max=this.step*Math.ceil(this.max/this.step),this.min<0&&0<=e&&(this.min=0),0<this.max&&n<=0&&(this.max=0),1<this.minReal&&1<this.max-this.minReal&&(this.minReal=Math.floor(this.minReal)),r=Math.pow(10,Math.floor(Math.log(Math.abs(this.minReal))*Math.LOG10E)),0===this.min&&(this.minReal=r),0===this.min&&1<this.minReal&&(this.minReal=1),0<this.min&&0<this.minReal-this.step&&(this.minReal=this.min+this.step<this.minReal?this.min+this.step:this.min),this.logarithmic&&(2<Math.log(n)*Math.LOG10E-Math.log(e)*Math.LOG10E?(this.minReal=this.min=Math.pow(10,Math.floor(Math.log(Math.abs(e))*Math.LOG10E)),this.maxReal=this.max=Math.pow(10,Math.ceil(Math.log(Math.abs(n))*Math.LOG10E))):(e=Math.pow(10,Math.floor(Math.log(Math.abs(e))*Math.LOG10E))/10,Math.pow(10,Math.floor(Math.log(Math.abs(this.min))*Math.LOG10E))/10<e&&(this.minReal=this.min=10*e)))},getExtremes:function(t,e){var n,r,i;for(i=t;i<=e;i++){var o,a=this.data[i].axes[this.id].graphs;for(o in a)if(a.hasOwnProperty(o)){var s,l=this.chart.graphsById[o];if(l.includeInMinMax&&(!l.hidden||this.includeHidden))if(isNaN(n)&&(n=1/0),isNaN(r)&&(r=-1/0),this.foundGraphs=!0,l=a[o].values,this.recalculateToPercents&&(l=a[o].percents),this.minMaxField)(s=l[this.minMaxField])<n&&(n=s),r<s&&(r=s);else for(var u in l)l.hasOwnProperty(u)&&"percents"!=u&&"total"!=u&&"error"!=u&&((s=l[u])<n&&(n=s),r<s&&(r=s))}}return{min:n,max:r}},zoomOut:function(t){this.maxZoom=this.minZoom=NaN,this.zoomToRelativeValues(0,1,t)},zoomToRelativeValues:function(t,e,n){if(this.reversed){var r=t;t=1-e,e=1-r}var i=this.fullMax,o=(r=this.fullMin)+(i-r)*t,a=r+(i-r)*e;return 0<=this.minimum&&o<0&&(o=0),this.logarithmic&&(isNaN(this.minimum)||(r=this.minimum),isNaN(this.maximum)||(i=this.maximum),i=Math.log(i)*Math.LOG10E-Math.log(r)*Math.LOG10E,o=Math.pow(10,i*t+Math.log(r)*Math.LOG10E),a=Math.pow(10,i*e+Math.log(r)*Math.LOG10E)),this.zoomToValues(o,a,n)},zoomToValues:function(t,e,n){if(e<t){var r=e;e=t,t=r}var i=this.fullMax;r=this.fullMin;if(this.relativeStart=R.roundTo((t-r)/(i-r),9),this.relativeEnd=R.roundTo((e-r)/(i-r),9),this.logarithmic){isNaN(this.minimum)||(r=this.minimum),isNaN(this.maximum)||(i=this.maximum);i=Math.log(i)*Math.LOG10E-Math.log(r)*Math.LOG10E;var o=Math.log(e)/Math.LN10-Math.log(r)*Math.LOG10E;this.relativeStart=R.roundTo((Math.log(t)/Math.LN10-Math.log(r)*Math.LOG10E)/i,9),this.relativeEnd=R.roundTo(o/i,9)}if(this.minZoom!=t||this.maxZoom!=e)return this.minZoom=t,this.maxZoom=e,(r={type:"axisZoomed"}).chart=this.chart,r.valueAxis=this,r.startValue=t,r.endValue=e,r.relativeStart=this.relativeStart,r.relativeEnd=this.relativeEnd,this.prevStartValue==t&&this.prevEndValue==e||this.fire(r),this.prevStartValue=t,this.prevEndValue=e,n||(t={},R.copyProperties(r,t),t.type="axisIntZoomed",this.fire(t)),0===this.relativeStart&&1==this.relativeEnd&&(this.maxZoom=this.minZoom=NaN),!0},coordinateToValue:function(t){if(isNaN(t))return NaN;var e=this.axisWidth,n=this.stepWidth,r=this.reversed,i=this.rotate,o=this.min,a=this.minReal;return!0===this.logarithmic?Math.pow(10,(i?!0===r?(e-t)/n:t/n:!0===r?t/n:(e-t)/n)+Math.log(a)*Math.LOG10E):!0===r?i?o-(t-e)/n:t/n+o:i?t/n+o:o-(t-e)/n},getCoordinate:function(t,e){if(isNaN(t))return NaN;var n=this.rotate,r=this.reversed,i=this.axisWidth,o=this.stepWidth,a=this.min,s=this.minReal;return n=!0===this.logarithmic?(0===t&&(t=this.treatZeroAs),a=Math.log(t)*Math.LOG10E-Math.log(s)*Math.LOG10E,n?!0===r?i-o*a:o*a:!0===r?o*a:i-o*a):!0===r?n?i-o*(t-a):o*(t-a):n?o*(t-a):i-o*(t-a),1e7<Math.abs(n)&&(n=n/Math.abs(n)*1e7),e||(n=Math.round(n)),n},synchronizeWithAxis:function(t){this.synchronizeWith=t,this.listenTo(this.synchronizeWith,"axisChanged",this.handleSynchronization)},handleSynchronization:function(){if(this.synchronizeWith){R.isString(this.synchronizeWith)&&(this.synchronizeWith=this.chart.getValueAxisById(this.synchronizeWith));var t=(n=this.synchronizeWith).min,e=n.max,n=n.step,r=this.synchronizationMultiplier;r&&(this.min=t*r,this.max=e*r,this.step=n*r,t=Math.abs(Math.log(Math.abs(Math.pow(10,Math.floor(Math.log(Math.abs(this.step))*Math.LOG10E))))*Math.LOG10E),this.maxDecCount=t=Math.round(t),this.draw())}}})}(),function(){var f=window.AmCharts;f.RecAxis=f.Class({construct:function(t){var e=t.chart,n=t.axisThickness,r=t.axisColor,i=t.axisAlpha,o=t.offset,a=t.dx,s=t.dy,l=t.x,u=t.y,h=t.height,c=t.width,d=e.container;n="H"==t.orientation?(r=f.line(d,[0,c],[0,0],r,i,n),this.axisWidth=t.width,"bottom"==t.position?(s=n/2+o+h+u-1,l):(s=-n/2-o+u+s,a+l)):(this.axisWidth=t.height,"right"==t.position?(r=f.line(d,[0,0,-a],[0,h,h-s],r,i,n),s=u+s,n/2+o+a+c+l-1):(r=f.line(d,[0,0],[0,h],r,i,n),s=u,-n/2-o+l)),r.translate(n,s),(n=e.container.set()).push(r),e.axesSet.push(n),f.setCN(e,r,t.bcn+"line"),this.axisSet=n,this.set=r}})}(),function(){var Q=window.AmCharts;Q.RecItem=Q.Class({construct:function(t,e,n,r,i,o,a,s,l,u,h,c){e=Math.round(e);var d=t.chart;null==(this.value=n)&&(n=""),l=l||0,null==r&&(r=!0);var f=d.fontFamily,p=t.fontSize;null==p&&(p=d.fontSize);var g=t.color;null==g&&(g=d.color),void 0!==h&&(g=h);var v=t.chart.container,m=v.set();this.set=m;var y=t.axisThickness,w=t.axisColor,b=t.axisAlpha,C=t.tickLength,E=t.gridAlpha,S=t.gridThickness,O=t.gridColor,T=t.dashLength,N=t.fillColor,R=t.fillAlpha,_=t.labelsEnabled;h=t.labelRotationR;var M,A,k=t.counter,x=t.inside,I=t.labelOffset,D=t.dx,L=t.dy,P=t.orientation,H=t.position,B=t.previousCoord,F=t.height,V=t.width,j=t.offset;a?(void 0!==a.id&&(c=d.classNamePrefix+"-guide-"+a.id),_=!0,isNaN(a.tickLength)||(C=a.tickLength),null!=a.lineColor&&(O=a.lineColor),null!=a.color&&(g=a.color),isNaN(a.lineAlpha)||(E=a.lineAlpha),isNaN(a.dashLength)||(T=a.dashLength),isNaN(a.lineThickness)||(S=a.lineThickness),!0===a.inside&&(x=!0,0<j&&(j=0)),isNaN(a.labelRotation)||(h=a.labelRotation),isNaN(a.fontSize)||(p=a.fontSize),a.position&&(H=a.position),void 0!==a.boldLabel&&(s=a.boldLabel),isNaN(a.labelOffset)||(I=a.labelOffset)):""===n&&(C=0),u&&!isNaN(t.minorTickLength)&&(C=t.minorTickLength);var W="start";0<i&&(W="middle"),t.centerLabels&&(W="middle");var U,z,G,Y=h*Math.PI/180,$=0,X=0,K=0,q=U=0,Z=0;"V"==P&&(h=0),_&&""!==n&&(q=(W=(G=t.autoWrap&&0===h?Q.wrappedText(v,n,g,f,p,W,s,Math.abs(i),0):Q.text(v,n,g,f,p,W,s)).getBBox()).width,Z=W.height),"H"==P?(0<=e&&e<=V+1&&(0<C&&0<b&&e+l<=V+1&&(M=Q.line(v,[e+l,e+l],[0,C],w,b,S),m.push(M)),0<E&&(A=Q.line(v,[e,e+D,e+D],[F,F+L,L],O,E,S,T),m.push(A))),X=0,$=e,a&&90==h&&x&&($-=p),!1===r?(W="start",X="bottom"==H?x?X+C:X-C:x?X-C:X+C,$+=3,0<i&&($+=i/2-3,W="middle"),0<h&&(W="middle")):W="middle",1==k&&0<R&&!a&&!u&&B<V&&(0<(U=(r=Q.fitToBounds(e,0,V))-(B=Q.fitToBounds(B,0,V)))&&((z=Q.rect(v,U,t.height,N,R)).translate(r-U+D,L),m.push(z))),"bottom"==H?(X+=F+p/2+j,x?(0<h?(X=F-q/2*Math.sin(Y)-C-3,t.centerRotatedLabels||($+=q/2*Math.cos(Y)-4+2)):h<0?(X=F+q*Math.sin(Y)-C-3+2,$+=-q*Math.cos(Y)-Z*Math.sin(Y)-4):X-=C+p+3+3,X-=I):(0<h?(X=F+q/2*Math.sin(Y)+C+3,t.centerRotatedLabels||($-=q/2*Math.cos(Y))):h<0?(X=F+C+3-q/2*Math.sin(Y)+2,$+=q/2*Math.cos(Y)):X+=C+y+3+3,X+=I)):(X+=L+p/2-j,$+=D,x?(0<h?(X=q/2*Math.sin(Y)+C+3,t.centerRotatedLabels||($-=q/2*Math.cos(Y))):X+=C+3,X+=I):(0<h?(X=-q/2*Math.sin(Y)-C-6,t.centerRotatedLabels||($+=q/2*Math.cos(Y))):X-=C+p+3+y+3,X-=I)),U="bottom"==H?(x?F-C-1:F+y-1)+j:(K=D,(x?L:L-C-y+1)-j),o&&($+=o),p=$,0<h&&(p+=q/2*Math.cos(Y)),G&&(o=0,x&&(o=q/2*Math.cos(Y)),V+2<p+o||p<0)&&(G.remove(),G=null)):(0<=e&&e<=F+1&&(0<C&&0<b&&e+l<=F+1&&(M=Q.line(v,[0,C+1],[e+l,e+l],w,b,S),m.push(M)),0<E&&(A=Q.line(v,[0,D,V+D],[e,e+L,e+L],O,E,S,T),m.push(A))),W="end",(!0===x&&"left"==H||!1===x&&"right"==H)&&(W="start"),X=e-Z/2+2,1==k&&0<R&&!a&&!u&&(Y=(r=Q.fitToBounds(e,0,F))-(B=Q.fitToBounds(B,0,F)),(z=Q.polygon(v,[0,t.width,t.width,0],[0,0,Y,Y],N,R)).translate(D,r-Y+L),m.push(z)),X+=p/2,"right"==H?($+=D+V+j,X+=L,x?(o||(X-=p/2+3),$=$-(C+4)-I):($+=C+4+y,X-=2,$+=I)):x?($+=C+4-j,o||(X-=p/2+3),a&&($+=D,X+=L),$+=I):($+=-C-y-4-2-j,X-=2,$-=I),M&&("right"==H?(K+=D+j+V-1,U+=L,K=x?K-y:K+y):(K-=j,x||(K-=C+y))),o&&(X+=o),x=-3,"right"==H&&(x+=L),G&&(F+1<X||X<x-p/10)&&(G.remove(),G=null)),M&&(M.translate(K,U),Q.setCN(d,M,t.bcn+"tick"),Q.setCN(d,M,c,!0),a&&Q.setCN(d,M,"guide")),!1===t.visible&&(M&&M.remove(),G&&(G.remove(),G=null)),G&&(G.attr({"text-anchor":W}),G.translate($,X,NaN,!0),0!==h&&G.rotate(-h,t.chart.backgroundColor),t.allLabels.push(G),this.label=G,Q.setCN(d,G,t.bcn+"label"),Q.setCN(d,G,c,!0),a&&Q.setCN(d,G,"guide")),A&&(Q.setCN(d,A,t.bcn+"grid"),Q.setCN(d,A,c,!0),a&&Q.setCN(d,A,"guide")),z&&(Q.setCN(d,z,t.bcn+"fill"),Q.setCN(d,z,c,!0)),u?A&&Q.setCN(d,A,t.bcn+"grid-minor"):(t.counter=0===k?1:0,t.previousCoord=e),0===this.set.node.childNodes.length&&this.set.remove()},graphics:function(){return this.set},getLabel:function(){return this.label}})}(),function(){var c=window.AmCharts;c.RecFill=c.Class({construct:function(t,e,n,r){var i=t.dx,o=t.dy,a=t.orientation,s=0;if(n<e){var l=e;e=n,n=l}var u=r.fillAlpha;isNaN(u)&&(u=0);l=t.chart.container;var h=r.fillColor;n="V"==a?(e=c.fitToBounds(e,0,t.height),c.fitToBounds(n,0,t.height)):(e=c.fitToBounds(e,0,t.width),c.fitToBounds(n,0,t.width)),n-=e,isNaN(n)&&(n=4,s=2,u=0),n<0&&"object"==typeof h&&(h=h.join(",").split(",").reverse()),"V"==a?(a=c.rect(l,t.width,n,h,u)).translate(i,e-s+o):(a=c.rect(l,n,t.height,h,u)).translate(e-s+i,o),c.setCN(t.chart,a,"guide-fill"),r.id&&c.setCN(t.chart,a,"guide-fill-"+r.id),this.set=l.set([a])},graphics:function(){return this.set},getLabel:function(){}})}(),function(){var c=window.AmCharts;c.AmChart=c.Class({construct:function(t){this.svgIcons=this.tapToActivate=!0,this.theme=t,this.classNamePrefix="amcharts",this.addClassNames=!1,this.version="3.21.14",c.addChart(this),this.createEvents("buildStarted","dataUpdated","init","rendered","drawn","failed","resized","animationFinished"),this.height=this.width="100%",this.dataChanged=!0,this.chartCreated=!1,this.previousWidth=this.previousHeight=0,this.backgroundColor="#FFFFFF",this.borderAlpha=this.backgroundAlpha=0,this.color=this.borderColor="#000000",this.fontFamily="Verdana",this.fontSize=11,this.usePrefixes=!1,this.autoResize=!0,this.autoDisplay=!1,this.addCodeCredits=this.accessible=!0,this.touchStartTime=this.touchClickDuration=0,this.precision=-1,this.percentPrecision=2,this.decimalSeparator=".",this.thousandsSeparator=",",this.labels=[],this.allLabels=[],this.titles=[],this.marginRight=this.marginLeft=this.autoMarginOffset=0,this.timeOuts=[],this.creditsPosition="top-left";var e=document.createElement("div"),n=e.style;n.overflow="hidden",n.position="relative",n.textAlign="left",this.chartDiv=e,(n=(e=document.createElement("div")).style).overflow="hidden",n.position="relative",n.textAlign="left",this.legendDiv=e,this.titleHeight=0,this.hideBalloonTime=150,this.handDrawScatter=2,this.cssScale=this.handDrawThickness=1,this.cssAngle=0,this.prefixesOfBigNumbers=[{number:1e3,prefix:"k"},{number:1e6,prefix:"M"},{number:1e9,prefix:"G"},{number:1e12,prefix:"T"},{number:1e15,prefix:"P"},{number:1e18,prefix:"E"},{number:1e21,prefix:"Z"},{number:1e24,prefix:"Y"}],this.prefixesOfSmallNumbers=[{number:1e-24,prefix:"y"},{number:1e-21,prefix:"z"},{number:1e-18,prefix:"a"},{number:1e-15,prefix:"f"},{number:1e-12,prefix:"p"},{number:1e-9,prefix:"n"},{number:1e-6,prefix:"Î¼"},{number:.001,prefix:"m"}],this.panEventsEnabled=!0,this.product="amcharts",this.animations=[],this.balloon=new c.AmBalloon(this.theme),(this.balloon.chart=this).processTimeout=0,this.processCount=1e3,this.animatable=[],this.langObj={},c.applyTheme(this,t,"AmChart")},drawChart:function(){0<this.realWidth&&0<this.realHeight&&(this.drawBackground(),this.redrawLabels(),this.drawTitles(),this.brr(),this.renderFix(),this.chartDiv&&(this.boundingRect=this.chartDiv.getBoundingClientRect()))},makeAccessible:function(t,e,n){this.accessible&&t&&(n&&t.setAttr("role",n),t.setAttr("aria-label",e))},drawBackground:function(){c.remove(this.background);var t=this.container,e=this.backgroundColor,n=this.backgroundAlpha,r=this.set;c.isModern||0!==n||(n=.001);var i=this.updateWidth();this.realWidth=i;var o=this.updateHeight();this.realHeight=o,e=c.polygon(t,[0,i-1,i-1,0],[0,0,o-1,o-1],e,n,1,this.borderColor,this.borderAlpha),c.setCN(this,e,"bg"),this.background=e,r.push(e),(e=this.backgroundImage)&&(t=t.image(e,0,0,i,o),c.setCN(this,e,"bg-image"),this.bgImg=t,r.push(t))},drawTitles:function(t){var e=this.titles;if(this.titleHeight=0,c.ifArray(e)){var n,r=20;for(n=0;n<e.length;n++){var i=e[n];if(!1!==(i=c.processObject(i,c.Title,this.theme)).enabled){var o=i.color;void 0===o&&(o=this.color);var a=i.size;isNaN(a)&&(a=this.fontSize+2),isNaN(i.alpha);var s=this.marginLeft,l=!0;void 0!==i.bold&&(l=i.bold),(o=c.wrappedText(this.container,i.text,o,this.fontFamily,a,"middle",l,this.realWidth-35-this.marginRight-s)).translate(s+(this.realWidth-this.marginRight-s)/2,r),o.node.style.pointerEvents="none",i.sprite=o,void 0!==i.tabIndex&&o.setAttr("tabindex",i.tabIndex),c.setCN(this,o,"title"),i.id&&c.setCN(this,o,"title-"+i.id),o.attr({opacity:i.alpha}),r+=o.getBBox().height+5,t?o.remove():this.freeLabelsSet.push(o)}}this.titleHeight=r-10}},write:function(t){var e=this;if(e.listeners)for(var n=0;n<e.listeners.length;n++){var r=e.listeners[n];e.addListener(r.event,r.method)}e.fire({type:"buildStarted",chart:e}),e.afterWriteTO&&clearTimeout(e.afterWriteTO),0<e.processTimeout?e.afterWriteTO=setTimeout(function(){e.afterWrite.call(e,t)},e.processTimeout):e.afterWrite(t)},afterWrite:function(t){var e;if(e="object"!=typeof t?document.getElementById(t):t){for(;e.firstChild;)e.removeChild(e.firstChild);(this.div=e).style.overflow="hidden",e.style.textAlign="left",t=this.chartDiv;var n=this.legendDiv,r=this.legend,i=n.style,o=t.style;this.measure(),this.previousHeight=this.divRealHeight,this.previousWidth=this.divRealWidth;var a,s=document.createElement("div");if((a=s.style).position="relative",(this.containerDiv=s).className=this.classNamePrefix+"-main-div",t.className=this.classNamePrefix+"-chart-div",e.appendChild(s),(e=this.exportConfig)&&c.AmExport&&!this.AmExport&&(this.AmExport=new c.AmExport(this,e)),this.amExport&&c.AmExport&&(this.AmExport=c.extend(this.amExport,new c.AmExport(this),!0)),this.AmExport&&this.AmExport.init&&this.AmExport.init(),r){if((r=this.addLegend(r,r.divId)).enabled)switch(i.left=null,i.top=null,i.right=null,o.left=null,o.right=null,o.top=null,i.position="relative",o.position="relative",a.width="100%",a.height="100%",r.position){case"bottom":s.appendChild(t),s.appendChild(n);break;case"top":s.appendChild(n),s.appendChild(t);break;case"absolute":i.position="absolute",o.position="absolute",void 0!==r.left&&(i.left=r.left+"px"),void 0!==r.right&&(i.right=r.right+"px"),void 0!==r.top&&(i.top=r.top+"px"),void 0!==r.bottom&&(i.bottom=r.bottom+"px"),r.marginLeft=0,r.marginRight=0,s.appendChild(t),s.appendChild(n);break;case"right":i.position="relative",o.position="absolute",s.appendChild(t),s.appendChild(n);break;case"left":i.position="absolute",o.position="relative",s.appendChild(t),s.appendChild(n);break;case"outside":s.appendChild(t)}else s.appendChild(t);this.prevLegendPosition=r.position}else s.appendChild(t);this.listenersAdded||(this.addListeners(),this.listenersAdded=!0),(this.mouseWheelScrollEnabled||this.mouseWheelZoomEnabled)&&c.addWheelListeners(),this.initChart()}},createLabelsSet:function(){c.remove(this.labelsSet),this.labelsSet=this.container.set(),this.freeLabelsSet.push(this.labelsSet)},initChart:function(){this.balloon=c.processObject(this.balloon,c.AmBalloon,this.theme),window.AmCharts_path&&(this.path=window.AmCharts_path),void 0===this.path&&(this.path=c.getPath()),void 0===this.path&&(this.path="amcharts/"),this.path=c.normalizeUrl(this.path),void 0===this.pathToImages&&(this.pathToImages=this.path+"images/"),this.initHC||(c.callInitHandler(this),this.initHC=!0),c.applyLang(this.language,this);var t=this.numberFormatter;t&&(isNaN(t.precision)||(this.precision=t.precision),void 0!==t.thousandsSeparator&&(this.thousandsSeparator=t.thousandsSeparator),void 0!==t.decimalSeparator&&(this.decimalSeparator=t.decimalSeparator)),(t=this.percentFormatter)&&!isNaN(t.precision)&&(this.percentPrecision=t.precision),this.nf={precision:this.precision,thousandsSeparator:this.thousandsSeparator,decimalSeparator:this.decimalSeparator},this.pf={precision:this.percentPrecision,thousandsSeparator:this.thousandsSeparator,decimalSeparator:this.decimalSeparator},this.destroy(),(t=this.container)?(t.container.innerHTML="",t.width=this.realWidth,t.height=this.realHeight,t.addDefs(this),this.chartDiv.appendChild(t.container)):t=new c.AmDraw(this.chartDiv,this.realWidth,this.realHeight,this),this.container=t,this.extension=".png",this.svgIcons&&c.SVG&&(this.extension=".svg"),this.checkDisplay(),this.checkTransform(this.div),t.chart=this,c.VML||c.SVG?(t.handDrawn=this.handDrawn,t.handDrawScatter=this.handDrawScatter,t.handDrawThickness=this.handDrawThickness,c.remove(this.set),this.set=t.set(),c.remove(this.gridSet),this.gridSet=t.set(),c.remove(this.cursorLineSet),this.cursorLineSet=t.set(),c.remove(this.graphsBehindSet),this.graphsBehindSet=t.set(),c.remove(this.bulletBehindSet),this.bulletBehindSet=t.set(),c.remove(this.columnSet),this.columnSet=t.set(),c.remove(this.graphsSet),this.graphsSet=t.set(),c.remove(this.trendLinesSet),this.trendLinesSet=t.set(),c.remove(this.axesSet),this.axesSet=t.set(),c.remove(this.cursorSet),this.cursorSet=t.set(),c.remove(this.scrollbarsSet),this.scrollbarsSet=t.set(),c.remove(this.bulletSet),this.bulletSet=t.set(),c.remove(this.freeLabelsSet),this.freeLabelsSet=t.set(),c.remove(this.axesLabelsSet),this.axesLabelsSet=t.set(),c.remove(this.balloonsSet),this.balloonsSet=t.set(),c.remove(this.plotBalloonsSet),this.plotBalloonsSet=t.set(),c.remove(this.zoomButtonSet),this.zoomButtonSet=t.set(),c.remove(this.zbSet),this.zbSet=null,c.remove(this.linkSet),this.linkSet=t.set()):this.fire({type:"failed",chart:this})},premeasure:function(){var t=this.div;if(t){try{this.boundingRect=this.chartDiv.getBoundingClientRect()}catch(t){}var e=t.offsetWidth,n=t.offsetHeight;t.clientHeight&&(e=t.clientWidth,n=t.clientHeight),e==this.mw&&n==this.mh||(this.mw=e,this.mh=n,this.measure())}},measure:function(){if(i=this.div){var t=this.chartDiv,e=i.offsetWidth,n=i.offsetHeight,r=this.container;i.clientHeight&&(e=i.clientWidth,n=i.clientHeight);n=Math.round(n),e=Math.round(e);var i=Math.round(c.toCoordinate(this.width,e)),o=Math.round(c.toCoordinate(this.height,n));(e!=this.previousWidth||n!=this.previousHeight)&&0<i&&0<o&&(t.style.width=i+"px",t.style.height=o+"px",t.style.padding=0,r&&r.setSize(i,o),this.balloon=c.processObject(this.balloon,c.AmBalloon,this.theme)),this.balloon&&this.balloon.setBounds&&this.balloon.setBounds(2,2,i-2,o),this.updateWidth(),(this.balloon.chart=this).realWidth=i,this.realHeight=o,this.divRealWidth=e,this.divRealHeight=n}},checkDisplay:function(){if(this.autoDisplay&&this.container){var t=c.rect(this.container,10,10),e=t.getBBox();0===e.width&&0===e.height&&(this.divRealHeight=this.divRealWidth=this.realHeight=this.realWidth=0,this.previousWidth=this.previousHeight=NaN),t.remove()}},checkTransform:function(t){if(this.autoTransform&&window.getComputedStyle&&t){if(t.style)if((e=(e=window.getComputedStyle(t,null))&&(e.getPropertyValue("-webkit-transform")||e.getPropertyValue("-moz-transform")||e.getPropertyValue("-ms-transform")||e.getPropertyValue("-o-transform")||e.getPropertyValue("transform")))&&"none"!==e){var e=(n=e.split("(")[1].split(")")[0].split(","))[0],n=n[1];e=Math.sqrt(e*e+n*n);isNaN(e)||(this.cssScale*=e)}t.parentNode&&this.checkTransform(t.parentNode)}},destroy:function(){this.chartDiv.innerHTML="",this.clearTimeOuts(),this.legend&&this.legend.destroy&&this.legend.destroy()},clearTimeOuts:function(){var t,e=this.timeOuts;if(e)for(t=0;t<e.length;t++)clearTimeout(e[t]);this.timeOuts=[]},clear:function(t){try{document.removeEventListener("touchstart",this.docfn1,!0),document.removeEventListener("touchend",this.docfn2,!0)}catch(t){}if(c.callMethod("clear",[this.chartScrollbar,this.scrollbarV,this.scrollbarH,this.chartCursor]),this.chartCursor=this.scrollbarH=this.scrollbarV=this.chartScrollbar=null,this.clearTimeOuts(),this.container&&(this.container.remove(this.chartDiv),this.container.remove(this.legendDiv)),t||c.removeChart(this),t=this.div)for(;t.firstChild;)t.removeChild(t.firstChild);this.legend&&this.legend.destroy&&this.legend.destroy(),this.AmExport&&this.AmExport.clear&&this.AmExport.clear()},setMouseCursor:function(t){"auto"==t&&c.isNN&&(t="default"),this.chartDiv.style.cursor=t,this.legendDiv.style.cursor=t},redrawLabels:function(){this.labels=[];var t,e=this.allLabels;for(this.createLabelsSet(),t=0;t<e.length;t++)this.drawLabel(e[t])},drawLabel:function(t){var e=this;if(e.container&&!1!==t.enabled){var n=(t=c.processObject(t,c.Label,e.theme)).y,r=t.text,i=t.align,o=t.size,a=t.color,s=t.rotation,l=t.alpha,u=t.bold,h=c.toCoordinate(t.x,e.realWidth);h=h||0,n=(n=c.toCoordinate(n,e.realHeight))||0,void 0===a&&(a=e.color),isNaN(o)&&(o=e.fontSize),"left"==(i=i||"start")&&(i="start"),"right"==i&&(i="end"),"center"==i&&(i="middle",s?n=e.realHeight-n+n/2:h=e.realWidth/2-h),void 0===l&&(l=1),void 0===s&&(s=0),n+=o/2,(r=c.text(e.container,r,a,e.fontFamily,o,i,u,l)).translate(h,n),void 0!==t.tabIndex&&r.setAttr("tabindex",t.tabIndex),c.setCN(e,r,"label"),t.id&&c.setCN(e,r,"label-"+t.id),0!==s&&r.rotate(s),t.url?(r.setAttr("cursor","pointer"),r.click(function(){c.getURL(t.url,e.urlTarget)})):r.node.style.pointerEvents="none",e.labelsSet.push(r),e.labels.push(r)}},addLabel:function(t,e,n,r,i,o,a,s,l,u){t={x:t,y:e,text:n,align:r,size:i,color:o,alpha:s,rotation:a,bold:l,url:u,enabled:!0},this.container&&this.drawLabel(t),this.allLabels.push(t)},clearLabels:function(){var t,e=this.labels;for(t=e.length-1;0<=t;t--)e[t].remove();this.labels=[],this.allLabels=[]},updateHeight:function(){var t=this.divRealHeight;if(e=this.legend){var e,n=this.legendDiv.offsetHeight;"top"!=(e=e.position)&&"bottom"!=e||(((t-=n)<0||isNaN(t))&&(t=0),this.chartDiv.style.height=t+"px")}return t},updateWidth:function(){var t=this.divRealWidth,e=this.divRealHeight,n=this.legend;if(n){var r=(o=this.legendDiv).offsetWidth;isNaN(n.width)||(r=n.width),n.ieW&&(r=n.ieW);var i=o.offsetHeight,o=o.style,a=this.chartDiv.style,s=n.position;"right"!=s&&"left"!=s||void 0!==n.divId||(((t-=r)<0||isNaN(t))&&(t=0),a.width=t+"px",this.balloon&&this.balloon.setBounds&&this.balloon.setBounds(2,2,t-2,this.realHeight),"left"==s?(a.left=r+"px",o.left="0px"):(a.left="0px",o.left=t+"px"),i<e&&(o.top=(e-i)/2+"px"))}return t},getTitleHeight:function(){return this.drawTitles(!0),this.titleHeight},addTitle:function(t,e,n,r,i){return isNaN(e)&&(e=this.fontSize+2),t={text:t,size:e,color:n,alpha:r,bold:i,enabled:!0},this.titles.push(t),t},handleWheel:function(t){var e=0;(t=t||window.event).wheelDelta?e=t.wheelDelta/120:t.detail&&(e=-t.detail/3),e&&this.handleWheelReal(e,t.shiftKey),t.preventDefault&&t.preventDefault()},handleWheelReal:function(){},handleDocTouchStart:function(){this.handleMouseMove(),this.tmx=this.mouseX,this.tmy=this.mouseY,this.touchStartTime=(new Date).getTime()},handleDocTouchEnd:function(){-.5<this.tmx&&this.tmx<this.divRealWidth+1&&0<this.tmy&&this.tmy<this.divRealHeight?(this.handleMouseMove(),Math.abs(this.mouseX-this.tmx)<4&&Math.abs(this.mouseY-this.tmy)<4?(this.tapped=!0,this.panRequired&&this.panEventsEnabled&&this.chartDiv&&(this.chartDiv.style.msTouchAction="none",this.chartDiv.style.touchAction="none")):this.mouseIsOver||this.resetTouchStyle()):(this.tapped=!1,this.resetTouchStyle())},resetTouchStyle:function(){this.panEventsEnabled&&this.chartDiv&&(this.chartDiv.style.msTouchAction="auto",this.chartDiv.style.touchAction="auto")},checkTouchDuration:function(t){var e=this,n=(new Date).getTime();if(t)if(t.touches)e.isTouchEvent=!0;else if(!e.isTouchEvent)return!0;if(n-e.touchStartTime>e.touchClickDuration)return!0;setTimeout(function(){e.resetTouchDuration()},300)},resetTouchDuration:function(){this.isTouchEvent=!1},checkTouchMoved:function(){if(4<Math.abs(this.mouseX-this.tmx)||4<Math.abs(this.mouseY-this.tmy))return!0},addListeners:function(){var e=this,t=e.chartDiv;document.addEventListener?("ontouchstart"in document.documentElement&&(t.addEventListener("touchstart",function(t){e.handleTouchStart.call(e,t)},!0),t.addEventListener("touchmove",function(t){e.handleMouseMove.call(e,t)},!0),t.addEventListener("touchend",function(t){e.handleTouchEnd.call(e,t)},!0),e.docfn1=function(t){e.handleDocTouchStart.call(e,t)},e.docfn2=function(t){e.handleDocTouchEnd.call(e,t)},document.addEventListener("touchstart",e.docfn1,!0),document.addEventListener("touchend",e.docfn2,!0)),t.addEventListener("mousedown",function(t){e.mouseIsOver=!0,e.handleMouseMove.call(e,t),e.handleMouseDown.call(e,t),e.handleDocTouchStart.call(e,t)},!0),t.addEventListener("mouseover",function(t){e.handleMouseOver.call(e,t)},!0),t.addEventListener("mouseout",function(t){e.handleMouseOut.call(e,t)},!0),t.addEventListener("mouseup",function(t){e.handleDocTouchEnd.call(e,t)},!0)):(t.attachEvent("onmousedown",function(t){e.handleMouseDown.call(e,t)}),t.attachEvent("onmouseover",function(t){e.handleMouseOver.call(e,t)}),t.attachEvent("onmouseout",function(t){e.handleMouseOut.call(e,t)}))},dispDUpd:function(){this.skipEvents||(this.dispatchDataUpdated&&(this.dispatchDataUpdated=!1,this.fire({type:"dataUpdated",chart:this})),this.chartCreated||(this.chartCreated=!0,this.fire({type:"init",chart:this})),!this.chartRendered&&0<this.divRealWidth&&0<this.divRealHeight&&(this.fire({type:"rendered",chart:this}),this.chartRendered=!0),this.fire({type:"drawn",chart:this})),this.skipEvents=!1},validateSize:function(){var t=this;if(t.premeasure(),t.checkDisplay(),t.cssScale=1,t.cssAngle=0,t.checkTransform(t.div),t.divRealWidth!=t.previousWidth||t.divRealHeight!=t.previousHeight){var e=t.legend;if(0<t.realWidth&&0<t.realHeight){if(t.sizeChanged=!0,e){t.legendInitTO&&clearTimeout(t.legendInitTO);var n=setTimeout(function(){e.invalidateSize()},10);t.timeOuts.push(n),t.legendInitTO=n}t.marginsUpdated=!1,clearTimeout(t.initTO),n=setTimeout(function(){t.initChart()},10),t.timeOuts.push(n),t.initTO=n}t.renderFix(),e&&e.renderFix&&e.renderFix(),t.positionCred(),clearTimeout(t.resizedTO),t.resizedTO=setTimeout(function(){t.fire({type:"resized",chart:t})},10),t.previousHeight=t.divRealHeight,t.previousWidth=t.divRealWidth}},invalidateSize:function(){this.previousHeight=this.previousWidth=NaN,this.invalidateSizeReal()},invalidateSizeReal:function(){var t=this;t.marginsUpdated=!1,clearTimeout(t.validateTO);var e=setTimeout(function(){t.validateSize()},5);t.timeOuts.push(e),t.validateTO=e},validateData:function(t){this.chartCreated&&(this.dataChanged=!0,this.marginsUpdated=!1,this.initChart(t))},validateNow:function(t,e){this.initTO&&clearTimeout(this.initTO),t&&(this.dataChanged=!0,this.marginsUpdated=!1),this.skipEvents=e,this.chartRendered=!1;var n=this.legend;n&&n.position!=this.prevLegendPosition&&(this.previousWidth=this.mw=0,n.invalidateSize&&(n.invalidateSize(),this.validateSize())),this.write(this.div)},showItem:function(t){t.hidden=!1,this.initChart()},hideItem:function(t){t.hidden=!0,this.initChart()},hideBalloon:function(){var t=this;clearTimeout(t.hoverInt),clearTimeout(t.balloonTO),t.hoverInt=setTimeout(function(){t.hideBalloonReal.call(t)},t.hideBalloonTime)},cleanChart:function(){},hideBalloonReal:function(){var t=this.balloon;t&&t.hide&&t.hide()},showBalloon:function(t,e,n,r,i){var o=this;clearTimeout(o.balloonTO),clearTimeout(o.hoverInt),o.balloonTO=setTimeout(function(){o.showBalloonReal.call(o,t,e,n,r,i)},1)},showBalloonReal:function(t,e,n,r,i){this.handleMouseMove();var o=this.balloon;o.enabled&&(o.followCursor(!1),o.changeColor(e),!n||o.fixedPosition?(o.setPosition(r,i),isNaN(r)||isNaN(i)?o.followCursor(!0):o.followCursor(!1)):o.followCursor(!0),t&&o.showBalloon(t))},handleMouseOver:function(){this.outTO&&clearTimeout(this.outTO),c.resetMouseOver(),this.mouseIsOver=!0},handleMouseOut:function(){var t=this;c.resetMouseOver(),t.outTO&&clearTimeout(t.outTO),t.outTO=setTimeout(function(){t.handleMouseOutReal()},10)},handleMouseOutReal:function(){this.mouseIsOver=!1},handleMouseMove:function(t){var e,n,r,i;if(t=t||window.event,this.mouse2Y=this.mouse2X=NaN,t){if(t.touches){var o=t.touches.item(1);if(o&&this.panEventsEnabled&&this.boundingRect&&(r=o.clientX-this.boundingRect.left,i=o.clientY-this.boundingRect.top),!(t=t.touches.item(0)))return}else this.wasTouched=!1;this.boundingRect&&t.clientX&&(e=t.clientX-this.boundingRect.left,n=t.clientY-this.boundingRect.top),isNaN(r)?this.mouseX=e:(this.mouseX=Math.min(e,r),this.mouse2X=Math.max(e,r)),isNaN(i)?this.mouseY=n:(this.mouseY=Math.min(n,i),this.mouse2Y=Math.max(n,i)),this.autoTransform&&(this.mouseX/=this.cssScale,this.mouseY/=this.cssScale)}},handleTouchStart:function(t){this.hideBalloonReal(),t&&(t.touches&&this.tapToActivate&&!this.tapped||!this.panRequired)||(this.handleMouseMove(t),this.handleMouseDown(t))},handleTouchEnd:function(t){this.wasTouched=!0,this.handleMouseMove(t),c.resetMouseOver(),this.handleReleaseOutside(t)},handleReleaseOutside:function(){this.handleDocTouchEnd.call(this)},handleMouseDown:function(t){c.resetMouseOver(),this.mouseIsOver=!0,t&&t.preventDefault&&(this.panEventsEnabled?t.preventDefault():t.touches||t.preventDefault())},handleKeyUp:function(t){},addLegend:function(t,e){var n;return(t=c.processObject(t,c.AmLegend,this.theme)).divId=e,t.ieW=0,n="object"!=typeof e&&e?document.getElementById(e):e,(this.legend=t).chart=this,n?(t.div=n,t.position="outside",t.autoMargins=!1):t.div=this.legendDiv,t},removeLegend:function(){this.legend=void 0,this.previousWidth=0,this.legendDiv.innerHTML=""},handleResize:function(){(c.isPercents(this.width)||c.isPercents(this.height))&&this.invalidateSizeReal(),this.renderFix()},renderFix:function(){if(!c.VML){var t=this.container;t&&t.renderFix()}},getSVG:function(){if(c.hasSVG)return this.container},animate:function(t,e,n,r,i,o,a){return t["an_"+e]&&c.removeFromArray(this.animations,t["an_"+e]),n={obj:t,frame:0,attribute:e,from:n,to:r,time:i,effect:o,suffix:a},t["an_"+e]=n,this.animations.push(n),n},setLegendData:function(t){var e=this.legend;e&&e.setData(t)},stopAnim:function(t){c.removeFromArray(this.animations,t)},updateAnimations:function(){var t;if(this.container&&this.container.update(),this.animations)for(t=this.animations.length-1;0<=t;t--){var e=this.animations[t],n=c.updateRate*e.time,r=e.frame+1,i=e.obj,o=e.attribute;if(r<=n){e.frame++;var a=Number(e.from),s=Number(e.to)-a;n=c[e.effect](0,r,a,s,n);0==s?(this.animations.splice(t,1),i.node.style[o]=Number(e.to)+e.suffix):i.node.style[o]=n+e.suffix}else i.node.style[o]=Number(e.to)+e.suffix,i.animationFinished=!0,this.animations.splice(t,1)}},update:function(){this.updateAnimations();var t=this.animatable;if(0<t.length){for(var e=!0,n=t.length-1;0<=n;n--){var r=t[n];r&&(r.animationFinished?t.splice(n,1):e=!1)}e&&(this.fire({type:"animationFinished",chart:this}),this.animatable=[])}},inIframe:function(){try{return window.self!==window.top}catch(t){return!0}},brr:function(){if(!this.hideCredits){var t,e="amcharts.com";if(2<=(n=window.location.hostname.split(".")).length&&(t=n[n.length-2]+"."+n[n.length-1]),this.amLink&&(n=this.amLink.parentNode)&&n.removeChild(this.amLink),t!=e||!0===this.inIframe()){t=e="http://www."+e;var n="",r="";"ammap"==this.product&&(t=e+"/javascript-maps/",n="Interactive JavaScript maps",r="JS map by amCharts"),e=document.createElement("a"),r=document.createTextNode(r),e.setAttribute("href",t),e.setAttribute("title",n),this.urlTarget&&e.setAttribute("target",this.urlTarget),e.appendChild(r),this.chartDiv.appendChild(e),(e=(this.amLink=e).style).position="absolute",e.textDecoration="none",e.color=this.color,e.fontFamily=this.fontFamily,e.fontSize="11px",e.opacity=.7,e.display="block",this.positionCred()}}},positionCred:function(){if(r=this.amLink){var t=this.creditsPosition,e=r.style,n=r.offsetWidth,r=r.offsetHeight,i=0,o=0,a=this.realWidth,s=this.realHeight;"serial"!=(l=this.type)&&"xy"!=l&&"gantt"!=l||(i=this.marginLeftReal,o=this.marginTopReal,a=i+this.plotAreaWidth,s=o+this.plotAreaHeight);var l=5+i,u=o+5;"bottom-left"==t&&(l=5+i,u=s-r-3),"bottom-right"==t&&(l=a-n-5,u=s-r-3),"top-right"==t&&(l=a-n-5,u=o+5),e.left=l+"px",e.top=u+"px"}}}),c.Slice=c.Class({construct:function(){}}),c.SerialDataItem=c.Class({construct:function(){}}),c.GraphDataItem=c.Class({construct:function(){}}),c.Guide=c.Class({construct:function(t){this.cname="Guide",c.applyTheme(this,t,this.cname)}}),c.Title=c.Class({construct:function(t){this.cname="Title",c.applyTheme(this,t,this.cname)}}),c.Label=c.Class({construct:function(t){this.cname="Label",c.applyTheme(this,t,this.cname)}})}(),function(){var Ke=window.AmCharts;Ke.AmGraph=Ke.Class({construct:function(t){this.cname="AmGraph",this.createEvents("rollOverGraphItem","rollOutGraphItem","clickGraphItem","doubleClickGraphItem","rightClickGraphItem","clickGraph","rollOverGraph","rollOutGraph"),this.type="line",this.stackable=!0,this.columnCount=1,this.columnIndex=0,this.centerCustomBullets=this.showBalloon=!0,this.maxBulletSize=50,this.minBulletSize=4,this.balloonText="[[value]]",this.hidden=this.scrollbar=this.animationPlayed=!1,this.pointPosition="middle",this.depthCount=1,this.includeInMinMax=!0,this.negativeBase=0,this.visibleInLegend=!0,this.showAllValueLabels=!1,this.showBulletsAt=this.showBalloonAt="close",this.lineThickness=1,this.dashLength=0,this.connect=!0,this.lineAlpha=1,this.bullet="none",this.bulletBorderThickness=2,this.bulletBorderAlpha=0,this.bulletAlpha=1,this.bulletSize=8,this.cornerRadiusTop=this.hideBulletsCount=this.bulletOffset=0,this.cursorBulletAlpha=1,this.gradientOrientation="vertical",this.dy=this.dx=0,this.periodValue="",this.clustered=!0,this.periodSpan=1,this.accessibleLabel="[[title]] [[category]] [[value]]",this.accessibleSkipText="Press enter to skip [[title]]",this.y=this.x=0,this.switchable=!0,this.minDistance=.8,this.tcc=1,this.labelRotation=0,this.labelAnchor="auto",this.labelOffset=3,this.bcn="graph-",this.dateFormat="MMM DD, YYYY",this.noRounding=!0,Ke.applyTheme(this,t,this.cname)},init:function(){this.createBalloon()},draw:function(){var t=this.chart;t.isRolledOverBullet=!1;var e=t.type;if(t.drawGraphs){isNaN(this.precision)||(this.numberFormatter?this.numberFormatter.precision=this.precision:this.numberFormatter={precision:this.precision,decimalSeparator:t.decimalSeparator,thousandsSeparator:t.thousandsSeparator});var n=t.container;this.container=n,this.destroy();var r=n.set();(this.set=r).translate(this.x,this.y);var i=n.set();(this.bulletSet=i).translate(this.x,this.y),this.behindColumns?(t.graphsBehindSet.push(r),t.bulletBehindSet.push(i)):(t.graphsSet.push(r),t.bulletSet.push(i));var o=this.bulletAxis;Ke.isString(o)&&(this.bulletAxis=t.getValueAxisById(o)),n=n.set(),Ke.remove(this.columnsSet),this.columnsSet=n,Ke.setCN(t,r,"graph-"+this.type),Ke.setCN(t,r,"graph-"+this.id),Ke.setCN(t,i,"graph-"+this.type),Ke.setCN(t,i,"graph-"+this.id),this.columnsArray=[],this.ownColumns=[],this.allBullets=[],this.animationArray=[],(i=this.labelPosition)||(o=this.valueAxis.stackType,i="top","column"==this.type&&(t.rotate&&(i="right"),"100%"==o||"regular"==o)&&(i="middle"),this.labelPosition=i),Ke.ifArray(this.data)&&(t=!1,"xy"==e?this.xAxis.axisCreated&&this.yAxis.axisCreated&&(t=!0):this.valueAxis.axisCreated&&(t=!0),!this.hidden&&t&&this.createGraph()),r.push(n)}},createGraph:function(){var t=this,e=t.chart;t.startAlpha=e.startAlpha,t.seqAn=e.sequencedAnimation,t.baseCoord=t.valueAxis.baseCoord,void 0===t.fillAlphas&&(t.fillAlphas=0),t.bulletColorR=t.bulletColor,void 0===t.bulletColorR&&(t.bulletColorR=t.lineColorR,t.bulletColorNegative=t.negativeLineColor),void 0===t.bulletAlpha&&(t.bulletAlpha=t.lineAlpha),"step"!=n&&!Ke.VML||(t.noRounding=!1);var n=e.type;if("gantt"==n&&(n="serial"),clearTimeout(t.playedTO),!isNaN(t.valueAxis.min)&&!isNaN(t.valueAxis.max)){switch(n){case"serial":t.categoryAxis&&(t.createSerialGraph(),"candlestick"==t.type&&t.valueAxis.minMaxMultiplier<1&&t.positiveClip(t.set));break;case"radar":t.createRadarGraph();break;case"xy":t.createXYGraph()}t.playedTO=setTimeout(function(){t.setAnimationPlayed.call(t)},500*t.chart.startDuration)}},setAnimationPlayed:function(){this.animationPlayed=!0},createXYGraph:function(){var t,e=[],n=[],r=this.xAxis,i=this.yAxis;for(this.pmh=i.height,this.pmw=r.width,this.pmy=this.pmx=0,t=this.start;t<=this.end;t++){var o=this.data[t].axes[r.id].graphs[this.id],a=(l=o.values).x,s=l.y,l=r.getCoordinate(a,this.noRounding),u=i.getCoordinate(s,this.noRounding);if(!isNaN(a)&&!isNaN(s)&&(e.push(l),n.push(u),o.x=l,o.y=u,a=this.createBullet(o,l,u,t),s=this.labelText)){s=this.createLabel(o,s);var h=0;a&&(h=a.size),this.positionLabel(o,l,u,s,h)}}this.drawLineGraph(e,n),this.launchAnimation()},createRadarGraph:function(){var t,e,n,r,i,o=this.valueAxis.stackType,a=[],s=[],l=[],u=[];for(i=this.start;i<=this.end;i++){var h,c,d=this.data[i].axes[this.valueAxis.id].graphs[this.id];if("none"==o||"3d"==o?h=d.values.value:(h=d.values.close,c=d.values.open),isNaN(h))this.connect||(this.drawLineGraph(a,s,l,u),a=[],s=[],l=[],u=[]);else{var f=(f=this.valueAxis.getCoordinate(h,this.noRounding)-this.height)*this.valueAxis.rMultiplier,p=-360/(this.end-this.start+1)*i;if("middle"==this.valueAxis.pointPosition&&(p-=180/(this.end-this.start+1)),h=f*Math.sin(p/180*Math.PI),f*=Math.cos(p/180*Math.PI),a.push(h),s.push(f),!isNaN(c)){var g,v=(g=(g=this.valueAxis.getCoordinate(c,this.noRounding)-this.height)*this.valueAxis.rMultiplier)*Math.sin(p/180*Math.PI);p=g*Math.cos(p/180*Math.PI);l.push(v),u.push(p),isNaN(n)&&(n=v),isNaN(r)&&(r=p)}p=this.createBullet(d,h,f,i),d.x=h,d.y=f,(v=this.labelText)&&(v=this.createLabel(d,v),g=0,p&&(g=p.size),this.positionLabel(d,h,f,v,g)),isNaN(t)&&(t=h),isNaN(e)&&(e=f)}}a.push(t),s.push(e),isNaN(n)||(l.push(n),u.push(r)),this.drawLineGraph(a,s,l,u),this.launchAnimation()},positionLabel:function(t,e,n,r,i){if(r){var o=this.chart,a=this.valueAxis,s="middle",l=!1,u=this.labelPosition,h=r.getBBox(),c=this.chart.rotate,d=t.isNegative;switch(void 0===(f=this.fontSize)&&(f=this.chart.fontSize),n-=h.height/2-f/2-1,void 0!==t.labelIsNegative&&(d=t.labelIsNegative),u){case"right":u=c&&d?"left":"right";break;case"top":u=c?"top":d?"bottom":"top";break;case"bottom":u=c?"bottom":d?"top":"bottom";break;case"left":u=c&&d?"right":"left"}var f,p=0,g=0;(f=t.columnGraphics)&&(p=f.x,g=f.y);var v=this.labelOffset;switch(u){case"right":s="start",e+=i/2+v;break;case"top":n=a.reversed?n+(i/2+h.height/2+v):n-(i/2+h.height/2+v);break;case"bottom":n=a.reversed?n-(i/2+h.height/2+v):n+(i/2+h.height/2+v);break;case"left":s="end",e-=i/2+v;break;case"inside":"column"==this.type&&(l=!0,c?e=d?(s="end",p-3-v):(s="start",p+3+v):n=d?g+7+v:g-10-v);break;case"middle":"column"==this.type&&(l=!0,c?e-=(e-p)/2+v-3:n-=(n-g)/2+v-3)}return"auto"!=this.labelAnchor&&(s=this.labelAnchor),r.attr({"text-anchor":s}),this.labelRotation&&r.rotate(this.labelRotation),r.translate(e,n),!this.showAllValueLabels&&f&&l&&((h=r.getBBox()).height>t.columnHeight||h.width>t.columnWidth)&&(r.remove(),r=null),r&&"radar"!=o.type&&(c?((n<0||n>this.height)&&(r.remove(),r=null),!this.showAllValueLabels&&r&&(e<0||e>this.width)&&(r.remove(),r=null)):((e<0||e>this.width)&&(r.remove(),r=null),!this.showAllValueLabels&&r&&(n<0||n>this.height)&&(r.remove(),r=null))),r&&this.allBullets.push(r),r}},getGradRotation:function(){var t=270;return"horizontal"==this.gradientOrientation&&(t=0),this.gradientRotation=t},createSerialGraph:function(){this.dashLengthSwitched=this.fillColorsSwitched=this.lineColorSwitched=void 0;var t=this.chart,e=this.id,n=this.index,r=this.data,i=this.chart.container,o=this.valueAxis,a=this.type,s=this.columnWidthReal,l=this.showBulletsAt;isNaN(this.columnWidth)||(s=this.columnWidth),isNaN(s)&&(s=.8);var u,h,c,d,f,p=this.useNegativeColorIfDown,g=this.width,v=this.height,m=this.y,y=this.rotate,w=this.columnCount,b=Ke.toCoordinate(this.cornerRadiusTop,s/2),C=this.connect,E=[],S=[],O=this.chart.graphs.length,T=this.dx/this.tcc,N=this.dy/this.tcc,R=o.stackType,_=this.start,M=this.end,A=this.scrollbar,k="graph-column-";A&&(k="scrollbar-graph-column-");var x,I=this.categoryAxis,D=this.baseCoord,L=this.negativeBase,P=this.columnIndex,H=this.lineThickness,B=this.lineAlpha,F=this.lineColorR,V=this.dashLength,j=this.set,W=this.getGradRotation(),U=this.chart.columnSpacing,z=I.cellWidth,G=(z*s-w)/w;G<U&&(U=G);var Y,$,X,K=v,q=g,Z=0,Q=0,J=0,tt=0,et=0,nt=0,rt=this.fillColorsR,it=this.negativeFillColors,ot=this.negativeLineColor,at=this.fillAlphas,st=this.negativeFillAlphas;"object"==typeof at&&(at=at[0]),"object"==typeof st&&(st=st[0]);var lt=this.noRounding;"step"==a&&(lt=!1);var ut=o.getCoordinate(o.min);if(o.logarithmic&&(ut=o.getCoordinate(o.minReal)),this.minCoord=ut,this.resetBullet&&(this.bullet="none"),!(A||"line"!=a&&"smoothedLine"!=a&&"step"!=a||(1==r.length&&"step"!=a&&"none"==this.bullet&&(this.bullet="round",this.resetBullet=!0),!it&&null==ot||p))){var ht=L;ht>o.max&&(ht=o.max),ht<o.min&&(ht=o.min),o.logarithmic&&(ht=o.minReal);var ct=o.getCoordinate(ht)+.5,dt=o.getCoordinate(o.max);y?(K=v,q=Math.abs(dt-ct),J=v,tt=Math.abs(ut-ct),nt=Q=0,et=o.reversed?(Z=0,ct):(Z=ct,0)):(q=g,K=Math.abs(dt-ct),tt=g,J=Math.abs(ut-ct),et=Z=0,o.reversed?(nt=m,Q=ct):nt=ct)}var ft=Math.round;this.pmx=ft(Z),this.pmy=ft(Q),this.pmh=ft(K),this.pmw=ft(q),this.nmx=ft(et),this.nmy=ft(nt),this.nmh=ft(J),this.nmw=ft(tt),Ke.isModern||(this.nmy=this.nmx=0,this.nmh=this.height),this.clustered||(w=1),(s="column"==a?(z*s-U*(w-1))/w:z*s)<1&&(s=1);var pt,gt=this.fixedColumnWidth;if(isNaN(gt)||(s=gt),"line"==a||"step"==a||"smoothedLine"==a){if(0<_){for(pt=_-1;-1<pt;pt--)if(X=($=(Y=r[pt]).axes[o.id].graphs[e]).values.value,!isNaN(X)){_=pt;break}if(this.lineColorField)for(pt=_;-1<pt;pt--)if(($=(Y=r[pt]).axes[o.id].graphs[e]).lineColor){this.lineColorSwitched=$.lineColor,void 0===this.bulletColor&&(this.bulletColorSwitched=this.lineColorSwitched);break}if(this.fillColorsField)for(pt=_;-1<pt;pt--)if(($=(Y=r[pt]).axes[o.id].graphs[e]).fillColors){this.fillColorsSwitched=$.fillColors;break}if(this.dashLengthField)for(pt=_;-1<pt;pt--)if($=(Y=r[pt]).axes[o.id].graphs[e],!isNaN($.dashLength)){this.dashLengthSwitched=$.dashLength;break}}if(M<r.length-1)for(pt=M+1;pt<r.length;pt++)if(X=($=(Y=r[pt]).axes[o.id].graphs[e]).values.value,!isNaN(X)){M=pt;break}}M<r.length-1&&M++;var vt=[],mt=[],yt=!1;"line"!=a&&"step"!=a&&"smoothedLine"!=a||(this.stackable&&"regular"==R||"100%"==R||this.fillToGraph)&&(yt=!0);var wt=this.noStepRisers,bt=-1e3,Ct=-1e3,Et=this.minDistance,St=!0,Ot=!1;for(pt=_;pt<=M;pt++){($=(Y=r[pt]).axes[o.id].graphs[e]).index=pt;var Tt,Nt=NaN;if(p&&null==this.openField)for(var Rt=pt+1;Rt<r.length&&(!r[Rt]||!(Tt=r[pt+1].axes[o.id].graphs[e])||!Tt.values||(Nt=Tt.values.value,isNaN(Nt)));Rt++);var _t,Mt,At,kt,xt,It,Dt=NaN,Lt=NaN,Pt=NaN,Ht=NaN,Bt=NaN,Ft=NaN,Vt=NaN,jt=NaN,Wt=NaN,Ut=NaN,zt=NaN,Gt=NaN,Yt=NaN,$t=NaN,Xt=NaN,Kt=NaN,qt=NaN,Zt=void 0,Qt=rt,Jt=at,te=F,ee=this.proCandlesticks,ne=this.topRadius,re=v-1,ie=g-1,oe=this.pattern;null!=$.pattern&&(oe=$.pattern),isNaN($.alpha)||(Jt=$.alpha),isNaN($.dashLength)||(V=$.dashLength);var ae=$.values;if(o.recalculateToPercents&&(ae=$.percents),"none"==R&&(P=isNaN($.columnIndex)?this.columnIndex:$.columnIndex),ae){if($t=this.stackable&&"none"!=R&&"3d"!=R?ae.close:ae.value,"candlestick"!=a&&"ohlc"!=a||($t=ae.close,Kt=ae.low,Vt=o.getCoordinate(Kt),Xt=ae.high,Wt=o.getCoordinate(Xt)),qt=ae.open,Pt=o.getCoordinate($t,lt),isNaN(qt)||(Bt=o.getCoordinate(qt,lt),p&&"regular"!=R&&"100%"!=R&&(Nt=qt,qt=Bt=NaN)),p&&(null==this.openField?Tt&&(Tt.isNegative=Nt<$t,isNaN(Nt)&&($.isNegative=!St)):$.isNegative=$t<Nt),!A)switch(this.showBalloonAt){case"close":$.y=Pt;break;case"open":$.y=Bt;break;case"high":$.y=Wt;break;case"low":$.y=Vt}Dt=Y.x[I.id];var se=this.periodSpan-1;"step"!=a||isNaN(Y.cellWidth)||(z=Y.cellWidth);var le=Math.floor(z/2)+Math.floor(se*z/2),ue=le;if("left"==this.stepDirection&&(Dt-=(2*z+se*z)/2),"center"==this.stepDirection&&(Dt-=z/2),"start"==this.pointPosition&&(Dt-=z/2+Math.floor(se*z/2),le=0,ue=Math.floor(z)+Math.floor(se*z)),"end"==this.pointPosition&&(Dt+=z/2+Math.floor(se*z/2),le=Math.floor(z)+Math.floor(se*z),ue=0),wt){var he=this.columnWidth;isNaN(he)||(le*=he,ue*=he)}A||($.x=Dt),Dt<-1e5&&(Dt=-1e5),g+1e5<Dt&&(Dt=g+1e5),y?(Lt=Pt,Ht=Bt,Bt=Pt=Dt,isNaN(qt)&&!this.fillToGraph&&(Ht=D),Ft=Vt,jt=Wt):(Ht=Lt=Dt,isNaN(qt)&&!this.fillToGraph&&(Bt=D)),(!ee&&$t<qt||ee&&$t<x)&&($.isNegative=!0,it&&(Qt=it),st&&(Jt=st),null!=ot&&(te=ot)),Ot=!1,isNaN($t)||(p?St=Nt<$t?(St&&(Ot=!0),!1):(St||(Ot=!0),!0):$.isNegative=$t<L,x=$t);var ce=!1;switch(A&&t.chartScrollbar.ignoreCustomColors&&(ce=!0),ce||(null!=$.color&&(Qt=$.color),$.fillColors&&(Qt=$.fillColors)),Pt=Ke.fitToBounds(Pt,-3e4,3e4),a){case"line":isNaN($t)?C||(this.drawLineGraph(E,S,vt,mt),E=[],S=[],vt=[],mt=[]):((Math.abs(Lt-bt)>=Et||Math.abs(Pt-Ct)>=Et)&&(E.push(Lt),S.push(Pt),bt=Lt,Ct=Pt),Gt=Ut=Lt,Yt=zt=Pt,!yt||isNaN(Bt)||isNaN(Ht)||(vt.push(Ht),mt.push(Bt)),(Ot||null!=$.lineColor&&$.lineColor!=this.lineColorSwitched||null!=$.fillColors&&$.fillColors!=this.fillColorsSwitched||!isNaN($.dashLength))&&(this.drawLineGraph(E,S,vt,mt),E=[Lt],S=[Pt],vt=[],mt=[],!yt||isNaN(Bt)||isNaN(Ht)||(vt.push(Ht),mt.push(Bt)),p?(St?(this.lineColorSwitched=F,this.fillColorsSwitched=rt):(this.lineColorSwitched=ot,this.fillColorsSwitched=it),void 0===this.bulletColor&&(this.bulletColorSwitched=F)):(this.lineColorSwitched=$.lineColor,this.fillColorsSwitched=$.fillColors,void 0===this.bulletColor&&(this.bulletColorSwitched=this.lineColorSwitched)),this.dashLengthSwitched=$.dashLength),$.gap&&(this.drawLineGraph(E,S,vt,mt),E=[],S=[],vt=[],mt=[],Ct=bt=-1e3));break;case"smoothedLine":isNaN($t)?C||(this.drawSmoothedGraph(E,S,vt,mt),E=[],S=[],vt=[],mt=[]):((Math.abs(Lt-bt)>=Et||Math.abs(Pt-Ct)>=Et)&&(E.push(Lt),S.push(Pt),bt=Lt,Ct=Pt),Gt=Ut=Lt,Yt=zt=Pt,!yt||isNaN(Bt)||isNaN(Ht)||(vt.push(Ht),mt.push(Bt)),(Ot||null!=$.lineColor&&$.lineColor!=this.lineColorSwitched||null!=$.fillColors&&$.fillColors!=this.fillColorsSwitched||!isNaN($.dashLength))&&(this.drawSmoothedGraph(E,S,vt,mt),E=[Lt],S=[Pt],vt=[],mt=[],!yt||isNaN(Bt)||isNaN(Ht)||(vt.push(Ht),mt.push(Bt)),this.lineColorSwitched=$.lineColor,this.fillColorsSwitched=$.fillColors,this.dashLengthSwitched=$.dashLength),$.gap&&(this.drawSmoothedGraph(E,S,vt,mt),E=[],S=[],vt=[],mt=[]));break;case"step":if(isNaN($t))C||((this.periodSpan<=1||1<this.periodSpan&&le+ue<Lt-u)&&(u=h=NaN),this.drawLineGraph(E,S,vt,mt),E=[],S=[],vt=[],mt=[]);else{if(y?(isNaN(u)||(E.push(u),S.push(Pt-le)),S.push(Pt-le),E.push(Lt),S.push(Pt+ue),E.push(Lt),!yt||isNaN(Bt)||isNaN(Ht)||(isNaN(c)||(vt.push(c),mt.push(Bt-le)),vt.push(Ht),mt.push(Bt-le),vt.push(Ht),mt.push(Bt+ue))):(isNaN(h)||(S.push(h),E.push(Lt-le)),E.push(Lt-le),S.push(Pt),E.push(Lt+ue),S.push(Pt),!yt||isNaN(Bt)||isNaN(Ht)||(isNaN(d)||(vt.push(Ht-le),mt.push(d)),vt.push(Ht-le),mt.push(Bt),vt.push(Ht+ue),mt.push(Bt))),c=Ht,d=Bt,Gt=Ut=u=Lt,Yt=zt=h=Pt,Ot||null!=$.lineColor||null!=$.fillColors||!isNaN($.dashLength)){var de=E[E.length-2],fe=S[S.length-2];E.pop(),S.pop(),vt.pop(),mt.pop(),this.drawLineGraph(E,S,vt,mt),E=[de],S=[fe],vt=[],mt=[],yt&&(vt=[de,de+le+ue],mt=[d,d]),y?(S.push(Pt+ue),E.push(Lt)):(E.push(Lt+ue),S.push(Pt)),this.lineColorSwitched=$.lineColor,this.fillColorsSwitched=$.fillColors,this.dashLengthSwitched=$.dashLength,p&&(St?(this.lineColorSwitched=F,this.fillColorsSwitched=rt):(this.lineColorSwitched=ot,this.fillColorsSwitched=it))}(wt||$.gap)&&(u=h=NaN,$.gap&&E.length<=2||this.drawLineGraph(E,S,vt,mt),E=[],S=[],vt=[],mt=[])}break;case"column":if(xt=te,null!=$.lineColor&&(xt=$.lineColor),!isNaN($t)){p||($.isNegative=$t<L),$.isNegative&&(it&&(Qt=it),null!=ot&&(xt=ot));var pe,ge=o.min,ve=o.max,me=qt;if(isNaN(me)&&(me=L),!($t<ge&&me<ge||ve<$t&&ve<me))if(y)pe="3d"==R?(Mt=Pt-(w/2-this.depthCount+1)*(s+U)+U/2+N*P,_t=Ht+T*P,P):(Mt=Math.floor(Pt-(w/2-P)*(s+U)+U/2),_t=Ht,0),Yt=zt=Mt+(At=s)/2,v+pe*N<Mt+At&&(At=v-Mt+pe*N),Mt<pe*N&&(At+=Mt,Mt=pe*N),kt=(Gt=Ut=Lt)-Ht,kt+=_t-(_t=Ke.fitToBounds(_t,0,g)),kt=Ke.fitToBounds(kt,-_t,g-_t+T*P),$.labelIsNegative=kt<0,0===kt&&1/$t==-1/0&&($.labelIsNegative=!0),isNaN(Y.percentWidthValue)||(zt=(Mt=Dt-(At=this.height*Y.percentWidthValue/100)/2)+At/2),At=Ke.roundTo(At,2),kt=Ke.roundTo(kt,2),Mt<v&&0<At&&(Zt=new Ke.Cuboid(i,kt,At,T-t.d3x,N-t.d3y,Qt,Jt,H,xt,B,W,b,y,V,oe,ne,k),$.columnWidth=Math.abs(kt),$.columnHeight=Math.abs(At));else pe="3d"==R?(_t=Lt-(w/2-this.depthCount+1)*(s+U)+U/2+T*P,Mt=Bt+N*P,P):(_t=Lt-(w/2-P)*(s+U)+U/2,Mt=Bt,0),Gt=Ut=_t+(At=s)/2,g+pe*T<_t+At&&(At=g-_t+pe*T),_t<pe*T&&(At+=_t-pe*T,_t=pe*T),kt=(Yt=zt=Pt)-Bt,$.labelIsNegative=0<kt,0===kt&&1/$t!=1/Math.abs($t)&&($.labelIsNegative=!0),kt+=Mt-(Mt=Ke.fitToBounds(Mt,this.dy,v)),kt=Ke.fitToBounds(kt,N*pe-Mt,v-Mt),isNaN(Y.percentWidthValue)||(Ut=(_t=Dt-(At=this.width*Y.percentWidthValue/100)/2)+At/2),At=Ke.roundTo(At,2),kt=Ke.roundTo(kt,2),_t<g+P*T&&0<At&&(this.showOnAxis&&(Mt-=N/2),Zt=new Ke.Cuboid(i,At,kt,T-t.d3x,N-t.d3y,Qt,Jt,H,xt,this.lineAlpha,W,b,y,V,oe,ne,k),$.columnHeight=Math.abs(kt),$.columnWidth=Math.abs(At));Zt&&(It=Zt.set,Ke.setCN(t,Zt.set,"graph-"+this.type),Ke.setCN(t,Zt.set,"graph-"+this.id),$.className&&Ke.setCN(t,Zt.set,$.className,!0),$.columnGraphics=It,_t=Ke.roundTo(_t,2),Mt=Ke.roundTo(Mt,2),It.translate(_t,Mt),($.url||this.showHandOnHover)&&It.setAttr("cursor","pointer"),A||("none"==R&&(f=y?(this.end+1-pt)*O-n:O*pt+n),"3d"==R&&(y?(f=(this.end+1-pt)*O-n-1e3*this.depthCount,Ut+=T*P,Gt+=T*P,$.y+=T*P):(f=(O-n)*(pt+1)+1e3*this.depthCount,zt+=N*P,Yt+=N*P,$.y+=N*P)),"regular"!=R&&"100%"!=R||(f=y?0<ae.value?(this.end+1-pt)*O+n+1e3*this.depthCount:(this.end+1-pt)*O-n+1e3*this.depthCount:0<ae.value?O*pt+n:O*pt-n),this.columnsArray.push({column:Zt,depth:f}),$.x=y?Mt+At/2:_t+At/2,this.ownColumns.push(Zt),this.animateColumns(Zt,pt,Lt,Ht,Pt,Bt),this.addListeners(It,$),void 0!==this.tabIndex&&It.setAttr("tabindex",this.tabIndex)),this.columnsSet.push(It))}break;case"candlestick":if(!isNaN(qt)&&!isNaN($t)){var ye,we;if(xt=te,null!=$.lineColor&&(xt=$.lineColor),Yt=zt=Pt,Gt=Ut=Lt,y){if("open"==l&&(Gt=Ht),"high"==l&&(Gt=jt),"low"==l&&(Gt=Ft),Lt=Ke.fitToBounds(Lt,0,ie),Ht=Ke.fitToBounds(Ht,0,ie),Ft=Ke.fitToBounds(Ft,0,ie),jt=Ke.fitToBounds(jt,0,ie),0===Lt&&0===Ht&&0===Ft&&0===jt)continue;if(Lt==ie&&Ht==ie&&Ft==ie&&jt==ie)continue;var be,Ce;if(_t=Ht,v<(Mt=Pt-s/2)+(At=s)&&(At=v-Mt),Mt<0&&(At+=Mt,Mt=0),Mt<v&&0<At)Ce=qt<$t?(be=[Lt,jt],[Ht,Ft]):(be=[Ht,jt],[Lt,Ft]),!isNaN(jt)&&!isNaN(Ft)&&Pt<v&&0<Pt&&(ye=Ke.line(i,be,[Pt,Pt],xt,B,H),we=Ke.line(i,Ce,[Pt,Pt],xt,B,H)),kt=Lt-Ht,Zt=new Ke.Cuboid(i,kt,At,T,N,Qt,at,H,xt,B,W,b,y,V,oe,ne,k)}else{if("open"==l&&(Yt=Bt),"high"==l&&(Yt=Wt),"low"==l&&(Yt=Vt),Pt=Ke.fitToBounds(Pt,0,re),Bt=Ke.fitToBounds(Bt,0,re),Vt=Ke.fitToBounds(Vt,0,re),Wt=Ke.fitToBounds(Wt,0,re),0===Pt&&0===Bt&&0===Vt&&0===Wt)continue;if(Pt==re&&Bt==re&&Vt==re&&Wt==re)continue;if(Mt=Bt+H/2,g<(_t=Lt-s/2)+(At=s)&&(At=g-_t),_t<0&&(At+=_t,_t=0),kt=Pt-Bt,_t<g&&0<At){ee&&qt<=$t&&(Jt=0);var Ee,Se;Zt=new Ke.Cuboid(i,At,kt,T,N,Qt,Jt,H,xt,B,W,b,y,V,oe,ne,k);Se=qt<$t?(Ee=[Pt,Wt],[Bt,Vt]):(Ee=[Bt,Wt],[Pt,Vt]),!isNaN(Wt)&&!isNaN(Vt)&&Lt<g&&0<Lt&&(ye=Ke.line(i,[Lt,Lt],Ee,xt,B,H),we=Ke.line(i,[Lt,Lt],Se,xt,B,H),Ke.setCN(t,ye,this.bcn+"line-high"),$.className&&Ke.setCN(t,ye,$.className,!0),Ke.setCN(t,we,this.bcn+"line-low"),$.className&&Ke.setCN(t,we,$.className,!0))}}Zt&&(It=Zt.set,$.columnGraphics=It,j.push(It),It.translate(_t,Mt-H/2),($.url||this.showHandOnHover)&&It.setAttr("cursor","pointer"),ye&&(j.push(ye),j.push(we)),A||($.x=y?Mt+At/2:_t+At/2,this.animateColumns(Zt,pt,Lt,Ht,Pt,Bt),this.addListeners(It,$),void 0!==this.tabIndex&&It.setAttr("tabindex",this.tabIndex)))}break;case"ohlc":if(!(isNaN(qt)||isNaN(Xt)||isNaN(Kt)||isNaN($t))){var Oe,Te,Ne,Re=i.set();if(j.push(Re),$t<qt&&($.isNegative=!0,null!=ot&&(te=ot)),null!=$.lineColor&&(te=$.lineColor),y){if(Yt=Pt,Gt=Lt,"open"==l&&(Gt=Ht),"high"==l&&(Gt=jt),"low"==l&&(Gt=Ft),Ft=Ke.fitToBounds(Ft,0,ie),jt=Ke.fitToBounds(jt,0,ie),0===Lt&&0===Ht&&0===Ft&&0===jt)continue;if(Lt==ie&&Ht==ie&&Ft==ie&&jt==ie)continue;var _e=Pt-s/2,Me=(_e=Ke.fitToBounds(_e,0,v),Ke.fitToBounds(Pt,0,v)),Ae=Pt+s/2;Ae=Ke.fitToBounds(Ae,0,v);0<=Ht&&Ht<=ie&&(Te=Ke.line(i,[Ht,Ht],[_e,Me],te,B,H,V)),0<Pt&&Pt<v&&(Oe=Ke.line(i,[Ft,jt],[Pt,Pt],te,B,H,V)),0<=Lt&&Lt<=ie&&(Ne=Ke.line(i,[Lt,Lt],[Me,Ae],te,B,H,V))}else{Yt=Pt,"open"==l&&(Yt=Bt),"high"==l&&(Yt=Wt),"low"==l&&(Yt=Vt);Gt=Lt,Vt=Ke.fitToBounds(Vt,0,re),Wt=Ke.fitToBounds(Wt,0,re);var ke=Lt-s/2,xe=(ke=Ke.fitToBounds(ke,0,g),Ke.fitToBounds(Lt,0,g)),Ie=Lt+s/2;Ie=Ke.fitToBounds(Ie,0,g);0<=Bt&&Bt<=re&&(Te=Ke.line(i,[ke,xe],[Bt,Bt],te,B,H,V)),0<Lt&&Lt<g&&(Oe=Ke.line(i,[Lt,Lt],[Vt,Wt],te,B,H,V)),0<=Pt&&Pt<=re&&(Ne=Ke.line(i,[xe,Ie],[Pt,Pt],te,B,H,V))}j.push(Te),j.push(Oe),j.push(Ne),Ke.setCN(t,Te,this.bcn+"stroke-open"),Ke.setCN(t,Ne,this.bcn+"stroke-close"),Ke.setCN(t,Oe,this.bcn+"stroke"),$.className&&Ke.setCN(t,Re,$.className,!0),Oe&&this.addListeners(Oe,$),Ne&&this.addListeners(Ne,$),Te&&this.addListeners(Te,$),Ut=Lt,zt=Pt}}if(!A&&!isNaN($t)){var De=this.hideBulletsCount;if(this.end-this.start<=De||0===De){var Le=this.createBullet($,Gt,Yt,pt),Pe=this.labelText;if(Pe&&!isNaN(Ut)&&!isNaN(Ut)){var He=this.createLabel($,Pe),Be=0;Le&&(Be=Le.size),this.positionLabel($,Ut,zt,He,Be)}if("regular"==R||"100%"==R){var Fe=o.totalText;if(Fe){var Ve=this.createLabel($,Fe,o.totalTextColor);if(Ke.setCN(t,Ve,this.bcn+"label-total"),this.allBullets.push(Ve),Ve){var je,We,Ue=Ve.getBBox(),ze=Ue.width,Ge=Ue.height,Ye=o.totalTextOffset,$e=o.totals[pt];$e&&$e.remove();var Xe=0;"column"!=a&&(Xe=this.bulletSize),y?(We=zt,je=$t<0?Lt-ze/2-2-Xe-Ye:Lt+ze/2+3+Xe+Ye):(je=Ut,We=$t<0?Pt+Ge/2+Xe+Ye:Pt-Ge/2-3-Xe-Ye),Ve.translate(je,We),o.totals[pt]=Ve,y?(We<0||v<We)&&Ve.remove():(je<0||g<je)&&Ve.remove()}}}}}}}this.lastDataItem=$,"line"!=a&&"step"!=a&&"smoothedLine"!=a||("smoothedLine"==a?this.drawSmoothedGraph(E,S,vt,mt):this.drawLineGraph(E,S,vt,mt),A||this.launchAnimation()),this.bulletsHidden&&this.hideBullets(),this.customBulletsHidden&&this.hideCustomBullets()},animateColumns:function(t,e){var n=this,r=n.chart.startDuration;0<r&&!n.animationPlayed&&(n.seqAn?(t.set.hide(),n.animationArray.push(t),r=setTimeout(function(){n.animate.call(n)},r/(n.end-n.start+1)*(e-n.start)*1e3),n.timeOuts.push(r)):n.animate(t),n.chart.animatable.push(t))},createLabel:function(t,e,n){var r=this.chart,i=t.labelColor;i=(i=i||this.color)||r.color,n&&(i=n),void 0===(n=this.fontSize)&&(this.fontSize=n=r.fontSize);var o=this.labelFunction;if(e=r.formatString(e,t),e=Ke.cleanFromEmpty(e),o&&(e=o(t,e)),void 0!==e&&""!==e)return(t=Ke.text(this.container,e,i,r.fontFamily,n)).node.style.pointerEvents="none",Ke.setCN(r,t,this.bcn+"label"),this.bulletSet.push(t),t},positiveClip:function(t){t.clipRect(this.pmx,this.pmy,this.pmw,this.pmh)},negativeClip:function(t){t.clipRect(this.nmx,this.nmy,this.nmw,this.nmh)},drawLineGraph:function(t,e,n,r){var i=this;if(1<t.length){var o=i.noRounding,a=i.set,s=i.chart,l=i.container,u=l.set(),h=l.set();a.push(h),a.push(u);var c=i.lineAlpha,d=i.lineThickness,f=(a=i.fillAlphas,i.lineColorR),p=i.negativeLineAlpha;isNaN(p)&&(p=c),(g=i.lineColorSwitched)&&(f=g);var g=i.fillColorsR;(m=i.fillColorsSwitched)&&(g=m);var v=i.dashLength;(m=i.dashLengthSwitched)&&(v=m);var m=i.negativeLineColor,y=i.negativeFillColors,w=i.negativeFillAlphas,b=i.baseCoord;0!==i.negativeBase&&((b=i.valueAxis.getCoordinate(i.negativeBase,o))>i.height&&(b=i.height),b<0&&(b=0)),(c=Ke.line(l,t,e,f,c,d,v,!1,!1,o)).node.setAttribute("stroke-linejoin","round"),Ke.setCN(s,c,i.bcn+"stroke"),u.push(c),u.click(function(t){i.handleGraphEvent(t,"clickGraph")}).mouseover(function(t){i.handleGraphEvent(t,"rollOverGraph")}).mouseout(function(t){i.handleGraphEvent(t,"rollOutGraph")}).touchmove(function(t){i.chart.handleMouseMove(t)}).touchend(function(t){i.chart.handleTouchEnd(t)}),void 0===m||i.useNegativeColorIfDown||((d=Ke.line(l,t,e,m,p,d,v,!1,!1,o)).node.setAttribute("stroke-linejoin","round"),Ke.setCN(s,d,i.bcn+"stroke"),Ke.setCN(s,d,i.bcn+"stroke-negative"),h.push(d)),(0<a||0<w)&&(d=t.join(";").split(";"),p=e.join(";").split(";"),"serial"==(c=s.type)||"radar"==c?0<n.length?(n.reverse(),r.reverse(),d=t.concat(n),p=e.concat(r)):"radar"==c?(p.push(0),d.push(0)):i.rotate?(p.push(p[p.length-1]),d.push(b),p.push(p[0]),d.push(b),p.push(p[0]),d.push(d[0])):(d.push(d[d.length-1]),p.push(b),d.push(d[0]),p.push(b),d.push(t[0]),p.push(p[0])):"xy"==c&&(e=i.fillToAxis)&&(Ke.isString(e)&&(e=s.getValueAxisById(e)),"H"==e.orientation?(b="top"==e.position?0:e.height,d.push(d[d.length-1]),p.push(b),d.push(d[0]),p.push(b),d.push(t[0]),p.push(p[0])):(b="left"==e.position?0:e.width,p.push(p[p.length-1]),d.push(b),p.push(p[0]),d.push(b),p.push(p[0]),d.push(d[0]))),t=i.gradientRotation,0<a&&((e=Ke.polygon(l,d,p,g,a,1,"#000",0,t,o)).pattern(i.pattern,NaN,s.path),Ke.setCN(s,e,i.bcn+"fill"),u.push(e),e.toBack()),!y&&void 0===m||(isNaN(w)&&(w=a),y=y||m,o=Ke.polygon(l,d,p,y,w,1,"#000",0,t,o),Ke.setCN(s,o,i.bcn+"fill"),Ke.setCN(s,o,i.bcn+"fill-negative"),o.pattern(i.pattern,NaN,s.path),h.push(o),o.toBack(),h.click(function(t){i.handleGraphEvent(t,"clickGraph")}).mouseover(function(t){i.handleGraphEvent(t,"rollOverGraph")}).mouseout(function(t){i.handleGraphEvent(t,"rollOutGraph")}).touchmove(function(t){i.chart.handleMouseMove(t)}).touchend(function(t){i.chart.handleTouchEnd(t)}))),i.applyMask(h,u)}},applyMask:function(t,e){var n=t.length();"serial"!=this.chart.type||this.scrollbar||(this.positiveClip(e),0<n&&this.negativeClip(t))},drawSmoothedGraph:function(t,e,n,r){if(1<t.length){var i=this.set,o=this.chart,a=this.container,s=a.set(),l=a.set();i.push(l),i.push(s);var u=this.lineAlpha,h=this.lineThickness,c=(i=this.dashLength,this.fillAlphas),d=this.lineColorR,f=this.fillColorsR,p=this.negativeLineColor,g=this.negativeFillColors,v=this.negativeFillAlphas,m=this.baseCoord,y=this.lineColorSwitched;y&&(d=y),(y=this.fillColorsSwitched)&&(f=y);var w=this.negativeLineAlpha;isNaN(w)&&(w=u),y=this.getGradRotation(),u=new Ke.Bezier(a,t,e,d,u,h,f,0,i,void 0,y),Ke.setCN(o,u,this.bcn+"stroke"),s.push(u.path),void 0!==p&&(h=new Ke.Bezier(a,t,e,p,w,h,f,0,i,void 0,y),Ke.setCN(o,h,this.bcn+"stroke"),Ke.setCN(o,h,this.bcn+"stroke-negative"),l.push(h.path)),0<c&&(h=t.join(";").split(";"),u=e.join(";").split(";"),d="",0<n.length?(n.push("M"),r.push("M"),n.reverse(),r.reverse(),h=t.concat(n),u=e.concat(r)):(this.rotate?(d+=" L"+m+","+e[e.length-1],d+=" L"+m+","+e[0]):(d+=" L"+t[t.length-1]+","+m,d+=" L"+t[0]+","+m),d+=" L"+t[0]+","+e[0]),t=new Ke.Bezier(a,h,u,NaN,0,0,f,c,i,d,y),Ke.setCN(o,t,this.bcn+"fill"),t.path.pattern(this.pattern,NaN,o.path),s.push(t.path),g||void 0!==p)&&(v=v||c,g=g||p,(a=new Ke.Bezier(a,h,u,NaN,0,0,g,v,i,d,y)).path.pattern(this.pattern,NaN,o.path),Ke.setCN(o,a,this.bcn+"fill"),Ke.setCN(o,a,this.bcn+"fill-negative"),l.push(a.path)),this.applyMask(l,s)}},launchAnimation:function(){var t=this,e=t.chart.startDuration;if(0<e&&!t.animationPlayed){var n=t.set,r=t.bulletSet;Ke.VML||(n.attr({opacity:t.startAlpha}),r.attr({opacity:t.startAlpha})),n.hide(),r.hide(),t.seqAn?(e=setTimeout(function(){t.animateGraphs.call(t)},t.index*e*1e3),t.timeOuts.push(e)):t.animateGraphs()}},animateGraphs:function(){var t=this.chart,e=this.set,n=this.bulletSet,r=this.x,i=this.y;e.show(),n.show();var o=t.startDuration,a=t.startEffect;e&&(this.rotate?(e.translate(-1e3,i),n.translate(-1e3,i)):(e.translate(r,-1e3),n.translate(r,-1e3)),e.animate({opacity:1,translate:r+","+i},o,a),n.animate({opacity:1,translate:r+","+i},o,a),t.animatable.push(e))},animate:function(t){var e=this.chart,n=this.animationArray;!t&&0<n.length&&(t=n[0],n.shift()),n=Ke[Ke.getEffect(e.startEffect)],e=e.startDuration,t&&(this.rotate?t.animateWidth(e,n):t.animateHeight(e,n),t.set.show())},legendKeyColor:function(){var t=this.legendColor,e=this.lineAlpha;return void 0===t&&(t=this.lineColorR,0===e&&(e=this.fillColorsR)&&(t="object"==typeof e?e[0]:e)),t},legendKeyAlpha:function(){var t=this.legendAlpha;return void 0===t&&(t=this.lineAlpha,this.fillAlphas>t&&(t=this.fillAlphas),0===t&&(t=this.bulletAlpha),0===t&&(t=1)),t},createBullet:function(t,e,n){if(!isNaN(e)&&!isNaN(n)&&("none"!=this.bullet||this.customBullet||t.bullet||t.customBullet)){var r=this.chart,i=this.container,o=this.bulletOffset,a=this.bulletSize;isNaN(t.bulletSize)||(a=t.bulletSize);var s,l=t.values.value,u=this.maxValue,h=this.minValue,c=this.maxBulletSize,d=this.minBulletSize;isNaN(u)||(isNaN(l)||(a=(l-h)/(u-h)*(c-d)+d),h==u&&(a=c)),u=a,this.bulletAxis&&(a=t.values.error,isNaN(a)||(l=a),a=this.bulletAxis.stepWidth*l),a<this.minBulletSize&&(a=this.minBulletSize),this.rotate?e=t.isNegative?e-o:e+o:n=t.isNegative?n+o:n-o,d=this.bulletColorR,t.lineColor&&void 0===this.bulletColor&&(this.bulletColorSwitched=t.lineColor),this.bulletColorSwitched&&(d=this.bulletColorSwitched),t.isNegative&&void 0!==this.bulletColorNegative&&(d=this.bulletColorNegative),void 0!==t.color&&(d=t.color),"xy"==r.type&&this.valueField&&(s=this.pattern,t.pattern&&(s=t.pattern)),o=this.bullet,t.bullet&&(o=t.bullet);l=this.bulletBorderThickness,h=this.bulletBorderColorR,c=this.bulletBorderAlpha;var f=this.bulletAlpha;h=h||d,this.useLineColorForBulletBorder&&(h=this.lineColorR,t.isNegative&&this.negativeLineColor&&(h=this.negativeLineColor),this.lineColorSwitched&&(h=this.lineColorSwitched));var p=t.alpha;return isNaN(p)||(f=p),s=Ke.bullet(i,o,a,d,f,l,h,c,u,0,s,r.path),u=this.customBullet,t.customBullet&&(u=t.customBullet),u&&(s&&s.remove(),"function"==typeof u?((u=new u).chart=r,t.bulletConfig&&(u.availableSpace=n,u.graph=this,u.graphDataItem=t,u.bulletY=n,t.bulletConfig.minCoord=this.minCoord-n,u.bulletConfig=t.bulletConfig),u.write(i),s&&u.showBullet&&u.set.push(s),t.customBulletGraphics=u.cset,s=u.set):(s=i.set(),u=i.image(u,0,0,a,a),s.push(u),this.centerCustomBullets&&u.translate(-a/2,-a/2))),s&&((t.url||this.showHandOnHover)&&s.setAttr("cursor","pointer"),"serial"!=r.type&&"gantt"!=r.type||(e<-.5||e>this.width||n<-a/2||n>this.height)&&(s.remove(),s=null),s&&(this.bulletSet.push(s),s.translate(e,n),this.addListeners(s,t),this.allBullets.push(s)),t.bx=e,t.by=n,Ke.setCN(r,s,this.bcn+"bullet"),t.className&&Ke.setCN(r,s,t.className,!0)),s?(s.size=a||0,(r=this.bulletHitAreaSize)&&((i=Ke.circle(i,r,"#FFFFFF",.001,0)).translate(e,n),t.hitBullet=i,this.bulletSet.push(i),this.addListeners(i,t)),t.bulletGraphics=s,void 0!==this.tabIndex&&s.setAttr("tabindex",this.tabIndex)):s={size:0},s.graphDataItem=t,s}},showBullets:function(){var t,e=this.allBullets;for(this.bulletsHidden=!1,t=0;t<e.length;t++)e[t].show()},hideBullets:function(){var t,e=this.allBullets;for(this.bulletsHidden=!0,t=0;t<e.length;t++)e[t].hide()},showCustomBullets:function(){var t,e=this.allBullets;for(this.customBulletsHidden=!1,t=0;t<e.length;t++){var n=e[t].graphDataItem;n&&n.customBulletGraphics&&n.customBulletGraphics.show()}},hideCustomBullets:function(){var t,e=this.allBullets;for(this.customBulletsHidden=!0,t=0;t<e.length;t++){var n=e[t].graphDataItem;n&&n.customBulletGraphics&&n.customBulletGraphics.hide()}},addListeners:function(t,e){var n=this;t.mouseover(function(t){n.handleRollOver(e,t)}).mouseout(function(t){n.handleRollOut(e,t)}).touchend(function(t){n.handleRollOver(e,t),n.chart.panEventsEnabled&&n.handleClick(e,t)}).touchstart(function(t){n.handleRollOver(e,t)}).click(function(t){n.handleClick(e,t)}).dblclick(function(t){n.handleDoubleClick(e,t)}).contextmenu(function(t){n.handleRightClick(e,t)});var r=n.chart;if(r.accessible&&n.accessibleLabel){var i=r.formatString(n.accessibleLabel,e);r.makeAccessible(t,i)}},handleRollOver:function(t,e){if(this.handleGraphEvent(e,"rollOverGraph"),t){var n=this.chart;t.bulletConfig&&(n.isRolledOverBullet=!0);var r={type:"rollOverGraphItem",item:t,index:t.index,graph:this,target:this,chart:this.chart,event:e};this.fire(r),n.fire(r),clearTimeout(n.hoverInt),(n=n.chartCursor)&&n.valueBalloonsEnabled||this.showGraphBalloon(t,"V",!0)}},handleRollOut:function(t,e){var n=this.chart;if(t){var r={type:"rollOutGraphItem",item:t,index:t.index,graph:this,target:this,chart:this.chart,event:e};this.fire(r),n.fire(r),n.isRolledOverBullet=!1}this.handleGraphEvent(e,"rollOutGraph"),(n=n.chartCursor)&&n.valueBalloonsEnabled||this.hideBalloon()},handleClick:function(t,e){if(!this.chart.checkTouchMoved()&&this.chart.checkTouchDuration(e)){if(t){var n={type:"clickGraphItem",item:t,index:t.index,graph:this,target:this,chart:this.chart,event:e};this.fire(n),this.chart.fire(n),Ke.getURL(t.url,this.urlTarget)}this.handleGraphEvent(e,"clickGraph")}},handleGraphEvent:function(t,e){var n={type:e,graph:this,target:this,chart:this.chart,event:t};this.fire(n),this.chart.fire(n)},handleRightClick:function(t,e){if(t){var n={type:"rightClickGraphItem",item:t,index:t.index,graph:this,target:this,chart:this.chart,event:e};this.fire(n),this.chart.fire(n)}},handleDoubleClick:function(t,e){if(t){var n={type:"doubleClickGraphItem",item:t,index:t.index,graph:this,target:this,chart:this.chart,event:e};this.fire(n),this.chart.fire(n)}},zoom:function(t,e){this.start=t,this.end=e,this.draw()},changeOpacity:function(t){var e,n=this.set;if(n&&n.setAttr("opacity",t),n=this.ownColumns)for(e=0;e<n.length;e++){var r=n[e].set;r&&r.setAttr("opacity",t)}(n=this.bulletSet)&&n.setAttr("opacity",t)},destroy:function(){Ke.remove(this.set),Ke.remove(this.bulletSet);var t,e=this.timeOuts;if(e)for(t=0;t<e.length;t++)clearTimeout(e[t]);this.timeOuts=[]},createBalloon:function(){var t=this.chart;this.balloon?this.balloon.destroy&&this.balloon.destroy():this.balloon={};var e=this.balloon;Ke.extend(e,t.balloon,!0),e.chart=t,e.mainSet=t.plotBalloonsSet,e.className=this.id},hideBalloon:function(){var t=this,e=t.chart;e.chartCursor&&e.chartCursor.valueBalloonsEnabled||e.hideBalloon(),clearTimeout(t.hoverInt),t.hoverInt=setTimeout(function(){t.hideBalloonReal.call(t)},e.hideBalloonTime)},hideBalloonReal:function(){this.balloon&&this.balloon.hide(),this.fixBulletSize()},fixBulletSize:function(){if(Ke.isModern){var t=this.resizedDItem;if(t){var e=t.bulletGraphics;if(e&&!e.doNotScale){e.translate(t.bx,t.by,1);var n=this.bulletAlpha;isNaN(t.alpha)||(n=t.alpha),e.setAttr("fill-opacity",n),e.setAttr("stroke-opacity",this.bulletBorderAlpha)}}this.resizedDItem=null}},showGraphBalloon:function(t,e,n,r,i){if(t){var o=this.chart,a=this.balloon,s=0,l=0,u=!0;if((h=o.chartCursor)&&h.valueBalloonsEnabled||(a=o.balloon,s=this.x,l=this.y,u=!1),clearTimeout(this.hoverInt),o.chartCursor&&(this.currentDataItem=t,"serial"==o.type&&o.isRolledOverBullet&&o.chartCursor.valueBalloonsEnabled))return void this.hideBalloonReal();if(this.resizeBullet(t,r,i),a&&a.enabled&&this.showBalloon&&!this.hidden){var h=o.formatString(this.balloonText,t,!0),c=this.balloonFunction;c&&(h=c(t,t.graph)),(h=h&&Ke.cleanFromEmpty(h))&&""!==h?(r=o.getBalloonColor(this,t),a.drop||(a.pointerOrientation=e),e=t.x,i=t.y,o.rotate&&(e=t.y,i=t.x),e+=s,i+=l,isNaN(e)||isNaN(i)?this.hideBalloonReal():(t=this.width,c=this.height,u&&a.setBounds(s,l,t+s,c+l),a.changeColor(r),a.setPosition(e,i),a.fixPrevious(),a.fixedPosition&&(n=!1),!n&&"radar"!=o.type&&(e<s-.5||t+s<e||i<l-.5||c+l<i)?(a.showBalloon(h),a.hide(0)):(a.followCursor(n),a.showBalloon(h)))):(this.hideBalloonReal(),a.hide(),this.resizeBullet(t,r,i))}else this.hideBalloonReal()}},resizeBullet:function(t,e,n){if(this.fixBulletSize(),t&&Ke.isModern&&(1!=e||!isNaN(n))){var r=t.bulletGraphics;r&&!r.doNotScale&&(r.translate(t.bx,t.by,e),isNaN(n)||(r.setAttr("fill-opacity",n),r.setAttr("stroke-opacity",n)),this.resizedDItem=t)}}})}(),function(){var h=window.AmCharts;h.ChartCursor=h.Class({construct:function(t){this.cname="ChartCursor",this.createEvents("changed","zoomed","onHideCursor","onShowCursor","draw","selected","moved","panning","zoomStarted"),this.enabled=!0,this.cursorAlpha=1,this.selectionAlpha=.2,this.cursorColor="#CC0000",this.categoryBalloonAlpha=1,this.color="#FFFFFF",this.type="cursor",this.zoomed=!1,this.zoomable=!0,this.pan=!1,this.categoryBalloonDateFormat="MMM DD, YYYY",this.categoryBalloonText="[[category]]",this.categoryBalloonEnabled=this.valueBalloonsEnabled=!0,this.rolledOver=!1,this.cursorPosition="middle",this.bulletsEnabled=this.skipZoomDispatch=!1,this.bulletSize=8,this.selectWithoutZooming=this.oneBalloonOnly=!1,this.graphBulletSize=1.7,this.animationDuration=.3,this.zooming=!1,this.adjustment=0,this.avoidBalloonOverlapping=!0,this.leaveCursor=!1,this.leaveAfterTouch=!0,this.valueZoomable=!1,this.balloonPointerOrientation="horizontal",this.hLineEnabled=this.vLineEnabled=!0,this.vZoomEnabled=this.hZoomEnabled=!1,h.applyTheme(this,t,this.cname)},draw:function(){this.destroy();var t=this.chart;t.panRequired=!0;var e=t.container;this.rotate=t.rotate,this.container=e,this.prevLineHeight=this.prevLineWidth=NaN,(e=e.set()).translate(this.x,this.y),this.set=e,t.cursorSet.push(e),this.createElements(),h.isString(this.limitToGraph)&&(this.limitToGraph=h.getObjById(t.graphs,this.limitToGraph),this.fullWidth=!1,this.cursorPosition="middle"),this.pointer=this.balloonPointerOrientation.substr(0,1).toUpperCase(),this.isHidden=!1,this.hideLines(),this.valueLineAxis||(this.valueLineAxis=t.valueAxes[0])},createElements:function(){var t,e,n=this,r=n.chart,i=r.dx,o=r.dy,a=n.width,s=n.height,l=n.cursorAlpha,u=n.valueLineAlpha;n.rotate?(t=u,e=l):(e=u,t=l),"xy"==r.type&&(e=l,void 0!==u&&(e=u),t=l),n.vvLine=h.line(n.container,[i,0,0],[o,0,s],n.cursorColor,t,1),h.setCN(r,n.vvLine,"cursor-line"),h.setCN(r,n.vvLine,"cursor-line-vertical"),n.hhLine=h.line(n.container,[0,a,a+i],[0,0,o],n.cursorColor,e,1),h.setCN(r,n.hhLine,"cursor-line"),h.setCN(r,n.hhLine,"cursor-line-horizontal"),n.vLine=n.rotate?n.vvLine:n.hhLine,n.set.push(n.vvLine),n.set.push(n.hhLine),n.set.node.style.pointerEvents="none",n.fullLines=n.container.set(),(r=r.cursorLineSet).push(n.fullLines),r.translate(n.x,n.y),r.clipRect(-1,-1,a+2,s+2),void 0!==n.tabIndex&&(r.setAttr("tabindex",n.tabIndex),r.keyup(function(t){n.handleKeys(t)}).focus(function(t){n.showCursor()}).blur(function(t){n.hideCursor()})),n.set.clipRect(0,0,a,s)},handleKeys:function(t){var e=this.prevIndex,n=this.chart;if(n){var r=n.chartData;r&&(isNaN(e)&&(e=r.length-1),37!=t.keyCode&&40!=t.keyCode||e--,39!=t.keyCode&&38!=t.keyCode||e++,e=h.fitToBounds(e,n.startIndex,n.endIndex),(t=this.chart.chartData[e])&&this.setPosition(t.x.categoryAxis),this.prevIndex=e)}},update:function(){var t=this.chart;if(t){var e,n=t.mouseX-this.x,r=t.mouseY-this.y;if(this.mouseX=n,this.mouseY=r,this.mouse2X=t.mouse2X-this.x,this.mouse2Y=t.mouse2Y-this.y,t.chartData&&0<t.chartData.length){if(this.mouseIsOver()?(this.hideGraphBalloons=!1,this.rolledOver=e=!0,this.updateDrawing(),this.vvLine&&isNaN(this.fx)&&(t.rotate||!this.limitToGraph)&&this.vvLine.translate(n,0),!this.hhLine||!isNaN(this.fy)||t.rotate&&this.limitToGraph||this.hhLine.translate(0,r),isNaN(this.mouse2X)?this.dispatchMovedEvent(n,r):e=!1):this.forceShow||this.hideCursor(),this.zooming){if(!isNaN(this.mouse2X))return void(isNaN(this.mouse2X0)||this.dispatchPanEvent());if(this.pan)return void this.dispatchPanEvent();(this.hZoomEnabled||this.vZoomEnabled)&&this.zooming&&this.updateSelection()}e&&this.showCursor()}}},updateDrawing:function(){if(this.drawing&&this.chart.setMouseCursor("crosshair"),this.drawingNow&&(h.remove(this.drawingLine),1<Math.abs(this.drawStartX-this.mouseX)||1<Math.abs(this.drawStartY-this.mouseY))){var t=(e=this.chart).marginTop,e=e.marginLeft;this.drawingLine=h.line(this.container,[this.drawStartX+e,this.mouseX+e],[this.drawStartY+t,this.mouseY+t],this.cursorColor,1,1)}},fixWidth:function(t){if(this.fullWidth&&this.prevLineWidth!=t){var e=this.vvLine,n=0;e&&(e.remove(),n=e.x),(e=this.container.set()).translate(n,0),n=h.rect(this.container,t,this.height,this.cursorColor,this.cursorAlpha,this.cursorAlpha,this.cursorColor),h.setCN(this.chart,n,"cursor-fill"),n.translate(-t/2-1,0),e.push(n),this.vvLine=e,this.fullLines.push(e),this.prevLineWidth=t}},fixHeight:function(t){if(this.fullWidth&&this.prevLineHeight!=t){var e=this.hhLine,n=0;e&&(e.remove(),n=e.y),(e=this.container.set()).translate(0,n),(n=h.rect(this.container,this.width,t,this.cursorColor,this.cursorAlpha)).translate(0,-t/2),e.push(n),this.fullLines.push(e),this.hhLine=e,this.prevLineHeight=t}},fixVLine:function(t,e){if(!isNaN(t)&&this.vvLine){if(isNaN(this.prevLineX)){var n=0,r=this.mouseX;if(this.limitToGraph){var i=this.chart.categoryAxis;i&&(this.chart.rotate||(n="bottom"==i.position?this.height:-this.height),r=t)}this.vvLine.translate(r,n)}else this.prevLineX!=t&&this.vvLine.translate(this.prevLineX,this.prevLineY);this.fx=t,this.prevLineX!=t&&(n=this.animationDuration,this.zooming&&(n=0),this.vvLine.stop(),this.vvLine.animate({translate:t+","+e},n,"easeOutSine"),this.prevLineX=t,this.prevLineY=e)}},fixHLine:function(t,e){if(!isNaN(t)&&this.hhLine){if(isNaN(this.prevLineY)){var n=0,r=this.mouseY;if(this.limitToGraph){var i=this.chart.categoryAxis;i&&(this.chart.rotate&&(n="right"==i.position?this.width:-this.width),r=t)}this.hhLine.translate(n,r)}else this.prevLineY!=t&&this.hhLine.translate(this.prevLineX,this.prevLineY);this.fy=t,this.prevLineY!=t&&(n=this.animationDuration,this.zooming&&(n=0),this.hhLine.stop(),this.hhLine.animate({translate:e+","+t},n,"easeOutSine"),this.prevLineY=t,this.prevLineX=e)}},hideCursor:function(t){this.forceShow=!1,this.chart.wasTouched&&this.leaveAfterTouch||this.isHidden||this.leaveCursor||(this.hideCursorReal(),t?this.chart.handleCursorHide():this.fire({target:this,chart:this.chart,type:"onHideCursor"}),this.chart.setMouseCursor("auto"))},hideCursorReal:function(){this.hideLines(),this.isHidden=!0,this.index=this.prevLineY=this.prevLineX=this.mouseY0=this.mouseX0=this.fy=this.fx=NaN},hideLines:function(){this.vvLine&&this.vvLine.hide(),this.hhLine&&this.hhLine.hide(),this.fullLines&&this.fullLines.hide(),this.isHidden=!0,this.chart.handleCursorHide()},showCursor:function(t){!this.drawing&&this.enabled&&(this.vLineEnabled&&this.vvLine&&this.vvLine.show(),this.hLineEnabled&&this.hhLine&&this.hhLine.show(),this.isHidden=!1,this.updateFullLine(),t||this.fire({target:this,chart:this.chart,type:"onShowCursor"}),this.pan&&this.chart.setMouseCursor("move"))},updateFullLine:function(){this.zooming&&this.fullWidth&&this.selection&&(this.rotate?0<this.selection.height&&this.hhLine.hide():0<this.selection.width&&this.vvLine.hide())},updateSelection:function(){if(!this.pan&&this.enabled){var t=this.mouseX,e=this.mouseY;isNaN(this.fx)||(t=this.fx),isNaN(this.fy)||(e=this.fy),this.clearSelection();var n,r=this.mouseX0,i=this.mouseY0,o=this.width,a=this.height;(t=h.fitToBounds(t,0,o))<r&&(n=t,t=r,r=n),(e=h.fitToBounds(e,0,a))<i&&(n=e,e=i,i=n),this.hZoomEnabled?o=t-r:r=0,this.vZoomEnabled?a=e-i:i=0,isNaN(this.mouse2X)&&0<Math.abs(o)&&0<Math.abs(a)&&(t=this.chart,e=h.rect(this.container,o,a,this.cursorColor,this.selectionAlpha),h.setCN(t,e,"cursor-selection"),e.width=o,e.height=a,e.translate(r,i),this.set.push(e),this.selection=e),this.updateFullLine()}},mouseIsOver:function(){var t=this.mouseX,e=this.mouseY;return this.justReleased?!(this.justReleased=!1):!!this.mouseIsDown||(this.chart.mouseIsOver&&0<t&&t<this.width&&0<e&&e<this.height||(this.handleMouseOut(),!1))},fixPosition:function(){this.prevY=this.prevX=NaN},handleMouseDown:function(){if(this.update(),this.mouseIsOver())if(this.mouseIsDown=!0,this.mouseX0=this.mouseX,this.mouseY0=this.mouseY,this.mouse2X0=this.mouse2X,this.mouse2Y0=this.mouse2Y,this.drawing)this.drawStartY=this.mouseY,this.drawStartX=this.mouseX,this.drawingNow=!0;else if(this.dispatchMovedEvent(this.mouseX,this.mouseY),!this.pan&&isNaN(this.mouse2X0)&&(isNaN(this.fx)||(this.mouseX0=this.fx),isNaN(this.fy)||(this.mouseY0=this.fy)),this.hZoomEnabled||this.vZoomEnabled){this.zooming=!0;var t={chart:this.chart,target:this,type:"zoomStarted"};t.x=this.mouseX/this.width,t.y=this.mouseY/this.height,this.index0=t.index=this.index,this.timestamp0=this.timestamp,this.fire(t)}},registerInitialMouse:function(){},handleReleaseOutside:function(){if(this.mouseIsDown=!1,this.drawingNow){this.drawingNow=!1,h.remove(this.drawingLine);var t=this.drawStartX,e=this.drawStartY,n=this.mouseX,r=this.mouseY,i=this.chart;(2<Math.abs(t-n)||2<Math.abs(e-r))&&this.fire({type:"draw",target:this,chart:i,initialX:t,initialY:e,finalX:n,finalY:r})}this.zooming&&(this.zooming=!1,this.selectWithoutZooming?this.dispatchZoomEvent("selected"):(this.hZoomEnabled||this.vZoomEnabled)&&this.dispatchZoomEvent("zoomed"),this.rolledOver&&this.dispatchMovedEvent(this.mouseX,this.mouseY)),this.mouse2Y0=this.mouse2X0=this.mouseY0=this.mouseX0=NaN},dispatchZoomEvent:function(t){if(!this.pan&&((u=this.selection)&&3<Math.abs(u.width)&&3<Math.abs(u.height))){var e=Math.min(this.index,this.index0),n=Math.max(this.index,this.index0),r=e,i=n,o=this.chart,a=o.chartData,s=o.categoryAxis;s&&s.parseDates&&!s.equalSpacing&&(r=a[e]?a[e].time:Math.min(this.timestamp0,this.timestamp),i=a[n]?o.getEndTime(a[n].time):Math.max(this.timestamp0,this.timestamp));var l,u={type:t,chart:this.chart,target:this,end:i,start:r,startIndex:e,endIndex:n,selectionHeight:u.height,selectionWidth:u.width,selectionY:u.y,selectionX:u.x};this.hZoomEnabled&&4<Math.abs(this.mouseX0-this.mouseX)&&(u.startX=this.mouseX0/this.width,u.endX=this.mouseX/this.width,l=!0),this.vZoomEnabled&&4<Math.abs(this.mouseY0-this.mouseY)&&(u.startY=1-this.mouseY0/this.height,u.endY=1-this.mouseY/this.height,l=!0),l&&(this.prevY=this.prevX=NaN,this.fire(u),"selected"!=t&&this.clearSelection()),this.hideCursor()}},dispatchMovedEvent:function(t,e,n,r){if(t=Math.round(t),e=Math.round(e),!this.isHidden&&(t!=this.prevX||e!=this.prevY||"changed"==n)){n=n||"moved";var i=this.fx,o=this.fy;isNaN(i)&&(i=t),isNaN(o)&&(o=e);var a=!1;this.zooming&&this.pan&&(a=!0),a={hidden:this.isHidden,type:n,chart:this.chart,target:this,x:t,y:e,finalX:i,finalY:o,zooming:this.zooming,panning:a,mostCloseGraph:this.mostCloseGraph,index:this.index,skip:r,hideBalloons:this.hideGraphBalloons},this.prevIndex=this.index,this.rotate?(a.position=e,a.finalPosition=o):(a.position=t,a.finalPosition=i),this.prevX=t,this.prevY=e,r?this.chart.handleCursorMove(a):(this.fire(a),"changed"==n&&this.chart.fire(a))}},dispatchPanEvent:function(){if(this.mouseIsDown){var t=h.roundTo((this.mouseX-this.mouseX0)/this.width,3),e=h.roundTo((this.mouseY-this.mouseY0)/this.height,3),n=h.roundTo((this.mouse2X-this.mouse2X0)/this.width,3),r=h.roundTo((this.mouse2Y-this.mouse2Y0)/this.height,2),i=!1;0!==Math.abs(t)&&0!==Math.abs(e)&&(i=!0),this.prevDeltaX!=t&&this.prevDeltaY!=e||(i=!1),isNaN(n)||isNaN(r)||(0!==Math.abs(n)&&0!==Math.abs(r)&&(i=!0),this.prevDelta2X!=n&&this.prevDelta2Y!=r)||(i=!1),i&&(this.hideLines(),this.fire({type:"panning",chart:this.chart,target:this,deltaX:t,deltaY:e,delta2X:n,delta2Y:r,index:this.index}),this.prevDeltaX=t,this.prevDeltaY=e,this.prevDelta2X=n,this.prevDelta2Y=r)}},clearSelection:function(){var t=this.selection;t&&(t.width=0,t.height=0,t.remove())},destroy:function(){this.clear(),h.remove(this.selection),this.selection=null,clearTimeout(this.syncTO),h.remove(this.set)},clear:function(){},setTimestamp:function(t){this.timestamp=t},setIndex:function(t,e){t!=this.index&&(this.index=t,e||this.isHidden||this.dispatchMovedEvent(this.mouseX,this.mouseY,"changed"))},handleMouseOut:function(){this.enabled&&this.rolledOver&&(this.leaveCursor||this.setIndex(void 0),this.forceShow=!1,this.hideCursor(),this.rolledOver=!1)},showCursorAt:function(t){var e=this.chart.categoryAxis;e&&this.setPosition(e.categoryToCoordinate(t),t)},setPosition:function(t,e){var n,r,i=this.chart,o=i.categoryAxis;o&&(void 0===e&&(e=o.coordinateToValue(t)),o.showBalloonAt(e,t),this.forceShow=!0,o.stickBalloonToCategory?i.rotate?this.fixHLine(t,0):this.fixVLine(t,0):(this.showCursor(),i.rotate?this.hhLine.translate(0,t):this.vvLine.translate(t,0)),i.rotate?n=t:r=t,i.rotate?(this.vvLine&&this.vvLine.hide(),this.hhLine&&this.hhLine.show()):(this.hhLine&&this.hhLine.hide(),this.vvLine&&this.vvLine.show()),this.updateFullLine(),this.isHidden=!1,this.dispatchMovedEvent(r,n,"moved",!0))},enableDrawing:function(t){this.enabled=!t,this.hideCursor(),this.drawing=t},syncWithCursor:function(t,e){clearTimeout(this.syncTO),t&&(t.isHidden?this.hideCursor(!0):this.syncWithCursorReal(t,e))},isZooming:function(t){this.zooming=t},syncWithCursorReal:function(t,e){var n=t.vvLine,r=t.hhLine;this.index=t.index,this.forceShow=!0,this.zooming&&this.pan||this.showCursor(!0),this.hideGraphBalloons=e,this.justReleased=t.justReleased,this.zooming=t.zooming,this.index0=t.index0,this.mouseX0=t.mouseX0,this.mouseY0=t.mouseY0,this.mouse2X0=t.mouse2X0,this.mouse2Y0=t.mouse2Y0,this.timestamp0=t.timestamp0,this.prevDeltaX=t.prevDeltaX,this.prevDeltaY=t.prevDeltaY,this.prevDelta2X=t.prevDelta2X,this.prevDelta2Y=t.prevDelta2Y,this.fx=t.fx,this.fy=t.fy,t.zooming&&this.updateSelection();var i=t.mouseX,o=t.mouseY;this.rotate?(i=NaN,this.vvLine&&this.vvLine.hide(),this.hhLine&&r&&(isNaN(t.fy)?this.hhLine.translate(0,t.mouseY):this.fixHLine(t.fy,0))):(o=NaN,this.hhLine&&this.hhLine.hide(),this.vvLine&&n&&(isNaN(t.fx)?this.vvLine.translate(t.mouseX,0):this.fixVLine(t.fx,0))),this.dispatchMovedEvent(i,o,"moved",!0)}})}(),function(){var f=window.AmCharts;f.SimpleChartScrollbar=f.Class({construct:function(t){this.createEvents("zoomed","zoomStarted","zoomEnded"),this.backgroundColor="#D4D4D4",this.backgroundAlpha=1,this.selectedBackgroundColor="#EFEFEF",this.scrollDuration=this.selectedBackgroundAlpha=1,this.resizeEnabled=!0,this.hideResizeGrips=!1,this.scrollbarHeight=20,this.updateOnReleaseOnly=!1,document.documentMode<9&&(this.updateOnReleaseOnly=!0),this.dragIconHeight=this.dragIconWidth=35,this.dragIcon="dragIconRoundBig",this.dragCursorHover="cursor: move; cursor: grab; cursor: -moz-grab; cursor: -webkit-grab;",this.dragCursorDown="cursor: move; cursor: grab; cursor: -moz-grabbing; cursor: -webkit-grabbing;",this.vResizeCursor="ns-resize",this.hResizeCursor="ew-resize",this.enabled=!0,this.percentStart=this.offset=0,this.percentEnd=1,f.applyTheme(this,t,"SimpleChartScrollbar")},getPercents:function(){var t=(r=this.getDBox()).x,e=r.y,n=r.width,r=r.height;this.rotate?(t=1-e/this.height,e=1-(e+r)/this.height):(e=t/this.width,t=(t+n)/this.width),this.percentStart=e,this.percentEnd=t},draw:function(){var e=this;if(e.destroy(),e.enabled){var t=e.chart.container,n=e.rotate,r=e.chart;r.panRequired=!0;var i,o,a=t.set();if(e.set=a,n?f.setCN(r,a,"scrollbar-vertical"):f.setCN(r,a,"scrollbar-horizontal"),r.scrollbarsSet.push(a),n?(i=e.scrollbarHeight,o=r.plotAreaHeight):(o=e.scrollbarHeight,i=r.plotAreaWidth),e.width=i,(e.height=o)&&i){var s=f.rect(t,i,o,e.backgroundColor,e.backgroundAlpha,1,e.backgroundColor,e.backgroundAlpha);f.setCN(r,s,"scrollbar-bg"),e.bg=s,a.push(s),s=f.rect(t,i,o,"#000",.005),a.push(s),(e.invisibleBg=s).click(function(){e.handleBgClick()}).mouseover(function(){e.handleMouseOver()}).mouseout(function(){e.handleMouseOut()}).touchend(function(){e.handleBgClick()}),s=f.rect(t,i,o,e.selectedBackgroundColor,e.selectedBackgroundAlpha),f.setCN(r,s,"scrollbar-bg-selected"),e.selectedBG=s,a.push(s),i=f.rect(t,i,o,"#000",.005),e.dragger=i,a.push(i),i.mousedown(function(t){e.handleDragStart(t)}).mouseup(function(){e.handleDragStop()}).mouseover(function(){e.handleDraggerOver()}).mouseout(function(){e.handleMouseOut()}).touchstart(function(t){e.handleDragStart(t)}).touchend(function(){e.handleDragStop()}),o=r.pathToImages;var l;s=e.dragIcon.replace(/\.[a-z]*$/i,"");f.isAbsolute(s)&&(o=""),n?(l=o+s+"H"+r.extension,o=e.dragIconWidth,n=e.dragIconHeight):(l=o+s+r.extension,n=e.dragIconWidth,o=e.dragIconHeight),s=t.image(l,0,0,n,o),f.setCN(r,s,"scrollbar-grip-left"),l=t.image(l,0,0,n,o),f.setCN(r,l,"scrollbar-grip-right");var u=10,h=20;r.panEventsEnabled&&(u=25,h=e.scrollbarHeight);var c=f.rect(t,u,h,"#000",.005),d=f.rect(t,u,h,"#000",.005);d.translate(-(u-n)/2,-(h-o)/2),c.translate(-(u-n)/2,-(h-o)/2),n=t.set([s,d]),t=t.set([l,c]),e.iconLeft=n,a.push(e.iconLeft),e.iconRight=t,a.push(t),e.updateGripCursor(!1),r.makeAccessible(n,e.accessibleLabel),r.makeAccessible(t,e.accessibleLabel),r.makeAccessible(i,e.accessibleLabel),n.setAttr("role","menuitem"),t.setAttr("role","menuitem"),i.setAttr("role","menuitem"),void 0!==e.tabIndex&&(n.setAttr("tabindex",e.tabIndex),n.keyup(function(t){e.handleKeys(t,1,0)})),void 0!==e.tabIndex&&(i.setAttr("tabindex",e.tabIndex),i.keyup(function(t){e.handleKeys(t,1,1)})),void 0!==e.tabIndex&&(t.setAttr("tabindex",e.tabIndex),t.keyup(function(t){e.handleKeys(t,0,1)})),n.mousedown(function(){e.leftDragStart()}).mouseup(function(){e.leftDragStop()}).mouseover(function(){e.iconRollOver()}).mouseout(function(){e.iconRollOut()}).touchstart(function(){e.leftDragStart()}).touchend(function(){e.leftDragStop()}),t.mousedown(function(){e.rightDragStart()}).mouseup(function(){e.rightDragStop()}).mouseover(function(){e.iconRollOver()}).mouseout(function(){e.iconRollOut()}).touchstart(function(){e.rightDragStart()}).touchend(function(){e.rightDragStop()}),f.ifArray(r.chartData)?a.show():a.hide(),e.hideDragIcons(),e.clipDragger(!1)}a.translate(e.x,e.y),a.node.style.msTouchAction="none",a.node.style.touchAction="none"}},handleKeys:function(t,e,n){this.getPercents();var r=this.percentStart,i=this.percentEnd;if(this.rotate){var o=i;i=r,r=o}37!=t.keyCode&&40!=t.keyCode||(r-=.02*e,i-=.02*n),39!=t.keyCode&&38!=t.keyCode||(r+=.02*e,i+=.02*n),this.rotate&&(t=i,i=r,r=t),isNaN(i)||isNaN(r)||this.percentZoom(r,i,!0)},updateScrollbarSize:function(t,e){if(!isNaN(t)&&!isNaN(e)){t=Math.round(t),e=Math.round(e);var n,r,i,o,a,s=this.dragger;this.rotate?(n=0,r=t,i=this.width+1,o=e-t,s.setAttr("height",e-t),s.setAttr("y",r)):(r=0,i=e-(n=t),o=this.height+1,a=e-t,s.setAttr("x",n),s.setAttr("width",a)),this.clipAndUpdate(n,r,i,o)}},update:function(){var t,e,n,r=!1,i=this.x,o=this.y,a=this.dragger;if(l=this.getDBox()){e=l.x+i,n=l.y+o;var s=l.width,l=l.height,u=this.rotate,h=this.chart,c=this.width,d=this.height,f=h.mouseX;h=h.mouseY;if(t=this.initialMouse,this.forceClip&&this.clipDragger(!0),this.dragging){var p=this.initialCoord;u?((t=p+(h-t))<0&&(t=0),(p=d-l)<t&&(t=p),a.setAttr("y",t)):((t=p+(f-t))<0&&(t=0),((p=c-s)<t||isNaN(t))&&(t=p),a.setAttr("x",t)),this.clipDragger(!0)}this.resizingRight&&(u?(t=h-n,!isNaN(this.maxHeight)&&t>this.maxHeight&&(t=this.maxHeight),d+o<t+n&&(t=d-n+o),t<0?(this.resizingRight=!1,r=this.resizingLeft=!0):(0!==t&&!isNaN(t)||(t=.1),a.setAttr("height",t))):(t=f-e,!isNaN(this.maxWidth)&&t>this.maxWidth&&(t=this.maxWidth),c+i<t+e&&(t=c-e+i),t<0?(this.resizingRight=!1,r=this.resizingLeft=!0):(0!==t&&!isNaN(t)||(t=.1),a.setAttr("width",t))),this.clipDragger(!0)),this.resizingLeft&&(u?(e=n,(n=h)<o&&(n=o),isNaN(n)&&(n=o),d+o<n&&(n=d+o),t=!0===r?e-n:l+e-n,!isNaN(this.maxHeight)&&t>this.maxHeight&&(t=this.maxHeight,n=e),t<0?(this.resizingRight=!0,this.resizingLeft=!1,a.setAttr("y",e+l-o)):(0!==t&&!isNaN(t)||(t=.1),a.setAttr("y",n-o),a.setAttr("height",t))):((n=f)<i&&(n=i),isNaN(n)&&(n=i),c+i<n&&(n=c+i),t=!0===r?e-n:s+e-n,!isNaN(this.maxWidth)&&t>this.maxWidth&&(t=this.maxWidth,n=e),t<0?(this.resizingRight=!0,this.resizingLeft=!1,a.setAttr("x",e+s-i)):(0!==t&&!isNaN(t)||(t=.1),a.setAttr("x",n-i),a.setAttr("width",t))),this.clipDragger(!0))}},stopForceClip:function(){this.animating=this.forceClip=!1},clipDragger:function(t){if(i=this.getDBox()){var e=i.x,n=i.y,r=i.width,i=i.height,o=!1;this.rotate?(e=0,r=this.width+1,this.clipY==n&&this.clipH==i||(o=!0)):(n=0,i=this.height+1,this.clipX==e&&this.clipW==r||(o=!0)),o&&this.clipAndUpdate(e,n,r,i),t&&(this.updateOnReleaseOnly||this.dispatchScrollbarEvent())}},maskGraphs:function(){},clipAndUpdate:function(t,e,n,r){this.clipX=t,this.clipY=e,this.clipW=n,this.clipH=r,this.selectedBG.setAttr("width",n),this.selectedBG.setAttr("height",r),this.selectedBG.translate(t,e),this.updateDragIconPositions(),this.maskGraphs(t,e,n,r)},dispatchScrollbarEvent:function(){if(this.skipEvent)this.skipEvent=!1;else{var t=this.chart;t.hideBalloon();var e=(i=this.getDBox()).x,n=i.y,r=i.width,i=i.height;this.getPercents(),r=this.rotate?(e=n,this.height/i):this.width/r,t={type:"zoomed",position:e,chart:t,target:this,multiplier:r,relativeStart:this.percentStart,relativeEnd:this.percentEnd},this.percentStart==this.prevPercentStart&&this.percentEnd==this.prevPercentEnd&&this.prevMultiplier==r||(this.fire(t),this.prevPercentStart=this.percentStart,this.prevPercentEnd=this.percentEnd,this.prevMultiplier=r)}},updateDragIconPositions:function(){var t,e,n=this.getDBox(),r=n.x,i=n.y,o=this.iconLeft,a=this.iconRight,s=this.scrollbarHeight;this.rotate?(t=this.dragIconWidth,e=this.dragIconHeight,o.translate((s-e)/2,i-t/2),a.translate((s-e)/2,i+n.height-t/2)):(t=this.dragIconHeight,e=this.dragIconWidth,o.translate(r-e/2,(s-t)/2),a.translate(r-e/2+n.width,(s-t)/2))},showDragIcons:function(){this.resizeEnabled&&(this.iconLeft.show(),this.iconRight.show())},hideDragIcons:function(){this.resizingLeft||this.resizingRight||this.dragging||(!this.hideResizeGrips&&this.resizeEnabled||(this.iconLeft.hide(),this.iconRight.hide()),this.removeCursors())},removeCursors:function(){this.chart.setMouseCursor("auto")},fireZoomEvent:function(t){this.fire({type:t,chart:this.chart,target:this})},percentZoom:function(t,e,n){var r,i;t=f.fitToBounds(t,0,e),e=f.fitToBounds(e,t,1),this.dragger&&this.enabled&&(this.dragger.stop(),isNaN(t)&&(t=0),isNaN(e)&&(e=1),this.rotate?(e=(r=this.height)-r*e,i=r-r*t):(i=(r=this.width)*e,e=r*t),this.updateScrollbarSize(e,i),this.clipDragger(!1),this.getPercents(),n&&this.dispatchScrollbarEvent())},destroy:function(){this.clear(),f.remove(this.set),f.remove(this.iconRight),f.remove(this.iconLeft)},clear:function(){},handleDragStart:function(){if(this.enabled){this.fireZoomEvent("zoomStarted");var t=this.chart;this.dragger.stop(),this.removeCursors(),f.isModern&&(this.dragger.node.style.cssText=this.dragCursorDown),this.dragging=!0;var e=this.getDBox();this.rotate?(this.initialCoord=e.y,this.initialMouse=t.mouseY):(this.initialCoord=e.x,this.initialMouse=t.mouseX)}},handleDragStop:function(){this.updateOnReleaseOnly&&(this.update(),this.skipEvent=!1,this.dispatchScrollbarEvent()),this.dragging=!1,this.mouseIsOver&&this.removeCursors(),f.isModern&&(this.dragger.node.style.cssText=this.dragCursorHover),this.update(),this.fireZoomEvent("zoomEnded")},handleDraggerOver:function(){this.handleMouseOver(),f.isModern&&(this.dragger.node.style.cssText=this.dragCursorHover)},leftDragStart:function(){this.fireZoomEvent("zoomStarted"),this.dragger.stop(),this.resizingLeft=!0,this.updateGripCursor(!0)},updateGripCursor:function(t){f.isModern&&(t=this.rotate?t?this.vResizeCursorDown:this.vResizeCursorHover:t?this.hResizeCursorDown:this.hResizeCursorHover)&&(this.iconRight&&(this.iconRight.node.style.cssText=t),this.iconLeft&&(this.iconLeft.node.style.cssText=t))},leftDragStop:function(){this.resizingLeft&&(this.resizingLeft=!1,this.mouseIsOver||this.removeCursors(),this.updateOnRelease(),this.fireZoomEvent("zoomEnded")),this.updateGripCursor(!1)},rightDragStart:function(){this.fireZoomEvent("zoomStarted"),this.dragger.stop(),this.resizingRight=!0,this.updateGripCursor(!0)},rightDragStop:function(){this.resizingRight&&(this.resizingRight=!1,this.mouseIsOver||this.removeCursors(),this.updateOnRelease(),this.fireZoomEvent("zoomEnded")),this.updateGripCursor(!1)},iconRollOut:function(){this.removeCursors()},iconRollOver:function(){this.rotate?this.vResizeCursor&&this.chart.setMouseCursor(this.vResizeCursor):this.hResizeCursor&&this.chart.setMouseCursor(this.hResizeCursor),this.handleMouseOver()},getDBox:function(){if(this.dragger)return this.dragger.getBBox()},handleBgClick:function(){var t=this;if(!t.resizingRight&&!t.resizingLeft){t.zooming=!0;var e,n,r=t.scrollDuration,i=t.dragger,o=(e=t.getDBox()).height,a=e.width;n=t.chart;var s=t.y,l=t.x,u=t.rotate;n=u?(e="y",n=n.mouseY-o/2-s,f.fitToBounds(n,0,t.height-o)):(e="x",n=n.mouseX-a/2-l,f.fitToBounds(n,0,t.width-a)),t.updateOnReleaseOnly?(t.skipEvent=!1,i.setAttr(e,n),t.dispatchScrollbarEvent(),t.clipDragger()):(t.animating=!0,n=Math.round(n),u?i.animate({y:n},r,">"):i.animate({x:n},r,">"),t.forceClip=!0,clearTimeout(t.forceTO),t.forceTO=setTimeout(function(){t.stopForceClip.call(t)},5e3*r))}},updateOnRelease:function(){this.updateOnReleaseOnly&&(this.update(),this.skipEvent=!1,this.dispatchScrollbarEvent())},handleReleaseOutside:function(){this.set&&((this.resizingLeft||this.resizingRight||this.dragging)&&(this.dragging=this.resizingRight=this.resizingLeft=!1,this.updateOnRelease(),this.removeCursors()),this.animating=this.mouseIsOver=!1,this.hideDragIcons(),this.update())},handleMouseOver:function(){this.mouseIsOver=!0,this.showDragIcons()},handleMouseOut:function(){this.mouseIsOver=!1,this.hideDragIcons(),this.removeCursors()}})}(),function(){var m=window.AmCharts;m.ChartScrollbar=m.Class({inherits:m.SimpleChartScrollbar,construct:function(t){this.cname="ChartScrollbar",m.ChartScrollbar.base.construct.call(this,t),this.graphLineColor="#BBBBBB",this.graphLineAlpha=0,this.graphFillColor="#BBBBBB",this.graphFillAlpha=1,this.selectedGraphLineColor="#888888",this.selectedGraphLineAlpha=0,this.selectedGraphFillColor="#888888",this.selectedGraphFillAlpha=1,this.gridCount=0,this.gridColor="#FFFFFF",this.gridAlpha=.7,this.skipEvent=this.autoGridCount=!1,this.color="#FFFFFF",this.scrollbarCreated=!1,this.oppositeAxis=!0,this.accessibleLabel="Zoom chart using cursor arrows",m.applyTheme(this,t,this.cname)},init:function(){var t=this.categoryAxis,e=this.chart,n=this.gridAxis;t||("CategoryAxis"==this.gridAxis.cname?(this.catScrollbar=!0,(t=new m.CategoryAxis).id="scrollbar"):((t=new m.ValueAxis).data=e.chartData,t.id=n.id,t.type=n.type,t.maximumDate=n.maximumDate,t.minimumDate=n.minimumDate,t.minPeriod=n.minPeriod,t.minMaxField=n.minMaxField),this.categoryAxis=t);var r=(t.chart=e).categoryAxis;r&&(t.firstDayOfWeek=r.firstDayOfWeek),t.dateFormats=n.dateFormats,t.markPeriodChange=n.markPeriodChange,t.boldPeriodBeginning=n.boldPeriodBeginning,t.labelFunction=n.labelFunction,t.axisItemRenderer=m.RecItem,t.axisRenderer=m.RecAxis,t.guideFillRenderer=m.RecFill,t.inside=!0,t.fontSize=this.fontSize,t.tickLength=0,t.axisAlpha=0,m.isString(this.graph)&&(this.graph=m.getObjById(e.graphs,this.graph)),(t=this.graph)&&this.catScrollbar&&((n=this.valueAxis)||(this.valueAxis=n=new m.ValueAxis,n.visible=!1,n.scrollbar=!0,n.axisItemRenderer=m.RecItem,n.axisRenderer=m.RecAxis,n.guideFillRenderer=m.RecFill,n.labelsEnabled=!1,n.chart=e),(e=this.unselectedGraph)||((e=new m.AmGraph).scrollbar=!0,(this.unselectedGraph=e).negativeBase=t.negativeBase,e.noStepRisers=t.noStepRisers),(e=this.selectedGraph)||((e=new m.AmGraph).scrollbar=!0,(this.selectedGraph=e).negativeBase=t.negativeBase,e.noStepRisers=t.noStepRisers)),this.scrollbarCreated=!0},draw:function(){var t=this;if(m.ChartScrollbar.base.draw.call(t),t.enabled){t.scrollbarCreated||t.init();var e=t.chart,n=e.chartData,r=t.categoryAxis,i=t.rotate,o=t.x,a=t.y,s=t.width,l=t.height,u=t.gridAxis,h=t.set;if(r.setOrientation(!i),r.parseDates=u.parseDates,"ValueAxis"==t.categoryAxis.cname&&(r.rotate=!i),r.equalSpacing=u.equalSpacing,r.minPeriod=u.minPeriod,r.startOnAxis=u.startOnAxis,r.width=s-1,r.height=l,r.gridCount=t.gridCount,r.gridColor=t.gridColor,r.gridAlpha=t.gridAlpha,r.color=t.color,r.tickLength=0,r.axisAlpha=0,r.autoGridCount=t.autoGridCount,r.parseDates&&!r.equalSpacing&&r.timeZoom(e.firstTime,e.lastTime),r.minimum=t.gridAxis.fullMin,r.maximum=t.gridAxis.fullMax,r.strictMinMax=!0,r.zoom(0,n.length-1),(u=t.graph)&&t.catScrollbar){var c=t.valueAxis,d=u.valueAxis;c.id=d.id,c.rotate=i,c.setOrientation(i),c.width=s,c.height=l,c.dataProvider=n,c.reversed=d.reversed,c.logarithmic=d.logarithmic,c.gridAlpha=0,c.axisAlpha=0,h.push(c.set),i?(c.y=a,c.x=0):(c.x=o,c.y=0);var f;o=1/0,a=-1/0;for(f=0;f<n.length;f++){var p,g=n[f].axes[d.id].graphs[u.id].values;for(p in g)if(g.hasOwnProperty(p)&&"percents"!=p&&"total"!=p){var v=g[p];v<o&&(o=v),a<v&&(a=v)}}1/0!=o&&(c.minimum=o),-1/0!=a&&(c.maximum=a+.1*(a-o)),o==a&&(--c.minimum,c.maximum+=1),void 0!==t.minimum&&(c.minimum=t.minimum),void 0!==t.maximum&&(c.maximum=t.maximum),c.zoom(0,n.length-1),(p=t.unselectedGraph).id=u.id,p.bcn="scrollbar-graph-",p.rotate=i,p.chart=e,p.data=n,p.valueAxis=c,p.chart=u.chart,p.categoryAxis=t.categoryAxis,p.periodSpan=u.periodSpan,p.valueField=u.valueField,p.openField=u.openField,p.closeField=u.closeField,p.highField=u.highField,p.lowField=u.lowField,p.lineAlpha=t.graphLineAlpha,p.lineColorR=t.graphLineColor,p.fillAlphas=t.graphFillAlpha,p.fillColorsR=t.graphFillColor,p.connect=u.connect,p.hidden=u.hidden,p.width=s,p.height=l,p.pointPosition=u.pointPosition,p.stepDirection=u.stepDirection,p.periodSpan=u.periodSpan,(d=t.selectedGraph).id=u.id,d.bcn=p.bcn+"selected-",d.rotate=i,d.chart=e,d.data=n,d.valueAxis=c,d.chart=u.chart,d.categoryAxis=r,d.periodSpan=u.periodSpan,d.valueField=u.valueField,d.openField=u.openField,d.closeField=u.closeField,d.highField=u.highField,d.lowField=u.lowField,d.lineAlpha=t.selectedGraphLineAlpha,d.lineColorR=t.selectedGraphLineColor,d.fillAlphas=t.selectedGraphFillAlpha,d.fillColorsR=t.selectedGraphFillColor,d.connect=u.connect,d.hidden=u.hidden,d.width=s,d.height=l,d.pointPosition=u.pointPosition,d.stepDirection=u.stepDirection,d.periodSpan=u.periodSpan,e=(e=t.graphType)||u.type,p.type=e,d.type=e,n=n.length-1,p.zoom(0,n),d.zoom(0,n),d.set.click(function(){t.handleBackgroundClick()}).mouseover(function(){t.handleMouseOver()}).mouseout(function(){t.handleMouseOut()}),p.set.click(function(){t.handleBackgroundClick()}).mouseover(function(){t.handleMouseOver()}).mouseout(function(){t.handleMouseOut()}),h.push(p.set),h.push(d.set)}h.push(r.set),h.push(r.labelsSet),t.bg.toBack(),t.invisibleBg.toFront(),t.dragger.toFront(),t.iconLeft.toFront(),t.iconRight.toFront()}},timeZoom:function(t,e,n){this.startTime=t,this.endTime=e,this.timeDifference=e-t,this.skipEvent=!m.toBoolean(n),this.zoomScrollbar(),this.dispatchScrollbarEvent()},zoom:function(t,e){this.start=t,this.end=e,this.skipEvent=!0,this.zoomScrollbar()},dispatchScrollbarEvent:function(){if(this.categoryAxis&&"ValueAxis"==this.categoryAxis.cname)m.ChartScrollbar.base.dispatchScrollbarEvent.call(this);else if(this.skipEvent)this.skipEvent=!1;else{var t,e,n=this.chart.chartData;t=(o=this.dragger.getBBox()).x;var r=o.y,i=o.width,o=o.height,a=this.chart;e=this.rotate?(t=r,o):i,(i={type:"zoomed",target:this}).chart=a;var s=this.categoryAxis,l=this.stepWidth,u=(r=a.minSelectedTime,o=a.maxSelectedTime,!1);s.parseDates&&!s.equalSpacing?(n=a.lastTime,a=a.firstTime,s=Math.round(t/l)+a,(t=this.dragging?s+this.timeDifference:Math.round((t+e)/l)+a)<s&&(s=t),0<r&&t-s<r&&(s=(t=Math.round(s+(t-s)/2))-(u=Math.round(r/2)),t+=u,u=!0),0<o&&o<t-s&&(s=(t=Math.round(s+(t-s)/2))-(u=Math.round(o/2)),t+=u,u=!0),n<t&&(t=n),t-r<s&&(s=t-r),s<a&&(s=a),t<s+r&&(t=s+r),s==this.startTime&&t==this.endTime||(this.startTime=s,this.endTime=t,i.start=s,i.end=t,i.startDate=new Date(s),i.endDate=new Date(t),this.fire(i))):(s.startOnAxis||(t+=l/2),e-=this.stepWidth/2,r=s.xToIndex(t),t=s.getCoordinate(r)-this.stepWidth/2,t=s.xToIndex(t+e),r==this.start&&this.end==t||(s.startOnAxis&&(this.resizingRight&&r==t&&t++,this.resizingLeft&&r==t&&(0<r?r--:t=1)),this.start=r,this.end=this.dragging?this.start+this.difference:t,i.start=this.start,i.end=this.end,s.parseDates&&(n[this.start]&&(i.startDate=new Date(n[this.start].time)),n[this.end]&&(i.endDate=new Date(n[this.end].time))),this.fire(i)),this.percentStart=r,this.percentEnd=t),u&&this.zoomScrollbar(!0)}},zoomScrollbar:function(t){if((!(this.dragging||this.resizingLeft||this.resizingRight||this.animating)||t)&&this.dragger&&this.enabled){var e,n,r=this.chart;t=r.chartData;var i=this.categoryAxis;i.parseDates&&!i.equalSpacing?(t=i.stepWidth,n=r.firstTime,e=t*(this.startTime-n),n=t*(this.endTime-n)):(t[this.start]&&(e=t[this.start].x[i.id]),t[this.end]&&(n=t[this.end].x[i.id]),t=i.stepWidth,i.startOnAxis||(e-=r=t/2,n+=r)),this.stepWidth=t,isNaN(e)||isNaN(n)||this.updateScrollbarSize(e,n)}},maskGraphs:function(t,e,n,r){var i=this.selectedGraph;i&&i.set.clipRect(t,e,n,r)},handleDragStart:function(){m.ChartScrollbar.base.handleDragStart.call(this),this.difference=this.end-this.start,this.timeDifference=this.endTime-this.startTime,this.timeDifference<0&&(this.timeDifference=0)},handleBackgroundClick:function(){m.ChartScrollbar.base.handleBackgroundClick.call(this),this.dragging||(this.difference=this.end-this.start,this.timeDifference=this.endTime-this.startTime,this.timeDifference<0&&(this.timeDifference=0))}})}(),function(){var x=window.AmCharts;x.AmBalloon=x.Class({construct:function(t){this.cname="AmBalloon",this.enabled=!0,this.fillColor="#FFFFFF",this.fillAlpha=.8,this.borderThickness=2,this.borderColor="#FFFFFF",this.borderAlpha=1,this.cornerRadius=0,this.maxWidth=220,this.horizontalPadding=8,this.verticalPadding=4,this.pointerWidth=6,this.pointerOrientation="V",this.color="#000000",this.adjustBorderColor=!0,this.show=this.follow=this.showBullet=!1,this.bulletSize=3,this.shadowAlpha=.4,this.shadowColor="#000000",this.fadeOutDuration=this.animationDuration=.3,this.fixedPosition=!0,this.offsetY=6,this.offsetX=1,this.textAlign="center",this.disableMouseEvents=!0,this.deltaSignX=this.deltaSignY=1,x.isModern||(this.offsetY*=1.5),this.sdy=this.sdx=0,x.applyTheme(this,t,this.cname)},draw:function(){var t=this.pointToX,e=this.pointToY;x.isModern||(this.drop=!1);var n=this.chart;if(x.VML&&(this.fadeOutDuration=0),this.xAnim&&n.stopAnim(this.xAnim),this.yAnim&&n.stopAnim(this.yAnim),this.sdy=this.sdx=0,!isNaN(t)){var r=this.follow,i=n.container,o=this.set;if(x.remove(o),this.removeDiv(),(o=i.set()).node.style.pointerEvents="none",this.set=o,this.mainSet?(this.mainSet.push(this.set),this.sdx=this.mainSet.x,this.sdy=this.mainSet.y):n.balloonsSet.push(o),this.show){var a=this.l,s=this.t,l=this.r,u=this.b,h=this.balloonColor,c=this.fillColor,d=this.borderColor,f=c;null!=h&&(this.adjustBorderColor?f=d=h:c=h);var p=this.horizontalPadding,g=this.verticalPadding,v=this.pointerWidth,m=this.pointerOrientation,y=this.cornerRadius,w=n.fontFamily;null==(N=this.fontSize)&&(N=n.fontSize);h=document.createElement("div");var b=n.classNamePrefix;h.className=b+"-balloon-div",this.className&&(h.className=h.className+" "+b+"-balloon-div-"+this.className),b=h.style,this.disableMouseEvents&&(b.pointerEvents="none"),b.position="absolute";var C=this.minWidth,E=document.createElement("div");h.appendChild(E);var S=E.style;isNaN(C)||(S.minWidth=C-2*p+"px"),S.textAlign=this.textAlign,S.maxWidth=this.maxWidth+"px",S.fontSize=N+"px",S.color=this.color,S.fontFamily=w,E.innerHTML=this.text,n.chartDiv.appendChild(h);S=(this.textDiv=h).offsetWidth;var O=h.offsetHeight;h.clientHeight&&(S=h.clientWidth,O=h.clientHeight),w=O+2*g,E=S+2*p,!isNaN(C)&&E<C&&(E=C),window.opera&&(w+=2);var T=!1,N=this.offsetY;n.handDrawn&&(N+=n.handDrawScatter+2),"H"!=m?(C=t-E/2,e<s+w+10&&"down"!=m?(T=!0,r&&(e+=N),N=e+v,this.deltaSignY=-1):(r&&(e-=N),N=e-w-v,this.deltaSignY=1)):(w<2*v&&(v=w/2),N=e-w/2,this.deltaSignX=t<a+(l-a)/2?(C=t+v,-1):(C=t-E-v,1)),u<=N+w&&(N=u-w),N<s&&(N=s),C<a&&(C=a),l<C+E&&(C=l-E);s=N+g,u=C+p;var R,_=this.shadowAlpha,M=this.shadowColor,A=(p=this.borderThickness,this.bulletSize),k=(g=this.fillAlpha,this.borderAlpha);this.showBullet&&(R=x.circle(i,A,f,g),o.push(R)),c=this.drop?(a=E/1.6,l=0,"V"==m&&(m="down"),"H"==m&&(m="left"),"down"==m&&(C=t+1,N=e-a-a/3),"up"==m&&(l=180,C=t+1,N=e+a+a/3),"left"==m&&(l=270,C=t+a+a/3+2,N=e),"right"==m&&(l=90,C=t-a-a/3+2,N=e),s=N-O/2+1,u=C-S/2-1,x.drop(i,a,l,c,g,p,d,k)):0<y||0===v?(0<_&&(t=x.rect(i,E,w,c,0,p+1,M,_,y),x.isModern?t.translate(1,1):t.translate(4,4),o.push(t)),x.rect(i,E,w,c,g,p,d,k,y)):(f=[],y=[],"H"!=m?(E-v<(a=t-C)&&(a=E-v),a<v&&(a=v),f=[0,a-v,t-C,a+v,E,E,0,0],y=T?[0,0,e-N,0,0,w,w,0]:[w,w,e-N,w,w,0,0,w]):(w-v<(m=e-N)&&(m=w-v),m<v&&(m=v),y=[0,m-v,e-N,m+v,w,w,0,0],f=t<a+(l-a)/2?[0,0,C<t?0:t-C,0,0,E,E,0]:[E,E,t<C+E?E:t-C,E,E,0,0,E]),0<_&&((t=x.polygon(i,f,y,c,0,p,M,_)).translate(1,1),o.push(t)),x.polygon(i,f,y,c,g,p,d,k)),this.bg=c,o.push(c),c.toFront(),x.setCN(n,c,"balloon-bg"),this.className&&x.setCN(n,c,"balloon-bg-"+this.className),i=1*this.deltaSignX,u+=this.sdx,s+=this.sdy,b.left=u+"px",b.top=s+"px",o.translate(C-i,N,1,!0),c=c.getBBox(),this.bottom=N+w+1,this.yPos=c.y+N,R&&R.translate(this.pointToX-C+i,e-N),e=this.animationDuration,0<this.animationDuration&&!r&&!isNaN(this.prevX)&&(o.translate(this.prevX,this.prevY,NaN,!0),o.animate({translate:C-i+","+N},e,"easeOutSine"),h&&(b.left=this.prevTX+"px",b.top=this.prevTY+"px",this.xAnim=n.animate({node:h},"left",this.prevTX,u,e,"easeOutSine","px"),this.yAnim=n.animate({node:h},"top",this.prevTY,s,e,"easeOutSine","px"))),this.prevX=C-i,this.prevY=N,this.prevTX=u,this.prevTY=s}}},fixPrevious:function(){this.rPrevX=this.prevX,this.rPrevY=this.prevY,this.rPrevTX=this.prevTX,this.rPrevTY=this.prevTY},restorePrevious:function(){this.prevX=this.rPrevX,this.prevY=this.rPrevY,this.prevTX=this.rPrevTX,this.prevTY=this.rPrevTY},followMouse:function(){if(this.follow&&this.show){var t=this.chart.mouseX-this.offsetX*this.deltaSignX-this.sdx,e=this.chart.mouseY-this.sdy;if(this.pointToX=t,this.pointToY=e,t!=this.previousX||e!=this.previousY)if(this.previousX=t,this.previousY=e,0===this.cornerRadius)this.draw();else{var n=this.set;if(n){var r=n.getBBox(),i=(t=t-r.width/2,e-r.height-10);t<this.l&&(t=this.l),t>this.r-r.width&&(t=this.r-r.width),i<this.t&&(i=e+10),n.translate(t,i),(e=this.textDiv.style).left=t+this.horizontalPadding+"px",e.top=i+this.verticalPadding+"px"}}}},changeColor:function(t){this.balloonColor=t},setBounds:function(t,e,n,r){this.l=t,this.t=e,this.r=n,this.b=r,this.destroyTO&&clearTimeout(this.destroyTO)},showBalloon:function(t){this.text==t&&!this.positionChanged||(this.text=t,this.isHiding=!1,this.show=!0,this.destroyTO&&clearTimeout(this.destroyTO),t=this.chart,this.fadeAnim1&&t.stopAnim(this.fadeAnim1),this.fadeAnim2&&t.stopAnim(this.fadeAnim2),this.draw(),this.positionChanged=!1)},hide:function(t){var e=this;e.text=void 0,isNaN(t)&&(t=e.fadeOutDuration);var n=e.chart;if(0<t&&!e.isHiding){e.isHiding=!0,e.destroyTO&&clearTimeout(e.destroyTO),e.destroyTO=setTimeout(function(){e.destroy.call(e)},1e3*t),e.follow=!1,e.show=!1;var r=e.set;r&&(r.setAttr("opacity",e.fillAlpha),e.fadeAnim1=r.animate({opacity:0},t,"easeInSine")),e.textDiv&&(e.fadeAnim2=n.animate({node:e.textDiv},"opacity",1,0,t,"easeInSine",""))}else e.show=!1,e.follow=!1,e.destroy()},setPosition:function(t,e){t==this.pointToX&&e==this.pointToY||(this.previousX=this.pointToX,this.previousY=this.pointToY,this.pointToX=t,this.pointToY=e,this.positionChanged=!0)},followCursor:function(t){var e=this;e.follow=t,clearInterval(e.interval);var n=e.chart.mouseX-e.sdx,r=e.chart.mouseY-e.sdy;!isNaN(n)&&t&&(e.pointToX=n-e.offsetX*e.deltaSignX,e.pointToY=r,e.followMouse(),e.interval=setInterval(function(){e.followMouse.call(e)},40))},removeDiv:function(){if(this.textDiv){var t=this.textDiv.parentNode;t&&t.removeChild(this.textDiv)}},destroy:function(){clearInterval(this.interval),x.remove(this.set),this.removeDiv(),this.set=null}})}(),function(){var I=window.AmCharts;I.AmCoordinateChart=I.Class({inherits:I.AmChart,construct:function(t){I.AmCoordinateChart.base.construct.call(this,t),this.theme=t,this.createEvents("rollOverGraphItem","rollOutGraphItem","clickGraphItem","doubleClickGraphItem","rightClickGraphItem","clickGraph","rollOverGraph","rollOutGraph"),this.startAlpha=1,this.startDuration=0,this.startEffect="elastic",this.sequencedAnimation=!0,this.colors="#FF6600 #FCD202 #B0DE09 #0D8ECF #2A0CD0 #CD0D74 #CC0000 #00CC00 #0000CC #DDDDDD #999999 #333333 #990000".split(" "),this.balloonDateFormat="MMM DD, YYYY",this.valueAxes=[],this.graphs=[],this.guides=[],this.gridAboveGraphs=!1,I.applyTheme(this,t,"AmCoordinateChart")},initChart:function(){I.AmCoordinateChart.base.initChart.call(this),this.drawGraphs=!0;var t=this.categoryAxis;t&&(this.categoryAxis=I.processObject(t,I.CategoryAxis,this.theme)),this.processValueAxes(),this.createValueAxes(),this.processGraphs(),this.processGuides(),I.VML&&(this.startAlpha=1),this.setLegendData(this.graphs),this.gridAboveGraphs&&(this.gridSet.toFront(),this.bulletSet.toFront(),this.balloonsSet.toFront())},createValueAxes:function(){if(0===this.valueAxes.length){var t=new I.ValueAxis;this.addValueAxis(t)}},parseData:function(){this.processValueAxes(),this.processGraphs()},parseSerialData:function(t){if(this.chartData=[],t)if(0<this.processTimeout){this.processCount<1&&(this.processCount=1);var e=t.length/this.processCount;this.parseCount=Math.ceil(e)-1;for(var n=0;n<e;n++)this.delayParseSerialData(t,n)}else this.parseCount=0,this.parsePartSerialData(t,0,t.length,0);else this.onDataUpdated()},delayParseSerialData:function(t,e){var n=this,r=n.processCount;setTimeout(function(){n.parsePartSerialData.call(n,t,e*r,(e+1)*r,e)},n.processTimeout)},parsePartSerialData:function(t,e,n,r){n>t.length&&(n=t.length);var i=this.graphs,o={},a=this.seriesIdField;a=a||this.categoryField;var s,l,u,h,c=!1,d=this.categoryAxis;d&&(c=d.parseDates,l=d.forceShowField,h=d.classNameField,u=d.labelColorField,s=d.categoryFunction);var f,p,g,v={};c&&(p=(f=I.extractPeriod(d.minPeriod)).period,f=f.count,g=I.getPeriodDuration(p,f));var m={};this.lookupTable=m;var y,w=this.dataDateFormat,b={};for(y=e;y<n;y++){var C={},E=t[y];if(e=E[this.categoryField],C.dataContext=E,C.category=s?s(e,E,d):String(e),l&&(C.forceShow=E[l]),h&&(C.className=E[h]),u&&(C.labelColor=E[u]),m[E[a]]=C,!c||(e=d.categoryFunction?d.categoryFunction(e,E,d):(!w||e instanceof Date||(e=e.toString()+" |"),I.getDate(e,w,d.minPeriod)),e=I.resetDateToMin(e,p,f,d.firstDayOfWeek),C.category=e,C.time=e.getTime(),!isNaN(C.time))){var S,O=this.valueAxes;for(C.axes={},C.x={},S=0;S<O.length;S++){var T,N=O[S].id;for(C.axes[N]={},C.axes[N].graphs={},T=0;T<i.length;T++){var R=(e=i[T]).id,_=1.1;isNaN(e.gapPeriod)||(_=e.gapPeriod);var M=e.periodValue;if(e.valueAxis.id==N){C.axes[N].graphs[R]={};var A={};A.index=y;var k=E;if(e.dataProvider&&(k=o),A.values=this.processValues(k,e,M),!e.connect||e.forceGap&&!isNaN(e.gapPeriod))if(b&&b[R]&&0<_&&C.time-v[R]>=g*_&&(b[R].gap=!0),e.forceGap){var x;_=0;for(x in A.values)_++;0<_&&(v[R]=C.time,b[R]=A)}else v[R]=C.time,b[R]=A;this.processFields(e,A,k),A.category=C.category,A.serialDataItem=C,A.graph=e,C.axes[N].graphs[R]=A}}}this.chartData[y]=C}}if(this.parseCount==r){for(t=0;t<i.length;t++)(e=i[t]).dataProvider&&this.parseGraphData(e);this.dataChanged=!1,this.dispatchDataUpdated=!0,this.onDataUpdated()}},processValues:function(t,e,n){var r,i={},o=!1;"candlestick"!=e.type&&"ohlc"!=e.type||""===n||(o=!0);for(var a="value error open close low high".split(" "),s=0;s<a.length;s++){var l=a[s];"value"!=l&&"error"!=l&&o&&(n=l.charAt(0).toUpperCase()+l.slice(1));var u=t[e[l+"Field"]+n];null!==u&&(r=Number(u),isNaN(r)||(i[l]=r),"date"==e.valueAxis.type&&void 0!==u&&(r=I.getDate(u,e.chart.dataDateFormat),i[l]=r.getTime()))}return i},parseGraphData:function(t){var e,n=t.dataProvider,r=t.seriesIdField;for(r=(r=r||this.seriesIdField)||this.categoryField,e=0;e<n.length;e++){var i=n[e],o=this.lookupTable[String(i[r])],a=t.valueAxis.id;o&&((a=o.axes[a].graphs[t.id]).serialDataItem=o,a.values=this.processValues(i,t,t.periodValue),this.processFields(t,a,i))}},addValueAxis:function(t){(t.chart=this).valueAxes.push(t),this.validateData()},removeValueAxesAndGraphs:function(){var t,e=this.valueAxes;for(t=e.length-1;-1<t;t--)this.removeValueAxis(e[t])},removeValueAxis:function(t){var e,n=this.graphs;for(e=n.length-1;0<=e;e--){var r=n[e];r&&r.valueAxis==t&&this.removeGraph(r)}for(e=(n=this.valueAxes).length-1;0<=e;e--)n[e]==t&&n.splice(e,1);this.validateData()},addGraph:function(t){this.graphs.push(t),this.chooseGraphColor(t,this.graphs.length-1),this.validateData()},removeGraph:function(t){var e,n=this.graphs;for(e=n.length-1;0<=e;e--)n[e]==t&&(n.splice(e,1),t.destroy());this.validateData()},handleValueAxisZoom:function(){},processValueAxes:function(){var t,e=this.valueAxes;for(t=0;t<e.length;t++){var n=e[t];n=I.processObject(n,I.ValueAxis,this.theme);(e[t]=n).chart=this,n.init(),this.listenTo(n,"axisIntZoomed",this.handleValueAxisZoom),n.id||(n.id="valueAxisAuto"+t+"_"+(new Date).getTime()),void 0===n.usePrefixes&&(n.usePrefixes=this.usePrefixes)}},processGuides:function(){var t=this.guides,e=this.categoryAxis;if(t)for(var n=0;n<t.length;n++){var r=t[n];void 0===r.category&&void 0===r.date||!e||e.addGuide(r),r.id||(r.id="guideAuto"+n+"_"+(new Date).getTime());var i=r.valueAxis;i?(I.isString(i)&&(i=this.getValueAxisById(i)),i?i.addGuide(r):this.valueAxes[0].addGuide(r)):isNaN(r.value)||this.valueAxes[0].addGuide(r)}},processGraphs:function(){var t,e=this.graphs;for(this.graphsById={},t=0;t<e.length;t++){var n=e[t];n=I.processObject(n,I.AmGraph,this.theme);e[t]=n,this.chooseGraphColor(n,t),n.chart=this,n.init(),I.isString(n.valueAxis)&&(n.valueAxis=this.getValueAxisById(n.valueAxis)),n.valueAxis||(n.valueAxis=this.valueAxes[0]),n.id||(n.id="graphAuto"+t+"_"+(new Date).getTime()),this.graphsById[n.id]=n}},formatString:function(t,e,n){var r=e.graph,i=r.valueAxis;if(i.duration&&i.maxInterval&&e.values.value){var o=i.numberFormatter;o=o||chart.nf,i=I.formatDuration(e.values.value,i.duration,"",i.durationUnits,i.maxInterval,o),t=t.split("[[value]]").join(i)}return t=I.massReplace(t,{"[[title]]":r.title,"[[description]]":e.description}),t=n?I.fixNewLines(t):I.fixBrakes(t),I.cleanFromEmpty(t)},getBalloonColor:function(t,e,n){var r=t.lineColor,i=t.balloonColor;return n&&(i=r),"object"==typeof(n=t.fillColorsR)?r=n[0]:void 0!==n&&(r=n),e.isNegative&&(n=t.negativeLineColor,"object"==typeof(t=t.negativeFillColors)?n=t[0]:void 0!==t&&(n=t),void 0!==n&&(r=n)),void 0!==e.color&&(r=e.color),void 0!==e.lineColor&&(r=e.lineColor),void 0!==(e=e.fillColors)&&(r=e,I.ifArray(e)&&(r=e[0])),void 0===i&&(i=r),i},getGraphById:function(t){return I.getObjById(this.graphs,t)},getValueAxisById:function(t){return I.getObjById(this.valueAxes,t)},processFields:function(t,e,n){if(t.itemColors){var r=t.itemColors,i=e.index;e.color=i<r.length?r[i]:I.randomColor()}for(r="lineColor color alpha fillColors description bullet customBullet bulletSize bulletConfig url labelColor dashLength pattern gap className columnIndex".split(" "),i=0;i<r.length;i++){var o=r[i],a=t[o+"Field"];a&&(a=n[a],I.isDefined(a)&&(e[o]=a))}e.dataContext=n},chooseGraphColor:function(t,e){var n;t.lineColor?t.lineColorR=t.lineColor:(n=this.colors.length>e?this.colors[e]:t.lineColorR?t.lineColorR:I.randomColor(),t.lineColorR=n);t.fillColorsR=t.fillColors?t.fillColors:t.lineColorR,t.bulletBorderColorR=t.bulletBorderColor?t.bulletBorderColor:t.useLineColorForBulletBorder?t.lineColorR:t.bulletColor,t.bulletColorR=t.bulletColor?t.bulletColor:t.lineColorR,(n=this.patterns)&&(t.pattern=n[e])},handleLegendEvent:function(t){var e=t.type;if(t=t.dataItem){var n=t.hidden,r=t.showBalloon;switch(e){case"clickMarker":this.textClickEnabled&&(r?this.hideGraphsBalloon(t):this.showGraphsBalloon(t));break;case"clickLabel":r?this.hideGraphsBalloon(t):this.showGraphsBalloon(t);break;case"rollOverItem":n||this.highlightGraph(t);break;case"rollOutItem":n||this.unhighlightGraph();break;case"hideItem":this.hideGraph(t);break;case"showItem":this.showGraph(t)}}},highlightGraph:function(t){var e=this.graphs;if(e){var n,r=.2;if(this.legend&&(r=this.legend.rollOverGraphAlpha),1!=r)for(n=0;n<e.length;n++){var i=e[n];i!=t&&i.changeOpacity(r)}}},unhighlightGraph:function(){var t,e;if(this.legend&&(t=this.legend.rollOverGraphAlpha),1!=t)for(t=this.graphs,e=0;e<t.length;e++)t[e].changeOpacity(1)},showGraph:function(t){t.switchable&&(t.hidden=!1,this.dataChanged=!0,"xy"!=this.type&&(this.marginsUpdated=!1),this.chartCreated&&this.initChart())},hideGraph:function(t){t.switchable&&(this.dataChanged=!0,"xy"!=this.type&&(this.marginsUpdated=!1),t.hidden=!0,this.chartCreated&&this.initChart())},hideGraphsBalloon:function(t){t.showBalloon=!1,this.updateLegend()},showGraphsBalloon:function(t){t.showBalloon=!0,this.updateLegend()},updateLegend:function(){this.legend&&this.legend.invalidateSize()},resetAnimation:function(){this.animatable=[];var t,e=this.graphs;if(e)for(t=0;t<e.length;t++)e[t].animationPlayed=!1},animateAgain:function(){this.resetAnimation(),this.validateNow()}})}(),function(){var b=window.AmCharts;b.TrendLine=b.Class({construct:function(t){this.cname="TrendLine",this.createEvents("click","rollOver","rollOut"),this.isProtected=!1,this.dashLength=0,this.lineColor="#00CC00",this.lineThickness=this.lineAlpha=1,b.applyTheme(this,t,this.cname)},draw:function(){var t=this;t.destroy();var e,n,r,i,o=t.chart,a=o.container,s=t.categoryAxis,l=t.initialDate,u=t.initialCategory,h=t.finalDate,c=t.finalCategory,d=t.valueAxis,f=t.valueAxisX,p=t.initialXValue,g=t.finalXValue,v=t.initialValue,m=t.finalValue,y=d.recalculateToPercents,w=o.dataDateFormat;s&&(l&&(l=b.getDate(l,w,"fff"),t.initialDate=l,e=s.dateToCoordinate(l)),u&&(e=s.categoryToCoordinate(u)),h&&(h=b.getDate(h,w,"fff"),t.finalDate=h,n=s.dateToCoordinate(h)),c&&(n=s.categoryToCoordinate(c))),f&&!y&&(isNaN(p)||(e=f.getCoordinate(p)),isNaN(g)||(n=f.getCoordinate(g))),d&&!y&&(isNaN(v)||(r=d.getCoordinate(v)),isNaN(m)||(i=d.getCoordinate(m))),isNaN(e)||isNaN(n)||isNaN(r)||isNaN(r)||(i=o.rotate?(s=[r,i],[e,n]):(s=[e,n],[r,i]),r=b.line(a,s,i,t.lineColor,t.lineAlpha,t.lineThickness,t.dashLength),n=i,0===(h=(e=s)[1]-s[0])&&(h=.01),0===(c=i[1]-i[0])&&(c=.01),l=h/Math.abs(h),u=c/Math.abs(c),c=90*Math.PI/180-Math.asin(h/(h*c/Math.abs(h*c)*Math.sqrt(Math.pow(h,2)+Math.pow(c,2)))),h=Math.abs(5*Math.cos(c)),c=Math.abs(5*Math.sin(c)),e.push(s[1]-l*c,s[0]-l*c),n.push(i[1]+u*h,i[0]+u*h),i=b.polygon(a,e,n,"#ffffff",.005,0),(a=a.set([i,r])).translate(o.marginLeftReal,o.marginTopReal),o.trendLinesSet.push(a),b.setCN(o,r,"trend-line"),b.setCN(o,r,"trend-line-"+t.id),t.line=r,t.set=a,(r=t.initialImage)&&((r=b.processObject(r,b.Image,t.theme)).chart=o,r.draw(),r.translate(e[0]+r.offsetX,n[0]+r.offsetY),a.push(r.set)),(r=t.finalImage)&&((r=b.processObject(r,b.Image,t.theme)).chart=o,r.draw(),r.translate(e[1]+r.offsetX,n[1]+r.offsetY),a.push(r.set)),a.mouseup(function(){t.handleLineClick()}).mouseover(function(){t.handleLineOver()}).mouseout(function(){t.handleLineOut()}),a.touchend&&a.touchend(function(){t.handleLineClick()}),a.clipRect(0,0,o.plotAreaWidth,o.plotAreaHeight))},handleLineClick:function(){this.fire({type:"click",trendLine:this,chart:this.chart})},handleLineOver:function(){var t=this.rollOverColor;void 0!==t&&this.line.attr({stroke:t}),this.balloonText&&(clearTimeout(this.chart.hoverInt),t=this.line.getBBox(),this.chart.showBalloon(this.balloonText,this.lineColor,!0,this.x+t.x+t.width/2,this.y+t.y+t.height/2)),this.fire({type:"rollOver",trendLine:this,chart:this.chart})},handleLineOut:function(){this.line.attr({stroke:this.lineColor}),this.balloonText&&this.chart.hideBalloon(),this.fire({type:"rollOut",trendLine:this,chart:this.chart})},destroy:function(){b.remove(this.set)}})}(),function(){var e=window.AmCharts;e.Image=e.Class({construct:function(t){this.cname="Image",this.height=this.width=20,this.rotation=this.offsetY=this.offsetX=0,this.balloonColor=this.color="#000000",this.opacity=1,e.applyTheme(this,t,this.cname)},draw:function(){var t=this;t.set&&t.set.remove();var e,n,r=t.chart.container;t.set=r.set(),t.url?(e=r.image(t.url,0,0,t.width,t.height),n=1):t.svgPath&&((e=r.path(t.svgPath)).setAttr("fill",t.color),e.setAttr("stroke",t.outlineColor),r=e.getBBox(),n=Math.min(t.width/r.width,t.height/r.height)),e&&(e.setAttr("opacity",t.opacity),t.set.rotate(t.rotation),e.translate(-t.width/2,-t.height/2,n),t.balloonText&&e.mouseover(function(){t.chart.showBalloon(t.balloonText,t.balloonColor,!0)}).mouseout(function(){t.chart.hideBalloon()}).touchend(function(){t.chart.hideBalloon()}).touchstart(function(){t.chart.showBalloon(t.balloonText,t.balloonColor,!0)}),t.set.push(e))},translate:function(t,e){this.set&&this.set.translate(t,e)}})}(),function(){var x=window.AmCharts;x.circle=function(t,e,n,r,i,o,a,s,l){return e<=0&&(e=.001),null!=i&&0!==i||(i=.01),void 0===o&&(o="#000000"),void 0===a&&(a=0),r={fill:n,stroke:o,"fill-opacity":r,"stroke-width":i,"stroke-opacity":a},t=isNaN(l)?t.circle(0,0,e).attr(r):t.ellipse(0,0,e,l).attr(r),s&&t.gradient("radialGradient",[n,x.adjustLuminosity(n,-.6)]),t},x.text=function(t,e,n,r,i,o,a,s){return"right"==(o=o||"middle")&&(o="end"),"left"==o&&(o="start"),isNaN(s)&&(s=1),void 0!==e&&(e=String(e),x.isIE&&!x.isModern&&(e=(e=e.replace("&amp;","&")).replace("&","&amp;"))),n={fill:n,"font-family":r,"font-size":i+"px",opacity:s},!0===a&&(n["font-weight"]="bold"),n["text-anchor"]=o,t.text(e,n)},x.polygon=function(t,e,n,r,i,o,a,s,l,u,h){isNaN(o)&&(o=.01),isNaN(s)&&(s=i);var c=r,d=!1;for("object"==typeof c&&1<c.length&&(d=!0,c=c[0]),void 0===a&&(a=c),i={fill:c,stroke:a,"fill-opacity":i,"stroke-width":o,"stroke-opacity":s},void 0!==h&&0<h&&(i["stroke-dasharray"]=h),h=x.dx,o=x.dy,t.handDrawn&&(e=(n=x.makeHD(e,n,t.handDrawScatter))[0],n=n[1]),a=Math.round,u&&(a=Number),s="M"+(a(e[0])+h)+","+(a(n[0])+o),c=1;c<e.length;c++)u&&(e[c]=x.roundTo(e[c],5),n[c]=x.roundTo(n[c],5)),s+=" L"+(a(e[c])+h)+","+(a(n[c])+o);return t=t.path(s+" Z").attr(i),d&&t.gradient("linearGradient",r,l),t},x.rect=function(t,e,n,r,i,o,a,s,l,u,h){if(isNaN(e)||isNaN(n))return t.set();isNaN(o)&&(o=0),void 0===l&&(l=0),void 0===u&&(u=270),isNaN(i)&&(i=0);var c=r,d=!1;"object"==typeof c&&(c=c[0],d=!0),void 0===a&&(a=c),void 0===s&&(s=i),e=Math.round(e),n=Math.round(n);var f=0,p=0;return e<0&&(f=-(e=Math.abs(e))),n<0&&(p=-(n=Math.abs(n))),f+=x.dx,p+=x.dy,i={fill:c,stroke:a,"fill-opacity":i,"stroke-opacity":s},void 0!==h&&0<h&&(i["stroke-dasharray"]=h),t=t.rect(f,p,e,n,l,o).attr(i),d&&t.gradient("linearGradient",r,u),t},x.bullet=function(t,e,n,r,i,o,a,s,l,u,h,c,d){var f;switch("circle"==e&&(e="round"),e){case"round":f=x.circle(t,n/2,r,i,o,a,s);break;case"square":f=x.polygon(t,[-n/2,n/2,n/2,-n/2],[n/2,n/2,-n/2,-n/2],r,i,o,a,s,u-180,void 0,d);break;case"rectangle":f=x.polygon(t,[-n,n,n,-n],[n/2,n/2,-n/2,-n/2],r,i,o,a,s,u-180,void 0,d);break;case"diamond":f=x.polygon(t,[-n/2,0,n/2,0],[0,-n/2,0,n/2],r,i,o,a,s);break;case"triangleUp":f=x.triangle(t,n,0,r,i,o,a,s);break;case"triangleDown":f=x.triangle(t,n,180,r,i,o,a,s);break;case"triangleLeft":f=x.triangle(t,n,270,r,i,o,a,s);break;case"triangleRight":f=x.triangle(t,n,90,r,i,o,a,s);break;case"bubble":f=x.circle(t,n/2,r,i,o,a,s,!0);break;case"line":f=x.line(t,[-n/2,n/2],[0,0],r,i,o,a,s);break;case"yError":(f=t.set()).push(x.line(t,[0,0],[-n/2,n/2],r,i,o)),f.push(x.line(t,[-l,l],[-n/2,-n/2],r,i,o)),f.push(x.line(t,[-l,l],[n/2,n/2],r,i,o));break;case"xError":(f=t.set()).push(x.line(t,[-n/2,n/2],[0,0],r,i,o)),f.push(x.line(t,[-n/2,-n/2],[-l,l],r,i,o)),f.push(x.line(t,[n/2,n/2],[-l,l],r,i,o))}return f&&f.pattern(h,NaN,c),f},x.triangle=function(t,e,n,r,i,o,a,s){var l;return void 0!==o&&0!==o||(o=1),void 0===a&&(a="#000"),void 0===s&&(s=0),r={fill:r,stroke:a,"fill-opacity":i,"stroke-width":o,"stroke-opacity":s},e/=2,0===n&&(l=" M"+-e+","+e+" L0,"+-e+" L"+e+","+e+" Z"),180==n&&(l=" M"+-e+","+-e+" L0,"+e+" L"+e+","+-e+" Z"),90==n&&(l=" M"+-e+","+-e+" L"+e+",0 L"+-e+","+e+" Z"),270==n&&(l=" M"+-e+",0 L"+e+","+e+" L"+e+","+-e+" Z"),t.path(l).attr(r)},x.line=function(t,e,n,r,i,o,a,s,l,u,h){if(t.handDrawn&&!h)return x.handDrawnLine(t,e,n,r,i,o,a,s,l,u,h);for(o={fill:"none","stroke-width":o},void 0!==a&&0<a&&(o["stroke-dasharray"]=a),isNaN(i)||(o["stroke-opacity"]=i),r&&(o.stroke=r),r=Math.round,u&&(r=Number,e[0]=x.roundTo(e[0],5),n[0]=x.roundTo(n[0],5)),u=x.dx,i=x.dy,a="M"+(r(e[0])+u)+","+(r(n[0])+i),s=1;s<e.length;s++)e[s]=x.roundTo(e[s],5),n[s]=x.roundTo(n[s],5),a+=" L"+(r(e[s])+u)+","+(r(n[s])+i);return x.VML?t.path(a,void 0,!0).attr(o):(l&&(a+=" M0,0 L0,0"),t.path(a).attr(o))},x.makeHD=function(t,e,n){for(var r=[],i=[],o=1;o<t.length;o++)for(var a=Number(t[o-1]),s=Number(e[o-1]),l=Number(t[o]),u=Number(e[o]),h=Math.round(Math.sqrt(Math.pow(l-a,2)+Math.pow(u-s,2))/50)+1,c=(l=(l-a)/h,u=(u-s)/h,0);c<=h;c++){var d=s+c*u+Math.random()*n;r.push(a+c*l+Math.random()*n),i.push(d)}return[r,i]},x.handDrawnLine=function(t,e,n,r,i,o,a,s,l,u){var h,c=t.set();for(h=1;h<e.length;h++)for(var d=[e[h-1],e[h]],f=[n[h-1],n[h]],p=(d=(f=x.makeHD(d,f,t.handDrawScatter))[0],f=f[1],1);p<d.length;p++)c.push(x.line(t,[d[p-1],d[p]],[f[p-1],f[p]],r,i,o+Math.random()*t.handDrawThickness-t.handDrawThickness/2,a,s,l,u,!0));return c},x.doNothing=function(t){return t},x.drop=function(t,e,n,r,i,o,a,s){var l=1/180*Math.PI,u=n-20,h=Math.sin(u*l)*e,c=Math.cos(u*l)*e,d=.8*e,f=-e/3,p=e/3;return 0===n&&(f=-f,p=0),180==n&&(p=0),90==n&&(f=0),270==n&&(f=0,p=-p),n={fill:r,stroke:a,"stroke-width":o,"stroke-opacity":s,"fill-opacity":i},e="M"+h+","+c+" A"+e+","+e+",0,1,1,"+Math.sin((40+u)*l)*e+","+Math.cos((40+u)*l)*e+" A"+d+","+d+",0,0,0,"+(Math.sin((20+u)*l)*e+p)+","+(Math.cos((20+u)*l)*e+f),e+=" A"+d+","+d+",0,0,0,"+h+","+c,t.path(e,void 0,void 0,"1000,1000").attr(n)},x.wedge=function(t,e,n,r,i,o,a,s,l,u,h,c,d,f){var p=Math.round;o=p(o);var g=p((a=p(a))/o*(s=p(s))),v=x.VML;359.94<(b=359.5+o/100)&&(b=359.94),b<=i&&(i=b);var m,y,w=1/180*Math.PI,b=e+Math.sin(r*w)*s,C=n-Math.cos(r*w)*g,E=e+Math.sin(r*w)*o,S=n-Math.cos(r*w)*a,O=e+Math.sin((r+i)*w)*o,T=n-Math.cos((r+i)*w)*a,N=e+Math.sin((r+i)*w)*s,R=(w=n-Math.cos((r+i)*w)*g,{fill:x.adjustLuminosity(u.fill,-.2),"stroke-opacity":0,"fill-opacity":u["fill-opacity"]}),_=0;if(180<Math.abs(i)&&(_=1),r=t.set(),v&&(b=p(10*b),E=p(10*E),O=p(10*O),N=p(10*N),C=p(10*C),S=p(10*S),T=p(10*T),w=p(10*w),e=p(10*e),l=p(10*l),n=p(10*n),o*=10,a*=10,s*=10,g*=10,Math.abs(i)<1&&Math.abs(O-E)<=1&&Math.abs(T-S)<=1&&(m=!0)),i="",c&&(R["fill-opacity"]=0,R["stroke-opacity"]=u["stroke-opacity"]/2,R.stroke=u.stroke),0<l){y=" M"+b+","+(C+l)+" L"+E+","+(S+l),v?(m||(y+=" A"+(e-o)+","+(l+n-a)+","+(e+o)+","+(l+n+a)+","+E+","+(S+l)+","+O+","+(T+l)),y+=" L"+N+","+(w+l),0<s&&(m||(y+=" B"+(e-s)+","+(l+n-g)+","+(e+s)+","+(l+n+g)+","+N+","+(l+w)+","+b+","+(l+C)))):(y+=" A"+o+","+a+",0,"+_+",1,"+O+","+(T+l)+" L"+N+","+(w+l),0<s&&(y+=" A"+s+","+g+",0,"+_+",0,"+b+","+(C+l))),y+=" Z";var M=l;v&&(M/=10);for(var A=0;A<M;A+=10){var k=t.path(y,void 0,void 0,"1000,1000").attr(R);r.push(k),k.translate(0,-A)}y=t.path(" M"+b+","+C+" L"+b+","+(C+l)+" L"+E+","+(S+l)+" L"+E+","+S+" L"+b+","+C+" Z",void 0,void 0,"1000,1000").attr(R),l=t.path(" M"+O+","+T+" L"+O+","+(T+l)+" L"+N+","+(w+l)+" L"+N+","+w+" L"+O+","+T+" Z",void 0,void 0,"1000,1000").attr(R),r.push(y),r.push(l)}if(a=v?(m||(i=" A"+p(e-o)+","+p(n-a)+","+p(e+o)+","+p(n+a)+","+p(E)+","+p(S)+","+p(O)+","+p(T))," M"+p(b)+","+p(C)+" L"+p(E)+","+p(S)+i+" L"+p(N)+","+p(w)):" M"+b+","+C+" L"+E+","+S+" A"+o+","+a+",0,"+_+",1,"+O+","+T+" L"+N+","+w,0<s&&(v?m||(a+=" B"+(e-s)+","+(n-g)+","+(e+s)+","+(n+g)+","+N+","+w+","+b+","+C):a+=" A"+s+","+g+",0,"+_+",0,"+b+","+C),t.handDrawn&&(s=x.line(t,[b,E],[C,S],u.stroke,u.thickness*Math.random()*t.handDrawThickness,u["stroke-opacity"]),r.push(s)),t=t.path(a+" Z",void 0,void 0,"1000,1000").attr(u),h){for(s=[],g=0;g<h.length;g++)s.push(x.adjustLuminosity(u.fill,h[g]));"radial"!=f||x.isModern||(s=[]),0<s.length&&t.gradient(f+"Gradient",s)}return x.isModern&&"radial"==f&&t.grad&&(t.grad.setAttribute("gradientUnits","userSpaceOnUse"),t.grad.setAttribute("r",o),t.grad.setAttribute("cx",e),t.grad.setAttribute("cy",n)),t.pattern(c,NaN,d),r.wedge=t,r.push(t),r},x.rgb2hex=function(t){return(t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===t.length?"#"+("0"+parseInt(t[1],10).toString(16)).slice(-2)+("0"+parseInt(t[2],10).toString(16)).slice(-2)+("0"+parseInt(t[3],10).toString(16)).slice(-2):""},x.adjustLuminosity=function(t,e){t&&-1!=t.indexOf("rgb")&&(t=x.rgb2hex(t)),(t=String(t).replace(/[^0-9a-f]/gi,"")).length<6&&(t=String(t[0])+String(t[0])+String(t[1])+String(t[1])+String(t[2])+String(t[2])),e=e||0;var n,r,i="#";for(r=0;r<3;r++)n=parseInt(t.substr(2*r,2),16),i+=("00"+(n=Math.round(Math.min(Math.max(0,n+n*e),255)).toString(16))).substr(n.length);return i}}(),function(){var v=window.AmCharts;v.Bezier=v.Class({construct:function(t,e,n,r,i,o,a,s,l,u,h){var c,d,f=t.chart,p=v.bezierX,g=v.bezierY;for(isNaN(f.bezierX)||(p=f.bezierX),isNaN(f.bezierY)||(g=f.bezierY),isNaN(p)&&(f.rotate?(p=20,g=4):(g=20,p=4)),"object"==typeof a&&1<a.length&&(d=!0,a=(c=a)[0]),"object"==typeof s&&(s=s[0]),0===s&&(a="none"),o={fill:a,"fill-opacity":s,"stroke-width":o},void 0!==l&&0<l&&(o["stroke-dasharray"]=l),isNaN(i)||(o["stroke-opacity"]=i),r&&(o.stroke=r),r="M"+Math.round(e[0])+","+Math.round(n[0])+" ",i=[],l=0;l<e.length;l++)isNaN(e[l])||isNaN(n[l])?(r+=this.drawSegment(i,p,g),l<e.length-1&&(r+="L"+e[l+1]+","+n[l+1]+" "),i=[]):i.push({x:Number(e[l]),y:Number(n[l])});r+=this.drawSegment(i,p,g),u&&(r+=u),this.path=t.path(r).attr(o),this.node=this.path.node,d&&this.path.gradient("linearGradient",c,h)},drawSegment:function(t,e,n){var r="";if(2<t.length)for(var i=0;i<t.length-1;i++){var o=[],a=t[i-1],s=t[i],l=t[i+1],u=t[i+2];0===i?(o.push({x:s.x,y:s.y}),o.push({x:s.x,y:s.y}),o.push({x:l.x,y:l.y}),o.push({x:u.x,y:u.y})):i>=t.length-2?(o.push({x:a.x,y:a.y}),o.push({x:s.x,y:s.y}),o.push({x:l.x,y:l.y}),o.push({x:l.x,y:l.y})):(o.push({x:a.x,y:a.y}),o.push({x:s.x,y:s.y}),o.push({x:l.x,y:l.y}),o.push({x:u.x,y:u.y})),a=[],s=Math.round,a.push({x:s(o[1].x),y:s(o[1].y)}),a.push({x:s((-o[0].x+e*o[1].x+o[2].x)/e),y:s((-o[0].y+n*o[1].y+o[2].y)/n)}),a.push({x:s((o[1].x+e*o[2].x-o[3].x)/e),y:s((o[1].y+n*o[2].y-o[3].y)/n)}),a.push({x:s(o[2].x),y:s(o[2].y)}),r+="C"+a[1].x+","+a[1].y+","+a[2].x+","+a[2].y+","+a[3].x+","+a[3].y+" "}else 1<t.length&&(r+="L"+t[1].x+","+t[1].y);return r}})}(),function(){var l=window.AmCharts;l.AmDraw=l.Class({construct:function(t,e,n,r){l.SVG_NS="http://www.w3.org/2000/svg",l.SVG_XLINK="http://www.w3.org/1999/xlink",l.hasSVG=!!document.createElementNS&&!!document.createElementNS(l.SVG_NS,"svg").createSVGRect,e<1&&(e=10),n<1&&(n=10),this.div=t,this.width=e,this.height=n,this.rBin=document.createElement("div"),l.hasSVG?(l.SVG=!0,e=this.createSvgElement("svg"),t.appendChild(e),this.container=e,this.addDefs(r),this.R=new l.SVGRenderer(this)):l.isIE&&l.VMLRenderer&&(l.VML=!0,l.vmlStyleSheet||(document.namespaces.add("amvml","urn:schemas-microsoft-com:vml"),document.styleSheets.length<31?((e=document.createStyleSheet()).addRule(".amvml","behavior:url(#default#VML); display:inline-block; antialias:true"),l.vmlStyleSheet=e):document.styleSheets[0].addRule(".amvml","behavior:url(#default#VML); display:inline-block; antialias:true")),this.container=t,this.R=new l.VMLRenderer(this,r),this.R.disableSelection(t))},createSvgElement:function(t){return document.createElementNS(l.SVG_NS,t)},circle:function(t,e,n,r){var i=new l.AmDObject("circle",this);return i.attr({r:n,cx:t,cy:e}),this.addToContainer(i.node,r),i},ellipse:function(t,e,n,r,i){var o=new l.AmDObject("ellipse",this);return o.attr({rx:n,ry:r,cx:t,cy:e}),this.addToContainer(o.node,i),o},setSize:function(t,e){0<t&&0<e&&(this.container.style.width=t+"px",this.container.style.height=e+"px")},rect:function(t,e,n,r,i,o,a){var s=new l.AmDObject("rect",this);return l.VML&&(i=Math.round(100*i/Math.min(n,r)),n+=2*o,r+=2*o,s.bw=o,s.node.style.marginLeft=-o,s.node.style.marginTop=-o),n<1&&(n=1),r<1&&(r=1),s.attr({x:t,y:e,width:n,height:r,rx:i,ry:i,"stroke-width":o}),this.addToContainer(s.node,a),s},image:function(t,e,n,r,i,o){var a=new l.AmDObject("image",this);return a.attr({x:e,y:n,width:r,height:i}),this.R.path(a,t),this.addToContainer(a.node,o),a},addToContainer:function(t,e){(e=e||this.container).appendChild(t)},text:function(t,e,n){return this.R.text(t,e,n)},path:function(t,e,n,r){var i=new l.AmDObject("path",this);return r=r||"100,100",i.attr({cs:r}),n?i.attr({dd:t}):i.attr({d:t}),this.addToContainer(i.node,e),i},set:function(t){return this.R.set(t)},remove:function(t){if(t){var e=this.rBin;e.appendChild(t),e.innerHTML=""}},renderFix:function(){var t=this.container,e=t.style;e.top="0px",e.left="0px";try{var n=t.getBoundingClientRect(),r=n.left-Math.round(n.left),i=n.top-Math.round(n.top);r&&(e.left=r+"px"),i&&(e.top=i+"px")}catch(t){}},update:function(){this.R.update()},addDefs:function(t){if(l.hasSVG){var e=this.createSvgElement("desc"),n=this.container;if(n.setAttribute("version","1.1"),n.style.position="absolute",this.setSize(this.width,this.height),t.accessibleTitle){var r=this.createSvgElement("text");n.appendChild(r),r.innerHTML=t.accessibleTitle,r.style.opacity=0}l.rtl&&(n.setAttribute("direction","rtl"),n.style.left="auto",n.style.right="0px"),t&&(t.addCodeCredits&&e.appendChild(document.createTextNode("JavaScript chart by amCharts "+t.version)),t.accessibleDescription&&(e.innerHTML="",e.appendChild(document.createTextNode(t.accessibleDescription))),n.appendChild(e),t.defs&&(e=this.createSvgElement("defs"),n.appendChild(e),l.parseDefs(t.defs,e),this.defs=e))}}})}(),function(){var a=window.AmCharts;a.AmDObject=a.Class({construct:function(t,e){this.D=e,this.R=e.R,this.node=this.R.create(this,t),this.y=this.x=0,this.scale=1},attr:function(t){return this.R.attr(this,t),this},getAttr:function(t){return this.node.getAttribute(t)},setAttr:function(t,e){return this.R.setAttr(this,t,e),this},clipRect:function(t,e,n,r){this.R.clipRect(this,t,e,n,r)},translate:function(t,e,n,r){r||(t=Math.round(t),e=Math.round(e)),this.R.move(this,t,e,n),this.x=t,this.y=e,this.scale=n,this.angle&&this.rotate(this.angle)},rotate:function(t,e){this.R.rotate(this,t,e),this.angle=t},animate:function(t,e,n){for(var r in t)if(t.hasOwnProperty(r)){var i=r,o=t[r];n=a.getEffect(n),this.R.animate(this,i,o,e,n)}},push:function(t){if(t){var e=this.node;e.appendChild(t.node);var n=t.clipPath;n&&e.appendChild(n),(t=t.grad)&&e.appendChild(t)}},text:function(t){this.R.setText(this,t)},remove:function(){this.stop(),this.R.remove(this)},clear:function(){var t=this.node;if(t.hasChildNodes())for(;1<=t.childNodes.length;)t.removeChild(t.firstChild)},hide:function(){this.setAttr("visibility","hidden")},show:function(){this.setAttr("visibility","visible")},getBBox:function(){return this.R.getBBox(this)},toFront:function(){var t=this.node;if(t){this.prevNextNode=t.nextSibling;var e=t.parentNode;e&&e.appendChild(t)}},toPrevious:function(){var t=this.node;t&&this.prevNextNode&&(t=t.parentNode)&&t.insertBefore(this.prevNextNode,null)},toBack:function(){var t=this.node;if(t){this.prevNextNode=t.nextSibling;var e=t.parentNode;if(e){var n=e.firstChild;n&&e.insertBefore(t,n)}}},mouseover:function(t){return this.R.addListener(this,"mouseover",t),this},mouseout:function(t){return this.R.addListener(this,"mouseout",t),this},click:function(t){return this.R.addListener(this,"click",t),this},dblclick:function(t){return this.R.addListener(this,"dblclick",t),this},mousedown:function(t){return this.R.addListener(this,"mousedown",t),this},mouseup:function(t){return this.R.addListener(this,"mouseup",t),this},touchmove:function(t){return this.R.addListener(this,"touchmove",t),this},touchstart:function(t){return this.R.addListener(this,"touchstart",t),this},touchend:function(t){return this.R.addListener(this,"touchend",t),this},keyup:function(t){return this.R.addListener(this,"keyup",t),this},focus:function(t){return this.R.addListener(this,"focus",t),this},blur:function(t){return this.R.addListener(this,"blur",t),this},contextmenu:function(t){return this.node.addEventListener?this.node.addEventListener("contextmenu",t,!0):this.R.addListener(this,"contextmenu",t),this},stop:function(){a.removeFromArray(this.R.animations,this.an_translate),a.removeFromArray(this.R.animations,this.an_y),a.removeFromArray(this.R.animations,this.an_x)},length:function(){return this.node.childNodes.length},gradient:function(t,e,n){this.R.gradient(this,t,e,n)},pattern:function(t,e,n){t&&this.R.pattern(this,t,e,n)}})}(),function(){var u=window.AmCharts;u.VMLRenderer=u.Class({construct:function(t,e){this.chart=e,this.D=t,this.cNames={circle:"oval",ellipse:"oval",rect:"roundrect",path:"shape"},this.styleMap={x:"left",y:"top",width:"width",height:"height","font-family":"fontFamily","font-size":"fontSize",visibility:"visibility"}},create:function(t,e){var n;if("group"==e)n=document.createElement("div"),t.type="div";else if("text"==e)n=document.createElement("div"),t.type="text";else if("image"==e)n=document.createElement("img"),t.type="image";else{t.type="shape",t.shapeType=this.cNames[e],n=document.createElement("amvml:"+this.cNames[e]);var r=document.createElement("amvml:stroke");n.appendChild(r),t.stroke=r;var i=document.createElement("amvml:fill");n.appendChild(i),(t.fill=i).className="amvml",r.className="amvml",n.className="amvml"}return n.style.position="absolute",n.style.top=0,n.style.left=0,n},path:function(t,e){t.node.setAttribute("src",e)},setAttr:function(t,e,n){if(void 0!==n){var r;8===document.documentMode&&(r=!0);var i=t.node,o=t.type,a=i.style;"r"==e&&(a.width=2*n,a.height=2*n),"oval"==t.shapeType&&("rx"==e&&(a.width=2*n),"ry"==e&&(a.height=2*n)),"roundrect"==t.shapeType&&("width"!=e&&"height"!=e||--n),"cursor"==e&&(a.cursor=n),"cx"==e&&(a.left=n-u.removePx(a.width)/2),"cy"==e&&(a.top=n-u.removePx(a.height)/2);var s=this.styleMap[e];if("width"==s&&n<0&&(n=0),void 0!==s&&(a[s]=n),"text"==o&&("text-anchor"==e&&(t.anchor=n,s=i.clientWidth,"end"==n&&(a.marginLeft=-s+"px"),"middle"==n&&(a.marginLeft=-s/2+"px",a.textAlign="center"),"start"==n&&(a.marginLeft="0px")),"fill"==e&&(a.color=n),"font-weight"==e&&(a.fontWeight=n)),a=t.children)for(s=0;s<a.length;s++)a[s].setAttr(e,n);"shape"==o&&("cs"==e&&(i.style.width="100px",i.style.height="100px",i.setAttribute("coordsize",n)),"d"==e&&i.setAttribute("path",this.svgPathToVml(n)),"dd"==e&&i.setAttribute("path",n),o=t.stroke,t=t.fill,"stroke"==e&&(r?o.color=n:o.setAttribute("color",n)),"stroke-width"==e&&(r?o.weight=n:o.setAttribute("weight",n)),"stroke-opacity"==e&&(r?o.opacity=n:o.setAttribute("opacity",n)),"stroke-dasharray"==e&&(a="solid",0<n&&n<3&&(a="dot"),3<=n&&n<=6&&(a="dash"),6<n&&(a="longdash"),r?o.dashstyle=a:o.setAttribute("dashstyle",a)),"fill-opacity"!=e&&"opacity"!=e||(0===n?r?t.on=!1:t.setAttribute("on",!1):r?t.opacity=n:t.setAttribute("opacity",n)),"fill"==e&&(r?t.color=n:t.setAttribute("color",n)),"rx"==e&&(r?i.arcSize=n+"%":i.setAttribute("arcsize",n+"%")))}},attr:function(t,e){for(var n in e)e.hasOwnProperty(n)&&this.setAttr(t,n,e[n])},text:function(t,e,n){var r=new u.AmDObject("text",this.D),i=r.node;return i.style.whiteSpace="pre",i.innerHTML=t,this.D.addToContainer(i,n),this.attr(r,e),r},getBBox:function(t){return this.getBox(t.node)},getBox:function(t){var e,n=t.offsetLeft,r=t.offsetTop,i=t.offsetWidth,o=t.offsetHeight;if(t.hasChildNodes()){var a,s,l;for(l=0;l<t.childNodes.length;l++){var u=(e=this.getBox(t.childNodes[l])).x;isNaN(u)||(isNaN(a)?a=u:u<a&&(a=u));var h=e.y;isNaN(h)||(isNaN(s)?s=h:h<s&&(s=h)),u=e.width+u,isNaN(u)||(i=Math.max(i,u)),e=e.height+h,isNaN(e)||(o=Math.max(o,e))}a<0&&(n+=a),s<0&&(r+=s)}return{x:n,y:r,width:i,height:o}},setText:function(t,e){var n=t.node;n&&(n.innerHTML=e),this.setAttr(t,"text-anchor",t.anchor)},addListener:function(t,e,n){t.node["on"+e]=n},move:function(t,e,n){var r=t.node,i=r.style;"text"==t.type&&(n-=u.removePx(i.fontSize)/2-1),"oval"==t.shapeType&&(e-=u.removePx(i.width)/2,n-=u.removePx(i.height)/2),t=t.bw,isNaN(t)||(e-=t,n-=t),isNaN(e)||isNaN(n)||(r.style.left=e+"px",r.style.top=n+"px")},svgPathToVml:function(t){var e=t.split(" ");t="";var n,r,i=Math.round;for(r=0;r<e.length;r++){var o,a=(o=e[r]).substring(0,1),s=(o=o.substring(1)).split(","),l=i(s[0])+","+i(s[1]);if("M"==a&&(t+=" m "+l),"L"==a&&(t+=" l "+l),"Z"==a&&(t+=" x e"),"Q"==a){var u=n.length,h=n[u-1],c=s[0],d=s[1],f=(l=s[2],s[3]);t+=" c "+(n=i(n[u-2]/3+2/3*c))+","+(h=i(h/3+2/3*d))+","+(c=i(2/3*c+l/3))+","+(d=i(2/3*d+f/3))+","+l+","+f}"C"==a&&(t+=" c "+s[0]+","+s[1]+","+s[2]+","+s[3]+","+s[4]+","+s[5]),"A"==a&&(t+=" wa "+o),"B"==a&&(t+=" at "+o),n=s}return t},animate:function(t,e,n,r,i){var o=t.node,a=this.chart;if(t.animationFinished=!1,"translate"==e){n=(e=n.split(","))[1];var s=o.offsetTop;a.animate(t,"left",o.offsetLeft,e[0],r,i,"px"),a.animate(t,"top",s,n,r,i,"px")}},clipRect:function(t,e,n,r,i){t=t.node,0===e&&0===n?(t.style.width=r+"px",t.style.height=i+"px",t.style.overflow="hidden"):t.style.clip="rect("+n+"px "+(e+r)+"px "+(n+i)+"px "+e+"px)"},rotate:function(t,e,n){if(0!==Number(e)){t=(l=t.node).style,n=n||this.getBGColor(l.parentNode),t.backgroundColor=n,t.paddingLeft=1,n=e*Math.PI/180;var r=Math.cos(n),i=Math.sin(n),o=u.removePx(t.left),a=u.removePx(t.top),s=l.offsetWidth,l=l.offsetHeight;e/=Math.abs(e),t.left=o+s/2-s/2*Math.cos(n)-e*l/2*Math.sin(n)+3,t.top=a-e*s/2*Math.sin(n)+e*l/2*Math.sin(n),t.cssText=t.cssText+"; filter:progid:DXImageTransform.Microsoft.Matrix(M11='"+r+"', M12='"+-i+"', M21='"+i+"', M22='"+r+"', sizingmethod='auto expand');"}},getBGColor:function(t){var e="#FFFFFF";if(t.style){var n=t.style.backgroundColor;""!==n?e=n:t.parentNode&&(e=this.getBGColor(t.parentNode))}return e},set:function(t){var e,n=new u.AmDObject("group",this.D);if(this.D.container.appendChild(n.node),t)for(e=0;e<t.length;e++)n.push(t[e]);return n},gradient:function(t,e,n,r){var i,o="";for("radialGradient"==e&&(e="gradientradial",n.reverse()),"linearGradient"==e&&(e="gradient"),i=0;i<n.length;i++)o+=Math.round(100*i/(n.length-1))+"% "+n[i],i<n.length-1&&(o+=",");t=t.fill,90==r?r=0:270==r?r=180:180==r?r=90:0===r&&(r=270),8===document.documentMode?(t.type=e,t.angle=r):(t.setAttribute("type",e),t.setAttribute("angle",r)),o&&(t.colors.value=o)},remove:function(t){t.clipPath&&this.D.remove(t.clipPath),this.D.remove(t.node)},disableSelection:function(t){t.onselectstart=function(){return!1},t.style.cursor="default"},pattern:function(t,e,n,r){n=t.node,t=t.fill;var i="none";e.color&&(i=e.color),n.fillColor=i,e=e.url,u.isAbsolute(e)||(e=r+e),8===document.documentMode?(t.type="tile",t.src=e):(t.setAttribute("type","tile"),t.setAttribute("src",e))},update:function(){}})}(),function(){var c=window.AmCharts;c.SVGRenderer=c.Class({construct:function(t){this.D=t,this.animations=[]},create:function(t,e){return document.createElementNS(c.SVG_NS,e)},attr:function(t,e){for(var n in e)e.hasOwnProperty(n)&&this.setAttr(t,n,e[n])},setAttr:function(t,e,n){void 0!==n&&t.node.setAttribute(e,n)},animate:function(t,e,n,r,i){t.animationFinished=!1;var o=t.node;t["an_"+e]&&c.removeFromArray(this.animations,t["an_"+e]),"translate"==e?0===(o=(o=(o=(o=o.getAttribute("transform"))?String(o).substring(10,o.length-1):"0,0").split(", ").join(" ")).split(" ").join(","))&&(o="0,0"):o=Number(o.getAttribute(e)),n={obj:t,frame:0,attribute:e,from:o,to:n,time:r,effect:i},this.animations.push(n),t["an_"+e]=n},update:function(){var t,e=this.animations;for(t=e.length-1;0<=t;t--){var n,r,i,o=e[t],a=o.time*c.updateRate,s=o.frame+1,l=o.obj,u=o.attribute;if(s<=a){if(o.frame++,"translate"==u){if(n=o.from.split(","),u=Number(n[0]),n=Number(n[1]),isNaN(n)&&(n=0),r=o.to.split(","),i=Number(r[0]),r=Number(r[1]),i=0==i-u?i:Math.round(c[o.effect](0,s,u,i-u,a)),o=0==r-n?r:Math.round(c[o.effect](0,s,n,r-n,a)),u="transform",isNaN(i)||isNaN(o))continue;o="translate("+i+","+o+")"}else r=Number(o.from),i=(n=Number(o.to))-r,o=c[o.effect](0,s,r,i,a),isNaN(o)&&(o=n),0===i&&this.animations.splice(t,1);this.setAttr(l,u,o)}else"translate"==u?(r=o.to.split(","),i=Number(r[0]),r=Number(r[1]),l.translate(i,r)):(n=Number(o.to),this.setAttr(l,u,n)),l.animationFinished=!0,this.animations.splice(t,1)}},getBBox:function(t){if(t=t.node)try{return t.getBBox()}catch(t){}return{width:0,height:0,x:0,y:0}},path:function(t,e){t.node.setAttributeNS(c.SVG_XLINK,"xlink:href",e)},clipRect:function(t,e,n,r,i){var o=t.node,a=t.clipPath;a&&this.D.remove(a);var s=o.parentNode;s&&(o=document.createElementNS(c.SVG_NS,"clipPath"),a=c.getUniqueId(),o.setAttribute("id",a),this.D.rect(e,n,r,i,0,0,o),s.appendChild(o),e="#",c.baseHref&&!c.isIE&&(e=this.removeTarget(window.location.href)+e),this.setAttr(t,"clip-path","url("+e+a+")"),this.clipPathC++,t.clipPath=o)},text:function(t,e,n){var r=new c.AmDObject("text",this.D);t=String(t).split("\n");var i,o=c.removePx(e["font-size"]);for(i=0;i<t.length;i++){var a=this.create(null,"tspan");a.appendChild(document.createTextNode(t[i])),a.setAttribute("y",(o+2)*i+Math.round(o/2)),a.setAttribute("x",0),r.node.appendChild(a)}return r.node.setAttribute("y",Math.round(o/2)),this.attr(r,e),this.D.addToContainer(r.node,n),r},setText:function(t,e){var n=t.node;n&&(n.removeChild(n.firstChild),n.appendChild(document.createTextNode(e)))},move:function(t,e,n,r){isNaN(e)&&(e=0),isNaN(n)&&(n=0),e="translate("+e+","+n+")",r&&(e=e+" scale("+r+")"),this.setAttr(t,"transform",e)},rotate:function(t,e){var n=t.node.getAttribute("transform"),r="rotate("+e+")";n&&(r=n+" "+r),this.setAttr(t,"transform",r)},set:function(t){var e,n=new c.AmDObject("g",this.D);if(this.D.container.appendChild(n.node),t)for(e=0;e<t.length;e++)n.push(t[e]);return n},addListener:function(t,e,n){t.node["on"+e]=n},gradient:function(t,e,n,r){var i=t.node,o=t.grad;if(o&&this.D.remove(o),e=document.createElementNS(c.SVG_NS,e),o=c.getUniqueId(),e.setAttribute("id",o),!isNaN(r)){var a=0,s=0,l=0,u=0;90==r?l=100:270==r?u=100:180==r?a=100:0===r&&(s=100),e.setAttribute("x1",a+"%"),e.setAttribute("x2",s+"%"),e.setAttribute("y1",l+"%"),e.setAttribute("y2",u+"%")}for(r=0;r<n.length;r++)a=document.createElementNS(c.SVG_NS,"stop"),s=100*r/(n.length-1),0===r&&(s=0),a.setAttribute("offset",s+"%"),a.setAttribute("stop-color",n[r]),e.appendChild(a);i.parentNode.appendChild(e),n="#",c.baseHref&&!c.isIE&&(n=this.removeTarget(window.location.href)+n),i.setAttribute("fill","url("+n+o+")"),t.grad=e},removeTarget:function(t){return t.split("#")[0]},pattern:function(t,e,n,r){var i=t.node;isNaN(n)&&(n=1),(o=t.patternNode)&&this.D.remove(o);var o=document.createElementNS(c.SVG_NS,"pattern"),a=c.getUniqueId(),s=e;e.url&&(s=e.url),c.isAbsolute(s)||-1!=s.indexOf("data:image")||(s=r+s),r=Number(e.width),isNaN(r)&&(r=4);var l=Number(e.height);isNaN(l)&&(l=4),r/=n,l/=n,n=e.x,isNaN(n)&&(n=0);var u=-Math.random()*Number(e.randomX);isNaN(u)||(n=u),u=e.y,isNaN(u)&&(u=0);var h=-Math.random()*Number(e.randomY);isNaN(h)||(u=h),o.setAttribute("id",a),o.setAttribute("width",r),o.setAttribute("height",l),o.setAttribute("patternUnits","userSpaceOnUse"),o.setAttribute("xlink:href",s),e.color&&((h=document.createElementNS(c.SVG_NS,"rect")).setAttributeNS(null,"height",r),h.setAttributeNS(null,"width",l),h.setAttributeNS(null,"fill",e.color),o.appendChild(h)),this.D.image(s,0,0,r,l,o).translate(n,u),s="#",c.baseHref&&!c.isIE&&(s=this.removeTarget(window.location.href)+s),i.setAttribute("fill","url("+s+a+")"),t.patternNode=o,i.parentNode.appendChild(o)},remove:function(t){t.clipPath&&this.D.remove(t.clipPath),t.grad&&this.D.remove(t.grad),t.patternNode&&this.D.remove(t.patternNode),this.D.remove(t.node)}})}(),function(){var N=window.AmCharts;N.AmLegend=N.Class({construct:function(t){this.enabled=!0,this.cname="AmLegend",this.createEvents("rollOverMarker","rollOverItem","rollOutMarker","rollOutItem","showItem","hideItem","clickMarker","clickLabel"),this.position="bottom",this.borderColor=this.color="#000000",this.borderAlpha=0,this.markerLabelGap=5,this.verticalGap=10,this.align="left",this.horizontalGap=0,this.spacing=10,this.markerDisabledColor="#AAB3B3",this.markerType="square",this.markerSize=16,this.markerBorderThickness=this.markerBorderAlpha=1,this.marginBottom=this.marginTop=0,this.marginLeft=this.marginRight=20,this.autoMargins=!0,this.valueWidth=50,this.switchable=!0,this.switchType="x",this.switchColor="#FFFFFF",this.rollOverColor="#CC0000",this.reversedOrder=!1,this.labelText="[[title]]",this.valueText="[[value]]",this.accessibleLabel="[[title]]",this.useMarkerColorForLabels=!1,this.rollOverGraphAlpha=1,this.textClickEnabled=!1,this.equalWidths=!0,this.backgroundColor="#FFFFFF",this.backgroundAlpha=0,this.useGraphSettings=!1,this.showEntries=!0,this.labelDx=0,N.applyTheme(this,t,this.cname)},setData:function(t){this.legendData=t,this.invalidateSize()},invalidateSize:function(){this.destroy(),this.entries=[],this.valueLabels=[];var t=this.legendData;this.enabled&&(N.ifArray(t)||N.ifArray(this.data))&&this.drawLegend()},drawLegend:function(){var t=this.chart,e=this.position,n=this.width,r=t.divRealWidth,i=t.divRealHeight,o=this.div,a=this.legendData;if(this.data&&(a=this.combineLegend?this.legendData.concat(this.data):this.data),isNaN(this.fontSize)&&(this.fontSize=t.fontSize),this.maxColumnsReal=this.maxColumns,"right"==e||"left"==e)this.maxColumnsReal=1,this.autoMargins&&(this.marginLeft=this.marginRight=10);else if(this.autoMargins){this.marginRight=t.marginRight,this.marginLeft=t.marginLeft;var s=t.autoMarginOffset;"bottom"==e?(this.marginBottom=s,this.marginTop=0):(this.marginTop=s,this.marginBottom=0)}if(n=void 0!==n?N.toCoordinate(n,r):"right"!=e&&"left"!=e?t.realWidth:0<this.ieW?this.ieW:t.realWidth,"outside"==e?(n=o.offsetWidth,i=o.offsetHeight,o.clientHeight&&(n=o.clientWidth,i=o.clientHeight)):(isNaN(n)||(o.style.width=n+"px"),o.className="amChartsLegend "+t.classNamePrefix+"-legend-div"),this.divWidth=n,(e=this.container)?(e.container.innerHTML="",o.appendChild(e.container),e.width=n,e.height=i,e.setSize(n,i),e.addDefs(t)):e=new N.AmDraw(o,n,i,t),this.container=e,this.lx=0,this.ly=8,(i=this.markerSize)>this.fontSize&&(this.ly=i/2-1),0<i&&(this.lx+=i+this.markerLabelGap),this.titleWidth=0,(i=this.title)&&(i=N.text(this.container,i,this.color,t.fontFamily,this.fontSize,"start",!0),N.setCN(t,i,"legend-title"),i.translate(this.marginLeft,this.marginTop+this.verticalGap+this.ly+1),t=i.getBBox(),this.titleWidth=t.width+15,this.titleHeight=t.height+6),this.index=this.maxLabelWidth=0,this.showEntries){for(t=0;t<a.length;t++)this.createEntry(a[t]);for(t=this.index=0;t<a.length;t++)this.createValue(a[t])}this.arrangeEntries(),this.updateValues()},arrangeEntries:function(){var t=this.position,e=this.marginLeft+this.titleWidth,n=this.marginRight,r=this.marginTop,i=this.marginBottom,o=this.horizontalGap,a=this.div,s=this.divWidth,l=this.maxColumnsReal,u=this.verticalGap,h=this.spacing,c=s-n-e,d=0,f=0,p=this.container;this.set&&this.set.remove();var g=p.set();this.set=g;var v=p.set();g.push(v);var m,y,w=this.entries;for(y=0;y<w.length;y++){d<(b=(m=w[y].getBBox()).width)&&(d=b),f<(m=m.height)&&(f=m)}var b=f=0,C=o,E=0,S=0;for(y=0;y<w.length;y++){var O,T=w[y];this.reversedOrder&&(T=w[w.length-y-1]),m=T.getBBox(),this.equalWidths?O=b*(d+h+this.markerLabelGap):C=(O=C)+m.width+o+h,O+m.width>c&&0<y&&0!==b&&(f++,C=(O=b=0)+m.width+o+h,E=E+S+u,S=0),m.height>S&&(S=m.height),T.translate(O,E),b++,!isNaN(l)&&l<=b&&(f++,E=E+S+u,C=o,S=b=0),v.push(T)}l=(m=v.getBBox()).height+2*u-1,"left"==t||"right"==t?(s=(h=m.width+2*o)+e+n,a.style.width=s+"px",this.ieW=s):h=s-e-n-1,n=N.polygon(this.container,[0,h,h,0],[0,0,l,l],this.backgroundColor,this.backgroundAlpha,1,this.borderColor,this.borderAlpha),N.setCN(this.chart,n,"legend-bg"),g.push(n),g.translate(e,r),n.toBack(),e=o,"top"!=t&&"bottom"!=t&&"absolute"!=t&&"outside"!=t||("center"==this.align?e=o+(h-m.width)/2:"right"==this.align&&(e=o+h-m.width)),v.translate(e,u+1),this.titleHeight>l&&(l=this.titleHeight),(r=l+r+i+1)<0&&(r=0),"absolute"!=t&&"outside"!=t&&r>this.chart.divRealHeight&&(a.style.top="0px"),a.style.height=Math.round(r)+"px",p.setSize(this.divWidth,r)},createEntry:function(e){if(!1!==e.visibleInLegend&&!e.hideFromLegend){var n=this,t=n.chart,r=n.useGraphSettings,i=e.markerType;i&&(r=!1),e.legendEntryWidth=n.markerSize,i=i||n.markerType;var o,a=e.color,s=e.alpha;e.legendKeyColor&&(a=e.legendKeyColor()),e.legendKeyAlpha&&(s=e.legendKeyAlpha()),!0===e.hidden&&(o=a=n.markerDisabledColor);var l,u=e.pattern,h=e.customMarker;h=h||n.customMarker;var c,d,f=n.container,p=n.markerSize,g=0,v=0,m=p/2;if(r)r=e.type,n.switchType=void 0,"line"==r||"step"==r||"smoothedLine"==r||"ohlc"==r?(l=f.set(),e.hidden||(a=e.lineColorR,o=e.bulletBorderColorR),g=N.line(f,[0,2*p],[p/2,p/2],a,e.lineAlpha,e.lineThickness,e.dashLength),N.setCN(t,g,"graph-stroke"),l.push(g),e.bullet&&(e.hidden||(a=e.bulletColorR),g=N.bullet(f,e.bullet,e.bulletSize,a,e.bulletAlpha,e.bulletBorderThickness,o,e.bulletBorderAlpha))&&(N.setCN(t,g,"graph-bullet"),g.translate(p+1,p/2),l.push(g)),m=0,v=(g=p)/3):(!e.getGradRotation||0===(l=e.getGradRotation())&&(l=180),g=e.fillColorsR,!0===e.hidden&&(g=a),(l=n.createMarker("rectangle",g,e.fillAlphas,e.lineThickness,a,e.lineAlpha,l,u,e.dashLength))&&(m=p,l.translate(m,p/2)),g=p),N.setCN(t,l,"graph-"+r),N.setCN(t,l,"graph-"+e.id);else if(h)l=f.image(h,0,0,p,p);else{var y;isNaN(n.gradientRotation)||(y=180+n.gradientRotation),(l=n.createMarker(i,a,s,void 0,void 0,void 0,y,u))&&l.translate(p/2,p/2)}N.setCN(t,l,"legend-marker"),n.addListeners(l,e),f=f.set([l]),n.switchable&&e.switchable&&f.setAttr("cursor","pointer"),void 0!==e.id&&N.setCN(t,f,"legend-item-"+e.id),N.setCN(t,f,e.className,!0),(o=n.switchType)&&"none"!=o&&0<p&&("x"==o?(c=n.createX()).translate(p/2,p/2):c=n.createV(),!0!==(c.dItem=e).hidden?"x"==o?c.hide():c.show():"x"!=o&&c.hide(),n.switchable||c.hide(),n.addListeners(c,e),e.legendSwitch=c,f.push(c),N.setCN(t,c,"legend-switch")),o=n.color,e.showBalloon&&n.textClickEnabled&&void 0!==n.selectedColor&&(o=n.selectedColor),n.useMarkerColorForLabels&&!u&&(o=a),!0===e.hidden&&(o=n.markerDisabledColor),a=N.massReplace(n.labelText,{"[[title]]":e.title}),void 0!==n.tabIndex&&(f.setAttr("tabindex",n.tabIndex),f.setAttr("role","menuitem"),f.keyup(function(t){13==t.keyCode&&n.clickMarker(e,t)})),t.accessible&&n.accessibleLabel&&(u=N.massReplace(n.accessibleLabel,{"[[title]]":e.title}),t.makeAccessible(f,u)),u=n.fontSize,l&&(p<=u&&(p=p/2+n.ly-u/2+(u+2-p)/2-v,l.translate(m,p),c&&c.translate(c.x,p)),e.legendEntryWidth=l.getBBox().width),a&&(a=N.fixBrakes(a),e.legendTextReal=a,d=n.labelWidth,d=isNaN(d)?N.text(n.container,a,o,t.fontFamily,u,"start"):N.wrappedText(n.container,a,o,t.fontFamily,u,"start",!1,d,0),N.setCN(t,d,"legend-label"),d.translate(n.lx+g,n.ly),f.push(d),n.labelDx=g,t=d.getBBox().width,n.maxLabelWidth<t&&(n.maxLabelWidth=t)),n.entries[n.index]=f,e.legendEntry=n.entries[n.index],e.legendMarker=l,e.legendLabel=d,n.index++}},addListeners:function(t,e){var n=this;t&&t.mouseover(function(t){n.rollOverMarker(e,t)}).mouseout(function(t){n.rollOutMarker(e,t)}).click(function(t){n.clickMarker(e,t)})},rollOverMarker:function(t,e){this.switchable&&this.dispatch("rollOverMarker",t,e),this.dispatch("rollOverItem",t,e)},rollOutMarker:function(t,e){this.switchable&&this.dispatch("rollOutMarker",t,e),this.dispatch("rollOutItem",t,e)},clickMarker:function(t,e){this.switchable&&(!0===t.hidden?this.dispatch("showItem",t,e):this.dispatch("hideItem",t,e)),this.dispatch("clickMarker",t,e)},rollOverLabel:function(t,e){t.hidden||this.textClickEnabled&&t.legendLabel&&t.legendLabel.attr({fill:this.rollOverColor}),this.dispatch("rollOverItem",t,e)},rollOutLabel:function(t,e){if(!t.hidden&&this.textClickEnabled&&t.legendLabel){var n=this.color;void 0!==this.selectedColor&&t.showBalloon&&(n=this.selectedColor),this.useMarkerColorForLabels&&(void 0===(n=t.lineColor)&&(n=t.color)),t.legendLabel.attr({fill:n})}this.dispatch("rollOutItem",t,e)},clickLabel:function(t,e){this.textClickEnabled?t.hidden||this.dispatch("clickLabel",t,e):this.switchable&&(!0===t.hidden?this.dispatch("showItem",t,e):this.dispatch("hideItem",t,e))},dispatch:function(t,e,n){t={type:t,dataItem:e,target:this,event:n,chart:this.chart},this.chart&&this.chart.handleLegendEvent(t),this.fire(t)},createValue:function(e){var n=this,t=n.fontSize,r=n.chart;if(!1!==e.visibleInLegend&&!e.hideFromLegend){var i=n.maxLabelWidth,o=0;n.forceWidth&&(i=n.labelWidth),n.equalWidths||(n.valueAlign="left"),o={x:0,y:0,width:0,height:0},e.legendLabel&&(o=e.legendLabel.getBBox()),"left"==n.valueAlign&&(i=o.width);o=o.height;var a=i,s=n.markerSize;if(s<t+7&&(s=t+7,N.VML&&(s+=3)),n.valueText&&0<n.valueWidth){var l=n.color;n.useMarkerColorForValues&&(l=e.color,e.legendKeyColor&&(l=e.legendKeyColor())),!0===e.hidden&&(l=n.markerDisabledColor);var u=n.valueText,h=(i=i+n.lx+n.labelDx+n.markerLabelGap+n.valueWidth,"end");"left"==n.valueAlign&&(i-=n.valueWidth,h="start"),t=N.text(n.container,u,l,n.chart.fontFamily,t,h),N.setCN(r,t,"legend-value"),t.translate(i,n.ly),n.entries[n.index].push(t),a+=n.valueWidth+2*n.markerLabelGap,t.dItem=e,n.valueLabels.push(t),s<o+5&&(s=o+5)}n.index++,(r=n.container.rect(e.legendEntryWidth,0,a,s,0,0).attr({stroke:"none",fill:"#fff","fill-opacity":.005})).dItem=e,n.entries[n.index-1].push(r),r.mouseover(function(t){n.rollOverLabel(e,t)}).mouseout(function(t){n.rollOutLabel(e,t)}).click(function(t){n.clickLabel(e,t)})}},createV:function(){var t=this.markerSize;return N.polygon(this.container,[t/5,t/2,t-t/5,t/2],[t/3,t-t/5,t/5,t/1.7],this.switchColor)},createX:function(){var t=(this.markerSize-4)/2,e={stroke:this.switchColor,"stroke-width":3},n=this.container,r=N.line(n,[-t,t],[-t,t]).attr(e);t=N.line(n,[-t,t],[t,-t]).attr(e);return this.container.set([r,t])},createMarker:function(t,e,n,r,i,o,a,s,l){var u=this.markerSize,h=this.container;return i=(i=i||this.markerBorderColor)||e,isNaN(r)&&(r=this.markerBorderThickness),isNaN(o)&&(o=this.markerBorderAlpha),N.bullet(h,t,u,e,n,r,i,o,u,a,s,this.chart.path,l)},validateNow:function(){this.invalidateSize()},updateValues:function(){var t,e=this.valueLabels,n=this.chart,r=this.data;if(e)for(t=0;t<e.length;t++){var i=e[t],o=i.dItem;o.periodDataItem=void 0,o.periodPercentDataItem=void 0;var a=" ";if(r)o.value?i.text(o.value):i.text("");else{var s=null;if(void 0!==o.type){s=o.currentDataItem;var l=this.periodValueText;o.legendPeriodValueText&&(l=o.legendPeriodValueText),o.legendPeriodValueTextR&&(l=o.legendPeriodValueTextR),s?(a=this.valueText,o.legendValueText&&(a=o.legendValueText),o.legendValueTextR&&(a=o.legendValueTextR),a=n.formatString(a,s)):l&&n.formatPeriodString&&(l=N.massReplace(l,{"[[title]]":o.title}),a=n.formatPeriodString(l,o))}else a=n.formatString(this.valueText,o);l=o,s&&(l=s);var u,h=this.valueFunction;h&&(a=h(l,a,n.periodDataItem)),this.useMarkerColorForLabels&&!s&&o.lastDataItem&&(s=o.lastDataItem),s?u=n.getBalloonColor(o,s):o.legendKeyColor&&(u=o.legendKeyColor()),o.legendColorFunction&&(u=o.legendColorFunction(l,a,o.periodDataItem,o.periodPercentDataItem)),i.text(a),!o.pattern&&(this.useMarkerColorForValues&&i.setAttr("fill",u),this.useMarkerColorForLabels)&&((i=o.legendMarker)&&(i.setAttr("fill",u),i.setAttr("stroke",u)),(i=o.legendLabel)&&(o.hidden?i.setAttr("fill",this.markerDisabledColor):i.setAttr("fill",u)))}}},renderFix:function(){if(!N.VML&&this.enabled){var t=this.container;t&&t.renderFix()}},destroy:function(){this.div.innerHTML="",N.remove(this.set)}})}(),function(){var v=window.AmCharts;v.formatMilliseconds=function(t,e){if(-1!=t.indexOf("fff")){var n=e.getMilliseconds(),r=String(n);n<10&&(r="00"+n),10<=n&&n<100&&(r="0"+n),t=t.replace(/fff/g,r)}return t},v.extractPeriod=function(t){var e=v.stripNumbers(t),n=1;return e!=t&&(n=Number(t.slice(0,t.indexOf(e)))),{period:e,count:n}},v.getDate=function(t,e,n){return t instanceof Date?v.newDate(t,n):e&&isNaN(t)?v.stringToDate(t,e):new Date(t)},v.daysInMonth=function(t){return new Date(t.getYear(),t.getMonth()+1,0).getDate()},v.newDate=function(t,e){return e&&-1==e.indexOf("fff")?new Date(t):new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())},v.resetDateToMin=function(t,e,n,r){var i,o,a,s,l,u,h;switch(void 0===r&&(r=1),t=v.useUTC?(i=t.getUTCFullYear(),o=t.getUTCMonth(),a=t.getUTCDate(),s=t.getUTCHours(),l=t.getUTCMinutes(),u=t.getUTCSeconds(),h=t.getUTCMilliseconds(),t.getUTCDay()):(i=t.getFullYear(),o=t.getMonth(),a=t.getDate(),s=t.getHours(),l=t.getMinutes(),u=t.getSeconds(),h=t.getMilliseconds(),t.getDay()),e){case"YYYY":i=Math.floor(i/n)*n,a=1,h=u=l=s=o=0;break;case"MM":o=Math.floor(o/n)*n,a=1,h=u=l=s=0;break;case"WW":a=r<=t?a-t+r:a-(7+t)+r,h=u=l=s=0;break;case"DD":h=u=l=s=0;break;case"hh":s=Math.floor(s/n)*n,h=u=l=0;break;case"mm":l=Math.floor(l/n)*n,h=u=0;break;case"ss":u=Math.floor(u/n)*n,h=0;break;case"fff":h=Math.floor(h/n)*n}return v.useUTC?((t=new Date).setUTCFullYear(i,o,a),t.setUTCHours(s,l,u,h)):t=new Date(i,o,a,s,l,u,h),t},v.getPeriodDuration=function(t,e){var n;switch(void 0===e&&(e=1),t){case"YYYY":n=316224e5;break;case"MM":n=26784e5;break;case"WW":n=6048e5;break;case"DD":n=864e5;break;case"hh":n=36e5;break;case"mm":n=6e4;break;case"ss":n=1e3;break;case"fff":n=1}return n*e},v.intervals={s:{nextInterval:"ss",contains:1e3},ss:{nextInterval:"mm",contains:60,count:0},mm:{nextInterval:"hh",contains:60,count:1},hh:{nextInterval:"DD",contains:24,count:2},DD:{nextInterval:"",contains:1/0,count:3}},v.getMaxInterval=function(t,e){var n=v.intervals;return t>=n[e].contains?(t=Math.round(t/n[e].contains),e=n[e].nextInterval,v.getMaxInterval(t,e)):"ss"==e?n[e].nextInterval:e},v.dayNames="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),v.shortDayNames="Sun Mon Tue Wed Thu Fri Sat".split(" "),v.monthNames="January February March April May June July August September October November December".split(" "),v.shortMonthNames="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),v.getWeekNumber=function(t){(t=new Date(t)).setHours(0,0,0),t.setDate(t.getDate()+4-(t.getDay()||7));var e=new Date(t.getFullYear(),0,1);return Math.ceil(((t-e)/864e5+1)/7)},v.stringToDate=function(t,e){var n={},r=[{pattern:"YYYY",period:"year"},{pattern:"YY",period:"year"},{pattern:"MM",period:"month"},{pattern:"M",period:"month"},{pattern:"DD",period:"date"},{pattern:"D",period:"date"},{pattern:"JJ",period:"hours"},{pattern:"J",period:"hours"},{pattern:"HH",period:"hours"},{pattern:"H",period:"hours"},{pattern:"KK",period:"hours"},{pattern:"K",period:"hours"},{pattern:"LL",period:"hours"},{pattern:"L",period:"hours"},{pattern:"NN",period:"minutes"},{pattern:"N",period:"minutes"},{pattern:"SS",period:"seconds"},{pattern:"S",period:"seconds"},{pattern:"QQQ",period:"milliseconds"},{pattern:"QQ",period:"milliseconds"},{pattern:"Q",period:"milliseconds"}],i=!0;-1!=(l=e.indexOf("AA"))&&(t.substr(l,2),"pm"==t.toLowerCase&&(i=!1));var o,a,s,l=e;for(s=0;s<r.length;s++)n[a=r[s].period]=0,"date"==a&&(n[a]=1);for(s=0;s<r.length;s++)if(o=r[s].pattern,a=r[s].period,-1!=e.indexOf(o)){var u=v.getFromDateString(o,t,l);e=e.replace(o,""),"KK"!=o&&"K"!=o&&"LL"!=o&&"L"!=o||i||(u+=12),n[a]=u}return v.useUTC?((r=new Date).setUTCFullYear(n.year,n.month,n.date),r.setUTCHours(n.hours,n.minutes,n.seconds,n.milliseconds)):r=new Date(n.year,n.month,n.date,n.hours,n.minutes,n.seconds,n.milliseconds),r},v.getFromDateString=function(t,e,n){if(void 0!==e)return n=n.indexOf(t),"0"==(e=(e=String(e)).substr(n,t.length)).charAt(0)&&(e=e.substr(1,e.length-1)),e=Number(e),isNaN(e)&&(e=0),-1!=t.indexOf("M")&&e--,e},v.formatDate=function(t,e,n){n=n||v;var r,i,o,a,s,l,u,h,c=v.getWeekNumber(t);h=v.useUTC?(r=t.getUTCFullYear(),i=t.getUTCMonth(),o=t.getUTCDate(),a=t.getUTCDay(),s=t.getUTCHours(),l=t.getUTCMinutes(),u=t.getUTCSeconds(),t.getUTCMilliseconds()):(r=t.getFullYear(),i=t.getMonth(),o=t.getDate(),a=t.getDay(),s=t.getHours(),l=t.getMinutes(),u=t.getSeconds(),t.getMilliseconds());var d=String(r).substr(2,2),f="0"+a;e=e.replace(/W/g,c),24==(c=s)&&(c=0);var p=c;p<10&&(p="0"+p),e=(e=e.replace(/JJ/g,p)).replace(/J/g,c),0===(p=s)&&(p=24,-1==e.indexOf("H")||0===--o&&((r=new Date(t)).setDate(r.getDate()-1),i=r.getMonth(),o=r.getDate(),r=r.getFullYear())),t=i+1,i<9&&(t="0"+t),(c=o)<10&&(c="0"+o);var g=p;return g<10&&(g="0"+g),e=(e=e.replace(/HH/g,g)).replace(/H/g,p),11<(p=s)&&(p-=12),(g=p)<10&&(g="0"+g),e=(e=e.replace(/KK/g,g)).replace(/K/g,p),0===(p=s)&&(p=12),12<p&&(p-=12),(g=p)<10&&(g="0"+g),e=(e=e.replace(/LL/g,g)).replace(/L/g,p),(p=l)<10&&(p="0"+p),e=(e=e.replace(/NN/g,p)).replace(/N/g,l),(l=u)<10&&(l="0"+l),e=(e=e.replace(/SS/g,l)).replace(/S/g,u),(u=h)<10?u="00"+u:u<100&&(u="0"+u),(l=h)<10&&(l="00"+l),e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/A/g,"@A@")).replace(/QQQ/g,u)).replace(/QQ/g,l)).replace(/Q/g,h)).replace(/YYYY/g,"@IIII@")).replace(/YY/g,"@II@")).replace(/MMMM/g,"@XXXX@")).replace(/MMM/g,"@XXX@")).replace(/MM/g,"@XX@")).replace(/M/g,"@X@")).replace(/DD/g,"@RR@")).replace(/D/g,"@R@")).replace(/EEEE/g,"@PPPP@")).replace(/EEE/g,"@PPP@")).replace(/EE/g,"@PP@")).replace(/E/g,"@P@")).replace(/@IIII@/g,r)).replace(/@II@/g,d)).replace(/@XXXX@/g,n.monthNames[i])).replace(/@XXX@/g,n.shortMonthNames[i])).replace(/@XX@/g,t)).replace(/@X@/g,i+1)).replace(/@RR@/g,c)).replace(/@R@/g,o)).replace(/@PPPP@/g,n.dayNames[a])).replace(/@PPP@/g,n.shortDayNames[a])).replace(/@PP@/g,f)).replace(/@P@/g,a),s<12?e.replace(/@A@/g,n.amString):e.replace(/@A@/g,n.pmString)},v.changeDate=function(t,e,n,r,i){if(v.useUTC)return v.changeUTCDate(t,e,n,r,i);var o=-1;switch(void 0===r&&(r=!0),void 0===i&&(i=!1),!0===r&&(o=1),e){case"YYYY":t.setFullYear(t.getFullYear()+n*o),r||i||t.setDate(t.getDate()+1);break;case"MM":e=t.getMonth();var a=t.getFullYear();t.setMonth(e+n*o);var s=t.getMonth();if(r&&n<s-e)for(;t.getMonth()-e>n;)t.setDate(t.getDate()-1);a==t.getFullYear()&&t.getMonth()>e+n*o&&t.setDate(t.getDate()-1),r||i||t.setDate(t.getDate()+1);break;case"DD":t.setDate(t.getDate()+n*o);break;case"WW":t.setDate(t.getDate()+n*o*7);break;case"hh":t.setHours(t.getHours()+n*o);break;case"mm":t.setMinutes(t.getMinutes()+n*o);break;case"ss":t.setSeconds(t.getSeconds()+n*o);break;case"fff":t.setMilliseconds(t.getMilliseconds()+n*o)}return t},v.changeUTCDate=function(t,e,n,r,i){var o=-1;switch(void 0===r&&(r=!0),void 0===i&&(i=!1),!0===r&&(o=1),e){case"YYYY":t.setUTCFullYear(t.getUTCFullYear()+n*o),r||i||t.setUTCDate(t.getUTCDate()+1);break;case"MM":e=t.getUTCMonth(),t.setUTCMonth(t.getUTCMonth()+n*o),t.getUTCMonth()>e+n*o&&t.setUTCDate(t.getUTCDate()-1),r||i||t.setUTCDate(t.getUTCDate()+1);break;case"DD":t.setUTCDate(t.getUTCDate()+n*o);break;case"WW":t.setUTCDate(t.getUTCDate()+n*o*7);break;case"hh":t.setUTCHours(t.getUTCHours()+n*o);break;case"mm":t.setUTCMinutes(t.getUTCMinutes()+n*o);break;case"ss":t.setUTCSeconds(t.getUTCSeconds()+n*o);break;case"fff":t.setUTCMilliseconds(t.getUTCMilliseconds()+n*o)}return t}}(),function(){var f=window.AmCharts;f.AmRectangularChart=f.Class({inherits:f.AmCoordinateChart,construct:function(t){f.AmRectangularChart.base.construct.call(this,t),this.theme=t,this.createEvents("zoomed","changed"),this.marginRight=this.marginBottom=this.marginTop=this.marginLeft=20,this.depth3D=this.angle=0,this.plotAreaFillColors="#FFFFFF",this.plotAreaFillAlphas=0,this.plotAreaBorderColor="#000000",this.plotAreaBorderAlpha=0,this.maxZoomFactor=20,this.zoomOutButtonImageSize=19,this.zoomOutButtonImage="lens",this.zoomOutText="Show all",this.zoomOutButtonColor="#e5e5e5",this.zoomOutButtonAlpha=0,this.zoomOutButtonRollOverAlpha=1,this.zoomOutButtonPadding=8,this.trendLines=[],this.autoMargins=!0,this.marginsUpdated=!1,this.autoMarginOffset=10,f.applyTheme(this,t,"AmRectangularChart")},initChart:function(){f.AmRectangularChart.base.initChart.call(this),this.updateDxy(),!this.marginsUpdated&&this.autoMargins&&(this.resetMargins(),this.drawGraphs=!1),this.processScrollbars(),this.updateMargins(),this.updatePlotArea(),this.updateScrollbars(),this.updateTrendLines(),this.updateChartCursor(),this.updateValueAxes(),this.scrollbarOnly||this.updateGraphs()},drawChart:function(){if(f.AmRectangularChart.base.drawChart.call(this),this.drawPlotArea(),f.ifArray(this.chartData)){var t=this.chartCursor;t&&t.draw()}},resetMargins:function(){var t,e={};if("xy"==this.type){var n=this.xAxes,r=this.yAxes;for(t=0;t<n.length;t++){var i=n[t];i.ignoreAxisWidth||(i.setOrientation(!0),i.fixAxisPosition(),e[i.position]=!0)}for(t=0;t<r.length;t++)(n=r[t]).ignoreAxisWidth||(n.setOrientation(!1),n.fixAxisPosition(),e[n.position]=!0)}else{for(r=this.valueAxes,t=0;t<r.length;t++)(n=r[t]).ignoreAxisWidth||(n.setOrientation(this.rotate),n.fixAxisPosition(),e[n.position]=!0);(t=this.categoryAxis)&&!t.ignoreAxisWidth&&(t.setOrientation(!this.rotate),t.fixAxisPosition(),t.fixAxisPosition(),e[t.position]=!0)}e.left&&(this.marginLeft=0),e.right&&(this.marginRight=0),e.top&&(this.marginTop=0),e.bottom&&(this.marginBottom=0),this.fixMargins=e},measureMargins:function(){var t,e,n=this.valueAxes,r=this.autoMarginOffset,i=this.fixMargins,o=this.realWidth,a=this.realHeight,s=r,l=r,u=o;for(t=a,e=0;e<n.length;e++)n[e].handleSynchronization(),t=this.getAxisBounds(n[e],s,u,l,t),s=Math.round(t.l),u=Math.round(t.r),l=Math.round(t.t),t=Math.round(t.b);(n=this.categoryAxis)&&(t=this.getAxisBounds(n,s,u,l,t),s=Math.round(t.l),u=Math.round(t.r),l=Math.round(t.t),t=Math.round(t.b)),i.left&&s<r&&(this.marginLeft=Math.round(-s+r),!isNaN(this.minMarginLeft)&&this.marginLeft<this.minMarginLeft&&(this.marginLeft=this.minMarginLeft)),i.right&&o-r<=u&&(this.marginRight=Math.round(u-o+r),!isNaN(this.minMarginRight)&&this.marginRight<this.minMarginRight&&(this.marginRight=this.minMarginRight)),i.top&&l<r+this.titleHeight&&(this.marginTop=Math.round(this.marginTop-l+r+this.titleHeight),!isNaN(this.minMarginTop)&&this.marginTop<this.minMarginTop&&(this.marginTop=this.minMarginTop)),i.bottom&&a-r<t&&(this.marginBottom=Math.round(this.marginBottom+t-a+r),!isNaN(this.minMarginBottom)&&this.marginBottom<this.minMarginBottom&&(this.marginBottom=this.minMarginBottom)),this.initChart()},getAxisBounds:function(t,e,n,r,i){if(!t.ignoreAxisWidth){var o=t.labelsSet,a=t.tickLength;if(t.inside&&(a=0),o)switch(o=t.getBBox(),t.position){case"top":(t=o.y)<r&&(r=t);break;case"bottom":i<(t=o.y+o.height)&&(i=t);break;case"right":n<(t=o.x+o.width+a+3)&&(n=t);break;case"left":(t=o.x-a)<e&&(e=t)}}return{l:e,t:r,r:n,b:i}},drawZoomOutButton:function(){var e=this;if(!e.zbSet){var t=e.container.set();e.zoomButtonSet.push(t);var n,r=e.color,i=e.fontSize,o=e.zoomOutButtonImageSize,a=e.zoomOutButtonImage.replace(/\.[a-z]*$/i,""),s=e.langObj.zoomOutText||e.zoomOutText,l=e.zoomOutButtonColor,u=e.zoomOutButtonAlpha,h=e.zoomOutButtonFontSize,c=e.zoomOutButtonPadding;isNaN(h)||(i=h),(h=e.zoomOutButtonFontColor)&&(r=h),(h=e.zoomOutButton)&&(h.fontSize&&(i=h.fontSize),h.color&&(r=h.color),h.backgroundColor&&(l=h.backgroundColor),isNaN(h.backgroundAlpha)||(e.zoomOutButtonRollOverAlpha=h.backgroundAlpha));var d=h=0;d=e.pathToImages;for(a&&(!f.isAbsolute(a)&&void 0!==d||(d=""),n=e.container.image(d+a+e.extension,0,0,o,o),f.setCN(e,n,"zoom-out-image"),t.push(n),h=(n=n.getBBox()).width+5),void 0!==s&&(r=f.text(e.container,s,r,e.fontFamily,i,"start"),f.setCN(e,r,"zoom-out-label"),i=r.getBBox(),d=n?n.height/2-3:i.height/2,r.translate(h,d),t.push(r)),n=t.getBBox(),r=1,f.isModern||(r=0),(l=f.rect(e.container,n.width+2*c+5,n.height+2*c-2,l,1,1,l,r)).setAttr("opacity",u),l.translate(-c,-c),f.setCN(e,l,"zoom-out-bg"),t.push(l),l.toBack(),n=(e.zbBG=l).getBBox(),t.translate(e.marginLeftReal+e.plotAreaWidth-n.width+c,e.marginTopReal+c),t.hide(),t.mouseover(function(){e.rollOverZB()}).mouseout(function(){e.rollOutZB()}).click(function(){e.clickZB()}).touchstart(function(){e.rollOverZB()}).touchend(function(){e.rollOutZB(),e.clickZB()}),u=0;u<t.length;u++)t[u].attr({cursor:"pointer"});void 0!==e.zoomOutButtonTabIndex&&(t.setAttr("tabindex",e.zoomOutButtonTabIndex),t.setAttr("role","menuitem"),t.keyup(function(t){13==t.keyCode&&e.clickZB()})),e.zbSet=t}},rollOverZB:function(){this.rolledOverZB=!0,this.zbBG.setAttr("opacity",this.zoomOutButtonRollOverAlpha)},rollOutZB:function(){this.rolledOverZB=!1,this.zbBG.setAttr("opacity",this.zoomOutButtonAlpha)},clickZB:function(){this.rolledOverZB=!1,this.zoomOut()},zoomOut:function(){this.zoomOutValueAxes()},drawPlotArea:function(){var t=this.dx,e=this.dy,n=this.marginLeftReal,r=this.marginTopReal,i=this.plotAreaWidth-1,o=this.plotAreaHeight-1,a=this.plotAreaFillColors,s=this.plotAreaFillAlphas,l=this.plotAreaBorderColor,u=this.plotAreaBorderAlpha;"object"==typeof s&&(s=s[0]),a=f.polygon(this.container,[0,i,i,0,0],[0,0,o,o,0],a,s,1,l,u,this.plotAreaGradientAngle),f.setCN(this,a,"plot-area"),a.translate(n+t,r+e),this.set.push(a),0!==t&&0!==e&&("object"==typeof(a=this.plotAreaFillColors)&&(a=a[0]),a=f.adjustLuminosity(a,-.15),i=f.polygon(this.container,[0,t,i+t,i,0],[0,e,e,0,0],a,s,1,l,u),f.setCN(this,i,"plot-area-bottom"),i.translate(n,r+o),this.set.push(i),t=f.polygon(this.container,[0,0,t,t,0],[0,o,o+e,e,0],a,s,1,l,u),f.setCN(this,t,"plot-area-left"),t.translate(n,r),this.set.push(t)),(n=this.bbset)&&this.scrollbarOnly&&n.remove()},updatePlotArea:function(){var t=this.updateWidth(),e=this.updateHeight(),n=this.container;this.realWidth=t,this.realWidth=e,n&&this.container.setSize(t,e);n=this.marginLeftReal;var r=this.marginTopReal;(t=t-n-this.marginRightReal-this.dx)<1&&(t=1),(e=e-r-this.marginBottomReal)<1&&(e=1),this.plotAreaWidth=Math.round(t),this.plotAreaHeight=Math.round(e),this.plotBalloonsSet.translate(n,r)},updateDxy:function(){this.dx=Math.round(this.depth3D*Math.cos(this.angle*Math.PI/180)),this.dy=Math.round(-this.depth3D*Math.sin(this.angle*Math.PI/180)),this.d3x=Math.round(this.columnSpacing3D*Math.cos(this.angle*Math.PI/180)),this.d3y=Math.round(-this.columnSpacing3D*Math.sin(this.angle*Math.PI/180))},updateMargins:function(){var t=this.getTitleHeight();this.titleHeight=t,this.marginTopReal=this.marginTop-this.dy,this.fixMargins&&!this.fixMargins.top&&(this.marginTopReal+=t),this.marginBottomReal=this.marginBottom,this.marginLeftReal=this.marginLeft,this.marginRightReal=this.marginRight},updateValueAxes:function(){var t,e=this.valueAxes;for(t=0;t<e.length;t++){var n=e[t];this.setAxisRenderers(n),this.updateObjectSize(n)}},setAxisRenderers:function(t){t.axisRenderer=f.RecAxis,t.guideFillRenderer=f.RecFill,t.axisItemRenderer=f.RecItem,t.marginsChanged=!0},updateGraphs:function(){var t,e=this.graphs;for(t=0;t<e.length;t++){var n=e[t];n.index=t,n.rotate=this.rotate,this.updateObjectSize(n)}},updateObjectSize:function(t){t.width=this.plotAreaWidth-1,t.height=this.plotAreaHeight-1,t.x=this.marginLeftReal,t.y=this.marginTopReal,t.dx=this.dx,t.dy=this.dy},updateChartCursor:function(){var t=this.chartCursor;t&&(t=f.processObject(t,f.ChartCursor,this.theme),this.updateObjectSize(t),this.addChartCursor(t),t.chart=this)},processScrollbars:function(){var t=this.chartScrollbar;t&&(t=f.processObject(t,f.ChartScrollbar,this.theme),this.addChartScrollbar(t))},updateScrollbars:function(){},removeChartCursor:function(){f.callMethod("destroy",[this.chartCursor]),this.chartCursor=null},zoomTrendLines:function(){var t,e=this.trendLines;for(t=0;t<e.length;t++){var n=e[t];n.valueAxis.recalculateToPercents?n.set&&n.set.hide():(n.x=this.marginLeftReal,n.y=this.marginTopReal,n.draw())}},handleCursorValueZoom:function(){},addTrendLine:function(t){this.trendLines.push(t)},zoomOutValueAxes:function(){for(var t=this.valueAxes,e=0;e<t.length;e++)t[e].zoomOut()},removeTrendLine:function(t){var e,n=this.trendLines;for(e=n.length-1;0<=e;e--)n[e]==t&&n.splice(e,1)},adjustMargins:function(t,e){var n=t.position,r=t.scrollbarHeight+t.offset;t.enabled&&("top"==n?e?this.marginLeftReal+=r:this.marginTopReal+=r:e?this.marginRightReal+=r:this.marginBottomReal+=r)},getScrollbarPosition:function(t,e,n){var r="bottom",i="top";t.oppositeAxis||(i=r,r="top"),t.position=e?"bottom"==n||"left"==n?r:i:"top"==n||"right"==n?r:i},updateChartScrollbar:function(t,e){if(t){t.rotate=e;var n=this.marginTopReal,r=this.marginLeftReal,i=t.scrollbarHeight,o=this.dx,a=this.dy,s=t.offset;"top"==t.position?e?(t.y=n,t.x=r-i-s):(t.y=n-i+a-s,t.x=r+o):e?(t.y=n+a,t.x=r+this.plotAreaWidth+o+s):(t.y=n+this.plotAreaHeight+s,t.x=this.marginLeftReal)}},showZB:function(t){var e=this.zbSet;!t||""!==(e=this.zoomOutText)&&e&&this.drawZoomOutButton(),(e=this.zbSet)&&(this.zoomButtonSet.push(e),t?e.show():e.hide(),this.rollOutZB())},handleReleaseOutside:function(t){f.AmRectangularChart.base.handleReleaseOutside.call(this,t),(t=this.chartCursor)&&t.handleReleaseOutside&&t.handleReleaseOutside()},handleMouseDown:function(t){f.AmRectangularChart.base.handleMouseDown.call(this,t);var e=this.chartCursor;e&&e.handleMouseDown&&!this.rolledOverZB&&e.handleMouseDown(t)},update:function(){f.AmRectangularChart.base.update.call(this),this.chartCursor&&this.chartCursor.update&&this.chartCursor.update()},handleScrollbarValueZoom:function(t){this.relativeZoomValueAxes(t.target.valueAxes,t.relativeStart,t.relativeEnd),this.zoomAxesAndGraphs()},zoomValueScrollbar:function(t){if(t&&t.enabled){var e=t.valueAxes[0],n=e.relativeStart,r=e.relativeEnd;e.reversed&&(r=1-n,n=1-e.relativeEnd),t.percentZoom(n,r)}},zoomAxesAndGraphs:function(){if(!this.scrollbarOnly){var t,e=this.valueAxes;for(t=0;t<e.length;t++)e[t].zoom(this.start,this.end);for(e=this.graphs,t=0;t<e.length;t++)e[t].zoom(this.start,this.end);(t=this.chartCursor)&&t.clearSelection(),this.zoomTrendLines()}},handleValueAxisZoomReal:function(t,e){var n=t.relativeStart;if((i=t.relativeEnd)<n)var r=n,i=(n=i,r);this.relativeZoomValueAxes(e,n,i),this.updateAfterValueZoom()},updateAfterValueZoom:function(){this.zoomAxesAndGraphs(),this.zoomScrollbar()},relativeZoomValueAxes:function(t,e,n){if(this.hideBalloonReal(),e=f.fitToBounds(e,0,1),(n=f.fitToBounds(n,0,1))<e){var r=e;e=n,n=r}r=1/this.maxZoomFactor;var i=f.getDecimals(r)+4;if(n-e<r&&(e=(n=e+(n-e)/2)-r/2,1<(n+=r/2)&&(e-=n-1,n=1),e<0&&(e=0,n=r)),e=f.roundTo(e,i),n=f.roundTo(n,i),r=!1,t){for(i=0;i<t.length;i++){var o=t[i].zoomToRelativeValues(e,n,!0);o&&(r=o)}this.showZB()}return r},addChartCursor:function(t){f.callMethod("destroy",[this.chartCursor]),t&&(this.listenTo(t,"moved",this.handleCursorMove),this.listenTo(t,"zoomed",this.handleCursorZoom),this.listenTo(t,"zoomStarted",this.handleCursorZoomStarted),this.listenTo(t,"panning",this.handleCursorPanning),this.listenTo(t,"onHideCursor",this.handleCursorHide)),this.chartCursor=t},handleCursorChange:function(){},handleCursorMove:function(t){var e,n=this.valueAxes;for(e=0;e<n.length;e++)if(!t.panning){var r=n[e];r&&r.showBalloon&&r.showBalloon(t.x,t.y)}},handleCursorZoom:function(t){if(this.skipZoomed)this.skipZoomed=!1;else{var e=this.startX0,n=this.endX0,r=this.endY0,i=this.startY0,o=t.startX,a=t.endX,s=t.startY,l=t.endY;this.startX0=this.endX0=this.startY0=this.endY0=NaN,this.handleCursorZoomReal(e+o*(n-e),e+a*(n-e),i+s*(r-i),i+l*(r-i),t)}},handleCursorHide:function(){var t,e=this.valueAxes;for(t=0;t<e.length;t++)e[t].hideBalloon();for(e=this.graphs,t=0;t<e.length;t++)e[t].hideBalloonReal()}})}(),function(){var R=window.AmCharts;R.AmSerialChart=R.Class({inherits:R.AmRectangularChart,construct:function(t){this.type="serial",R.AmSerialChart.base.construct.call(this,t),this.cname="AmSerialChart",this.theme=t,this.columnSpacing=5,this.columnSpacing3D=0,this.columnWidth=.8;var e=new R.CategoryAxis(t);(e.chart=this).categoryAxis=e,this.zoomOutOnDataUpdate=!0,this.mouseWheelZoomEnabled=this.mouseWheelScrollEnabled=this.rotate=this.skipZoom=!1,this.minSelectedTime=0,R.applyTheme(this,t,this.cname)},initChart:function(){R.AmSerialChart.base.initChart.call(this),this.updateCategoryAxis(this.categoryAxis,this.rotate,"categoryAxis"),this.dataChanged?this.parseData():this.onDataUpdated(),this.drawGraphs=!0},onDataUpdated:function(){var t,e=this.countColumns(),n=this.chartData,r=this.graphs;for(t=0;t<r.length;t++){var i=r[t];i.data=n,i.columnCount=e}0<n.length&&(this.firstTime=this.getStartTime(n[0].time),this.lastTime=this.getEndTime(n[n.length-1].time)),this.drawChart(),this.autoMargins&&!this.marginsUpdated?(this.marginsUpdated=!0,this.measureMargins()):this.dispDUpd()},syncGrid:function(){if(this.synchronizeGrid){var t,e,n=this.valueAxes;if(0<n.length){var r=0;for(e=0;e<n.length;e++)r<(t=n[e]).gridCountReal&&(r=t.gridCountReal);var i=!1;for(e=0;e<n.length;e++)if((t=n[e]).gridCountReal<r){var o=(r-t.gridCountReal)/2,a=i=o;0!=o-Math.round(o)&&(i-=.5,a+=.5),0<=t.min&&t.min-i*t.step<0&&(a+=i,i=0),t.max<=0&&0<t.max+a*t.step&&(i+=a,a=0),o=R.getDecimals(t.step),t.minimum=R.roundTo(t.min-i*t.step,o),t.maximum=R.roundTo(t.max+a*t.step,o),t.setStep=t.step,i=t.strictMinMax=!0}for(i&&this.updateAfterValueZoom(),e=0;e<n.length;e++)(t=n[e]).minimum=NaN,t.maximum=NaN,t.setStep=NaN,t.strictMinMax=!1}}},handleWheelReal:function(t,e){if(!this.wheelBusy){var n=this.categoryAxis,r=n.parseDates,i=n.minDuration(),o=1,a=1;if(this.mouseWheelZoomEnabled?e||(o=-1):e&&(o=-1),l=this.chartCursor)if(l.mouseIsOver()){var s=l.mouseX,l=l.mouseY;o!=a&&(o*=s=this.rotate?l/this.plotAreaHeight:s/this.plotAreaWidth,a*=1-s),s=.05*(this.end-this.start),r&&(s=.05*(this.endTime-this.startTime)/i),s<1&&(s=1),o*=s,a*=s,r&&!n.equalSpacing||(o=Math.round(o),a=Math.round(a)),l=this.chartData.length,n=this.lastTime,s=this.firstTime,t<0?r?(l=this.endTime-this.startTime,r=this.startTime+o*i,i=this.endTime+a*i,0<a&&0<o&&n<=i&&(r=(i=n)-l),this.zoomToDates(new Date(r),new Date(i))):(0<a&&0<o&&this.end>=l-1&&(o=a=0),r=this.start+o,i=this.end+a,this.zoomToIndexes(r,i)):r?(l=this.endTime-this.startTime,r=this.startTime-o*i,i=this.endTime-a*i,0<a&&0<o&&r<=s&&(i=(r=s)+l),this.zoomToDates(new Date(r),new Date(i))):(0<a&&0<o&&this.start<1&&(o=a=0),r=this.start-o,i=this.end-a,this.zoomToIndexes(r,i))}else this.handleMouseOut()}},validateData:function(t){this.marginsUpdated=!1,this.zoomOutOnDataUpdate&&!t&&(this.endTime=this.end=this.startTime=this.start=NaN);var e=t=!1,n=!1,r=this.chartScrollbar;r&&(r.dragging&&(t=!0,r.handleDragStop()),r.resizingRight&&(n=!0,r.rightDragStop()),r.resizingLeft&&(e=!0,r.leftDragStop())),R.AmSerialChart.base.validateData.call(this),t&&r.handleDragStart(),n&&r.rightDragStart(),e&&r.leftDragStart()},drawChart:function(){if(0<this.realWidth&&0<this.realHeight){R.AmSerialChart.base.drawChart.call(this);var t=this.chartData;if(R.ifArray(t)){!(r=this.chartScrollbar)||!this.marginsUpdated&&this.autoMargins||r.draw(),(r=this.valueScrollbar)&&r.draw();var e,n,r=t.length-1;(e=this.categoryAxis).parseDates&&!e.equalSpacing?(e=this.startTime,n=this.endTime,(isNaN(e)||isNaN(n))&&(e=this.firstTime,n=this.lastTime)):(e=this.start,n=this.end,(isNaN(e)||isNaN(n))&&(n=e=NaN),isNaN(e)&&(isNaN(this.startTime)||(e=this.getClosestIndex(t,"time",this.startTime,!0,0,t.length))),isNaN(n)&&(isNaN(this.endTime)||(n=this.getClosestIndex(t,"time",this.endTime,!1,0,t.length))),(isNaN(e)||isNaN(n))&&(e=0,n=r)),this.endTime=this.startTime=this.end=this.start=void 0,this.zoom(e,n)}}else this.cleanChart()},cleanChart:function(){R.callMethod("destroy",[this.valueAxes,this.graphs,this.categoryAxis,this.chartScrollbar,this.chartCursor,this.valueScrollbar])},updateCategoryAxis:function(t,e,n){t.chart=this,t.id=n,t.rotate=e,t.setOrientation(!this.rotate),t.init(),this.setAxisRenderers(t),this.updateObjectSize(t)},updateValueAxes:function(){R.AmSerialChart.base.updateValueAxes.call(this);var t,e=this.valueAxes;for(t=0;t<e.length;t++){var n=e[t],r=this.rotate;n.rotate=r,n.setOrientation(r),(r=this.categoryAxis).startOnAxis&&!r.parseDates||(n.expandMinMax=!0)}},getStartTime:function(t){var e=this.categoryAxis;return R.resetDateToMin(new Date(t),e.minPeriod,1,e.firstDayOfWeek).getTime()},getEndTime:function(t){var e=R.extractPeriod(this.categoryAxis.minPeriod);return R.changeDate(new Date(t),e.period,e.count,!0).getTime()-1},updateMargins:function(){R.AmSerialChart.base.updateMargins.call(this);var t=this.chartScrollbar;t&&(this.getScrollbarPosition(t,this.rotate,this.categoryAxis.position),this.adjustMargins(t,this.rotate)),(t=this.valueScrollbar)&&(this.getScrollbarPosition(t,!this.rotate,this.valueAxes[0].position),this.adjustMargins(t,!this.rotate))},updateScrollbars:function(){R.AmSerialChart.base.updateScrollbars.call(this),this.updateChartScrollbar(this.chartScrollbar,this.rotate),this.updateChartScrollbar(this.valueScrollbar,!this.rotate)},zoom:function(t,e){var n=this.categoryAxis;n.parseDates&&!n.equalSpacing?(this.timeZoom(t,e),isNaN(t)&&this.zoomOutValueAxes()):this.indexZoom(t,e),(n=this.chartCursor)&&(n.pan||n.hideCursorReal()),this.updateLegendValues()},timeZoom:function(t,e){var n=this.maxSelectedTime;if(isNaN(n)||(e!=this.endTime&&n<e-t&&(t=e-n),t!=this.startTime&&n<e-t&&(e=t+n)),0<(r=this.minSelectedTime)&&e-t<r){var r,i=Math.round(t+(e-t)/2);t=i-(r=Math.round(r/2)),e=i+r}if(r=this.chartData,i=this.categoryAxis,R.ifArray(r)&&(t!=this.startTime||e!=this.endTime)){var o=i.minDuration(),a=this.firstTime,s=this.lastTime;t||(t=a,isNaN(n)||(t=s-n)),s<t&&(t=s),(e=e||s)<a&&(e=a),t<a&&(t=a),s<e&&(e=s),e<t&&(e=t+o),e-t<o/5&&(e<s?e=t+o/5:t=e-o/5),this.startTime=t,this.endTime=e,n=r.length-1,o=this.getClosestIndex(r,"time",t,!0,0,n),r=this.getClosestIndex(r,"time",e,!1,o,n),i.timeZoom(t,e),i.zoom(o,r),this.start=R.fitToBounds(o,0,n),this.end=R.fitToBounds(r,0,n),this.zoomAxesAndGraphs(),this.zoomScrollbar(),this.fixCursor(),this.showZB(),this.syncGrid(),this.updateColumnsDepth(),this.dispatchTimeZoomEvent()}},showZB:function(){var t,e=this.categoryAxis;e&&e.parseDates&&!e.equalSpacing&&(this.startTime>this.firstTime&&(t=!0),this.endTime<this.lastTime&&(t=!0)),0<this.start&&(t=!0),this.end<this.chartData.length-1&&(t=!0),(e=this.valueAxes)&&(e=e[0],isNaN(e.relativeStart)||(0!==R.roundTo(e.relativeStart,3)&&(t=!0),1!=R.roundTo(e.relativeEnd,3)&&(t=!0))),R.AmSerialChart.base.showZB.call(this,t)},updateAfterValueZoom:function(){R.AmSerialChart.base.updateAfterValueZoom.call(this),this.updateColumnsDepth()},indexZoom:function(t,e){var n=this.maxSelectedSeries,r=!1;if(isNaN(n)||(e!=this.end&&n<e-t&&(t=e-n,r=!0),t!=this.start&&n<e-t&&(e=t+n,r=!0)),(r=r&&this.chartScrollbar)&&r.dragger){var i=r.dragger.getBBox();r.maxWidth=i.width,r.maxHeight=i.height}t==this.start&&e==this.end||(r=this.chartData.length-1,isNaN(t)&&(t=0,isNaN(n)||(t=r-n)),isNaN(e)&&(e=r),e<t&&(e=t),r<e&&(e=r),r<t&&(t=r-1),t<0&&(t=0),this.start=t,this.end=e,this.categoryAxis.zoom(t,e),this.zoomAxesAndGraphs(),this.zoomScrollbar(),this.fixCursor(),0!==t||e!=this.chartData.length-1?this.showZB(!0):this.showZB(!1),this.syncGrid(),this.updateColumnsDepth(),this.dispatchIndexZoomEvent())},updateGraphs:function(){R.AmSerialChart.base.updateGraphs.call(this);var t,e=this.graphs;for(t=0;t<e.length;t++){var n=e[t];n.columnWidthReal=this.columnWidth,n.categoryAxis=this.categoryAxis,R.isString(n.fillToGraph)&&(n.fillToGraph=this.graphsById[n.fillToGraph])}},zoomAxesAndGraphs:function(){R.AmSerialChart.base.zoomAxesAndGraphs.call(this),this.updateColumnsDepth()},updateColumnsDepth:function(){if(0!==this.depth3D||0!==this.angle){var t,e,n=this.graphs;for(this.columnsArray=[],t=0;t<n.length;t++){var r,i=(e=n[t]).columnsArray;if(i)for(r=0;r<i.length;r++)this.columnsArray.push(i[r])}if(this.columnsArray.sort(this.compareDepth),n=this.columnsSet,0<this.columnsArray.length){for(i=this.container.set(),this.columnSet.push(i),t=0;t<this.columnsArray.length;t++)i.push(this.columnsArray[t].column.set);e&&i.translate(e.x,e.y),this.columnsSet=i}R.remove(n)}},compareDepth:function(t,e){return t.depth>e.depth?1:-1},zoomScrollbar:function(){var t=this.chartScrollbar,e=this.categoryAxis;if(t){if(!this.zoomedByScrollbar){var n=t.dragger;n&&n.stop()}this.zoomedByScrollbar=!1,e.parseDates&&!e.equalSpacing?t.timeZoom(this.startTime,this.endTime):t.zoom(this.start,this.end)}this.zoomValueScrollbar(this.valueScrollbar)},updateTrendLines:function(){var t,e=this.trendLines;for(t=0;t<e.length;t++){var n=e[t];n=R.processObject(n,R.TrendLine,this.theme);(e[t]=n).chart=this,n.id||(n.id="trendLineAuto"+t+"_"+(new Date).getTime()),R.isString(n.valueAxis)&&(n.valueAxis=this.getValueAxisById(n.valueAxis)),n.valueAxis||(n.valueAxis=this.valueAxes[0]),n.categoryAxis=this.categoryAxis}},validateNow:function(t,e){t&&this.zoomOutOnDataUpdate&&(this.endTime=this.end=this.startTime=this.start=NaN),R.AmSerialChart.base.validateNow.call(this,t,e)},countColumns:function(){var t,e,n,r,i=0,o=this.valueAxes.length,a=this.graphs.length,s=!1;for(r=0;r<o;r++){var l=(e=this.valueAxes[r]).stackType,u=0;if("100%"==l||"regular"==l)for(s=!1,n=0;n<a;n++)(t=this.graphs[n]).tcc=1,t.valueAxis==e&&"column"==t.type&&(!s&&t.stackable&&(i++,s=!0),(!t.stackable&&t.clustered||t.newStack&&0!==u)&&i++,t.columnIndex=i-1,t.clustered||(t.columnIndex=0),u++);if("none"==l||"3d"==l){for(u=!1,n=0;n<a;n++)(t=this.graphs[n]).valueAxis==e&&"column"==t.type&&(t.clustered?(t.tcc=1,t.newStack&&(i=0),t.hidden||(t.columnIndex=i,i++)):t.hidden||(u=!0,t.tcc=1,t.columnIndex=0));u&&0===i&&(i=1)}if("3d"==l){for(e=1,u=0;u<a;u++)(t=this.graphs[u]).newStack&&e++,t.depthCount=e,t.tcc=i;i=e}if("regular"==l||"100%"==l)for(e=10,u=0;u<a;u++)(t=this.graphs[u]).newStack&&e--,t.depthCount=e,t.tcc=i}return i},parseData:function(){R.AmSerialChart.base.parseData.call(this),this.parseSerialData(this.dataProvider)},getCategoryIndexByValue:function(t){var e,n=this.chartData;for(e=0;e<n.length;e++)if(n[e].category==t)return e},handleScrollbarZoom:function(t){this.zoomedByScrollbar=!0,this.zoom(t.start,t.end)},dispatchTimeZoomEvent:function(){if(this.drawGraphs&&(this.prevStartTime!=this.startTime||this.prevEndTime!=this.endTime)){var t={type:"zoomed"};t.startDate=new Date(this.startTime),t.endDate=new Date(this.endTime),t.startIndex=this.start,t.endIndex=this.end,this.startIndex=this.start,this.endIndex=this.end,this.startDate=t.startDate,this.endDate=t.endDate,this.prevStartTime=this.startTime,this.prevEndTime=this.endTime;var e=this.categoryAxis,n=R.extractPeriod(e.minPeriod).period;e=e.dateFormatsObject[n];t.startValue=R.formatDate(t.startDate,e,this),t.endValue=R.formatDate(t.endDate,e,this),t.chart=this,(t.target=this).fire(t)}},dispatchIndexZoomEvent:function(){if(this.drawGraphs&&(this.prevStartIndex!=this.start||this.prevEndIndex!=this.end)){this.startIndex=this.start,this.endIndex=this.end;var t=this.chartData;if(R.ifArray(t)&&!isNaN(this.start)&&!isNaN(this.end)){var e={chart:this,target:this,type:"zoomed"};e.startIndex=this.start,e.endIndex=this.end,e.startValue=t[this.start].category,e.endValue=t[this.end].category,this.categoryAxis.parseDates&&(this.startTime=t[this.start].time,this.endTime=t[this.end].time,e.startDate=new Date(this.startTime),e.endDate=new Date(this.endTime)),this.prevStartIndex=this.start,this.prevEndIndex=this.end,this.fire(e)}}},updateLegendValues:function(){this.legend&&this.legend.updateValues()},getClosestIndex:function(t,e,n,r,i,o){i<0&&(i=0),o>t.length-1&&(o=t.length-1);var a=i+Math.round((o-i)/2),s=t[a][e];return n==s?a:o-i<=1?r?i:Math.abs(t[i][e]-n)<Math.abs(t[o][e]-n)?i:o:n==s?a:n<s?this.getClosestIndex(t,e,n,r,i,a):this.getClosestIndex(t,e,n,r,a,o)},zoomToIndexes:function(t,e){var n=this.chartData;if(n){var r=n.length;0<r&&(t<0&&(t=0),r-1<e&&(e=r-1),(r=this.categoryAxis).parseDates&&!r.equalSpacing?this.zoom(n[t].time,this.getEndTime(n[e].time)):this.zoom(t,e))}},zoomToDates:function(t,e){var n=this.chartData;if(n)if(this.categoryAxis.equalSpacing){var r=this.getClosestIndex(n,"time",t.getTime(),!0,0,n.length);e=R.resetDateToMin(e,this.categoryAxis.minPeriod,1),n=this.getClosestIndex(n,"time",e.getTime(),!1,0,n.length),this.zoom(r,n)}else this.zoom(t.getTime(),e.getTime())},zoomToCategoryValues:function(t,e){this.chartData&&this.zoom(this.getCategoryIndexByValue(t),this.getCategoryIndexByValue(e))},formatPeriodString:function(t,e){if(e){e.periodDataItem={},e.periodPercentDataItem={};var n=["value","open","low","high","close"],r="value open low high close average sum count".split(" "),i=e.valueAxis,o=this.chartData,a=e.numberFormatter;a=a||this.nf;for(var s=0;s<n.length;s++){for(var l,u,h,c,d,f,p,g,v,m,y=n[s],w=0,b=0,C=0,E=0,S=this.start;S<=this.end;S++){if(N=o[S]){var O=N.axes[i.id].graphs[e.id];if(O){if(O.values){var T=O.values[y],N=N.x.categoryAxis;this.rotate?(N<0||N>O.graph.height)&&(T=NaN):(N<0||N>O.graph.width)&&(T=NaN),isNaN(T)||(isNaN(l)&&(l=T),u=T,(isNaN(h)||T<h)&&(h=T),(isNaN(c)||c<T)&&(c=T),d=R.getDecimals(w),N=R.getDecimals(T),w+=T,d=(w=R.roundTo(w,Math.max(d,N)))/++b)}O.percents&&(O=O.percents[y],!isNaN(O))&&(isNaN(f)&&(f=O),p=O,(isNaN(g)||O<g)&&(g=O),(isNaN(v)||v<O)&&(v=O),m=R.getDecimals(C),T=R.getDecimals(O),C+=O,m=(C=R.roundTo(C,Math.max(m,T)))/++E)}}}w={open:l,close:u,high:c,low:h,average:d,sum:w,count:b},C={open:f,close:p,high:v,low:g,average:m,sum:C,count:E},t=R.formatValue(t,w,r,a,y+"\\.",this.usePrefixes,this.prefixesOfSmallNumbers,this.prefixesOfBigNumbers),t=R.formatValue(t,C,r,this.pf,"percents\\."+y+"\\."),e.periodDataItem[y]=w,e.periodPercentDataItem[y]=C}}return R.cleanFromEmpty(t)},formatString:function(t,e,n){if(e){var r=e.graph;if(void 0!==t){if(-1!=t.indexOf("[[category]]")){var i=e.serialDataItem.category;if(this.categoryAxis.parseDates){var o=this.balloonDateFormat,a=this.chartCursor;a&&a.categoryBalloonDateFormat&&(o=a.categoryBalloonDateFormat),-1!=(o=R.formatDate(i,o,this)).indexOf("fff")&&(o=R.formatMilliseconds(o,i)),i=o}t=t.replace(/\[\[category\]\]/g,String(i.replace("$","$$$")))}i=(i=r.numberFormatter)||this.nf,(a=(o=e.graph.valueAxis).duration)&&!isNaN(e.values.value)&&o.maxInterval&&(a=R.formatDuration(e.values.value,a,"",o.durationUnits,o.maxInterval,i),t=t.replace(RegExp("\\[\\[value\\]\\]","g"),a)),"date"==o.type&&(o=R.formatDate(new Date(e.values.value),r.dateFormat,this),a=RegExp("\\[\\[value\\]\\]","g"),t=t.replace(a,o),o=R.formatDate(new Date(e.values.open),r.dateFormat,this),a=RegExp("\\[\\[open\\]\\]","g"),t=t.replace(a,o)),r="value open low high close total".split(" "),o=this.pf,t=R.formatValue(t,e.percents,r,o,"percents\\."),t=R.formatValue(t,e.values,r,i,"",this.usePrefixes,this.prefixesOfSmallNumbers,this.prefixesOfBigNumbers),-1!=(t=R.formatValue(t,e.values,["percents"],o)).indexOf("[[")&&(t=R.formatDataContextValue(t,e.dataContext)),-1!=t.indexOf("[[")&&e.graph.customData&&(t=R.formatDataContextValue(t,e.graph.customData)),t=R.AmSerialChart.base.formatString.call(this,t,e,n)}return t}},updateChartCursor:function(){R.AmSerialChart.base.updateChartCursor.call(this);var t=this.chartCursor,e=this.categoryAxis;if(t){var n=t.categoryBalloonAlpha,r=t.categoryBalloonColor,i=t.color;void 0===r&&(r=t.cursorColor);var o=t.valueZoomable,a=t.zoomable,s=t.valueLineEnabled;if(this.rotate?(t.vLineEnabled=s,t.hZoomEnabled=o,t.vZoomEnabled=a):(t.hLineEnabled=s,t.vZoomEnabled=o,t.hZoomEnabled=a),t.valueLineBalloonEnabled)for(s=0;s<this.valueAxes.length;s++)(a=(o=this.valueAxes[s]).balloon)||(a={}),(a=R.extend(a,this.balloon,!0)).fillColor=r,a.balloonColor=r,a.fillAlpha=n,a.borderColor=r,a.color=i,o.balloon=a;else for(a=0;a<this.valueAxes.length;a++)(o=this.valueAxes[a]).balloon&&(o.balloon=null);e&&(e.balloonTextFunction=t.categoryBalloonFunction,(t.categoryLineAxis=e).balloonText=t.categoryBalloonText,t.categoryBalloonEnabled&&((a=e.balloon)||(a={}),(a=R.extend(a,this.balloon,!0)).fillColor=r,a.balloonColor=r,a.fillAlpha=n,a.borderColor=r,a.color=i,e.balloon=a),e.balloon&&(e.balloon.enabled=t.categoryBalloonEnabled))}},addChartScrollbar:function(t){R.callMethod("destroy",[this.chartScrollbar]),t&&(t.chart=this).listenTo(t,"zoomed",this.handleScrollbarZoom),this.rotate?void 0===t.width&&(t.width=t.scrollbarHeight):void 0===t.height&&(t.height=t.scrollbarHeight),t.gridAxis=this.categoryAxis,this.chartScrollbar=t},addValueScrollbar:function(t){R.callMethod("destroy",[this.valueScrollbar]),t&&((t.chart=this).listenTo(t,"zoomed",this.handleScrollbarValueZoom),this.listenTo(t,"zoomStarted",this.handleCursorZoomStarted));var e=t.scrollbarHeight;this.rotate?void 0===t.height&&(t.height=e):void 0===t.width&&(t.width=e),t.gridAxis||(t.gridAxis=this.valueAxes[0]),t.valueAxes=this.valueAxes,this.valueScrollbar=t},removeChartScrollbar:function(){R.callMethod("destroy",[this.chartScrollbar]),this.chartScrollbar=null},removeValueScrollbar:function(){R.callMethod("destroy",[this.valueScrollbar]),this.valueScrollbar=null},handleReleaseOutside:function(t){R.AmSerialChart.base.handleReleaseOutside.call(this,t),R.callMethod("handleReleaseOutside",[this.chartScrollbar,this.valueScrollbar])},update:function(){R.AmSerialChart.base.update.call(this),this.chartScrollbar&&this.chartScrollbar.update&&this.chartScrollbar.update(),this.valueScrollbar&&this.valueScrollbar.update&&this.valueScrollbar.update()},processScrollbars:function(){R.AmSerialChart.base.processScrollbars.call(this);var t=this.valueScrollbar;t&&((t=R.processObject(t,R.ChartScrollbar,this.theme)).id="valueScrollbar",this.addValueScrollbar(t))},handleValueAxisZoom:function(t){this.handleValueAxisZoomReal(t,this.valueAxes)},zoomOut:function(){R.AmSerialChart.base.zoomOut.call(this),this.zoom(),this.syncGrid()},getNextItem:function(t){var e=t.index,n=this.chartData,r=t.graph;if(e+1<n.length)for(e+=1;e<n.length;e++)if((t=n[e])&&(t=t.axes[r.valueAxis.id].graphs[r.id],!isNaN(t.y)))return t},handleCursorZoomReal:function(t,e,n,r,i){var o,a,s=i.target;this.rotate?(isNaN(t)||isNaN(e)||this.relativeZoomValueAxes(this.valueAxes,t,e)&&this.updateAfterValueZoom(),s.vZoomEnabled&&(o=i.start,a=i.end)):(isNaN(n)||isNaN(r)||this.relativeZoomValueAxes(this.valueAxes,n,r)&&this.updateAfterValueZoom(),s.hZoomEnabled&&(o=i.start,a=i.end)),isNaN(o)||isNaN(a)||((t=this.categoryAxis).parseDates&&!t.equalSpacing?this.zoomToDates(new Date(o),new Date(a)):this.zoomToIndexes(o,a))},handleCursorZoomStarted:function(){if(t=this.valueAxes){var t,e=(t=t[0]).relativeStart,n=t.relativeEnd;t.reversed&&(e=1-t.relativeEnd,n=1-t.relativeStart),this.rotate?(this.startX0=e,this.endX0=n):(this.startY0=e,this.endY0=n)}this.categoryAxis&&(this.start0=this.start,this.end0=this.end,this.startTime0=this.startTime,this.endTime0=this.endTime)},fixCursor:function(){this.chartCursor&&this.chartCursor.fixPosition(),this.prevCursorItem=null},handleCursorMove:function(t){R.AmSerialChart.base.handleCursorMove.call(this,t);var e=t.target,n=this.categoryAxis;if(t.panning)this.handleCursorHide(t);else if(this.chartData&&!e.isHidden){var r,i=this.graphs;if(i)if(r=n.xToIndex(this.rotate?t.y:t.x),r=this.chartData[r]){var o,a,s,l;if(e.oneBalloonOnly&&e.valueBalloonsEnabled){var u=1/0;for(o=i.length-1;0<=o;o--)if((a=i[o]).balloon.enabled&&a.showBalloon&&!a.hidden){if(s=a.valueAxis.id,s=r.axes[s].graphs[a.id],e.showNextAvailable&&isNaN(s.y)&&!(s=this.getNextItem(s)))continue;s=s.y,"top"==a.showBalloonAt&&(s=0),"bottom"==a.showBalloonAt&&(s=this.height);var h=e.mouseX,c=e.mouseY;(s=this.rotate?Math.abs(h-s):Math.abs(c-s))<u&&(u=s,l=a)}e.mostCloseGraph=l}if(this.prevCursorItem!=r||l!=this.prevMostCloseGraph){for(u=[],o=0;o<i.length;o++)s=(a=i[o]).valueAxis.id,s=r.axes[s].graphs[a.id],e.showNextAvailable&&isNaN(s.y)&&!(s=this.getNextItem(s))&&a.balloon?a.balloon.hide():l&&a!=l?(a.showGraphBalloon(s,e.pointer,!1,e.graphBulletSize,e.graphBulletAlpha),a.balloon.hide(0)):e.valueBalloonsEnabled?(a.balloon.showBullet=e.bulletsEnabled,a.balloon.bulletSize=e.bulletSize/2,t.hideBalloons||(a.showGraphBalloon(s,e.pointer,!1,e.graphBulletSize,e.graphBulletAlpha),a.balloon.set&&u.push({balloon:a.balloon,y:a.balloon.pointToY}))):(a.currentDataItem=s,a.resizeBullet(s,e.graphBulletSize,e.graphBulletAlpha));e.avoidBalloonOverlapping&&this.arrangeBalloons(u),this.prevCursorItem=r}this.prevMostCloseGraph=l}i=R.fitToBounds(t.x,0,e.width),l=R.fitToBounds(t.y,0,e.height),n.showBalloon(i,l,e.categoryBalloonDateFormat,t.skip),this.updateLegendValues()}},handleCursorHide:function(t){var e;for(R.AmSerialChart.base.handleCursorHide.call(this,t),t=this.categoryAxis,this.prevCursorItem=null,this.updateLegendValues(),t&&t.hideBalloon(),t=this.graphs,e=0;e<t.length;e++)t[e].currentDataItem=null},handleCursorPanning:function(t){var e,n,r,i=t.target,o=t.deltaX,a=t.deltaY,s=t.delta2X,l=t.delta2Y;if(t=!1,this.rotate){isNaN(s)&&(s=o,t=!0);var u=(h=this.endX0)-(e=this.startX0),h=h-u*s,c=u;t||(c=0),t=R.fitToBounds(e-u*o,0,1-c)}else isNaN(l)&&(l=a,t=!0),h=this.endY0,h+=(u=h-(e=this.startY0))*a,c=u,t||(c=0),t=R.fitToBounds(e+u*l,0,1-c);e=R.fitToBounds(h,c,1),i.valueZoomable&&(n=this.relativeZoomValueAxes(this.valueAxes,t,e)),e=this.categoryAxis,this.rotate&&(o=a,s=l),t=!1,isNaN(s)&&(s=o,t=!0),i.zoomable&&(0<Math.abs(o)||0<Math.abs(s))&&(e.parseDates&&!e.equalSpacing?(l=this.startTime0,s*=e=(a=this.endTime0)-l,u=this.firstTime,h=this.lastTime,c=e,t||(c=0),t=Math.round(R.fitToBounds(l-e*o,u,h-c)),s=Math.round(R.fitToBounds(a-s,u+c,h)),this.startTime==t&&this.endTime==s||(r={chart:this,target:i,type:"zoomed",start:t,end:s},this.skipZoomed=!0,i.fire(r),this.zoom(t,s),r=!0)):(l=this.start0,e=(a=this.end0)-l,o=Math.round(e*o),s=Math.round(e*s),u=this.chartData.length-1,t||(e=0),t=R.fitToBounds(l-o,0,u-e),e=R.fitToBounds(a-s,e,u),this.start==t&&this.end==e||(this.skipZoomed=!0,i.fire({chart:this,target:i,type:"zoomed",start:t,end:e}),this.zoom(t,e),r=!0))),!r&&n&&this.updateAfterValueZoom()},arrangeBalloons:function(t){var e=this.plotAreaHeight;t.sort(this.compareY);var n,r,i,o=this.plotAreaWidth,a=t.length;for(n=0;n<a;n++)(r=t[n].balloon).setBounds(0,0,o,e),r.restorePrevious(),r.draw(),e=r.yPos-3;for(t.reverse(),n=0;n<a;n++){e=(r=t[n].balloon).bottom;var s=r.bottom-r.yPos;0<n&&e-s<i+3&&r.setBounds&&(r.setBounds(0,i+3,o,i+s+3),r.restorePrevious(),r.draw()),r.set&&r.set.show(),i=r.bottom}},compareY:function(t,e){return t.y<e.y?1:-1}})}(),function(){var B=window.AmCharts;B.Cuboid=B.Class({construct:function(t,e,n,r,i,o,a,s,l,u,h,c,d,f,p,g,v){this.set=t.set(),this.container=t,this.h=Math.round(n),this.w=Math.round(e),this.dx=r,this.dy=i,this.colors=o,this.alpha=a,this.bwidth=s,this.bcolor=l,this.balpha=u,this.dashLength=f,this.topRadius=g,this.pattern=p,this.rotate=d,this.bcn=v,d?e<0&&0===h&&(h=180):n<0&&270==h&&(h=90),this.gradientRotation=h,0===r&&0===i&&(this.cornerRadius=c),this.draw()},draw:function(){var t=this.set;t.clear();var e=this.container,n=e.chart,r=this.w,i=this.h,o=this.dx,a=this.dy,s=this.colors,l=this.alpha,u=this.bwidth,h=this.bcolor,c=this.balpha,d=this.gradientRotation,f=this.cornerRadius,p=this.dashLength,g=this.pattern,v=this.topRadius,m=this.bcn,y=s,w=s;"object"==typeof s&&(y=s[0],w=s[s.length-1]);var b,C,E,S,O,T,N,R,_,M=l;g&&(l=0);var A,k,x,I,D=this.rotate;if(0<Math.abs(o)||0<Math.abs(a))if(isNaN(v))N=w,w=B.adjustLuminosity(y,-.2),w=B.adjustLuminosity(y,-.2),b=B.polygon(e,[0,o,r+o,r,0],[0,a,a,0,0],w,l,1,h,0,d),0<c&&(_=B.line(e,[0,o,r+o],[0,a,a],h,c,u,p)),(C=B.polygon(e,[0,0,r,r,0],[0,i,i,0,0],w,l,1,h,0,d)).translate(o,a),0<c&&(E=B.line(e,[o,o],[a,a+i],h,c,u,p)),S=B.polygon(e,[0,0,o,o,0],[0,i,i+a,a,0],w,l,1,h,0,d),O=B.polygon(e,[r,r,r+o,r+o,r],[0,i,i+a,a,0],w,l,1,h,0,d),0<c&&(T=B.line(e,[r,r+o,r+o,r],[0,a,i+a,i],h,c,u,p)),w=B.adjustLuminosity(N,.2),N=B.polygon(e,[0,o,r+o,r,0],[i,i+a,i+a,i,i],w,l,1,h,0,d),0<c&&(R=B.line(e,[0,o,r+o],[i,i+a,i+a],h,c,u,p));else{var L,P,H;D?(H=L=i/2,P=r+(w=o/2),k=Math.abs(i/2),A=Math.abs(o/2)):(P=w=r/2,H=i+(L=a/2)+1,A=Math.abs(r/2),k=Math.abs(a/2)),x=A*v,I=k*v,.1<A&&.1<A&&(b=B.circle(e,A,y,l,u,h,c,!1,k)).translate(w,L),.1<x&&.1<x&&(N=B.circle(e,x,B.adjustLuminosity(y,.5),l,u,h,c,!1,I)).translate(P,H)}for(l=M,Math.abs(i)<1&&(i=0),Math.abs(r)<1&&(r=0),!isNaN(v)&&(0<Math.abs(o)||0<Math.abs(a))?(s={fill:s=[y],stroke:h,"stroke-width":u,"stroke-opacity":c,"fill-opacity":l},A=D?(l="M0,0 L"+r+","+(i/2-i/2*v),u=" B",0<r&&(u=" A"),B.VML?l=(l+=u+Math.round(r-x)+","+Math.round(i/2-I)+","+Math.round(r+x)+","+Math.round(i/2+I)+","+r+",0,"+r+","+i)+" L0,"+i+(u+Math.round(-A))+","+Math.round(i/2-k)+","+Math.round(A)+","+Math.round(i/2+k)+",0,"+i+",0,0":(l+="A"+x+","+I+",0,0,0,"+r+","+(i-i/2*(1-v))+"L0,"+i,l+="A"+A+","+k+",0,0,1,0,0"),90):(l="M0,0 L"+(u=r/2-r/2*v)+","+i,B.VML?(l="M0,0 L"+u+","+i,u=" B",i<0&&(u=" A"),l+=u+Math.round(r/2-x)+","+Math.round(i-I)+","+Math.round(r/2+x)+","+Math.round(i+I)+",0,"+i+","+r+","+i,l+=" L"+r+",0",l+=u+Math.round(r/2+A)+","+Math.round(k)+","+Math.round(r/2-A)+","+Math.round(-k)+","+r+",0,0,0"):(l+="A"+x+","+I+",0,0,0,"+(r-r/2*(1-v))+","+i+"L"+r+",0",l+="A"+A+","+k+",0,0,1,0,0"),180),(e=e.path(l).attr(s)).gradient("linearGradient",[y,B.adjustLuminosity(y,-.3),B.adjustLuminosity(y,-.3),y],A),D?e.translate(o/2,0):e.translate(0,a/2)):e=0===i?B.line(e,[0,r],[0,0],h,c,u,p):0===r?B.line(e,[0,0],[0,i],h,c,u,p):0<f?B.rect(e,r,i,s,l,u,h,c,f,d,p):B.polygon(e,[0,0,r,r,0],[0,i,i,0,0],s,l,u,h,c,d,!1,p),r=isNaN(v)?i<0?[b,_,C,E,S,O,T,N,R,e]:[N,R,C,E,S,O,b,_,T,e]:D?0<r?[b,e,N]:[N,e,b]:i<0?[b,e,N]:[N,e,b],B.setCN(n,e,m+"front"),B.setCN(n,C,m+"back"),B.setCN(n,N,m+"top"),B.setCN(n,b,m+"bottom"),B.setCN(n,S,m+"left"),B.setCN(n,O,m+"right"),b=0;b<r.length;b++)(C=r[b])&&(t.push(C),B.setCN(n,C,m+"element"));g&&e.pattern(g,NaN,n.path)},width:function(t){isNaN(t)&&(t=0),this.w=Math.round(t),this.draw()},height:function(t){isNaN(t)&&(t=0),this.h=Math.round(t),this.draw()},animateHeight:function(t,e){var n=this;n.animationFinished=!1,n.easing=e,n.totalFrames=t*B.updateRate,n.rh=n.h,n.frame=0,n.height(1),setTimeout(function(){n.updateHeight.call(n)},1e3/B.updateRate)},updateHeight:function(){var t=this;t.frame++;var e=t.totalFrames;t.frame<=e?(e=t.easing(0,t.frame,1,t.rh-1,e),t.height(e),window.requestAnimationFrame?window.requestAnimationFrame(function(){t.updateHeight.call(t)}):setTimeout(function(){t.updateHeight.call(t)},1e3/B.updateRate)):(t.height(t.rh),t.animationFinished=!0)},animateWidth:function(t,e){var n=this;n.animationFinished=!1,n.easing=e,n.totalFrames=t*B.updateRate,n.rw=n.w,n.frame=0,n.width(1),setTimeout(function(){n.updateWidth.call(n)},1e3/B.updateRate)},updateWidth:function(){var t=this;t.frame++;var e=t.totalFrames;t.frame<=e?(e=t.easing(0,t.frame,1,t.rw-1,e),t.width(e),window.requestAnimationFrame?window.requestAnimationFrame(function(){t.updateWidth.call(t)}):setTimeout(function(){t.updateWidth.call(t)},1e3/B.updateRate)):(t.width(t.rw),t.animationFinished=!0)}})}(),function(){var N=window.AmCharts;N.CategoryAxis=N.Class({inherits:N.AxisBase,construct:function(t){this.cname="CategoryAxis",N.CategoryAxis.base.construct.call(this,t),this.minPeriod="DD",this.equalSpacing=this.parseDates=!1,this.position="bottom",this.startOnAxis=!1,this.gridPosition="middle",this.safeDistance=30,this.stickBalloonToCategory=!1,N.applyTheme(this,t,this.cname)},draw:function(){N.CategoryAxis.base.draw.call(this),this.generateDFObject();var t=this.chart.chartData;if(this.data=t,this.labelRotationR=this.labelRotation,this.type=null,N.ifArray(t)){var e,n=this.chart;"scrollbar"!=this.id?(N.setCN(n,this.set,"category-axis"),N.setCN(n,this.labelsSet,"category-axis"),N.setCN(n,this.axisLine.axisSet,"category-axis")):this.bcn=this.id+"-";var r,i,o,a,s,l,u=this.start,h=this.labelFrequency,c=0,d=this.end-u+1,f=this.gridCountR,p=this.showFirstLabel,g=this.showLastLabel,v="",m=(v=N.extractPeriod(this.minPeriod),N.getPeriodDuration(v.period,v.count)),y=this.rotate,w=this.firstDayOfWeek,b=this.boldPeriodBeginning;e=N.resetDateToMin(new Date(t[t.length-1].time+1.05*m),this.minPeriod,1,w).getTime(),this.firstTime=n.firstTime,this.endTime>e&&(this.endTime=e),l=this.minorGridEnabled,o=this.gridAlpha;var C=0,E=0;if(this.widthField)for(e=this.start;e<=this.end;e++)if(s=this.data[e]){var S=Number(this.data[e].dataContext[this.widthField]);isNaN(S)||(C+=S,s.widthValue=S)}if(this.parseDates&&!this.equalSpacing)this.lastTime=t[t.length-1].time,this.maxTime=N.resetDateToMin(new Date(this.lastTime+1.05*m),this.minPeriod,1,w).getTime(),this.timeDifference=this.endTime-this.startTime,this.parseDatesDraw();else if(this.parseDates){if(this.parseDates&&this.equalSpacing){if(c=this.start,this.startTime=this.data[this.start].time,this.endTime=this.data[this.end].time,this.timeDifference=this.endTime-this.startTime,h=(e=this.choosePeriod(0)).period,i=e.count,(e=N.getPeriodDuration(h,i))<m&&(h=v.period,i=v.count,e=m),"WW"==(o=h)&&(o="DD"),this.currentDateFormat=this.dateFormatsObject[o],this.stepWidth=this.getStepWidth(d),f=Math.ceil(this.timeDifference/e)+1,v=N.resetDateToMin(new Date(this.startTime-e),h,i,w).getTime(),this.cellWidth=this.getStepWidth(d),u=-1,(d=Math.round(v/e))/2==Math.round(d/2)&&(u=-2,v-=e),(d=this.start)/2==Math.round(d/2)&&d--,d<0&&(d=0),(E=this.end+2)>=this.data.length&&(E=this.data.length),t=!1,t=!p,this.previousPos=-1e3,20<this.labelRotationR&&(this.safeDistance=5),S=d,this.data[d].time!=N.resetDateToMin(new Date(this.data[d].time),h,i,w).getTime()){m=0;var O=v;for(e=d;e<E;e++)s=this.data[e].time,this.checkPeriodChange(h,i,s,O)&&(2<=++m&&(S=e,e=E),O=s)}if(l&&1<i&&(s=this.chooseMinorFrequency(i),N.getPeriodDuration(h,s)),0<this.gridCountR)for(e=d;e<E;e++)s=this.data[e].time,this.checkPeriodChange(h,i,s,v)&&S<=e&&(d=this.getCoordinate(e-this.start),l=!1,this.nextPeriod[o]&&(l=this.checkPeriodChange(this.nextPeriod[o],1,s,v,o))&&N.resetDateToMin(new Date(s),this.nextPeriod[o],1,w).getTime()!=s&&(l=!1),m=!1,l&&this.markPeriodChange?(l=this.dateFormatsObject[this.nextPeriod[o]],m=!0):l=this.dateFormatsObject[o],v=N.formatDate(new Date(s),l,n),(e==u&&!p||e==f&&!g)&&(v=" "),t?t=!1:(b||(m=!1),d-this.previousPos>this.safeDistance*Math.cos(this.labelRotationR*Math.PI/180)&&(this.labelFunction&&(v=this.labelFunction(v,new Date(s),this,h,i,a)),this.boldLabels&&(m=!0),l=(r=new this.axisItemRenderer(this,d,v,void 0,void 0,void 0,void 0,m)).graphics(),this.pushAxisItem(r),l=l.getBBox().width,N.isModern||(l-=d),this.previousPos=d+l)),a=v=s)}}else if(this.cellWidth=this.getStepWidth(d),d<f&&(f=d),c+=this.start,this.stepWidth=this.getStepWidth(d),0<f)for(w=Math.floor(d/f),s=this.chooseMinorFrequency(w),(d=c)/2==Math.round(d/2)&&d--,d<0&&(d=0),b=0,this.widthField&&(d=this.start,w=1),this.end-d+1>=this.autoRotateCount&&(this.labelRotationR=this.autoRotateAngle),e=d;e<=this.end+2;e++){if(f=!1,0<=e&&e<this.data.length?(v=(i=this.data[e]).category,f=i.forceShow):v="",l&&!isNaN(s)){if(e/s!=Math.round(e/s)&&!f)continue;e/w==Math.round(e/w)||f||(this.gridAlpha=this.minorGridAlpha,v=void 0)}else if(e/w!=Math.round(e/w)&&!f)continue;d=this.getCoordinate(e-c),f=0,"start"==this.gridPosition&&(d-=this.cellWidth/2,f=this.cellWidth/2),r=!0,a=f,"start"==this.tickPosition&&(r=!1,f=a=0),(e==u&&!p||e==this.end&&!g)&&(v=void 0),Math.round(b/h)!=b/h&&(v=void 0),b++,t=this.cellWidth,y&&(t=NaN,this.ignoreAxisWidth||!n.autoMargins)&&(t="right"==this.position?n.marginRight-this.titleWidth:n.marginLeft-this.titleWidth,t-=this.tickLength+10),this.labelFunction&&i&&(v=this.labelFunction(v,i,this)),v=N.fixBrakes(v),m=!1,this.boldLabels&&(m=!0),e>this.end&&"start"==this.tickPosition&&(v=" "),this.rotate&&this.inside&&(f-=2),isNaN(i.widthValue)||(i.percentWidthValue=i.widthValue/C*100,d=E,E+=t=this.rotate?this.height*i.widthValue/C:this.width*i.widthValue/C,a=f=t/2),(r=new this.axisItemRenderer(this,d,v,r,t,f,void 0,m,a,!1,i.labelColor,i.className)).serialDataItem=i,this.pushAxisItem(r),this.gridAlpha=o}for(e=p=0;e<this.data.length;e++)(s=this.data[e])&&(g=this.parseDates&&!this.equalSpacing?(g=s.time,u=this.cellWidth,"MM"==this.minPeriod&&(u=864e5*N.daysInMonth(new Date(g))*this.stepWidth,s.cellWidth=u),Math.round((g-this.startTime)*this.stepWidth+u/2)):this.getCoordinate(e-c),s.x[this.id]=g);if(this.widthField)for(e=this.start;e<=this.end;e++)u=(s=this.data[e]).widthValue,s.percentWidthValue=u/C*100,p=this.rotate?(g=this.height*u/C/2+p,this.height*u/C+p):(g=this.width*u/C/2+p,this.width*u/C+p),s.x[this.id]=g;for(C=this.guides.length,e=0;e<C;e++)w=w=w=l=u=NaN,g=(p=this.guides[e]).above,p.toCategory&&(w=n.getCategoryIndexByValue(p.toCategory),isNaN(w)||(u=this.getCoordinate(w-c),p.expand&&(u+=this.cellWidth/2),r=new this.axisItemRenderer(this,u,"",!0,NaN,NaN,p),this.pushAxisItem(r,g))),p.category&&(w=n.getCategoryIndexByValue(p.category),isNaN(w)||(l=this.getCoordinate(w-c),p.expand&&(l-=this.cellWidth/2),w=(u-l)/2,r=new this.axisItemRenderer(this,l,p.label,!0,NaN,w,p),this.pushAxisItem(r,g))),b=n.dataDateFormat,p.toDate&&(!b||p.toDate instanceof Date||(p.toDate=p.toDate.toString()+" |"),p.toDate=N.getDate(p.toDate,b),this.equalSpacing?(w=n.getClosestIndex(this.data,"time",p.toDate.getTime(),!1,0,this.data.length-1),isNaN(w)||(u=this.getCoordinate(w-c))):u=(p.toDate.getTime()-this.startTime)*this.stepWidth,r=new this.axisItemRenderer(this,u,"",!0,NaN,NaN,p),this.pushAxisItem(r,g)),p.date&&(!b||p.date instanceof Date||(p.date=p.date.toString()+" |"),p.date=N.getDate(p.date,b),this.equalSpacing?(w=n.getClosestIndex(this.data,"time",p.date.getTime(),!1,0,this.data.length-1),isNaN(w)||(l=this.getCoordinate(w-c))):l=(p.date.getTime()-this.startTime)*this.stepWidth,w=(u-l)/2,r=!0,p.toDate&&(r=!1),r="H"==this.orientation?new this.axisItemRenderer(this,l,p.label,r,2*w,NaN,p):new this.axisItemRenderer(this,l,p.label,!1,NaN,w,p),this.pushAxisItem(r,g)),r&&(w=r.label)&&this.addEventListeners(w,p),(0<u||0<l)&&(w=!1,this.rotate?(u<this.height||l<this.height)&&(w=!0):(u<this.width||l<this.width)&&(w=!0),w&&(l=(u=new this.guideFillRenderer(this,l,u,p)).graphics(),this.pushAxisItem(u,g),(p.graphics=l).index=e,this.addEventListeners(l,p)));(n=n.chartCursor)&&(y?n.fixHeight(this.cellWidth):(n.fixWidth(this.cellWidth),n.fullWidth&&this.balloon&&(this.balloon.minWidth=this.cellWidth))),this.previousHeight=T}this.axisCreated=!0,this.set.translate(this.x,this.y),this.labelsSet.translate(this.x,this.y),this.labelsSet.show(),this.positionTitle(),(y=this.axisLine.set)&&y.toFront();var T=this.getBBox().height;2<T-this.previousHeight&&this.autoWrap&&!this.parseDates&&(this.axisCreated=this.chart.marginsUpdated=!1)},xToIndex:function(t){var e,n,r=this.data,i=this.chart,o=i.rotate,a=this.stepWidth;if(this.parseDates&&!this.equalSpacing)t=this.startTime+Math.round(t/a)-this.minDuration()/2,e=i.getClosestIndex(r,"time",t,!1,this.start,this.end+1);else if(this.widthField)for(i=1/0,a=this.start;a<=this.end;a++){var s=this.data[a];s&&((s=Math.abs(s.x[this.id]-t))<i&&(i=s,e=a))}else this.startOnAxis||(t-=a/2),e=this.start+Math.round(t/a);return r[e=N.fitToBounds(e,0,r.length-1)]&&(n=r[e].x[this.id]),o?n>this.height+1&&e--:n>this.width+1&&e--,n<0&&e++,N.fitToBounds(e,0,r.length-1)},dateToCoordinate:function(t){return this.parseDates&&!this.equalSpacing?(t.getTime()-this.startTime)*this.stepWidth:this.parseDates&&this.equalSpacing?(t=this.chart.getClosestIndex(this.data,"time",t.getTime(),!1,0,this.data.length-1),this.getCoordinate(t-this.start)):NaN},categoryToCoordinate:function(t){return this.chart?this.parseDates?this.dateToCoordinate(new Date(t)):(t=this.chart.getCategoryIndexByValue(t),isNaN(t)?void 0:this.getCoordinate(t-this.start)):NaN},coordinateToDate:function(t){return this.equalSpacing?(t=this.xToIndex(t),new Date(this.data[t].time)):new Date(this.startTime+t/this.stepWidth)},coordinateToValue:function(t){if(t=this.xToIndex(t),t=this.data[t])return this.parseDates?t.time:t.category},getCoordinate:function(t){return t*=this.stepWidth,this.startOnAxis||(t+=this.stepWidth/2),Math.round(t)},formatValue:function(t,e){return e=e||this.currentDateFormat,this.parseDates&&(t=N.formatDate(new Date(t),e,this.chart)),t},showBalloonAt:function(t,e){return void 0===e&&(e=this.parseDates?this.dateToCoordinate(new Date(t)):this.categoryToCoordinate(t)),this.adjustBalloonCoordinate(e)},formatBalloonText:function(t,e,n){var r="",i="",o=this.chart,a=this.data[e];if(a)if(this.parseDates)r=N.formatDate(a.category,n,o),e=N.changeDate(new Date(a.category),this.minPeriod,1),i=N.formatDate(e,n,o),-1!=r.indexOf("fff")&&(r=N.formatMilliseconds(r,a.category),i=N.formatMilliseconds(i,e));else{var s;this.data[e+1]&&(s=this.data[e+1]),r=N.fixNewLines(a.category),s&&(i=N.fixNewLines(s.category))}return(t=t.replace(/\[\[category\]\]/g,String(r))).replace(/\[\[toCategory\]\]/g,String(i))},adjustBalloonCoordinate:function(t,e){var n=this.xToIndex(t),r=this.chart.chartCursor;if(this.stickBalloonToCategory){var i=this.data[n];i&&(t=i.x[this.id]),this.stickBalloonToStart&&(t-=this.cellWidth/2);var o=0;if(r){var a=r.limitToGraph;if(a){var s=a.valueAxis.id;a.hidden||(o=i.axes[s].graphs[a.id].y)}this.rotate?("left"==this.position?(a&&(o-=r.width),0<o&&(o=0)):o<0&&(o=0),r.fixHLine(t,o)):("top"==this.position?(a&&(o-=r.height),0<o&&(o=0)):o<0&&(o=0),r.fullWidth&&(t+=1),r.fixVLine(t,o))}}return r&&!e&&(r.setIndex(n),this.parseDates&&r.setTimestamp(this.coordinateToDate(t).getTime())),t}})}(),function(){var l=window.AmCharts;l.AmSlicedChart=l.Class({inherits:l.AmChart,construct:function(t){this.createEvents("rollOverSlice","rollOutSlice","clickSlice","pullOutSlice","pullInSlice","rightClickSlice"),l.AmSlicedChart.base.construct.call(this,t),this.colors="#FF0F00 #FF6600 #FF9E01 #FCD202 #F8FF01 #B0DE09 #04D215 #0D8ECF #0D52D1 #2A0CD0 #8A0CCF #CD0D74 #754DEB #DDDDDD #999999 #333333 #000000 #57032A #CA9726 #990000 #4B0C25".split(" "),this.alpha=1,this.groupPercent=0,this.groupedTitle="Other",this.groupedPulled=!1,this.groupedAlpha=1,this.marginLeft=0,this.marginBottom=this.marginTop=10,this.marginRight=0,this.hoverAlpha=1,this.outlineColor="#FFFFFF",this.outlineAlpha=0,this.outlineThickness=1,this.startAlpha=0,this.startDuration=1,this.startEffect="bounce",this.sequencedAnimation=!0,this.pullOutDuration=1,this.pullOutEffect="bounce",this.pullOnHover=this.pullOutOnlyOne=!1,this.labelsEnabled=!0,this.labelTickColor="#000000",this.labelTickAlpha=.2,this.hideLabelsPercent=0,this.urlTarget="_self",this.autoMarginOffset=10,this.gradientRatio=[],this.maxLabelWidth=200,this.accessibleLabel="[[title]]: [[percents]]% [[value]] [[description]]",l.applyTheme(this,t,"AmSlicedChart")},initChart:function(){l.AmSlicedChart.base.initChart.call(this),this.dataChanged&&(this.parseData(),this.dispatchDataUpdated=!0,this.dataChanged=!1,this.setLegendData(this.chartData)),this.drawChart()},handleLegendEvent:function(t){var e=t.type,n=t.dataItem,r=this.legend;if(n.wedge&&n){var i=n.hidden;switch(t=t.event,e){case"clickMarker":i||r.switchable||this.clickSlice(n,t);break;case"clickLabel":i||this.clickSlice(n,t,!1);break;case"rollOverItem":i||this.rollOverSlice(n,!1,t);break;case"rollOutItem":i||this.rollOutSlice(n,t);break;case"hideItem":this.hideSlice(n,t);break;case"showItem":this.showSlice(n,t)}}},invalidateVisibility:function(){this.recalculatePercents(),this.initChart();var t=this.legend;t&&t.invalidateSize()},addEventListeners:function(t,e){var n=this;t.mouseover(function(t){n.rollOverSlice(e,!0,t)}).mouseout(function(t){n.rollOutSlice(e,t)}).touchend(function(t){n.rollOverSlice(e,t)}).mouseup(function(t){n.clickSlice(e,t)}).contextmenu(function(t){n.handleRightClick(e,t)}).focus(function(t){n.rollOverSlice(e,t)}).blur(function(t){n.rollOutSlice(e,t)})},formatString:function(t,e,n){t=l.formatValue(t,e,["value"],this.nf,"",this.usePrefixes,this.prefixesOfSmallNumbers,this.prefixesOfBigNumbers);var r=this.pf.precision;return isNaN(this.tempPrec)||(this.pf.precision=this.tempPrec),t=l.formatValue(t,e,["percents"],this.pf),t=l.massReplace(t,{"[[title]]":e.title,"[[description]]":e.description}),this.pf.precision=r,-1!=t.indexOf("[[")&&(t=l.formatDataContextValue(t,e.dataContext)),t=n?l.fixNewLines(t):l.fixBrakes(t),l.cleanFromEmpty(t)},startSlices:function(){var t;for(t=0;t<this.chartData.length;t++)0<this.startDuration&&this.sequencedAnimation?this.setStartTO(t):this.startSlice(this.chartData[t])},setStartTO:function(t){var e=this;t=setTimeout(function(){e.startSequenced.call(e)},e.startDuration/e.chartData.length*500*t),e.timeOuts.push(t)},pullSlices:function(t){var e,n=this.chartData;for(e=0;e<n.length;e++){var r=n[e];r.pulled&&this.pullSlice(r,1,t)}},startSequenced:function(){var t,e=this.chartData;for(t=0;t<e.length;t++)if(!e[t].started){this.startSlice(this.chartData[t]);break}},startSlice:function(t){t.started=!0;var e=t.wedge,n=this.startDuration,r=t.labelSet;e&&0<n&&(0<t.alpha&&e.show(),e.translate(t.startX,t.startY),this.animatable.push(e),e.animate({opacity:1,translate:"0,0"},n,this.startEffect)),r&&0<n&&(0<t.alpha&&r.show(),r.translate(t.startX,t.startY),r.animate({opacity:1,translate:"0,0"},n,this.startEffect))},showLabels:function(){var t,e=this.chartData;for(t=0;t<e.length;t++){var n=e[t];if(0<n.alpha){var r=n.label;r&&r.show(),(n=n.tick)&&n.show()}}},showSlice:function(t){isNaN(t)?t.hidden=!1:this.chartData[t].hidden=!1,this.invalidateVisibility()},hideSlice:function(t){isNaN(t)?t.hidden=!0:this.chartData[t].hidden=!0,this.hideBalloon(),this.invalidateVisibility()},rollOverSlice:function(t,e,n){if(isNaN(t)||(t=this.chartData[t]),clearTimeout(this.hoverInt),!t.hidden){this.pullOnHover&&this.pullSlice(t,1),this.hoverAlpha<1&&t.wedge&&t.wedge.attr({opacity:this.hoverAlpha});var r=t.balloonX,i=t.balloonY;t.pulled&&(r+=t.pullX,i+=t.pullY);var o=this.formatString(this.balloonText,t,!0),a=this.balloonFunction;a&&(o=a(t,o)),a=l.adjustLuminosity(t.color,-.15),o?this.showBalloon(o,a,e,r,i):this.hideBalloon(),0===t.value&&this.hideBalloon(),this.fire({type:"rollOverSlice",dataItem:t,chart:this,event:n})}},rollOutSlice:function(t,e){isNaN(t)||(t=this.chartData[t]),t.wedge&&t.wedge.attr({opacity:1}),this.hideBalloon(),this.fire({type:"rollOutSlice",dataItem:t,chart:this,event:e})},clickSlice:function(t,e,n){this.checkTouchDuration(e)&&(isNaN(t)||(t=this.chartData[t]),t.pulled?this.pullSlice(t,0):this.pullSlice(t,1),l.getURL(t.url,this.urlTarget),n||this.fire({type:"clickSlice",dataItem:t,chart:this,event:e}))},handleRightClick:function(t,e){isNaN(t)||(t=this.chartData[t]),this.fire({type:"rightClickSlice",dataItem:t,chart:this,event:e})},drawTicks:function(){var t,e=this.chartData;for(t=0;t<e.length;t++){var n=e[t];if(n.label&&!n.skipTick){var r=n.ty;r=l.line(this.container,[n.tx0,n.tx,n.tx2],[n.ty0,r,r],this.labelTickColor,this.labelTickAlpha);l.setCN(this,r,this.type+"-tick"),l.setCN(this,r,n.className,!0),n.tick=r,n.wedge.push(r),"AmFunnelChart"==this.cname&&r.toBack()}}},initialStart:function(){var t=this,e=t.startDuration,n=setTimeout(function(){t.showLabels.call(t)},1e3*e);t.timeOuts.push(n),t.chartCreated?t.pullSlices(!0):(t.startSlices(),0<e?(e=setTimeout(function(){t.pullSlices.call(t)},1200*e),t.timeOuts.push(e)):t.pullSlices(!0))},pullSlice:function(t,e,n){var r=this.pullOutDuration;!0===n&&(r=0),(n=t.wedge)&&(0<r?(n.animate({translate:e*t.pullX+","+e*t.pullY},r,this.pullOutEffect),t.labelSet&&t.labelSet.animate({translate:e*t.pullX+","+e*t.pullY},r,this.pullOutEffect)):(t.labelSet&&t.labelSet.translate(e*t.pullX,e*t.pullY),n.translate(e*t.pullX,e*t.pullY))),t=1==e?(t.pulled=!0,this.pullOutOnlyOne&&this.pullInAll(t.index),{type:"pullOutSlice",dataItem:t,chart:this}):(t.pulled=!1,{type:"pullInSlice",dataItem:t,chart:this}),this.fire(t)},pullInAll:function(t){var e,n=this.chartData;for(e=0;e<this.chartData.length;e++)e!=t&&n[e].pulled&&this.pullSlice(n[e],0)},pullOutAll:function(){var t,e=this.chartData;for(t=0;t<e.length;t++)e[t].pulled||this.pullSlice(e[t],1)},parseData:function(){var t=[];this.chartData=t;var e=this.dataProvider;if(isNaN(this.pieAlpha)||(this.alpha=this.pieAlpha),void 0!==e){var n,r,i,o=e.length,a=0;for(n=0;n<o;n++){r={};var s=e[n];null!==(r.dataContext=s)[this.valueField]&&(r.value=Number(s[this.valueField])),(i=s[this.titleField])||(i=""),r.title=i,r.pulled=l.toBoolean(s[this.pulledField],!1),(i=s[this.descriptionField])||(i=""),r.description=i,r.labelRadius=Number(s[this.labelRadiusField]),r.switchable=!0,r.className=s[this.classNameField],r.url=s[this.urlField],!(i=s[this.patternField])&&this.patterns&&(i=this.patterns[n]),r.pattern=i,r.visibleInLegend=l.toBoolean(s[this.visibleInLegendField],!0),i=s[this.alphaField],r.alpha=void 0!==i?Number(i):this.alpha,void 0!==(i=s[this.colorField])&&(r.color=i),r.labelColor=l.toColor(s[this.labelColorField]),a+=r.value,r.hidden=!1,t[n]=r}for(n=e=0;n<o;n++)(r=t[n]).percents=r.value/a*100,r.percents<this.groupPercent&&e++;for(1<e&&(this.groupValue=0,this.removeSmallSlices(),t.push({title:this.groupedTitle,value:this.groupValue,percents:this.groupValue/a*100,pulled:this.groupedPulled,color:this.groupedColor,url:this.groupedUrl,description:this.groupedDescription,alpha:this.groupedAlpha,pattern:this.groupedPattern,className:this.groupedClassName,dataContext:{}})),o=(o=this.baseColor)||this.pieBaseColor,a=(a=this.brightnessStep)||this.pieBrightnessStep,n=0;n<t.length;n++)o?i=l.adjustLuminosity(o,n*a/100):void 0===(i=this.colors[n])&&(i=l.randomColor()),void 0===t[n].color&&(t[n].color=i);this.recalculatePercents()}},recalculatePercents:function(){var t,e,n=this.chartData,r=0;for(t=0;t<n.length;t++)!(e=n[t]).hidden&&0<e.value&&(r+=e.value);for(t=0;t<n.length;t++)(e=this.chartData[t]).percents=!e.hidden&&0<e.value?100*e.value/r:0},removeSmallSlices:function(){var t,e=this.chartData;for(t=e.length-1;0<=t;t--)e[t].percents<this.groupPercent&&(this.groupValue+=e[t].value,e.splice(t,1))},animateAgain:function(){var t=this;t.startSlices();for(var e=0;e<t.chartData.length;e++){var n=t.chartData[e];n.started=!1;var r=n.wedge;r&&(r.setAttr("opacity",t.startAlpha),r.translate(n.startX,n.startY)),(r=n.labelSet)&&(r.setAttr("opacity",t.startAlpha),r.translate(n.startX,n.startY))}0<(e=t.startDuration)?(e=setTimeout(function(){t.pullSlices.call(t)},1200*e),t.timeOuts.push(e)):t.pullSlices()},measureMaxLabel:function(){var t,e=this.chartData,n=0;for(t=0;t<e.length;t++){var r=e[t],i=this.formatString(this.labelText,r),o=this.labelFunction;o&&(i=o(r,i)),n<(i=(r=l.text(this.container,i,this.color,this.fontFamily,this.fontSize)).getBBox().width)&&(n=i),r.remove()}return n}})}(),function(){var N=window.AmCharts;N.AmPieChart=N.Class({inherits:N.AmSlicedChart,construct:function(t){this.type="pie",N.AmPieChart.base.construct.call(this,t),this.cname="AmPieChart",this.pieBrightnessStep=30,this.minRadius=10,this.depth3D=0,this.startAngle=90,this.angle=this.innerRadius=0,this.startRadius="500%",this.pullOutRadius="20%",this.labelRadius=20,this.labelText="[[title]]: [[percents]]%",this.balloonText="[[title]]: [[percents]]% ([[value]])\n[[description]]",this.previousScale=1,this.adjustPrecision=!1,this.gradientType="radial",N.applyTheme(this,t,this.cname)},drawChart:function(){N.AmPieChart.base.drawChart.call(this);var t=this.chartData;if(N.ifArray(t)){if(0<this.realWidth&&0<this.realHeight){N.VML&&(this.startAlpha=1);var e=this.startDuration,n=this.container,r=this.updateWidth();this.realWidth=r;var i=this.updateHeight();this.realHeight=i;var o,a,s,l=N.toCoordinate,u=l(this.marginLeft,r),h=l(this.marginRight,r),c=l(this.marginTop,i)+this.getTitleHeight(),d=l(this.marginBottom,i)+this.depth3D,f=N.toNumber(this.labelRadius);for((v=this.measureMaxLabel())>this.maxLabelWidth&&(v=this.maxLabelWidth),this.labelText&&this.labelsEnabled||(f=v=0),o=void 0===this.pieX?(r-u-h)/2+u:l(this.pieX,this.realWidth),a=void 0===this.pieY?(i-c-d)/2+c:l(this.pieY,i),(s=l(this.radius,r,i))||(r=0<=f?r-u-h-2*v:r-u-h,i=i-c-d,s=Math.min(r,i),i<r&&(r<(s/=1-this.angle/90)&&(s=r)),i=N.toCoordinate(this.pullOutRadius,s),s=(0<=f?s-1.8*(f+i):s-1.8*i)/2),s<this.minRadius&&(s=this.minRadius),i=l(this.pullOutRadius,s),c=N.toCoordinate(this.startRadius,s),s<=(l=l(this.innerRadius,s))&&(l=s-1),d=N.fitToBounds(this.startAngle,0,360),0<this.depth3D&&(d=270<=d?270:90),360<(d-=90)&&(d-=360),r=s-s*this.angle/90,u=v=0;u<t.length;u++)!0!==(h=t[u]).hidden&&(v+=N.roundTo(h.percents,this.pf.precision));v=N.roundTo(v,this.pf.precision),this.tempPrec=NaN,this.adjustPrecision&&100!=v&&(this.tempPrec=this.pf.precision+1);var p;for(u=0;u<t.length;u++)if(!0!==(h=t[u]).hidden&&(this.showZeroSlices||0!==h.percents)){var g=360*h.percents/100,v=Math.sin((d+g/2)/180*Math.PI),m=r/s*-Math.cos((d+g/2)/180*Math.PI),y=this.outlineColor;y=y||h.color;var w=this.alpha;if(isNaN(h.alpha)||(w=h.alpha),y={fill:h.color,stroke:y,"stroke-width":this.outlineThickness,"stroke-opacity":this.outlineAlpha,"fill-opacity":w},h.url&&(y.cursor="pointer"),y=N.wedge(n,o,a,d,g,s,r,l,this.depth3D,y,this.gradientRatio,h.pattern,this.path,this.gradientType),N.setCN(this,y,"pie-item"),N.setCN(this,y.wedge,"pie-slice"),N.setCN(this,y,h.className,!0),this.addEventListeners(y,h),h.startAngle=d,t[u].wedge=y,0<e&&(this.chartCreated||y.setAttr("opacity",this.startAlpha)),h.ix=v,h.iy=m,h.wedge=y,h.index=u,h.label=null,w=n.set(),this.labelsEnabled&&this.labelText&&h.percents>=this.hideLabelsPercent){var b=d+g/2;b<0&&(b+=360),360<b&&(b-=360);var C=f;isNaN(h.labelRadius)||(C=h.labelRadius)<0&&(h.skipTick=!0);g=o+v*(s+C);var E,S,O=a+m*(s+C),T=0;if(isNaN(p)&&350<b&&1<t.length-u&&(p=u-1+Math.floor((t.length-u)/2)),0<=C)b<=90&&0<=b?(S=0,E="start",T=8):90<=b&&b<180?(S=1,E="start",T=8):180<=b&&b<270?(S=2,E="end",T=-8):270<=b&&b<=354?(S=3,E="end",T=-8):354<=b&&(T=p<u?(S=0,E="start",8):(S=3,E="end",-8)),h.labelQuarter=S;else E="middle";b=this.formatString(this.labelText,h),(C=this.labelFunction)&&(b=C(h,b)),C=(C=h.labelColor)||this.color,""!==b&&(b=N.wrappedText(n,b,C,this.fontFamily,this.fontSize,E,!1,this.maxLabelWidth),N.setCN(this,b,"pie-label"),N.setCN(this,b,h.className,!0),b.translate(g+1.5*T,O),f<0&&(b.node.style.pointerEvents="none"),b.node.style.cursor="default",h.ty=O,h.textX=g+1.5*T,w.push(b),this.axesSet.push(w),h.labelSet=w,h.label=b,this.addEventListeners(w,h)),h.tx=g,h.tx2=g+T,h.tx0=o+v*s,h.ty0=a+m*s}g=l+(s-l)/2,h.pulled&&(g+=i),this.accessible&&this.accessibleLabel&&(O=this.formatString(this.accessibleLabel,h),this.makeAccessible(y,O)),void 0!==this.tabIndex&&y.setAttr("tabindex",this.tabIndex),h.balloonX=v*g+o,h.balloonY=m*g+a,h.startX=Math.round(v*c),h.startY=Math.round(m*c),h.pullX=Math.round(v*i),h.pullY=Math.round(m*i),this.graphsSet.push(y),(0===h.alpha||0<e&&!this.chartCreated)&&(y.hide(),w&&w.hide()),360<(d+=360*h.percents/100)&&(d-=360)}0<f&&this.arrangeLabels(),this.pieXReal=o,this.pieYReal=a,this.radiusReal=s,this.innerRadiusReal=l,0<f&&this.drawTicks(),this.initialStart(),this.setDepths()}(t=this.legend)&&t.invalidateSize()}else this.cleanChart();this.dispDUpd()},setDepths:function(){var t,e=this.chartData;for(t=0;t<e.length;t++){var n,r=(n=e[t]).wedge;0<=(n=n.startAngle)&&n<180?r.toFront():180<=n&&r.toBack()}},arrangeLabels:function(){var t,e,n=this.chartData,r=n.length;for(e=r-1;0<=e;e--)0!==(t=n[e]).labelQuarter||t.hidden||this.checkOverlapping(e,t,0,!0,0);for(e=0;e<r;e++)1!=(t=n[e]).labelQuarter||t.hidden||this.checkOverlapping(e,t,1,!1,0);for(e=r-1;0<=e;e--)2!=(t=n[e]).labelQuarter||t.hidden||this.checkOverlapping(e,t,2,!0,0);for(e=0;e<r;e++)3!=(t=n[e]).labelQuarter||t.hidden||this.checkOverlapping(e,t,3,!1,0)},checkOverlapping:function(t,e,n,r,i){var o,a,s=this.chartData,l=s.length,u=e.label;if(u){if(!0===r)for(a=t+1;a<l;a++)s[a].labelQuarter==n&&(o=this.checkOverlappingReal(e,s[a],n))&&(a=l);else for(a=t-1;0<=a;a--)s[a].labelQuarter==n&&(o=this.checkOverlappingReal(e,s[a],n))&&(a=0);!0===o&&i<200&&isNaN(e.labelRadius)&&(o=e.ty+3*e.iy,e.ty=o,u.translate(e.textX,o),this.checkOverlapping(t,e,n,r,i+1))}},checkOverlappingReal:function(t,e,n){var r=!1,i=t.label,o=e.label;return t.labelQuarter!=n||t.hidden||e.hidden||!o||(i=i.getBBox(),(n={}).width=i.width,n.height=i.height,n.y=t.ty,n.x=t.tx,t=o.getBBox(),(o={}).width=t.width,o.height=t.height,o.y=e.ty,o.x=e.tx,N.hitTest(n,o)&&(r=!0)),r}})}(),function(){"use strict";function o(t){var e=1-t;return 1-(e*=e*e*e)}function l(t,e,n,r){this._object=t,this._key=e,this._from=n,this._to=r}function a(t,e,n,r,i){this._finished=!1,this._startTime=null,this._duration=t,this._easing=null==e?o:e,this._onComplete=n,this._tweens=r,this._chart=i}function t(){this._animating=!1,this._animations=[],this._onBeforeFrames=[],this._onAfterFrames=[];var e=this;this._raf=function(t){e._onFrame(t)}}function u(t,e){for(var n=0;n<t.length;++n)e(t[n])}function r(n,r,i,t){u(t,function(t){var e=i[t];null!=e&&function(t,e,n){e[n]||(e[n]=!0,t.push(n))}(n,r,e)})}function i(t,e,n){r(e,n,t,["alphaField","valueField"])}function s(t,e,n){r(e,n,t,["alphaField","bulletSizeField","closeField","dashLengthField","errorField","highField","lowField","openField","valueField"])}function h(t,e,n){s(t,e,n),r(e,n,t,["xField","yField"])}function c(t,e,n,r){u(t,function(t){r(t,e,n)})}function d(t){var e=[],n={};return"funnel"===t.type?function(t,e,n){i(t,e,n)}(t,e,n):"pie"===t.type?function(t,e,n){i(t,e,n),r(e,n,t,["labelRadiusField"])}(t,e,n):"serial"===t.type?(function(t,e,n){r(e,n,t,["widthField"])}(t.categoryAxis,e,n),c(t.graphs,e,n,s)):"radar"===t.type?c(t.graphs,e,n,s):"xy"===t.type&&c(t.graphs,e,n,h),e}function f(t,e){var n=t[e];return null==n?null:function(t){return t!=t}(n=+n)?null:n}function p(t,e){var n=t[e];return null==n?null:""+n}function g(t,e){if("xy"===t.type){var n=d(t);return function(t,e,n){for(var r=[],i=Math.min(t.length,e.length),o=0;o<i;++o){var a=t[o],s=e[o];u(n,function(t){var e=f(a,t),n=f(s,t);null!=e&&null!=n&&r.push(new l(s,t,e,n))})}return r}(t.dataProvider,e,n)}var r=function(t){return"funnel"===t.type||"pie"===t.type?t.titleField:"serial"===t.type||"radar"===t.type?t.categoryField:void 0}(t);n=d(t);return function(t,e,n,o){var a=[];return u(t,function(r){var t=p(r,e);if(null!=t&&t in n){var i=n[t];u(o,function(t){var e=f(i,t),n=f(r,t);null!=e&&null!=n&&a.push(new l(r,t,e,n))})}}),a}(e,r,function(t,n){var r={};return u(t,function(t){var e=p(t,n);null!=e&&(r[e]=t)}),r}(t.dataProvider,r),n)}function e(t,e){var n=this,r=g(n,t);if(e.fixedMinMax)var i=function(t){var o={};return"serial"!==t.type&&"radar"!==t.type&&"xy"!==t.type||u(t.valueAxes,function(t){if(null==o[t.id]){o[t.id]={minimum:t.minimum,maximum:t.maximum};var e,n=t.minRR,r=t.maxRR,i=r-n;e=0==i?Math.pow(10,Math.floor(Math.log(Math.abs(r))*Math.LOG10E))/10:Math.pow(10,Math.floor(Math.log(Math.abs(i))*Math.LOG10E))/10,null==t.minimum&&(t.minimum=Math.floor(n/e)*e-e),null==t.maximum&&(t.maximum=Math.ceil(r/e)*e+e)}}),o}(n);n.dataProvider=t;var o=new a(e.duration,e.easing,function(){e.fixedMinMax&&function(t,n){"serial"!==t.type&&"radar"!==t.type&&"xy"!==t.type||u(t.valueAxes,function(t){var e=n[t.id];null!=e&&(null==e.minimum&&delete t.minimum,null==e.maximum&&delete t.maximum)})}(n,i),null!=e.complete&&e.complete()},r,n);return m.animate(o),o}if("undefined"==typeof requestAnimationFrame)var v=function(t){setTimeout(function(){t((new Date).getTime())},1e3/60)};else v=requestAnimationFrame;l.prototype.interpolate=function(t){this._object[this._key]=function(t,e,n){return t*(n-e)+e}(t,this._from,this._to)},a.prototype.cancel=function(){this._finished=!0,this._startTime=null,this._duration=null,this._easing=null,this._onComplete=null,this._tweens=null,this._chart=null},a.prototype._onFrame=function(t){if(this._finished)return!0;if(null===this._startTime)return this._startTime=t,!1;var e=t-this._startTime;return e<this._duration?(this._tick(e/this._duration),!1):(this._end(1),this.cancel(),!0)},a.prototype._tick=function(t){t=this._easing(t);for(var e=this._tweens,n=0;n<e.length;++n)e[n].interpolate(t);!function(t,e){for(var n=0;n<t.length;++n)if(t[n]===e)return;t.push(e)}(y,this._chart)},a.prototype._end=function(t){this._tick(t),this._onComplete()},t.prototype.animate=function(t){this._animations.push(t),this._animating||(this._animating=!0,v(this._raf))},t.prototype.onBeforeFrame=function(t){this._onBeforeFrames.push(t)},t.prototype.onAfterFrame=function(t){this._onAfterFrames.push(t)},t.prototype._onFrame=function(t){for(var e=this._onBeforeFrames,n=0;n<e.length;++n)e[n](t);var r=this._animations;for(n=0;n<r.length;++n){r[n]._onFrame(t)&&(r.splice(n,1),--n)}var i=this._onAfterFrames;for(n=0;n<i.length;++n)i[n](t);0===r.length?this._animating=!1:v(this._raf)};var m=new t,y=[];m.onAfterFrame(function(){for(var t=0;t<y.length;++t)y[t].validateData();y.length=0}),AmCharts.addInitHandler(function(t){t.animateData=e},["funnel","pie","serial","radar","xy"])}(),AmCharts.themes.light={themeName:"light",AmChart:{color:"#000000",backgroundColor:"#FFFFFF"},AmCoordinateChart:{colors:["#67b7dc","#fdd400","#84b761","#cc4748","#cd82ad","#2f4074","#448e4d","#b7b83f","#b9783f","#b93e3d","#913167"]},AmStockChart:{colors:["#67b7dc","#fdd400","#84b761","#cc4748","#cd82ad","#2f4074","#448e4d","#b7b83f","#b9783f","#b93e3d","#913167"]},AmSlicedChart:{colors:["#67b7dc","#fdd400","#84b761","#cc4748","#cd82ad","#2f4074","#448e4d","#b7b83f","#b9783f","#b93e3d","#913167"],outlineAlpha:1,outlineThickness:2,labelTickColor:"#000000",labelTickAlpha:.3},AmRectangularChart:{zoomOutButtonColor:"#000000",zoomOutButtonRollOverAlpha:.15,zoomOutButtonImage:"lens"},AxisBase:{axisColor:"#000000",axisAlpha:.3,gridAlpha:.1,gridColor:"#000000"},ChartScrollbar:{backgroundColor:"#000000",backgroundAlpha:.12,graphFillAlpha:.5,graphLineAlpha:0,selectedBackgroundColor:"#FFFFFF",selectedBackgroundAlpha:.4,gridAlpha:.15},ChartCursor:{cursorColor:"#000000",color:"#FFFFFF",cursorAlpha:.5},AmLegend:{color:"#000000"},AmGraph:{lineAlpha:.9},GaugeArrow:{color:"#000000",alpha:.8,nailAlpha:0,innerRadius:"40%",nailRadius:15,startWidth:15,borderAlpha:.8,nailBorderAlpha:0},GaugeAxis:{tickColor:"#000000",tickAlpha:1,tickLength:15,minorTickLength:8,axisThickness:3,axisColor:"#000000",axisAlpha:1,bandAlpha:.8},TrendLine:{lineColor:"#c03246",lineAlpha:.8},AreasSettings:{alpha:.8,color:"#67b7dc",colorSolid:"#003767",unlistedAreasAlpha:.4,unlistedAreasColor:"#000000",outlineColor:"#FFFFFF",outlineAlpha:.5,outlineThickness:.5,rollOverColor:"#3c5bdc",rollOverOutlineColor:"#FFFFFF",selectedOutlineColor:"#FFFFFF",selectedColor:"#f15135",unlistedAreasOutlineColor:"#FFFFFF",unlistedAreasOutlineAlpha:.5},LinesSettings:{color:"#000000",alpha:.8},ImagesSettings:{alpha:.8,labelColor:"#000000",color:"#000000",labelRollOverColor:"#3c5bdc"},ZoomControl:{buttonFillAlpha:.7,buttonIconColor:"#a7a7a7"},SmallMap:{mapColor:"#000000",rectangleColor:"#f15135",backgroundColor:"#FFFFFF",backgroundAlpha:.7,borderThickness:1,borderAlpha:.8},PeriodSelector:{color:"#000000"},PeriodButton:{color:"#000000",background:"transparent",opacity:.7,border:"1px solid rgba(0, 0, 0, .3)",MozBorderRadius:"5px",borderRadius:"5px",margin:"1px",outline:"none",boxSizing:"border-box"},PeriodButtonSelected:{color:"#000000",backgroundColor:"#b9cdf5",border:"1px solid rgba(0, 0, 0, .3)",MozBorderRadius:"5px",borderRadius:"5px",margin:"1px",outline:"none",opacity:1,boxSizing:"border-box"},PeriodInputField:{color:"#000000",background:"transparent",border:"1px solid rgba(0, 0, 0, .3)",outline:"none"},DataSetSelector:{color:"#000000",selectedBackgroundColor:"#b9cdf5",rollOverBackgroundColor:"#a8b0e4"},DataSetCompareList:{color:"#000000",lineHeight:"100%",boxSizing:"initial",webkitBoxSizing:"initial",border:"1px solid rgba(0, 0, 0, .3)"},DataSetSelect:{border:"1px solid rgba(0, 0, 0, .3)",outline:"none"}};